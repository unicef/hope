<<<<<<<< HEAD:src/hope/apps/web/static/web/assets/main-CA-9Gfxd.js
import{_ as ca,m as fs,l as mt,u as ts,a as V,b as ge,r as A,s as T,c as je,j as e,B as P,d as H,R as dc,L as ys,D as Lh,A as cc,T as ee,e as M,f as ha,g as ks,C as la,G as p,P as us,h as yt,I as dt,S as Pa,F as tt,i as Ct,k as at,n as Rt,o as Ve,M as de,V as Oh,p as kh,q as ut,t as wh,v as Mh,w as on,E as za,x as $h,y as Ua,K as rl,z as ll,H as Uh,J as Os,N as ia,O as Ls,Q,U as xe,W as B,X as In,Y as Gt,Z as uc,$ as Ms,a0 as Rs,a1 as is,a2 as os,a3 as Vh,a4 as Le,a5 as Be,a6 as yo,a7 as Et,a8 as Zs,a9 as bt,aa as Ta,ab as Ra,ac as qa,ad as ma,ae as kn,af as hs,ag as be,ah as _,ai as ns,aj as Ft,ak as hc,al as gs,am as Ut,an as mc,ao as pc,ap as cs,aq as Bh,ar as Gh,as as bo,at as sa,au as Js,av as pa,aw as Ma,ax as ol,ay as Si,az as gc,aA as ct,aB as fi,aC as kt,aD as Ii,aE as zh,aF as Fe,aG as qh,aH as dl,aI as Ha,aJ as cl,aK as wn,aL as dn,aM as jo,aN as Hh,aO as Wa,aP as Wh,aQ as Kh,aR as Xt,aS as yi,aT as Ao,aU as Hr,aV as Di,aW as Yh,aX as xc,aY as Qh,aZ as Xh,a_ as Jh,a$ as Ee,b0 as At,b1 as Ot,b2 as fc,b3 as Zh,b4 as ul,b5 as oa,b6 as yc,b7 as em,b8 as sm,b9 as Ti,ba as tm,bb as am,bc as nm,bd as Wt,be as bc,bf as Dn,bg as Tn,bh as Ri,bi as im,bj as or,bk as jc,bl as rm,bm as Ac,bn as hl,bo as lm,bp as om,bq as dm,br as cm,bs as um,bt as hm,bu as mm,bv as pm,bw as gm,bx as xm,by as fm,bz as ym,bA as bm,bB as jm,bC as Am,bD as _o,bE as Po,bF as _m,bG as Pm,bH as dr,bI as Cm,bJ as Em,bK as vm,bL as Sm,bM as Im,bN as _c,bO as Dm,bP as Tm,bQ as Rm,bR as Co,bS as Fm,bT as Pc,bU as Fi,bV as Jn,bW as Zn,bX as ml,bY as Nm,bZ as Lm,b_ as pl,b$ as Cc,c0 as Om,c1 as km,c2 as Ca,c3 as gl,c4 as Ec,c5 as wm,c6 as Ka,c7 as Ni,c8 as vc,c9 as Sc,ca as xl,cb as Mm,cc as fl,cd as $m,ce as Um,cf as Vm,cg as Bm,ch as Gm,ci as zm,cj as Wr,ck as Ic,cl as ja,cm as Dc,cn as Tc,co as qm,cp as Hm,cq as Wm,cr as Km,cs as Eo,ct as Ym,cu as Qm,cv as Xm,cw as Jm,cx as Zm,cy as ep,cz as sp,cA as Zt,cB as tp,cC as ap,cD as np,cE as ip,cF as Fa,cG as rp,cH as lp,cI as op,cJ as dp,cK as cp,cL as up,cM as hp,cN as mp,cO as pp,cP as gp,cQ as xp,cR as fp,cS as yp}from"./vendor-CnWCQu-3.js";const bp="4.7.0",Rc={version:bp};var bs=(s=>(s.RULE_ENGINE_RUN="RULE_ENGINE_RUN",s.RULE_ENGINE_ERROR="RULE_ENGINE_ERROR",s.XLSX_EXPORTING="XLSX_EXPORTING",s.XLSX_EXPORT_ERROR="XLSX_EXPORT_ERROR",s.XLSX_IMPORT_ERROR="XLSX_IMPORT_ERROR",s.XLSX_IMPORTING_ENTITLEMENTS="XLSX_IMPORTING_ENTITLEMENTS",s.XLSX_IMPORTING_RECONCILIATION="XLSX_IMPORTING_RECONCILIATION",s.EXCLUDE_BENEFICIARIES="EXCLUDE_BENEFICIARIES",s.EXCLUDE_BENEFICIARIES_ERROR="EXCLUDE_BENEFICIARIES_ERROR",s.SEND_TO_PAYMENT_GATEWAY="SEND_TO_PAYMENT_GATEWAY",s.SEND_TO_PAYMENT_GATEWAY_ERROR="SEND_TO_PAYMENT_GATEWAY_ERROR",s))(bs||{}),En=(s=>(s.DUPLICATE_IN_BATCH="DUPLICATE_IN_BATCH",s.NOT_PROCESSED="NOT_PROCESSED",s.SIMILAR_IN_BATCH="SIMILAR_IN_BATCH",s.UNIQUE_IN_BATCH="UNIQUE_IN_BATCH",s))(En||{}),en=(s=>(s.DUPLICATE="DUPLICATE",s.NEEDS_ADJUDICATION="NEEDS_ADJUDICATION",s.NOT_PROCESSED="NOT_PROCESSED",s.POSTPONE="POSTPONE",s.UNIQUE="UNIQUE",s))(en||{}),Kr=(s=>(s.STANDARD="STANDARD",s.SOCIAL="SOCIAL",s))(Kr||{}),yl=(s=>(s.DISABLED="disabled",s.NOT_DISABLED="not disabled",s))(yl||{}),te=(s=>(s.ABORTED="ABORTED",s.ACCEPTED="ACCEPTED",s.CLOSED="CLOSED",s.DRAFT="DRAFT",s.FINISHED="FINISHED",s.IN_APPROVAL="IN_APPROVAL",s.IN_AUTHORIZATION="IN_AUTHORIZATION",s.IN_REVIEW="IN_REVIEW",s.TP_LOCKED="TP_LOCKED",s.LOCKED="LOCKED",s.LOCKED_FSP="LOCKED_FSP",s.TP_OPEN="TP_OPEN",s.OPEN="OPEN",s.PREPARING="PREPARING",s.PROCESSING="PROCESSING",s.STEFICON_COMPLETED="STEFICON_COMPLETED",s.STEFICON_ERROR="STEFICON_ERROR",s.STEFICON_RUN="STEFICON_RUN",s.STEFICON_WAIT="STEFICON_WAIT",s))(te||{}),Li=(s=>(s.DISTRIBUTION_SUCCESSFUL="Distribution Successful",s.NOT_DISTRIBUTED="Not Distributed",s.TRANSACTION_SUCCESSFUL="Transaction Successful",s.TRANSACTION_ERRONEOUS="Transaction Erroneous",s.FORCE_FAILED="Force failed",s.PARTIALLY_DISTRIBUTED="Partially Distributed",s.PENDING="Pending",s.SENT_TO_PAYMENT_GATEWAY="Sent to Payment Gateway",s.SENT_TO_FSP="Sent to FSP",s.MANUALLY_CANCELLED="Manually Cancelled",s))(Li||{}),rn=(s=>(s.ACTIVE="ACTIVE",s.FINISHED="FINISHED",s.INVALID="INVALID",s.PENDING="PENDING",s.RAPID_PRO_ERROR="RAPID_PRO_ERROR",s))(rn||{}),ht=(s=>(s.ACTIVE="ACTIVE",s.DRAFT="DRAFT",s.FINISHED="FINISHED",s))(ht||{}),bl=(s=>(s.PENDING="PENDING",s.MERGED="MERGED",s))(bl||{}),Xs=(s=>(s.LOADING="LOADING",s.DEDUPLICATION="DEDUPLICATION",s.DEDUPLICATION_FAILED="DEDUPLICATION_FAILED",s.IMPORT_SCHEDULED="IMPORT_SCHEDULED",s.IMPORTING="IMPORTING",s.IMPORT_ERROR="IMPORT_ERROR",s.IN_REVIEW="IN_REVIEW",s.MERGE_SCHEDULED="MERGE_SCHEDULED",s.MERGED="MERGED",s.MERGING="MERGING",s.MERGE_ERROR="MERGE_ERROR",s.REFUSED="REFUSED",s))(Xs||{}),Fc=(s=>(s.UNKNOWN="UNKNOWN",s.AUNT_UNCLE="AUNT_UNCLE",s.BROTHER_SISTER="BROTHER_SISTER",s.COUSIN="COUSIN",s.DAUGHTERINLAW_SONINLAW="DAUGHTERINLAW_SONINLAW",s.GRANDDAUGHER_GRANDSON="GRANDDAUGHER_GRANDSON",s.GRANDMOTHER_GRANDFATHER="GRANDMOTHER_GRANDFATHER",s.HEAD="HEAD",s.MOTHER_FATHER="MOTHER_FATHER",s.MOTHERINLAW_FATHERINLAW="MOTHERINLAW_FATHERINLAW",s.NEPHEW_NIECE="NEPHEW_NIECE",s.NON_BENEFICIARY="NON_BENEFICIARY",s.OTHER="OTHER",s.SISTERINLAW_BROTHERINLAW="SISTERINLAW_BROTHERINLAW",s.SON_DAUGHTER="SON_DAUGHTER",s.WIFE_HUSBAND="WIFE_HUSBAND",s.FOSTER_CHILD="FOSTER_CHILD",s.FREE_UNION="FREE_UNION",s))(Fc||{}),Ht=(s=>(s.FULL_LIST="FULL_LIST",s.RANDOM="RANDOM",s))(Ht||{}),Yr=(s=>(s.FULL_LIST="FULL_LIST",s.RANDOM="RANDOM",s))(Yr||{});const z={BASE:"",VERSION:"1.0.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0};class vo extends Error{url;status;statusText;body;request;constructor(t,a,n){super(n),this.name="ApiError",this.url=a.url,this.status=a.status,this.statusText=a.statusText,this.body=a.body,this.request=t}}class jp extends Error{constructor(t){super(t),this.name="CancelError"}get isCancelled(){return!0}}class Ap{#s;#t;#e;#a;#i;#r;#n;constructor(t){this.#s=!1,this.#t=!1,this.#e=!1,this.#a=[],this.#i=new Promise((a,n)=>{this.#r=a,this.#n=n;const i=o=>{this.#s||this.#t||this.#e||(this.#s=!0,this.#r&&this.#r(o))},r=o=>{this.#s||this.#t||this.#e||(this.#t=!0,this.#n&&this.#n(o))},l=o=>{this.#s||this.#t||this.#e||this.#a.push(o)};return Object.defineProperty(l,"isResolved",{get:()=>this.#s}),Object.defineProperty(l,"isRejected",{get:()=>this.#t}),Object.defineProperty(l,"isCancelled",{get:()=>this.#e}),t(i,r,l)})}get[Symbol.toStringTag](){return"Cancellable Promise"}then(t,a){return this.#i.then(t,a)}catch(t){return this.#i.catch(t)}finally(t){return this.#i.finally(t)}cancel(){if(!(this.#s||this.#t||this.#e)){if(this.#e=!0,this.#a.length)try{for(const t of this.#a)t()}catch(t){console.warn("Cancellation threw an error",t);return}this.#a.length=0,this.#n&&this.#n(new jp("Request aborted"))}}get isCancelled(){return this.#e}}const _p={[te.OPEN]:"Open",[te.LOCKED]:"Locked",[te.LOCKED_FSP]:"FSP Locked",[te.IN_APPROVAL]:"In Approval",[te.IN_AUTHORIZATION]:"In Authorization",[te.IN_REVIEW]:"In Review",[te.ACCEPTED]:"Accepted",[te.FINISHED]:"Finished",ASSIGNED:"Assigned"};bs.RULE_ENGINE_RUN+"",bs.RULE_ENGINE_ERROR+"",bs.XLSX_EXPORTING+"",bs.XLSX_EXPORT_ERROR+"",bs.XLSX_IMPORTING_ENTITLEMENTS+"",bs.XLSX_IMPORTING_RECONCILIATION+"",bs.XLSX_IMPORT_ERROR+"";const ze={NEW:1,ASSIGNED:2,IN_PROGRESS:3,ON_HOLD:4,FOR_APPROVAL:5,CLOSED:6},Pp={1:"NEW",2:"ASSIGNED",3:"IN_PROGRESS",4:"ON_HOLD",5:"FOR_APPROVAL",6:"CLOSED"},De={PAYMENT_VERIFICATION:"1",DATA_CHANGE:"2",SENSITIVE_GRIEVANCE:"3",GRIEVANCE_COMPLAINT:"4",NEGATIVE_FEEDBACK:"5",REFERRAL:"6",POSITIVE_FEEDBACK:"7",NEEDS_ADJUDICATION:"8",SYSTEM_FLAGGING:"9",BENEFICIARY:"10"},jl={1:"PAYMENT_VERIFICATION",2:"DATA_CHANGE",3:"SENSITIVE_GRIEVANCE",4:"GRIEVANCE_COMPLAINT",5:"NEGATIVE_FEEDBACK",6:"REFERRAL",7:"POSITIVE_FEEDBACK",8:"NEEDS_ADJUDICATION",9:"SYSTEM_FLAGGING",10:"BENEFICIARY"},$e={EDIT_HOUSEHOLD:"13",EDIT_INDIVIDUAL:"14",DELETE_INDIVIDUAL:"15",ADD_INDIVIDUAL:"16",DELETE_HOUSEHOLD:"17",PAYMENT_COMPLAINT:"18",FSP_COMPLAINT:"19",PARTNER_COMPLAINT:"22"},Oi={1:"DATA_BREACH",2:"BRIBERY_CORRUPTION_KICKBACKS",3:"FRAUD_FORGERY",4:"FRAUD_MISUSE",5:"HARASSMENT",6:"INAPPROPRIATE_STAFF_CONDUCT",7:"UNAUTHORIZED_USE",8:"CONFLICT_OF_INTEREST",9:"GROSS_MISMANAGEMENT",10:"PERSONAL_DISPUTES",11:"SEXUAL_HARASSMENT",12:"MISCELLANEOUS",13:"EDIT_HOUSEHOLD",14:"EDIT_INDIVIDUAL",15:"WITHDRAW_INDIVIDUAL",16:"ADD_INDIVIDUAL",17:"WITHDRAW_HOUSEHOLD",18:"PAYMENT_COMPLAINT",19:"FSP_COMPLAINT",20:"REGISTRATION_COMPLAINT",21:"OTHER_COMPLAINT",22:"PARTNER_COMPLAINT",23:"UNIQUE_IDENTIFIERS_SIMILARITY",24:"BIOGRAPHICAL_DATA_SIMILARITY",25:"BIOMETRICS_SIMILARITY"},Nc=s=>({DATA_CHANGE:`A grievance that is submitted to change in the ${s?.groupLabelPlural} or ${s?.memberLabel} status`,GRIEVANCE_COMPLAINT:`A grievance submitted to express dissatisfaction made about a ${s?.memberLabel}, UNICEF/NGO/Partner/Vendor, about a received service or about the process itself`,REFERRAL:`A grievance submitted to direct the reporting ${s?.memberLabel} to another service provider/actor to provide support/help that is beyond the scope of work of UNICEF`,SENSITIVE_GRIEVANCE:`A grievance that shall be treated with sensitivity or which ${s?.memberLabel} wishes to submit anonymously`,NEEDS_ADJUDICATION:`This is a ticket created for ${s?.memberLabel} records suspected of being potential duplicates. Such a ticket requires a review to decide the appropriate action, either to flag the ${s?.memberLabelPlural} as non-duplicates or to label the record as a duplicate.`,PAYMENT_VERIFICATION:`This refers to a system-generated ticket that is created due to a discrepancy between the amount delivered to the ${s?.memberLabel} (as outlined in the reconciliation report) and the actual amount received by the ${s?.memberLabel} (as reported during the payment verification process).`,SYSTEM_FLAGGING:`This ticket type is generated by the system for a ${s?.memberLabel} who potentially matches a ${s?.memberLabel} on the UN sanction list.`}),Lc=s=>({ADD_INDIVIDUAL:`A grievance submitted to specifically change in the ${s?.groupLabelPlural} to add a ${s?.memberLabel}`,EDIT_HOUSEHOLD:`A grievance submitted to change in the ${s?.groupLabel} data (Address, number of ${s?.memberLabelPlural}, etc.)`,EDIT_INDIVIDUAL:`A grievance submitted to change in the ${s?.groupLabel}’s ${s?.memberLabelPlural} data (Family name, full name, birth date, etc.)`,DELETE_INDIVIDUAL:`A grievance submitted to remove a ${s?.memberLabel} from within a ${s?.groupLabel}`,DELETE_HOUSEHOLD:`A grievance submitted to remove a ${s?.groupLabel}`,PAYMENT_COMPLAINT:"A grievance submitted to complain about payments",FSP_COMPLAINT:"A grievance to report dissatisfaction on service provided by a Financial Service Providers",REGISTRATION_COMPLAINT:`A grievance submitted on issues/difficulties encountered during the registration of ${s?.memberLabelPlural}`,PARTNER_COMPLAINT:"A grievance submitted on issues encountered by an implementing partner",OTHER_COMPLAINT:"Other complaints that do not fall into specific predefined categories",DATA_BREACH:`Grievance on unauthorized access or disclosure of ${s?.memberLabel} data`,BRIBERY_CORRUPTION_KICKBACKS:"Grievance on illicit payments or favors in exchange for personal gain",FRAUD_FORGERY:"Grievance related to identity theft or impersonation to benefit from someones entitlements",FRAUD_MISUSE:"Grievance on forgery actions undertaken by third parties’ individuals",HARASSMENT:"Grievance related to intimidation, mistreatment, or abuse by those in authority",INAPPROPRIATE_STAFF_CONDUCT:"Grievance related to improper behavior or actions (physical or verbal) by program staff",UNAUTHORIZED_USE:"Grievance on improper or unauthorized handling or disposal of assets/funds",CONFLICT_OF_INTEREST:"Grievance on deception or falsification for personal gain",GROSS_MISMANAGEMENT:"Grievance on mismanagement leading to significant negative impact",PERSONAL_DISPUTES:"Grievance on conflicts or disagreements between individuals",SEXUAL_HARASSMENT:"Grievance on unwanted advances, abuse, or exploitation of a sexual nature",MISCELLANEOUS:"Other issues not falling into specific predefined categories"}),sn={userGenerated:0,systemGenerated:1},Qr={0:"user",1:"system"},Xr={All:"all",Active:"active"},Qs={Selection:0,Lookup:1,Verification:2,Description:3},tn={Selection:0,Lookup:1,Verification:2,Description:3},ka={LookUp:0,SampleSize:1,Details:2},Bt={HOUSEHOLD:0,TARGET_POPULATION:1,RDI:2},wa={LookUp:0,SampleSize:1,Details:2},nn={WHOLE_PROGRAM_POPULATION:0,TARGET_POPULATION:1},Oc=s=>s?[{name:`${s.groupLabel}: ascending`,value:"unicef_id"},{name:`${s.groupLabel}: descending`,value:"-unicef_id"},{name:"Status: ascending",value:"status_label"},{name:"Status: descending",value:"-status_label"},{name:`${s.groupLabel} Size: ascending`,value:"size"},{name:`${s.groupLabel} Size: descending`,value:"-size"},{name:"Registration Date: ascending",value:"last_registration_date"},{name:"Registration Date: descending",value:"-last_registration_date"}]:null,kc=s=>s?[{name:`${s.memberLabel}: ascending`,value:"unicef_id"},{name:`${s.memberLabel}: descending`,value:"-unicef_id"},{name:`${s.groupLabel} Size: ascending`,value:"household__size"},{name:`${s.groupLabel} Size: descending`,value:"-household__size"},{name:"Registration Date: ascending",value:"last_registration_date"},{name:"Registration Date: descending",value:"-last_registration_date"}]:null;function bi(s){return typeof s=="string"?mt.startCase(s):String(s)}function Al(s){if(typeof s=="object"&&s!==null)try{return JSON.stringify(s)}catch{return"[object Object]"}return String(s)}function cn(s,t){switch(t){case"NEW":return s.hctPalette.gray;case"READY":return s.hctPalette.orange;case"APPROVED":return s.hctPalette.green;case"MERGED":return s.hctPalette.darkerBlue;case"MERGING":return s.hctPalette.blue;case"CREATING":return s.hctPalette.blue;case"FAILED_MERGE":return s.hctPalette.red;case"FAILED_CREATE":return s.hctPalette.red;default:return s.hctPalette.gray}}const So=new Map([["MALE","Male"],["FEMALE","Female"],["OTHER","Other"],["NOT_COLLECTED","Not Collected"],["NOT_ANSWERED","Not Answered"]]),ga=s=>So.has(s)?So.get(s):s;function wc(s){return Math.floor(s*255).toString(16)}const Mn=s=>s?!s.startsWith("UNICEF Partner for")&&s!=="UNICEF HQ":!1;function _l(s,t){return s.filter(a=>Mn(a.name)).map(a=>({value:a.value,label:a.name,disabled:t.some(n=>n.id===a.value)}))}function Cp(s,t){return s.filter(a=>Mn(a.name)).map(a=>({value:a.id,label:a.name,disabled:t.some(n=>n.id===a.value)}))}function Pl(s,t){switch(t){case ht.DRAFT:return s.hctPalette.gray;case ht.ACTIVE:return s.hctPalette.green;case ht.FINISHED:return s.hctPalette.gray;default:return s.hctPalette.orange}}function Ep(s,t){return t==="ACTIVE"?s.hctPalette.green:s.hctPalette.gray}function Na(s,t){switch(t){case"Pending":case"Sent to Payment Gateway":case"Sent to FSP":return s.hctPalette.orange;case"Distribution Successful":case"Transaction Successful":return s.hctPalette.green;case"Partially Distributed":return s.hctPalette.lightBlue;default:return s.palette.error.main}}function Ya(s){switch(s){case"Pending":return"PENDING";case"Distribution Successful":case"Transaction Successful":return"DELIVERED FULLY";case"Partially Distributed":return"DELIVERED PARTIALLY";case"Not Distributed":return"NOT DELIVERED";case"Force failed":return"FORCE FAILED";case"Manually Cancelled":return"MANUALLY CANCELLED";case"Sent to Payment Gateway":return"SENT TO PAYMENT GATEWAY";case"Sent to FSP":return"SENT TO FSP";default:return"UNSUCCESSFUL"}}function Cl(s){switch(s){case te.OPEN:return"OPEN";case te.LOCKED:return"LOCKED";case te.TP_OPEN:return"OPEN";case te.DRAFT:return"READY FOR PAYMENT MODULE";case te.TP_LOCKED:return"LOCKED";case te.PROCESSING:return"PROCESSING";case te.STEFICON_WAIT:return"STEFICON WAIT";case te.STEFICON_RUN:return"STEFICON RUN";case te.STEFICON_ERROR:return"STEFICON ERROR";case te.STEFICON_COMPLETED:return"STEFICON COMPLETED";default:return"ASSIGNED"}}function El(s,t){switch(t){case"ACTIVE":return s.hctPalette.green;case"PENDING":return s.hctPalette.orange;case"FINISHED":return s.hctPalette.gray;default:return s.palette.error.main}}function $n(s,t){switch(t){case"PENDING":return s.hctPalette.gray;case"RECEIVED":return s.hctPalette.green;case"NOT_RECEIVED":return s.palette.error.main;case"RECEIVED_WITH_ISSUES":return s.hctPalette.orange;default:return s.palette.error.main}}function ki(s,t){switch(t){case"Merged":return s.hctPalette.green;case"In Progress":return s.hctPalette.orange;case"Import Error":case"Merge Error":case"Deduplication Failed":return s.palette.error.main;default:return s.hctPalette.orange}}function vp(s,t){switch(t){case"PENDING":return s.hctPalette.gray;case"UPLOADED":return s.hctPalette.orange;case"IN_PROGRESS":return s.hctPalette.orange;case"FINISHED":return s.hctPalette.green;case"UPLOAD_ERROR":case"ERROR":return s.palette.error.main;default:return s.hctPalette.orange}}function Vt(s,t){const a={ASSIGNED:s.hctPalette.gray,[te.ACCEPTED]:s.hctPalette.green,[te.DRAFT]:s.hctPalette.lighterGray,[te.FINISHED]:s.hctPalette.green,[te.IN_APPROVAL]:s.hctPalette.blue,[te.IN_AUTHORIZATION]:s.hctPalette.blue,[te.IN_REVIEW]:s.hctPalette.blue,[te.LOCKED]:s.hctPalette.gray,[te.LOCKED_FSP]:s.hctPalette.gray,[te.OPEN]:s.hctPalette.lighterGray,[te.PREPARING]:s.hctPalette.blue,[te.PROCESSING]:s.hctPalette.blue,[te.STEFICON_COMPLETED]:s.hctPalette.green,[te.STEFICON_ERROR]:s.palette.error.main,[te.STEFICON_RUN]:s.hctPalette.blue,[te.STEFICON_WAIT]:s.hctPalette.orange,[te.TP_LOCKED]:s.hctPalette.gray,[te.TP_OPEN]:s.hctPalette.lighterGray,[te.ABORTED]:s.hctPalette.red,[te.CLOSED]:s.hctPalette.blue};return t in a?a[t]:s.hctPalette.gray}function Sp(s,t){const a={OK:s.hctPalette.green,FAILED:s.hctPalette.red,BUILDING:s.hctPalette.orange,PENDING:s.hctPalette.gray};return t in a?a[t]:s.palette.error.main}function Ip(s,t){const a={NEW:s.hctPalette.gray,EXPORTED:s.hctPalette.green,FAILED:s.hctPalette.red,TO_EXPORT:s.hctPalette.gray,NOT_SCHEDULED:s.hctPalette.gray,CANCELED:s.hctPalette.gray,EXPORTING:s.hctPalette.orange};return t in a?a[t]:s.palette.error.main}function Dp(s,t){const a={SUCCESSFUL:s.hctPalette.green,FAILED:s.hctPalette.red,PENDING:s.hctPalette.gray,NOT_SCHEDULED:s.hctPalette.gray,CANCELED:s.hctPalette.gray,PROCESSING:s.hctPalette.orange};return t in a?a[t]:s.palette.error.main}function wi(s,t){const a={[bs.RULE_ENGINE_RUN]:s.hctPalette.gray,[bs.RULE_ENGINE_ERROR]:s.palette.error.main,[bs.XLSX_EXPORTING]:s.hctPalette.gray,[bs.XLSX_EXPORT_ERROR]:s.palette.error.main,[bs.XLSX_IMPORTING_ENTITLEMENTS]:s.hctPalette.gray,[bs.XLSX_IMPORTING_RECONCILIATION]:s.hctPalette.gray,[bs.XLSX_IMPORT_ERROR]:s.palette.error.main,[bs.SEND_TO_PAYMENT_GATEWAY]:s.hctPalette.gray,[bs.SEND_TO_PAYMENT_GATEWAY_ERROR]:s.palette.error.main};return t in a?a[t]:s.palette.error.main}function Tp(s,t){switch(t){case"INVITED":return s.hctPalette.gray;case"ACTIVE":return s.hctPalette.green;case"INACTIVE":return s.palette.error.main;default:return s.palette.error.main}}function Un(s,t){switch(t){case"ACTIVE":return s.hctPalette.green;case"INACTIVE":return s.palette.error.main;default:return s.palette.error.main}}function Rp(s,t){switch(t){case"ACTIVE":return s.hctPalette.green;case"INACTIVE":return s.palette.error.main;default:return s.palette.error.main}}function Vn(s,t){switch(t){case"New":return s.hctPalette.orange;case"Assigned":return s.hctPalette.darkerBlue;case"In Progress":return s.hctPalette.green;case"On Hold":return s.palette.error.main;case"For Approval":return s.hctPalette.darkBrown;case"Closed":return s.hctPalette.gray;default:return s.palette.error.main}}function ji(s,t){switch(t){case"Not urgent":case"Low":return s.hctPalette.green;case"Very urgent":case"High":return s.palette.error.main;case"Urgent":case"Medium":return s.hctPalette.orange;default:return s.palette.error.main}}function vl(s,t){switch(t){case"Draft":return s.hctPalette.gray;case"Active":return s.hctPalette.green;case"Finished":return s.hctPalette.gray;default:return s.hctPalette.gray}}function Rn(s){return s.replace(/([A-Z])/g,"_$1").toLowerCase()}function da(s){return Array.isArray(s)?s.map(Mc):s}function Mc(s){return s&&Object.keys(s).reduce((t,a)=>(s[a]==null?t[mt.camelCase(a)]=s[a]:Array.isArray(s[a])?t[mt.camelCase(a)]=da(s[a]):typeof s[a]=="object"?t[Rn(a)]=Mc(s[a]):t[mt.camelCase(a)]=s[a],t),{})}function Fp(s,t){if(s.startsWith("-")){const a=s.replace("-","");return Rn(`${t==="asc"?"-":""}${a}`)}return Rn(`${t==="desc"?"-":""}${s}`)}function _s(s){return s?s.reduce((t,a)=>{const n={...t};return n[a.value]=a.name,n},{}):{}}function Np(s){return typeof s!="string"||!s.length||s.length%4!==0?!1:/^[A-Za-z0-9+/]+={0,2}$/.test(s)}function Ea(s){if(!s)return null;if(!Np(s))return s;if(s.includes(":"))return s.split(":")[1];const t=/^[A-Za-z0-9+/=]+$/;if(s.length%4!==0||!t.test(s))return console.error("decodeIdString: Not a valid base64 string:",s),null;try{return atob(s).split(":")[1]}catch(a){return console.error("Failed to decode string:",a,s),null}}function $c(s,t=!1){if(s==null)return"-";const a=Qe(s,{minimumFractionDigits:2,maximumFractionDigits:2});return a==="-"?"-":`${a}${t?"":" USD"}`}function Ps(s,t="USD"){if(s==null)return"-";const a=s===0?0:s||0,n=typeof a=="string"?parseFloat(a):a;return isNaN(n)?"-":t==="USDC"?`${Qe(n)} ${t}`:t?new Intl.NumberFormat(void 0,{style:"currency",currency:t,currencyDisplay:"code"}).format(n):$c(n,!0)}function Jr(s,t){return!t||!s?0:+(s/t*100).toFixed(2)}function Mi(s,t){return`${Jr(s,t)}%`}function Uc(s){return s&&(parseInt(s,10)>=1e4?`${s.toString().slice(0,-3)}k`:s)}function Qe(s,t){if(s==null)return"-";const a=typeof s=="string"?parseFloat(s):s;if(isNaN(a))return"-";const n={minimumFractionDigits:t?.minimumFractionDigits??0,maximumFractionDigits:t?.maximumFractionDigits??2};return new Intl.NumberFormat(void 0,{minimumFractionDigits:n.minimumFractionDigits,maximumFractionDigits:n.maximumFractionDigits}).format(a)}function $i(s){return _p[s]}function Lp(s,t){const a=s.map((n,i)=>[n,i]);return a.sort((n,i)=>{const r=t(n[0],i[0]);return r!==0?r:n[1]-i[1]}),a.map(n=>n[0])}function Io(s,t,a){return t[a]<s[a]?-1:t[a]>s[a]?1:0}function Op(s,t){return s==="desc"?(a,n)=>Io(a,n,t):(a,n)=>-Io(a,n,t)}function va(s){return s?s?.firstName?`${s?.firstName} ${s?.lastName}`:`${s?.email}`:"-"}const Kt=(s,t)=>s?t===!1?"Invalid Phone Number":s:"-",kp={[De.NEGATIVE_FEEDBACK]:!1,[De.POSITIVE_FEEDBACK]:!1,[De.REFERRAL]:!1,[De.GRIEVANCE_COMPLAINT]:!1,[De.SENSITIVE_GRIEVANCE]:!0,[De.DATA_CHANGE]:!0};function Ui(s,t,a=null,n=kp){const i=s.category?.toString(),r=s.issueType?.toString();if(!(i in t))return a;const l=t[i];return n[i]==="IGNORE"||!n[i]&&r==null?l:r in l?l[r]:a}const Zr=(s,t,a)=>t[s]&&a[s],wp=(s,t)=>s?t?s.split(" ").map(a=>a.substring(0,2)+"*".repeat(3)).join(" "):s:null,rt=s=>s?.message.includes("Permission Denied"),Mp=(s,t,a)=>{let n=t;return a&&(a.type==="SELECT_ONE"&&(n=a.choices.find(i=>i.value===t)?.labelEn||t),a.type==="SELECT_MANY"&&(n=a.choices.filter(r=>t.includes(r.value)).map(r=>r.labelEn).join(", "))),n};function Aa(s){return s??"-"}function Va(s){return s==null?"-":s===!0?"Yes":"No"}const Sl=s=>s>0?s:"<1",Ke=(s,t={})=>{const a={...t};try{const n=new URLSearchParams(s.search);for(const[i,r]of n.entries())if(i in a){const l=a[i];if(Array.isArray(l)){const o=r.split(",");a[i]=[...l,...o]}else a[i]=r!=="true"&&r!=="false"?r:r==="true"}}catch(n){return console.error("Error parsing query parameters:",n),{...t}}return a},Ss=(s,t,a,n,i,r,l)=>({handleFilterChange:(u,h)=>{const m={...n,[u]:h};i(m)},applyFilterChanges:()=>{l(n);const u=new URLSearchParams(a.search);Object.entries(n).forEach(([m,g])=>{if(g!=null&&g!=="")if(Array.isArray(g))u.delete(m),g.forEach(x=>{x!=null&&u.append(m,x)});else{const x=typeof g=="boolean"?g.toString():g;u.set(m,x)}else u.delete(m)});const h=u.toString();t({search:h}),i(n)},clearFilter:()=>{const u=new URLSearchParams(a.search);Object.keys(r).forEach(m=>{u.delete(m)});const h=u.toString();t({search:h}),i(s),l(s)}}),Vc=new Date().setDate(new Date().getDate()+1),ta=new Date;ta.setHours(0,0,0,0);const Yt=(s,t)=>{if(!s)return null;if(t==="startOfDay")return fs.utc(s).startOf("day").toISOString();if(t==="endOfDay")return fs.utc(s).endOf("day").toISOString();throw new Error("Invalid type specified")},Qa=(s,t,a)=>{t==null&&a(s,""),t&&a(s,t)},$p=(s,t)=>t?s===t:!s;function $s(s,t,a){return t?s.map(n=>a[n.id]?{...n,label:a[n.id](t)}:n):s}const Il=s=>s?Object.fromEntries(Object.entries(s).filter(([,t])=>{if(t==null||t===""||Array.isArray(t)&&t.length===1&&t[0]===""||Array.isArray(t)&&t.length===0)return!1;if(typeof t=="string"&&(t.startsWith("{")||t.startsWith("[")))try{const a=JSON.parse(t);if(Array.isArray(a)&&a.length===0)return!1;if(typeof a=="object"&&a!==null)return Object.values(a).some(i=>i!==""&&i!==null&&i!==void 0)}catch{return!0}return!0})):{};function gi(s){const t=["form_errors","household_data"];return ca.isArray(s)?s.map(gi):ca.isObject(s)?ca.reduce(s,(a,n,i)=>{const r=ca.camelCase(i);return t.includes(i)?(a[r]=n,a):i.endsWith("_i_f")||i.endsWith("_h_f")?(a[i]=gi(n),a):(a[r]=gi(n),a)},{}):s}function $a(s){const t=[];return ca.isArray(s)?s.map($a):ca.isObject(s)?ca.reduce(s,(a,n,i)=>{if(t.includes(i))a[ca.snakeCase(i)]=n;else if(/^[a-zA-Z]+\d+$/.test(i))a[i]=$a(n);else{const r=ca.snakeCase(i);a[r]=$a(n)}return a},{}):s}const Up=s=>s?s.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" "):"";function fe(s,t,a="An error occurred"){function n(o){let d=o.replace(/\[\d+\]/g,"");d=d.split(".").pop();let c=d.replace(/_/g," ");return c=c.replace(/([a-z])([A-Z])/g,"$1 $2"),c=c.split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1).toLowerCase()).join(" "),c.trim()}function i(o,d="",c={}){if(Array.isArray(o))o.forEach(u=>{i(u,d,c)});else if(o&&typeof o=="object")Object.entries(o).forEach(([u,h])=>{const m=d?`${d}.${u}`:u;i(h,m,c)});else if(typeof o=="string"){const u=d?n(d):"";c[u]||(c[u]=[]),c[u].push(o)}return c}const r=[];function l(o){const d=(o||"").toString().trim();t(d||a)}if(Array.isArray(s)&&s.every(o=>typeof o=="string")){l(s.join(`  
========
import{_ as da,m as xs,l as ut,u as ss,a as V,b as ge,r as A,s as T,c as je,j as e,B as P,d as H,R as oc,L as fs,D as Nh,A as dc,T as ee,e as M,f as ua,g as Os,C as ra,G as p,P as cs,h as ft,I as lt,S as _a,F as st,i as Pt,k as tt,n as Tt,o as Ve,M as de,V as Lh,p as Oh,q as dt,t as kh,v as wh,w as ln,E as Ga,x as Mh,y as $a,K as il,z as rl,H as $h,J as Ls,N as na,O as Ns,Q,U as xe,W as B,X as Sn,Y as Bt,Z as cc,$ as ws,a0 as Ts,a1 as ns,a2 as ls,a3 as Uh,a4 as Le,a5 as Be,a6 as fo,a7 as Ct,a8 as Js,a9 as yt,aa as Da,ab as Ta,ac as za,ad as ha,ae as On,af as us,ag as be,ah as _,ai as as,aj as Rt,ak as uc,al as ps,am as $t,an as hc,ao as mc,ap as ds,aq as Vh,ar as Bh,as as yo,at as ea,au as Xs,av as ma,aw as wa,ax as ll,ay as Si,az as pc,aA as ot,aB as fi,aC as Ot,aD as Ii,aE as Gh,aF as Fe,aG as zh,aH as ol,aI as qa,aJ as dl,aK as kn,aL as on,aM as bo,aN as qh,aO as Ha,aP as Hh,aQ as Wh,aR as Qt,aS as yi,aT as jo,aU as qr,aV as Di,aW as Kh,aX as gc,aY as Yh,aZ as Qh,a_ as Xh,a$ as Ee,b0 as jt,b1 as Lt,b2 as xc,b3 as Jh,b4 as cl,b5 as la,b6 as fc,b7 as Zh,b8 as em,b9 as Ti,ba as sm,bb as tm,bc as am,bd as Ht,be as yc,bf as In,bg as Dn,bh as Ri,bi as nm,bj as lr,bk as bc,bl as im,bm as jc,bn as ul,bo as rm,bp as lm,bq as om,br as dm,bs as cm,bt as um,bu as hm,bv as mm,bw as pm,bx as gm,by as xm,bz as fm,bA as ym,bB as bm,bC as jm,bD as Ao,bE as _o,bF as Am,bG as _m,bH as or,bI as Pm,bJ as Cm,bK as Em,bL as vm,bM as Sm,bN as Ac,bO as Im,bP as Dm,bQ as Tm,bR as Po,bS as Rm,bT as _c,bU as Fi,bV as Jn,bW as Zn,bX as hl,bY as Fm,bZ as Nm,b_ as ml,b$ as Pc,c0 as Lm,c1 as Om,c2 as Pa,c3 as pl,c4 as Cc,c5 as km,c6 as Wa,c7 as Ni,c8 as Ec,c9 as vc,ca as gl,cb as wm,cc as xl,cd as Mm,ce as $m,cf as Um,cg as Vm,ch as Bm,ci as Gm,cj as Hr,ck as Sc,cl as ba,cm as Ic,cn as Dc,co as zm,cp as qm,cq as Hm,cr as Wm,cs as Co,ct as Km,cu as Ym,cv as Qm,cw as Xm,cx as Jm,cy as Zm,cz as ep,cA as Jt,cB as sp,cC as tp,cD as ap,cE as np,cF as Ra,cG as ip,cH as rp,cI as lp,cJ as op,cK as dp,cL as cp,cM as up,cN as hp,cO as mp,cP as pp,cQ as gp,cR as xp,cS as fp}from"./vendor-xV7mCiQB.js";const yp="4.7.1",Tc={version:yp};var ys=(s=>(s.RULE_ENGINE_RUN="RULE_ENGINE_RUN",s.RULE_ENGINE_ERROR="RULE_ENGINE_ERROR",s.XLSX_EXPORTING="XLSX_EXPORTING",s.XLSX_EXPORT_ERROR="XLSX_EXPORT_ERROR",s.XLSX_IMPORT_ERROR="XLSX_IMPORT_ERROR",s.XLSX_IMPORTING_ENTITLEMENTS="XLSX_IMPORTING_ENTITLEMENTS",s.XLSX_IMPORTING_RECONCILIATION="XLSX_IMPORTING_RECONCILIATION",s.EXCLUDE_BENEFICIARIES="EXCLUDE_BENEFICIARIES",s.EXCLUDE_BENEFICIARIES_ERROR="EXCLUDE_BENEFICIARIES_ERROR",s.SEND_TO_PAYMENT_GATEWAY="SEND_TO_PAYMENT_GATEWAY",s.SEND_TO_PAYMENT_GATEWAY_ERROR="SEND_TO_PAYMENT_GATEWAY_ERROR",s))(ys||{}),Cn=(s=>(s.DUPLICATE_IN_BATCH="DUPLICATE_IN_BATCH",s.NOT_PROCESSED="NOT_PROCESSED",s.SIMILAR_IN_BATCH="SIMILAR_IN_BATCH",s.UNIQUE_IN_BATCH="UNIQUE_IN_BATCH",s))(Cn||{}),Za=(s=>(s.DUPLICATE="DUPLICATE",s.NEEDS_ADJUDICATION="NEEDS_ADJUDICATION",s.NOT_PROCESSED="NOT_PROCESSED",s.POSTPONE="POSTPONE",s.UNIQUE="UNIQUE",s))(Za||{}),Wr=(s=>(s.STANDARD="STANDARD",s.SOCIAL="SOCIAL",s))(Wr||{}),fl=(s=>(s.DISABLED="disabled",s.NOT_DISABLED="not disabled",s))(fl||{}),te=(s=>(s.ABORTED="ABORTED",s.ACCEPTED="ACCEPTED",s.CLOSED="CLOSED",s.DRAFT="DRAFT",s.FINISHED="FINISHED",s.IN_APPROVAL="IN_APPROVAL",s.IN_AUTHORIZATION="IN_AUTHORIZATION",s.IN_REVIEW="IN_REVIEW",s.TP_LOCKED="TP_LOCKED",s.LOCKED="LOCKED",s.LOCKED_FSP="LOCKED_FSP",s.TP_OPEN="TP_OPEN",s.OPEN="OPEN",s.PREPARING="PREPARING",s.PROCESSING="PROCESSING",s.STEFICON_COMPLETED="STEFICON_COMPLETED",s.STEFICON_ERROR="STEFICON_ERROR",s.STEFICON_RUN="STEFICON_RUN",s.STEFICON_WAIT="STEFICON_WAIT",s))(te||{}),Li=(s=>(s.DISTRIBUTION_SUCCESSFUL="Distribution Successful",s.NOT_DISTRIBUTED="Not Distributed",s.TRANSACTION_SUCCESSFUL="Transaction Successful",s.TRANSACTION_ERRONEOUS="Transaction Erroneous",s.FORCE_FAILED="Force failed",s.PARTIALLY_DISTRIBUTED="Partially Distributed",s.PENDING="Pending",s.SENT_TO_PAYMENT_GATEWAY="Sent to Payment Gateway",s.SENT_TO_FSP="Sent to FSP",s.MANUALLY_CANCELLED="Manually Cancelled",s))(Li||{}),nn=(s=>(s.ACTIVE="ACTIVE",s.FINISHED="FINISHED",s.INVALID="INVALID",s.PENDING="PENDING",s.RAPID_PRO_ERROR="RAPID_PRO_ERROR",s))(nn||{}),ct=(s=>(s.ACTIVE="ACTIVE",s.DRAFT="DRAFT",s.FINISHED="FINISHED",s))(ct||{}),yl=(s=>(s.PENDING="PENDING",s.MERGED="MERGED",s))(yl||{}),Qs=(s=>(s.LOADING="LOADING",s.DEDUPLICATION="DEDUPLICATION",s.DEDUPLICATION_FAILED="DEDUPLICATION_FAILED",s.IMPORT_SCHEDULED="IMPORT_SCHEDULED",s.IMPORTING="IMPORTING",s.IMPORT_ERROR="IMPORT_ERROR",s.IN_REVIEW="IN_REVIEW",s.MERGE_SCHEDULED="MERGE_SCHEDULED",s.MERGED="MERGED",s.MERGING="MERGING",s.MERGE_ERROR="MERGE_ERROR",s.REFUSED="REFUSED",s))(Qs||{}),Rc=(s=>(s.UNKNOWN="UNKNOWN",s.AUNT_UNCLE="AUNT_UNCLE",s.BROTHER_SISTER="BROTHER_SISTER",s.COUSIN="COUSIN",s.DAUGHTERINLAW_SONINLAW="DAUGHTERINLAW_SONINLAW",s.GRANDDAUGHER_GRANDSON="GRANDDAUGHER_GRANDSON",s.GRANDMOTHER_GRANDFATHER="GRANDMOTHER_GRANDFATHER",s.HEAD="HEAD",s.MOTHER_FATHER="MOTHER_FATHER",s.MOTHERINLAW_FATHERINLAW="MOTHERINLAW_FATHERINLAW",s.NEPHEW_NIECE="NEPHEW_NIECE",s.NON_BENEFICIARY="NON_BENEFICIARY",s.OTHER="OTHER",s.SISTERINLAW_BROTHERINLAW="SISTERINLAW_BROTHERINLAW",s.SON_DAUGHTER="SON_DAUGHTER",s.WIFE_HUSBAND="WIFE_HUSBAND",s.FOSTER_CHILD="FOSTER_CHILD",s.FREE_UNION="FREE_UNION",s))(Rc||{}),qt=(s=>(s.FULL_LIST="FULL_LIST",s.RANDOM="RANDOM",s))(qt||{}),Kr=(s=>(s.FULL_LIST="FULL_LIST",s.RANDOM="RANDOM",s))(Kr||{});const z={BASE:"",VERSION:"1.0.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0};class Eo extends Error{url;status;statusText;body;request;constructor(t,a,n){super(n),this.name="ApiError",this.url=a.url,this.status=a.status,this.statusText=a.statusText,this.body=a.body,this.request=t}}class bp extends Error{constructor(t){super(t),this.name="CancelError"}get isCancelled(){return!0}}class jp{#s;#t;#e;#a;#i;#r;#n;constructor(t){this.#s=!1,this.#t=!1,this.#e=!1,this.#a=[],this.#i=new Promise((a,n)=>{this.#r=a,this.#n=n;const i=o=>{this.#s||this.#t||this.#e||(this.#s=!0,this.#r&&this.#r(o))},r=o=>{this.#s||this.#t||this.#e||(this.#t=!0,this.#n&&this.#n(o))},l=o=>{this.#s||this.#t||this.#e||this.#a.push(o)};return Object.defineProperty(l,"isResolved",{get:()=>this.#s}),Object.defineProperty(l,"isRejected",{get:()=>this.#t}),Object.defineProperty(l,"isCancelled",{get:()=>this.#e}),t(i,r,l)})}get[Symbol.toStringTag](){return"Cancellable Promise"}then(t,a){return this.#i.then(t,a)}catch(t){return this.#i.catch(t)}finally(t){return this.#i.finally(t)}cancel(){if(!(this.#s||this.#t||this.#e)){if(this.#e=!0,this.#a.length)try{for(const t of this.#a)t()}catch(t){console.warn("Cancellation threw an error",t);return}this.#a.length=0,this.#n&&this.#n(new bp("Request aborted"))}}get isCancelled(){return this.#e}}const Ap={[te.OPEN]:"Open",[te.LOCKED]:"Locked",[te.LOCKED_FSP]:"FSP Locked",[te.IN_APPROVAL]:"In Approval",[te.IN_AUTHORIZATION]:"In Authorization",[te.IN_REVIEW]:"In Review",[te.ACCEPTED]:"Accepted",[te.FINISHED]:"Finished",ASSIGNED:"Assigned"};ys.RULE_ENGINE_RUN+"",ys.RULE_ENGINE_ERROR+"",ys.XLSX_EXPORTING+"",ys.XLSX_EXPORT_ERROR+"",ys.XLSX_IMPORTING_ENTITLEMENTS+"",ys.XLSX_IMPORTING_RECONCILIATION+"",ys.XLSX_IMPORT_ERROR+"";const ze={NEW:1,ASSIGNED:2,IN_PROGRESS:3,ON_HOLD:4,FOR_APPROVAL:5,CLOSED:6},_p={1:"NEW",2:"ASSIGNED",3:"IN_PROGRESS",4:"ON_HOLD",5:"FOR_APPROVAL",6:"CLOSED"},De={PAYMENT_VERIFICATION:"1",DATA_CHANGE:"2",SENSITIVE_GRIEVANCE:"3",GRIEVANCE_COMPLAINT:"4",NEGATIVE_FEEDBACK:"5",REFERRAL:"6",POSITIVE_FEEDBACK:"7",NEEDS_ADJUDICATION:"8",SYSTEM_FLAGGING:"9",BENEFICIARY:"10"},bl={1:"PAYMENT_VERIFICATION",2:"DATA_CHANGE",3:"SENSITIVE_GRIEVANCE",4:"GRIEVANCE_COMPLAINT",5:"NEGATIVE_FEEDBACK",6:"REFERRAL",7:"POSITIVE_FEEDBACK",8:"NEEDS_ADJUDICATION",9:"SYSTEM_FLAGGING",10:"BENEFICIARY"},$e={EDIT_HOUSEHOLD:"13",EDIT_INDIVIDUAL:"14",DELETE_INDIVIDUAL:"15",ADD_INDIVIDUAL:"16",DELETE_HOUSEHOLD:"17",PAYMENT_COMPLAINT:"18",FSP_COMPLAINT:"19",PARTNER_COMPLAINT:"22"},Oi={1:"DATA_BREACH",2:"BRIBERY_CORRUPTION_KICKBACKS",3:"FRAUD_FORGERY",4:"FRAUD_MISUSE",5:"HARASSMENT",6:"INAPPROPRIATE_STAFF_CONDUCT",7:"UNAUTHORIZED_USE",8:"CONFLICT_OF_INTEREST",9:"GROSS_MISMANAGEMENT",10:"PERSONAL_DISPUTES",11:"SEXUAL_HARASSMENT",12:"MISCELLANEOUS",13:"EDIT_HOUSEHOLD",14:"EDIT_INDIVIDUAL",15:"WITHDRAW_INDIVIDUAL",16:"ADD_INDIVIDUAL",17:"WITHDRAW_HOUSEHOLD",18:"PAYMENT_COMPLAINT",19:"FSP_COMPLAINT",20:"REGISTRATION_COMPLAINT",21:"OTHER_COMPLAINT",22:"PARTNER_COMPLAINT",23:"UNIQUE_IDENTIFIERS_SIMILARITY",24:"BIOGRAPHICAL_DATA_SIMILARITY",25:"BIOMETRICS_SIMILARITY"},Fc=s=>({DATA_CHANGE:`A grievance that is submitted to change in the ${s?.groupLabelPlural} or ${s?.memberLabel} status`,GRIEVANCE_COMPLAINT:`A grievance submitted to express dissatisfaction made about a ${s?.memberLabel}, UNICEF/NGO/Partner/Vendor, about a received service or about the process itself`,REFERRAL:`A grievance submitted to direct the reporting ${s?.memberLabel} to another service provider/actor to provide support/help that is beyond the scope of work of UNICEF`,SENSITIVE_GRIEVANCE:`A grievance that shall be treated with sensitivity or which ${s?.memberLabel} wishes to submit anonymously`,NEEDS_ADJUDICATION:`This is a ticket created for ${s?.memberLabel} records suspected of being potential duplicates. Such a ticket requires a review to decide the appropriate action, either to flag the ${s?.memberLabelPlural} as non-duplicates or to label the record as a duplicate.`,PAYMENT_VERIFICATION:`This refers to a system-generated ticket that is created due to a discrepancy between the amount delivered to the ${s?.memberLabel} (as outlined in the reconciliation report) and the actual amount received by the ${s?.memberLabel} (as reported during the payment verification process).`,SYSTEM_FLAGGING:`This ticket type is generated by the system for a ${s?.memberLabel} who potentially matches a ${s?.memberLabel} on the UN sanction list.`}),Nc=s=>({ADD_INDIVIDUAL:`A grievance submitted to specifically change in the ${s?.groupLabelPlural} to add a ${s?.memberLabel}`,EDIT_HOUSEHOLD:`A grievance submitted to change in the ${s?.groupLabel} data (Address, number of ${s?.memberLabelPlural}, etc.)`,EDIT_INDIVIDUAL:`A grievance submitted to change in the ${s?.groupLabel}’s ${s?.memberLabelPlural} data (Family name, full name, birth date, etc.)`,DELETE_INDIVIDUAL:`A grievance submitted to remove a ${s?.memberLabel} from within a ${s?.groupLabel}`,DELETE_HOUSEHOLD:`A grievance submitted to remove a ${s?.groupLabel}`,PAYMENT_COMPLAINT:"A grievance submitted to complain about payments",FSP_COMPLAINT:"A grievance to report dissatisfaction on service provided by a Financial Service Providers",REGISTRATION_COMPLAINT:`A grievance submitted on issues/difficulties encountered during the registration of ${s?.memberLabelPlural}`,PARTNER_COMPLAINT:"A grievance submitted on issues encountered by an implementing partner",OTHER_COMPLAINT:"Other complaints that do not fall into specific predefined categories",DATA_BREACH:`Grievance on unauthorized access or disclosure of ${s?.memberLabel} data`,BRIBERY_CORRUPTION_KICKBACKS:"Grievance on illicit payments or favors in exchange for personal gain",FRAUD_FORGERY:"Grievance related to identity theft or impersonation to benefit from someones entitlements",FRAUD_MISUSE:"Grievance on forgery actions undertaken by third parties’ individuals",HARASSMENT:"Grievance related to intimidation, mistreatment, or abuse by those in authority",INAPPROPRIATE_STAFF_CONDUCT:"Grievance related to improper behavior or actions (physical or verbal) by program staff",UNAUTHORIZED_USE:"Grievance on improper or unauthorized handling or disposal of assets/funds",CONFLICT_OF_INTEREST:"Grievance on deception or falsification for personal gain",GROSS_MISMANAGEMENT:"Grievance on mismanagement leading to significant negative impact",PERSONAL_DISPUTES:"Grievance on conflicts or disagreements between individuals",SEXUAL_HARASSMENT:"Grievance on unwanted advances, abuse, or exploitation of a sexual nature",MISCELLANEOUS:"Other issues not falling into specific predefined categories"}),en={userGenerated:0,systemGenerated:1},Yr={0:"user",1:"system"},Qr={All:"all",Active:"active"},Ys={Selection:0,Lookup:1,Verification:2,Description:3},sn={Selection:0,Lookup:1,Verification:2,Description:3},Oa={LookUp:0,SampleSize:1,Details:2},Vt={HOUSEHOLD:0,TARGET_POPULATION:1,RDI:2},ka={LookUp:0,SampleSize:1,Details:2},an={WHOLE_PROGRAM_POPULATION:0,TARGET_POPULATION:1},Lc=s=>s?[{name:`${s.groupLabel}: ascending`,value:"unicef_id"},{name:`${s.groupLabel}: descending`,value:"-unicef_id"},{name:"Status: ascending",value:"status_label"},{name:"Status: descending",value:"-status_label"},{name:`${s.groupLabel} Size: ascending`,value:"size"},{name:`${s.groupLabel} Size: descending`,value:"-size"},{name:"Registration Date: ascending",value:"last_registration_date"},{name:"Registration Date: descending",value:"-last_registration_date"}]:null,Oc=s=>s?[{name:`${s.memberLabel}: ascending`,value:"unicef_id"},{name:`${s.memberLabel}: descending`,value:"-unicef_id"},{name:`${s.groupLabel} Size: ascending`,value:"household__size"},{name:`${s.groupLabel} Size: descending`,value:"-household__size"},{name:"Registration Date: ascending",value:"last_registration_date"},{name:"Registration Date: descending",value:"-last_registration_date"}]:null;function bi(s){return typeof s=="string"?ut.startCase(s):String(s)}function jl(s){if(typeof s=="object"&&s!==null)try{return JSON.stringify(s)}catch{return"[object Object]"}return String(s)}function dn(s,t){switch(t){case"NEW":return s.hctPalette.gray;case"READY":return s.hctPalette.orange;case"APPROVED":return s.hctPalette.green;case"MERGED":return s.hctPalette.darkerBlue;case"MERGING":return s.hctPalette.blue;case"CREATING":return s.hctPalette.blue;case"FAILED_MERGE":return s.hctPalette.red;case"FAILED_CREATE":return s.hctPalette.red;default:return s.hctPalette.gray}}const vo=new Map([["MALE","Male"],["FEMALE","Female"],["OTHER","Other"],["NOT_COLLECTED","Not Collected"],["NOT_ANSWERED","Not Answered"]]),pa=s=>vo.has(s)?vo.get(s):s;function kc(s){return Math.floor(s*255).toString(16)}const wn=s=>s?!s.startsWith("UNICEF Partner for")&&s!=="UNICEF HQ":!1;function Al(s,t){return s.filter(a=>wn(a.name)).map(a=>({value:a.value,label:a.name,disabled:t.some(n=>n.id===a.value)}))}function Pp(s,t){return s.filter(a=>wn(a.name)).map(a=>({value:a.id,label:a.name,disabled:t.some(n=>n.id===a.value)}))}function _l(s,t){switch(t){case ct.DRAFT:return s.hctPalette.gray;case ct.ACTIVE:return s.hctPalette.green;case ct.FINISHED:return s.hctPalette.gray;default:return s.hctPalette.orange}}function Cp(s,t){switch(t){case"ACTIVE":return s.hctPalette.green;default:return s.hctPalette.gray}}function Fa(s,t){switch(t){case"Pending":case"Sent to Payment Gateway":case"Sent to FSP":return s.hctPalette.orange;case"Distribution Successful":case"Transaction Successful":return s.hctPalette.green;case"Partially Distributed":return s.hctPalette.lightBlue;default:return s.palette.error.main}}function Ka(s){switch(s){case"Pending":return"PENDING";case"Distribution Successful":case"Transaction Successful":return"DELIVERED FULLY";case"Partially Distributed":return"DELIVERED PARTIALLY";case"Not Distributed":return"NOT DELIVERED";case"Force failed":return"FORCE FAILED";case"Manually Cancelled":return"MANUALLY CANCELLED";case"Sent to Payment Gateway":return"SENT TO PAYMENT GATEWAY";case"Sent to FSP":return"SENT TO FSP";default:return"UNSUCCESSFUL"}}function Pl(s){switch(s){case te.OPEN:return"OPEN";case te.LOCKED:return"LOCKED";case te.TP_OPEN:return"OPEN";case te.DRAFT:return"READY FOR PAYMENT MODULE";case te.TP_LOCKED:return"LOCKED";case te.PROCESSING:return"PROCESSING";case te.STEFICON_WAIT:return"STEFICON WAIT";case te.STEFICON_RUN:return"STEFICON RUN";case te.STEFICON_ERROR:return"STEFICON ERROR";case te.STEFICON_COMPLETED:return"STEFICON COMPLETED";default:return"ASSIGNED"}}function Cl(s,t){switch(t){case"ACTIVE":return s.hctPalette.green;case"PENDING":return s.hctPalette.orange;case"FINISHED":return s.hctPalette.gray;default:return s.palette.error.main}}function Mn(s,t){switch(t){case"PENDING":return s.hctPalette.gray;case"RECEIVED":return s.hctPalette.green;case"NOT_RECEIVED":return s.palette.error.main;case"RECEIVED_WITH_ISSUES":return s.hctPalette.orange;default:return s.palette.error.main}}function ki(s,t){switch(t){case"Merged":return s.hctPalette.green;case"In Progress":return s.hctPalette.orange;case"Import Error":case"Merge Error":case"Deduplication Failed":return s.palette.error.main;default:return s.hctPalette.orange}}function Ep(s,t){switch(t){case"PENDING":return s.hctPalette.gray;case"UPLOADED":return s.hctPalette.orange;case"IN_PROGRESS":return s.hctPalette.orange;case"FINISHED":return s.hctPalette.green;case"UPLOAD_ERROR":case"ERROR":return s.palette.error.main;default:return s.hctPalette.orange}}function Ut(s,t){const a={ASSIGNED:s.hctPalette.gray,[te.ACCEPTED]:s.hctPalette.green,[te.DRAFT]:s.hctPalette.lighterGray,[te.FINISHED]:s.hctPalette.green,[te.IN_APPROVAL]:s.hctPalette.blue,[te.IN_AUTHORIZATION]:s.hctPalette.blue,[te.IN_REVIEW]:s.hctPalette.blue,[te.LOCKED]:s.hctPalette.gray,[te.LOCKED_FSP]:s.hctPalette.gray,[te.OPEN]:s.hctPalette.lighterGray,[te.PREPARING]:s.hctPalette.blue,[te.PROCESSING]:s.hctPalette.blue,[te.STEFICON_COMPLETED]:s.hctPalette.green,[te.STEFICON_ERROR]:s.palette.error.main,[te.STEFICON_RUN]:s.hctPalette.blue,[te.STEFICON_WAIT]:s.hctPalette.orange,[te.TP_LOCKED]:s.hctPalette.gray,[te.TP_OPEN]:s.hctPalette.lighterGray,[te.ABORTED]:s.hctPalette.red,[te.CLOSED]:s.hctPalette.blue};return t in a?a[t]:s.hctPalette.gray}function vp(s,t){const a={OK:s.hctPalette.green,FAILED:s.hctPalette.red,BUILDING:s.hctPalette.orange,PENDING:s.hctPalette.gray};return t in a?a[t]:s.palette.error.main}function Sp(s,t){const a={NEW:s.hctPalette.gray,EXPORTED:s.hctPalette.green,FAILED:s.hctPalette.red,TO_EXPORT:s.hctPalette.gray,NOT_SCHEDULED:s.hctPalette.gray,CANCELED:s.hctPalette.gray,EXPORTING:s.hctPalette.orange};return t in a?a[t]:s.palette.error.main}function Ip(s,t){const a={SUCCESSFUL:s.hctPalette.green,FAILED:s.hctPalette.red,PENDING:s.hctPalette.gray,NOT_SCHEDULED:s.hctPalette.gray,CANCELED:s.hctPalette.gray,PROCESSING:s.hctPalette.orange};return t in a?a[t]:s.palette.error.main}function wi(s,t){const a={[ys.RULE_ENGINE_RUN]:s.hctPalette.gray,[ys.RULE_ENGINE_ERROR]:s.palette.error.main,[ys.XLSX_EXPORTING]:s.hctPalette.gray,[ys.XLSX_EXPORT_ERROR]:s.palette.error.main,[ys.XLSX_IMPORTING_ENTITLEMENTS]:s.hctPalette.gray,[ys.XLSX_IMPORTING_RECONCILIATION]:s.hctPalette.gray,[ys.XLSX_IMPORT_ERROR]:s.palette.error.main,[ys.SEND_TO_PAYMENT_GATEWAY]:s.hctPalette.gray,[ys.SEND_TO_PAYMENT_GATEWAY_ERROR]:s.palette.error.main};return t in a?a[t]:s.palette.error.main}function Dp(s,t){switch(t){case"INVITED":return s.hctPalette.gray;case"ACTIVE":return s.hctPalette.green;case"INACTIVE":return s.palette.error.main;default:return s.palette.error.main}}function $n(s,t){switch(t){case"ACTIVE":return s.hctPalette.green;case"INACTIVE":return s.palette.error.main;default:return s.palette.error.main}}function Tp(s,t){switch(t){case"ACTIVE":return s.hctPalette.green;case"INACTIVE":return s.palette.error.main;default:return s.palette.error.main}}function Un(s,t){switch(t){case"New":return s.hctPalette.orange;case"Assigned":return s.hctPalette.darkerBlue;case"In Progress":return s.hctPalette.green;case"On Hold":return s.palette.error.main;case"For Approval":return s.hctPalette.darkBrown;case"Closed":return s.hctPalette.gray;default:return s.palette.error.main}}function ji(s,t){switch(t){case"Not urgent":case"Low":return s.hctPalette.green;case"Very urgent":case"High":return s.palette.error.main;case"Urgent":case"Medium":return s.hctPalette.orange;default:return s.palette.error.main}}function El(s,t){switch(t){case"Draft":return s.hctPalette.gray;case"Active":return s.hctPalette.green;case"Finished":return s.hctPalette.gray;default:return s.hctPalette.gray}}function Tn(s){return s.replace(/([A-Z])/g,"_$1").toLowerCase()}function oa(s){return Array.isArray(s)?s.map(wc):s}function wc(s){return s&&Object.keys(s).reduce((t,a)=>(s[a]==null?t[ut.camelCase(a)]=s[a]:Array.isArray(s[a])?t[ut.camelCase(a)]=oa(s[a]):typeof s[a]=="object"?t[Tn(a)]=wc(s[a]):t[ut.camelCase(a)]=s[a],t),{})}function Rp(s,t){if(s.startsWith("-")){const a=s.replace("-","");return Tn(`${t==="asc"?"-":""}${a}`)}return Tn(`${t==="desc"?"-":""}${s}`)}function As(s){return s?s.reduce((t,a)=>{const n={...t};return n[a.value]=a.name,n},{}):{}}function Fp(s){return typeof s!="string"||!s.length||s.length%4!==0?!1:/^[A-Za-z0-9+/]+={0,2}$/.test(s)}function Ca(s){if(!s)return null;if(!Fp(s))return s;if(s.includes(":"))return s.split(":")[1];const t=/^[A-Za-z0-9+/=]+$/;if(s.length%4!==0||!t.test(s))return console.error("decodeIdString: Not a valid base64 string:",s),null;try{return atob(s).split(":")[1]}catch(a){return console.error("Failed to decode string:",a,s),null}}function Mc(s,t=!1){return`${(s||0).toLocaleString("en-US",{currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2})}${t?"":" USD"}`}function _s(s,t="USD"){if(s==null)return"-";const a=s||0;return t==="USDC"?`${a} ${t}`:t?new Intl.NumberFormat(void 0,{style:"currency",currency:t,currencyDisplay:"code"}).format(Number(a)):Mc(Number(a),!0)}function Xr(s,t){return!t||!s?0:+(s/t*100).toFixed(2)}function Mi(s,t){return`${Xr(s,t)}%`}function $c(s){return s&&(parseInt(s,10)>=1e4?`${s.toString().slice(0,-3)}k`:s)}function $i(s){return Ap[s]}function Np(s,t){const a=s.map((n,i)=>[n,i]);return a.sort((n,i)=>{const r=t(n[0],i[0]);return r!==0?r:n[1]-i[1]}),a.map(n=>n[0])}function So(s,t,a){return t[a]<s[a]?-1:t[a]>s[a]?1:0}function Lp(s,t){return s==="desc"?(a,n)=>So(a,n,t):(a,n)=>-So(a,n,t)}function Ea(s){return s?s?.firstName?`${s?.firstName} ${s?.lastName}`:`${s?.email}`:"-"}const Wt=(s,t)=>s?t===!1?"Invalid Phone Number":s:"-",Op={[De.NEGATIVE_FEEDBACK]:!1,[De.POSITIVE_FEEDBACK]:!1,[De.REFERRAL]:!1,[De.GRIEVANCE_COMPLAINT]:!1,[De.SENSITIVE_GRIEVANCE]:!0,[De.DATA_CHANGE]:!0};function Ui(s,t,a=null,n=Op){const i=s.category?.toString(),r=s.issueType?.toString();if(!(i in t))return a;const l=t[i];return n[i]==="IGNORE"||!n[i]&&r==null?l:r in l?l[r]:a}const Jr=(s,t,a)=>t[s]&&a[s],kp=(s,t)=>s?t?s.split(" ").map(a=>a.substring(0,2)+"*".repeat(3)).join(" "):s:null,it=s=>s?.message.includes("Permission Denied"),wp=(s,t,a)=>{let n=t;return a&&(a.type==="SELECT_ONE"&&(n=a.choices.find(i=>i.value===t)?.labelEn||t),a.type==="SELECT_MANY"&&(n=a.choices.filter(r=>t.includes(r.value)).map(r=>r.labelEn).join(", "))),n};function ja(s){return s??"-"}function Ua(s){if(s==null)return"-";switch(s){case!0:return"Yes";default:return"No"}}const vl=s=>s>0?s:"<1",Ke=(s,t={})=>{const a={...t};try{const n=new URLSearchParams(s.search);for(const[i,r]of n.entries())if(i in a){const l=a[i];if(Array.isArray(l)){const o=r.split(",");a[i]=[...l,...o]}else a[i]=r!=="true"&&r!=="false"?r:r==="true"}}catch(n){return console.error("Error parsing query parameters:",n),{...t}}return a},vs=(s,t,a,n,i,r,l)=>({handleFilterChange:(u,h)=>{const m={...n,[u]:h};i(m)},applyFilterChanges:()=>{l(n);const u=new URLSearchParams(a.search);Object.entries(n).forEach(([m,g])=>{if(g!=null&&g!=="")if(Array.isArray(g))u.delete(m),g.forEach(x=>{x!=null&&u.append(m,x)});else{const x=typeof g=="boolean"?g.toString():g;u.set(m,x)}else u.delete(m)});const h=u.toString();t({search:h}),i(n)},clearFilter:()=>{const u=new URLSearchParams(a.search);Object.keys(r).forEach(m=>{u.delete(m)});const h=u.toString();t({search:h}),i(s),l(s)}}),Uc=new Date().setDate(new Date().getDate()+1),sa=new Date;sa.setHours(0,0,0,0);const Kt=(s,t)=>{if(!s)return null;if(t==="startOfDay")return xs.utc(s).startOf("day").toISOString();if(t==="endOfDay")return xs.utc(s).endOf("day").toISOString();throw new Error("Invalid type specified")},Ya=(s,t,a)=>{t==null&&a(s,""),t&&a(s,t)},Mp=(s,t)=>t?s===t:!s;function Ms(s,t,a){return t?s.map(n=>a[n.id]?{...n,label:a[n.id](t)}:n):s}const Sl=s=>s?Object.fromEntries(Object.entries(s).filter(([,t])=>{if(t==null||t===""||Array.isArray(t)&&t.length===1&&t[0]===""||Array.isArray(t)&&t.length===0)return!1;if(typeof t=="string"&&(t.startsWith("{")||t.startsWith("[")))try{const a=JSON.parse(t);if(Array.isArray(a)&&a.length===0)return!1;if(typeof a=="object"&&a!==null)return Object.values(a).some(i=>i!==""&&i!==null&&i!==void 0)}catch{return!0}return!0})):{};function gi(s){const t=["form_errors","household_data"];return da.isArray(s)?s.map(gi):da.isObject(s)?da.reduce(s,(a,n,i)=>{const r=da.camelCase(i);return t.includes(i)?(a[r]=n,a):i.endsWith("_i_f")||i.endsWith("_h_f")?(a[i]=gi(n),a):(a[r]=gi(n),a)},{}):s}function Ma(s){const t=[];return da.isArray(s)?s.map(Ma):da.isObject(s)?da.reduce(s,(a,n,i)=>{if(t.includes(i))a[da.snakeCase(i)]=n;else if(/^[a-zA-Z]+\d+$/.test(i))a[i]=Ma(n);else{const r=da.snakeCase(i);a[r]=Ma(n)}return a},{}):s}const $p=s=>s?s.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" "):"";function fe(s,t,a="An error occurred"){function n(o){let d=o.replace(/\[\d+\]/g,"");d=d.split(".").pop();let c=d.replace(/_/g," ");return c=c.replace(/([a-z])([A-Z])/g,"$1 $2"),c=c.split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1).toLowerCase()).join(" "),c.trim()}function i(o,d="",c={}){if(Array.isArray(o))o.forEach(u=>{i(u,d,c)});else if(o&&typeof o=="object")Object.entries(o).forEach(([u,h])=>{const m=d?`${d}.${u}`:u;i(h,m,c)});else if(typeof o=="string"){const u=d?n(d):"";c[u]||(c[u]=[]),c[u].push(o)}return c}const r=[];function l(o){const d=(o||"").toString().trim();t(d||a)}if(Array.isArray(s)&&s.every(o=>typeof o=="string")){l(s.join(`  
>>>>>>>> 4a8ec9386f (296205_Admin_responsiveness):src/hope/apps/web/static/web/assets/main-mBAVynE0.js
`));return}if(s&&typeof s=="object"&&Array.isArray(s.body)){if(s.body.every(d=>typeof d=="string")){l(s.body.join(`  
`));return}const o=i(s.body);Object.entries(o).forEach(([d,c])=>{c.forEach(u=>{r.push(`${d}: ${u}`)})}),l(r.join(`  
`));return}if(s&&typeof s=="object"&&typeof s.body=="string"){l(s.body);return}if(s&&typeof s=="object"&&typeof s.body=="object"&&s.body!==null){const o=i(s.body);Object.entries(o).forEach(([d,c])=>{c.forEach(u=>{r.push(`${d}: ${u}`)})}),l(r.join(`  
`));return}if(s&&typeof s=="object"&&s!==null){const o=i(s);Object.entries(o).forEach(([d,c])=>{c.forEach(u=>{r.push(`${d}: ${u}`)})}),l(r.join(`  
`));return}if(s&&typeof s=="object"&&typeof s.message=="string"){l(s.message);return}l(a)}function Dl(s,t="An error occurred"){function a(r){let l=r.replace(/\[\d+\]/g,"");l=l.split(".").pop();let o=l.replace(/_/g," ");return o=o.replace(/([a-z])([A-Z])/g,"$1 $2"),o=o.split(" ").map(d=>d.charAt(0).toUpperCase()+d.slice(1).toLowerCase()).join(" "),o.trim()}function n(r,l="",o={}){if(Array.isArray(r))r.forEach(d=>{n(d,l,o)});else if(r&&typeof r=="object")Object.entries(r).forEach(([d,c])=>{const u=l?`${l}.${d}`:d;n(c,u,o)});else if(typeof r=="string"){const d=l?a(l):"";o[d]||(o[d]=[]),o[d].push(r)}return o}const i=[];if(Array.isArray(s)&&s.every(r=>typeof r=="string"))return s.join(`  
`);if(s&&typeof s=="object"&&Array.isArray(s.body)){if(s.body.every(l=>typeof l=="string"))return s.body.join(`  
`);const r=n(s.body);return Object.entries(r).forEach(([l,o])=>{o.forEach(d=>{i.push(`${l}: ${d}`)})}),i.join(`  
`)}if(s&&typeof s=="object"&&typeof s.body=="string")return s.body;if(s&&typeof s=="object"&&typeof s.body=="object"&&s.body!==null){const r=n(s.body);return Object.entries(r).forEach(([l,o])=>{o.forEach(d=>{i.push(`${l}: ${d}`)})}),i.join(`  
`)}if(s&&typeof s=="object"&&s!==null){const r=n(s);return Object.entries(r).forEach(([l,o])=>{o.forEach(d=>{i.push(`${l}: ${d}`)})}),i.join(`  
`)}return s&&typeof s=="object"&&typeof s.message=="string"?s.message:t}function Vp(s){return s?s.replace(/([A-Z])/g," $1").replace(/^./,a=>a.toUpperCase()).trim():""}const Bc=s=>Object.entries(s).map(([t,a])=>{if(a&&typeof a=="object"&&!Array.isArray(a)){const n=Object.entries(a).map(([i,r])=>{let l;return r==null?l="-":typeof r=="boolean"?l=r?"true":"false":typeof r=="number"?l=r.toString():typeof r=="object"?l=JSON.stringify(r):l=r,`${i}: ${l}`}).join(", ");return`${t}: ${n}`}return`${t}: ${String(a)}`}).join(`
`),Gc=s=>s!=null,Vi=s=>typeof s=="string",cr=s=>Vi(s)&&s!=="",zc=s=>typeof s=="object"&&typeof s.type=="string"&&typeof s.stream=="function"&&typeof s.arrayBuffer=="function"&&typeof s.constructor=="function"&&typeof s.constructor.name=="string"&&/^(Blob|File)$/.test(s.constructor.name)&&/^(Blob|File)$/.test(s[Symbol.toStringTag]),Tl=s=>s instanceof FormData,Bp=s=>{try{return btoa(s)}catch{return Buffer.from(s).toString("base64")}},Gp=s=>{const t=[],a=(i,r)=>{t.push(`${encodeURIComponent(i)}=${encodeURIComponent(String(r))}`)},n=(i,r)=>{Gc(r)&&(Array.isArray(r)?r.forEach(l=>{n(i,l)}):typeof r=="object"?Object.entries(r).forEach(([l,o])=>{n(`${i}[${l}]`,o)}):a(i,r))};return Object.entries(s).forEach(([i,r])=>{n(i,r)}),t.length>0?`?${t.join("&")}`:""},zp=(s,t)=>{const a=encodeURI,n=t.url.replace("{api-version}",s.VERSION).replace(/{(.*?)}/g,(r,l)=>t.path?.hasOwnProperty(l)?a(String(t.path[l])):r),i=`${s.BASE}${n}`;return t.query?`${i}${Gp(t.query)}`:i};function qp(s){return s.replace(/([a-z])([A-Z])/g,"$1_$2").replace(/([a-zA-Z])([0-9])/g,"$1_$2").replace(/([0-9])([a-zA-Z])/g,"$1_$2").replace(/_0(\d)(_|$)/g,"_0_$1$2").replace(/_6(\d{2})(_|$)/g,"_6_$1$2").replace(/_1(\d{2})(_|$)/g,"_1_$1$2").replace(/_6_0(_|$)/g,"_60$1").toLowerCase()}function el(s,t,a){const n=t||new FormData;if(typeof s!="object"||s===null||s instanceof File)return a&&(s instanceof File?n.append(a,s):typeof s=="boolean"?n.append(a,s?"true":"false"):s!=null&&n.append(a,s)),n;for(const i in s){if(s[i]===void 0||s[i]===null)continue;const r=s[i],l=qp(i);let o;if(Array.isArray(s)?o=a?`${a}[${i}]`:i:o=a?`${a}.${l}`:l,o=o.replace(/_if/g,"_i_f").replace(/_hf/g,"_h_f"),r instanceof File)n.append(o,r);else if(Array.isArray(r)){if(r.length===0)continue;r.forEach((d,c)=>{el(d,n,`${o}[${c}]`)})}else if(typeof r=="object"&&r!==null){if(Object.keys(r).length===0)continue;el(r,n,o)}else typeof r=="boolean"?n.append(o,r?"true":"false"):n.append(o,r)}return n}const Hp=s=>{if(s.formData)return el(s.formData)},ei=async(s,t)=>t,Wp=async(s,t)=>{const[a,n,i,r]=await Promise.all([ei(t,s.TOKEN),ei(t,s.USERNAME),ei(t,s.PASSWORD),ei(t,s.HEADERS)]),l=Object.entries({Accept:"application/json",...r,...t.headers}).filter(([o,d])=>Gc(d)).reduce((o,[d,c])=>({...o,[d]:String(c)}),{});if(cr(a)&&(l.Authorization=`Bearer ${a}`),cr(n)&&cr(i)){const o=Bp(`${n}:${i}`);l.Authorization=`Basic ${o}`}return t.body!==void 0&&(Tl(t.body)||(t.mediaType?l["Content-Type"]=t.mediaType:zc(t.body)?l["Content-Type"]=t.body.type||"application/octet-stream":Vi(t.body)?l["Content-Type"]="text/plain":l["Content-Type"]="application/json")),new Headers(l)},Kp=s=>{if(s.body!==void 0)return Tl(s.body)?s.body:s.mediaType?.includes("/json")?JSON.stringify(s.body):Vi(s.body)||zc(s.body)?s.body:JSON.stringify(s.body)},Yp=async(s,t,a,n,i,r,l)=>{const o=new AbortController;let d=n;if(Tl(i))d=i;else if(n)try{const m=JSON.parse(n),g=$a(m);"pduFields"in m&&"pdu_fields"in g&&(g.pdu_fields=m.pduFields),d=JSON.stringify(g)}catch{d=n}const c={headers:r,body:d,method:t.method,signal:o.signal};l(()=>o.abort());let u=await fetch(a,c);const h=await u.json();try{if(u?.status==403&&h?.detail!=="Authentication credentials were not provided."){if(Array.isArray(h?.required_permissions)&&h.required_permissions.length>0){const m=new URLSearchParams;return m.set("required_permissions",h.required_permissions.join(",")),h?.detail&&m.set("detail",h.detail),window.location.href=`/access-denied?${m.toString()}`,u}else console.log("No permissions array found in response");return u}else if(u?.status==403&&h?.detail==="Authentication credentials were not provided."){const m=window.location.pathname+window.location.search;let g="";m&&(g=`?next=${encodeURIComponent(m)}`),window.location.href=`/login/${g}`}}catch(m){console.error(m)}return u.json=async()=>{let m=gi(h);return"pdu_fields"in h&&"pduFields"in m&&(m.pduFields=h.pdu_fields),"flex_fields"in h&&"flexFields"in m&&(m.flexFields=h.flex_fields),m},u},Qp=(s,t)=>{if(t){const a=s.headers.get(t);if(Vi(a))return a}},Xp=async s=>{if(s.status!==204)try{const t=s.headers.get("Content-Type");if(t)return["application/json","application/problem+json"].some(i=>t.toLowerCase().startsWith(i))?await s.json():await s.text()}catch(t){console.error(t)}},Jp=(s,t)=>{const n={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...s.errors}[t.status];if(n)throw new vo(s,t,n);if(!t.ok){const i=t.status??"unknown",r=t.statusText??"unknown",l=(()=>{try{return JSON.stringify(t.body,null,2)}catch{return}})();throw new vo(s,t,`Generic Error: status: ${i}; status text: ${r}; body: ${l}`)}},q=(s,t)=>new Ap(async(a,n,i)=>{try{const r=zp(s,t),l=Hp(t),o=Kp(t),d=await Wp(s,t);if(!i.isCancelled){const c=await Yp(s,t,r,o,l,d,i),u=await Xp(c),h=Qp(c,t.responseHeader),m={url:r,ok:c.ok,status:c.status,statusText:c.statusText,body:h??u};Jp(t,m),a(m.body)}}catch(r){n(r)}});class qc{static fieldsAttributesRetrieve(){return q(z,{method:"GET",url:"/api/fields_attributes/"})}}class N{static restRetrieve({format:t,lang:a}){return q(z,{method:"GET",url:"/api/rest/",query:{format:t,lang:a}})}static restBeneficiaryTicketsCreate({businessArea:t,requestBody:a}){return q(z,{method:"POST",url:"/api/rest/{business_area}/beneficiary-tickets/",path:{business_area:t},body:a,mediaType:"application/json"})}static restProgramList({businessArea:t,ordering:a,updatedAtAfter:n,updatedAtBefore:i}){return q(z,{method:"GET",url:"/api/rest/{business_area}/program/",path:{business_area:t},query:{ordering:a,updated_at_after:n,updated_at_before:i}})}static restProgramCreateCreate({businessArea:t,requestBody:a}){return q(z,{method:"POST",url:"/api/rest/{business_area}/program/create/",path:{business_area:t},body:a,mediaType:"application/json"})}static restRdiCompletedCreate({businessArea:t,rdi:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/{business_area}/rdi/{rdi}/completed/",path:{business_area:t,rdi:a},body:n,mediaType:"application/json"})}static restRdiCompletedUpdate({businessArea:t,rdi:a,requestBody:n}){return q(z,{method:"PUT",url:"/api/rest/{business_area}/rdi/{rdi}/completed/",path:{business_area:t,rdi:a},body:n,mediaType:"application/json"})}static restRdiCompletedPartialUpdate({businessArea:t,rdi:a,requestBody:n}){return q(z,{method:"PATCH",url:"/api/rest/{business_area}/rdi/{rdi}/completed/",path:{business_area:t,rdi:a},body:n,mediaType:"application/json"})}static restRdiDelegatePeopleCreate({businessArea:t,rdi:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/{business_area}/rdi/{rdi}/delegate/people/",path:{business_area:t,rdi:a},body:n,mediaType:"application/json"})}static restRdiPushCreate({businessArea:t,rdi:a}){return q(z,{method:"POST",url:"/api/rest/{business_area}/rdi/{rdi}/push/",path:{business_area:t,rdi:a}})}static restRdiPushLaxCreate({businessArea:t,rdi:a}){return q(z,{method:"POST",url:"/api/rest/{business_area}/rdi/{rdi}/push/lax/",path:{business_area:t,rdi:a}})}static restRdiPushLaxHouseholdsCreate({businessArea:t,rdi:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/{business_area}/rdi/{rdi}/push/lax/households/",path:{business_area:t,rdi:a},body:n,mediaType:"application/json"})}static restRdiPushLaxIndividualsCreate({businessArea:t,rdi:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/{business_area}/rdi/{rdi}/push/lax/individuals/",path:{business_area:t,rdi:a},body:n,mediaType:"application/json"})}static restRdiPushPeopleCreate({businessArea:t,rdi:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/{business_area}/rdi/{rdi}/push/people/",path:{business_area:t,rdi:a},body:n,mediaType:"application/json"})}static restRdiCreateCreate({businessArea:t,requestBody:a}){return q(z,{method:"POST",url:"/api/rest/{business_area}/rdi/create/",path:{business_area:t},body:a,mediaType:"application/json"})}static restRdiUploadCreate({businessArea:t,requestBody:a}){return q(z,{method:"POST",url:"/api/rest/{business_area}/rdi/upload/",path:{business_area:t},body:a,mediaType:"application/json"})}static restAreasList({areaTypeAreaLevel:t,countryIsoCode2:a,countryIsoCode3:n,id:i,limit:r,offset:l,ordering:o,parentId:d,parentPCode:c,search:u,updatedAtAfter:h,updatedAtBefore:m,validFromAfter:g,validFromBefore:x,validUntilAfter:f,validUntilBefore:j}){return q(z,{method:"GET",url:"/api/rest/areas/",query:{area_type_area_level:t,country_iso_code2:a,country_iso_code3:n,id:i,limit:r,offset:l,ordering:o,parent_id:d,parent_p_code:c,search:u,updated_at_after:h,updated_at_before:m,valid_from_after:g,valid_from_before:x,valid_until_after:f,valid_until_before:j}})}static restAreatypesList({areaLevel:t,countryIsoCode2:a,countryIsoCode3:n,limit:i,offset:r,ordering:l,parentAreaLevel:o,search:d,updatedAtAfter:c,updatedAtBefore:u}){return q(z,{method:"GET",url:"/api/rest/areatypes/",query:{area_level:t,country_iso_code2:a,country_iso_code3:n,limit:i,offset:r,ordering:l,parent_area_level:o,search:d,updated_at_after:c,updated_at_before:u}})}static restBeneficiaryGroupsList({limit:t,offset:a,ordering:n,updatedAtAfter:i,updatedAtBefore:r}){return q(z,{method:"GET",url:"/api/rest/beneficiary-groups/",query:{limit:t,offset:a,ordering:n,updated_at_after:i,updated_at_before:r}})}static restBusinessAreasList({limit:t,offset:a,ordering:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/",query:{limit:t,offset:a,ordering:n}})}static restBusinessAreasActivityLogsList({businessAreaSlug:t,businessArea:a,limit:n,module:i,objectId:r,offset:l,ordering:o,programId:d,search:c,user:u,userId:h}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/activity-logs/",path:{business_area_slug:t},query:{business_area:a,limit:n,module:i,object_id:r,offset:l,ordering:o,program_id:d,search:c,user:u,user_id:h}})}static restBusinessAreasActivityLogsActionChoicesList({businessAreaSlug:t,businessArea:a,limit:n,module:i,objectId:r,offset:l,ordering:o,programId:d,search:c,user:u,userId:h}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/activity-logs/action-choices/",path:{business_area_slug:t},query:{business_area:a,limit:n,module:i,object_id:r,offset:l,ordering:o,program_id:d,search:c,user:u,user_id:h}})}static restBusinessAreasActivityLogsCountRetrieve({businessAreaSlug:t,businessArea:a,module:n,objectId:i,ordering:r,programId:l,search:o,user:d,userId:c}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/activity-logs/count/",path:{business_area_slug:t},query:{business_area:a,module:n,object_id:i,ordering:r,program_id:l,search:o,user:d,user_id:c}})}static restBusinessAreasAvailableFspsForDeliveryMechanismsList({businessAreaSlug:t}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/available-fsps-for-delivery-mechanisms/",path:{business_area_slug:t}})}static restBusinessAreasFeedbacksList({businessAreaSlug:t,createdAtAfter:a,createdAtBefore:n,createdBy:i,isActiveProgram:r,issueType:l,limit:o,offset:d,orderBy:c,ordering:u,search:h}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/feedbacks/",path:{business_area_slug:t},query:{created_at_after:a,created_at_before:n,created_by:i,is_active_program:r,issue_type:l,limit:o,offset:d,order_by:c,ordering:u,search:h}})}static restBusinessAreasFeedbacksCreate({businessAreaSlug:t,requestBody:a}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/feedbacks/",path:{business_area_slug:t},body:a,mediaType:"application/json"})}static restBusinessAreasFeedbacksRetrieve({businessAreaSlug:t,id:a}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/feedbacks/{id}/",path:{business_area_slug:t,id:a}})}static restBusinessAreasFeedbacksPartialUpdate({businessAreaSlug:t,id:a,requestBody:n}){return q(z,{method:"PATCH",url:"/api/rest/business-areas/{business_area_slug}/feedbacks/{id}/",path:{business_area_slug:t,id:a},body:n,mediaType:"application/json"})}static restBusinessAreasFeedbacksMessageCreate({businessAreaSlug:t,id:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/feedbacks/{id}/message/",path:{business_area_slug:t,id:a},body:n,mediaType:"application/json"})}static restBusinessAreasFeedbacksCountRetrieve({businessAreaSlug:t,createdAtAfter:a,createdAtBefore:n,createdBy:i,isActiveProgram:r,issueType:l,orderBy:o,ordering:d,search:c}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/feedbacks/count/",path:{business_area_slug:t},query:{created_at_after:a,created_at_before:n,created_by:i,is_active_program:r,issue_type:l,order_by:o,ordering:d,search:c}})}static restBusinessAreasGeoAreasList({businessAreaSlug:t,id:a,level:n,name:i,ordering:r,parentId:l,parentPCode:o,updatedAtAfter:d,updatedAtBefore:c}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/geo/areas/",path:{business_area_slug:t},query:{id:a,level:n,name:i,ordering:r,parent_id:l,parent_p_code:o,updated_at_after:d,updated_at_before:c}})}static restBusinessAreasGeoAreasAllAreasTreeList({businessAreaSlug:t,id:a,level:n,name:i,ordering:r,parentId:l,parentPCode:o,updatedAtAfter:d,updatedAtBefore:c}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/geo/areas/all-areas-tree/",path:{business_area_slug:t},query:{id:a,level:n,name:i,ordering:r,parent_id:l,parent_p_code:o,updated_at_after:d,updated_at_before:c}})}static restBusinessAreasGrievanceTicketsList({businessAreaSlug:t,activeProgramsOnly:a,admin1:n,admin2:i,area:r,areaStartswith:l,assignedTo:o,cashPlan:d,category:c,createdAtAfter:u,createdAtBefore:h,createdBy:m,documentNumber:g,documentType:x,fsp:f,grievanceStatus:j,grievanceType:y,household:b,householdId:C,id:v,idStartswith:S,individualId:I,isActiveProgram:E,isCrossArea:D,issueType:F,limit:w,officeSearch:O,offset:k,orderBy:$,ordering:G,paymentRecordIds:W,preferredLanguage:Y,priority:X,program:J,registrationDataImport:ae,scoreMax:re,scoreMin:se,search:le,status:ce,urgency:_e}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/",path:{business_area_slug:t},query:{active_programs_only:a,admin1:n,admin2:i,area:r,area__startswith:l,assigned_to:o,cash_plan:d,category:c,created_at_after:u,created_at_before:h,created_by:m,document_number:g,document_type:x,fsp:f,grievance_status:j,grievance_type:y,household:b,household_id:C,id:v,id__startswith:S,individual_id:I,is_active_program:E,is_cross_area:D,issue_type:F,limit:w,office_search:O,offset:k,order_by:$,ordering:G,payment_record_ids:W,preferred_language:Y,priority:X,program:J,registration_data_import:ae,score_max:re,score_min:se,search:le,status:ce,urgency:_e}})}static restBusinessAreasGrievanceTicketsCreate({businessAreaSlug:t,formData:a,activeProgramsOnly:n,admin1:i,admin2:r,area:l,areaStartswith:o,assignedTo:d,cashPlan:c,category:u,createdAtAfter:h,createdAtBefore:m,createdBy:g,documentNumber:x,documentType:f,fsp:j,grievanceStatus:y,grievanceType:b,household:C,householdId:v,id:S,idStartswith:I,individualId:E,isActiveProgram:D,isCrossArea:F,issueType:w,limit:O,officeSearch:k,offset:$,orderBy:G,ordering:W,paymentRecordIds:Y,preferredLanguage:X,priority:J,program:ae,registrationDataImport:re,scoreMax:se,scoreMin:le,search:ce,status:_e,urgency:ne}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/",path:{business_area_slug:t},query:{active_programs_only:n,admin1:i,admin2:r,area:l,area__startswith:o,assigned_to:d,cash_plan:c,category:u,created_at_after:h,created_at_before:m,created_by:g,document_number:x,document_type:f,fsp:j,grievance_status:y,grievance_type:b,household:C,household_id:v,id:S,id__startswith:I,individual_id:E,is_active_program:D,is_cross_area:F,issue_type:w,limit:O,office_search:k,offset:$,order_by:G,ordering:W,payment_record_ids:Y,preferred_language:X,priority:J,program:ae,registration_data_import:re,score_max:se,score_min:le,search:ce,status:_e,urgency:ne},formData:a,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsRetrieve({businessAreaSlug:t,id:a}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/{id}/",path:{business_area_slug:t,id:a}})}static restBusinessAreasGrievanceTicketsPartialUpdate({businessAreaSlug:t,id:a,formData:n}){return q(z,{method:"PATCH",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/{id}/",path:{business_area_slug:t,id:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsApproveDeleteHouseholdCreate({businessAreaSlug:t,id:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/{id}/approve-delete-household/",path:{business_area_slug:t,id:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsApproveHouseholdDataChangeCreate({businessAreaSlug:t,id:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/{id}/approve-household-data-change/",path:{business_area_slug:t,id:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsApproveIndividualDataChangeCreate({businessAreaSlug:t,id:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/{id}/approve-individual-data-change/",path:{business_area_slug:t,id:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsApproveNeedsAdjudicationCreate({businessAreaSlug:t,id:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/{id}/approve-needs-adjudication/",path:{business_area_slug:t,id:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsApprovePaymentDetailsCreate({businessAreaSlug:t,id:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/{id}/approve-payment-details/",path:{business_area_slug:t,id:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsApproveStatusUpdateCreate({businessAreaSlug:t,id:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/{id}/approve-status-update/",path:{business_area_slug:t,id:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsCreateNoteCreate({businessAreaSlug:t,id:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/{id}/create-note/",path:{business_area_slug:t,id:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsReassignRoleCreate({businessAreaSlug:t,id:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/{id}/reassign-role/",path:{business_area_slug:t,id:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsStatusChangeCreate({businessAreaSlug:t,id:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/{id}/status-change/",path:{business_area_slug:t,id:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsAllAddIndividualsFieldsAttributesList({businessAreaSlug:t,activeProgramsOnly:a,admin1:n,admin2:i,area:r,areaStartswith:l,assignedTo:o,cashPlan:d,category:c,createdAtAfter:u,createdAtBefore:h,createdBy:m,documentNumber:g,documentType:x,fsp:f,grievanceStatus:j,grievanceType:y,household:b,householdId:C,id:v,idStartswith:S,individualId:I,isActiveProgram:E,isCrossArea:D,issueType:F,officeSearch:w,orderBy:O,ordering:k,paymentRecordIds:$,preferredLanguage:G,priority:W,program:Y,registrationDataImport:X,scoreMax:J,scoreMin:ae,search:re,status:se,urgency:le}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/all-add-individuals-fields-attributes/",path:{business_area_slug:t},query:{active_programs_only:a,admin1:n,admin2:i,area:r,area__startswith:l,assigned_to:o,cash_plan:d,category:c,created_at_after:u,created_at_before:h,created_by:m,document_number:g,document_type:x,fsp:f,grievance_status:j,grievance_type:y,household:b,household_id:C,id:v,id__startswith:S,individual_id:I,is_active_program:E,is_cross_area:D,issue_type:F,office_search:w,order_by:O,ordering:k,payment_record_ids:$,preferred_language:G,priority:W,program:Y,registration_data_import:X,score_max:J,score_min:ae,search:re,status:se,urgency:le}})}static restBusinessAreasGrievanceTicketsAllEditHouseholdFieldsAttributesList({businessAreaSlug:t,activeProgramsOnly:a,admin1:n,admin2:i,area:r,areaStartswith:l,assignedTo:o,cashPlan:d,category:c,createdAtAfter:u,createdAtBefore:h,createdBy:m,documentNumber:g,documentType:x,fsp:f,grievanceStatus:j,grievanceType:y,household:b,householdId:C,id:v,idStartswith:S,individualId:I,isActiveProgram:E,isCrossArea:D,issueType:F,limit:w,officeSearch:O,offset:k,orderBy:$,ordering:G,paymentRecordIds:W,preferredLanguage:Y,priority:X,program:J,registrationDataImport:ae,scoreMax:re,scoreMin:se,search:le,status:ce,urgency:_e}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/all-edit-household-fields-attributes/",path:{business_area_slug:t},query:{active_programs_only:a,admin1:n,admin2:i,area:r,area__startswith:l,assigned_to:o,cash_plan:d,category:c,created_at_after:u,created_at_before:h,created_by:m,document_number:g,document_type:x,fsp:f,grievance_status:j,grievance_type:y,household:b,household_id:C,id:v,id__startswith:S,individual_id:I,is_active_program:E,is_cross_area:D,issue_type:F,limit:w,office_search:O,offset:k,order_by:$,ordering:G,payment_record_ids:W,preferred_language:Y,priority:X,program:J,registration_data_import:ae,score_max:re,score_min:se,search:le,status:ce,urgency:_e}})}static restBusinessAreasGrievanceTicketsAllEditPeopleFieldsAttributesList({businessAreaSlug:t,activeProgramsOnly:a,admin1:n,admin2:i,area:r,areaStartswith:l,assignedTo:o,cashPlan:d,category:c,createdAtAfter:u,createdAtBefore:h,createdBy:m,documentNumber:g,documentType:x,fsp:f,grievanceStatus:j,grievanceType:y,household:b,householdId:C,id:v,idStartswith:S,individualId:I,isActiveProgram:E,isCrossArea:D,issueType:F,limit:w,officeSearch:O,offset:k,orderBy:$,ordering:G,paymentRecordIds:W,preferredLanguage:Y,priority:X,program:J,registrationDataImport:ae,scoreMax:re,scoreMin:se,search:le,status:ce,urgency:_e}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/all-edit-people-fields-attributes/",path:{business_area_slug:t},query:{active_programs_only:a,admin1:n,admin2:i,area:r,area__startswith:l,assigned_to:o,cash_plan:d,category:c,created_at_after:u,created_at_before:h,created_by:m,document_number:g,document_type:x,fsp:f,grievance_status:j,grievance_type:y,household:b,household_id:C,id:v,id__startswith:S,individual_id:I,is_active_program:E,is_cross_area:D,issue_type:F,limit:w,office_search:O,offset:k,order_by:$,ordering:G,payment_record_ids:W,preferred_language:Y,priority:X,program:J,registration_data_import:ae,score_max:re,score_min:se,search:le,status:ce,urgency:_e}})}static restBusinessAreasGrievanceTicketsBulkAddNoteCreate({businessAreaSlug:t,formData:a,activeProgramsOnly:n,admin1:i,admin2:r,area:l,areaStartswith:o,assignedTo:d,cashPlan:c,category:u,createdAtAfter:h,createdAtBefore:m,createdBy:g,documentNumber:x,documentType:f,fsp:j,grievanceStatus:y,grievanceType:b,household:C,householdId:v,id:S,idStartswith:I,individualId:E,isActiveProgram:D,isCrossArea:F,issueType:w,limit:O,officeSearch:k,offset:$,orderBy:G,ordering:W,paymentRecordIds:Y,preferredLanguage:X,priority:J,program:ae,registrationDataImport:re,scoreMax:se,scoreMin:le,search:ce,status:_e,urgency:ne}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/bulk-add-note/",path:{business_area_slug:t},query:{active_programs_only:n,admin1:i,admin2:r,area:l,area__startswith:o,assigned_to:d,cash_plan:c,category:u,created_at_after:h,created_at_before:m,created_by:g,document_number:x,document_type:f,fsp:j,grievance_status:y,grievance_type:b,household:C,household_id:v,id:S,id__startswith:I,individual_id:E,is_active_program:D,is_cross_area:F,issue_type:w,limit:O,office_search:k,offset:$,order_by:G,ordering:W,payment_record_ids:Y,preferred_language:X,priority:J,program:ae,registration_data_import:re,score_max:se,score_min:le,search:ce,status:_e,urgency:ne},formData:a,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsBulkUpdateAssigneeCreate({businessAreaSlug:t,formData:a,activeProgramsOnly:n,admin1:i,admin2:r,area:l,areaStartswith:o,assignedTo:d,cashPlan:c,category:u,createdAtAfter:h,createdAtBefore:m,createdBy:g,documentNumber:x,documentType:f,fsp:j,grievanceStatus:y,grievanceType:b,household:C,householdId:v,id:S,idStartswith:I,individualId:E,isActiveProgram:D,isCrossArea:F,issueType:w,limit:O,officeSearch:k,offset:$,orderBy:G,ordering:W,paymentRecordIds:Y,preferredLanguage:X,priority:J,program:ae,registrationDataImport:re,scoreMax:se,scoreMin:le,search:ce,status:_e,urgency:ne}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/bulk-update-assignee/",path:{business_area_slug:t},query:{active_programs_only:n,admin1:i,admin2:r,area:l,area__startswith:o,assigned_to:d,cash_plan:c,category:u,created_at_after:h,created_at_before:m,created_by:g,document_number:x,document_type:f,fsp:j,grievance_status:y,grievance_type:b,household:C,household_id:v,id:S,id__startswith:I,individual_id:E,is_active_program:D,is_cross_area:F,issue_type:w,limit:O,office_search:k,offset:$,order_by:G,ordering:W,payment_record_ids:Y,preferred_language:X,priority:J,program:ae,registration_data_import:re,score_max:se,score_min:le,search:ce,status:_e,urgency:ne},formData:a,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsBulkUpdatePriorityCreate({businessAreaSlug:t,formData:a,activeProgramsOnly:n,admin1:i,admin2:r,area:l,areaStartswith:o,assignedTo:d,cashPlan:c,category:u,createdAtAfter:h,createdAtBefore:m,createdBy:g,documentNumber:x,documentType:f,fsp:j,grievanceStatus:y,grievanceType:b,household:C,householdId:v,id:S,idStartswith:I,individualId:E,isActiveProgram:D,isCrossArea:F,issueType:w,limit:O,officeSearch:k,offset:$,orderBy:G,ordering:W,paymentRecordIds:Y,preferredLanguage:X,priority:J,program:ae,registrationDataImport:re,scoreMax:se,scoreMin:le,search:ce,status:_e,urgency:ne}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/bulk-update-priority/",path:{business_area_slug:t},query:{active_programs_only:n,admin1:i,admin2:r,area:l,area__startswith:o,assigned_to:d,cash_plan:c,category:u,created_at_after:h,created_at_before:m,created_by:g,document_number:x,document_type:f,fsp:j,grievance_status:y,grievance_type:b,household:C,household_id:v,id:S,id__startswith:I,individual_id:E,is_active_program:D,is_cross_area:F,issue_type:w,limit:O,office_search:k,offset:$,order_by:G,ordering:W,payment_record_ids:Y,preferred_language:X,priority:J,program:ae,registration_data_import:re,score_max:se,score_min:le,search:ce,status:_e,urgency:ne},formData:a,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsBulkUpdateUrgencyCreate({businessAreaSlug:t,formData:a,activeProgramsOnly:n,admin1:i,admin2:r,area:l,areaStartswith:o,assignedTo:d,cashPlan:c,category:u,createdAtAfter:h,createdAtBefore:m,createdBy:g,documentNumber:x,documentType:f,fsp:j,grievanceStatus:y,grievanceType:b,household:C,householdId:v,id:S,idStartswith:I,individualId:E,isActiveProgram:D,isCrossArea:F,issueType:w,limit:O,officeSearch:k,offset:$,orderBy:G,ordering:W,paymentRecordIds:Y,preferredLanguage:X,priority:J,program:ae,registrationDataImport:re,scoreMax:se,scoreMin:le,search:ce,status:_e,urgency:ne}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/bulk-update-urgency/",path:{business_area_slug:t},query:{active_programs_only:n,admin1:i,admin2:r,area:l,area__startswith:o,assigned_to:d,cash_plan:c,category:u,created_at_after:h,created_at_before:m,created_by:g,document_number:x,document_type:f,fsp:j,grievance_status:y,grievance_type:b,household:C,household_id:v,id:S,id__startswith:I,individual_id:E,is_active_program:D,is_cross_area:F,issue_type:w,limit:O,office_search:k,offset:$,order_by:G,ordering:W,payment_record_ids:Y,preferred_language:X,priority:J,program:ae,registration_data_import:re,score_max:se,score_min:le,search:ce,status:_e,urgency:ne},formData:a,mediaType:"multipart/form-data"})}static restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:t}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/choices/",path:{business_area_slug:t}})}static restBusinessAreasGrievanceTicketsCountRetrieve({businessAreaSlug:t,activeProgramsOnly:a,admin1:n,admin2:i,area:r,areaStartswith:l,assignedTo:o,cashPlan:d,category:c,createdAtAfter:u,createdAtBefore:h,createdBy:m,documentNumber:g,documentType:x,fsp:f,grievanceStatus:j,grievanceType:y,household:b,householdId:C,id:v,idStartswith:S,individualId:I,isActiveProgram:E,isCrossArea:D,issueType:F,officeSearch:w,orderBy:O,ordering:k,paymentRecordIds:$,preferredLanguage:G,priority:W,program:Y,registrationDataImport:X,scoreMax:J,scoreMin:ae,search:re,status:se,urgency:le}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/count/",path:{business_area_slug:t},query:{active_programs_only:a,admin1:n,admin2:i,area:r,area__startswith:l,assigned_to:o,cash_plan:d,category:c,created_at_after:u,created_at_before:h,created_by:m,document_number:g,document_type:x,fsp:f,grievance_status:j,grievance_type:y,household:b,household_id:C,id:v,id__startswith:S,individual_id:I,is_active_program:E,is_cross_area:D,issue_type:F,office_search:w,order_by:O,ordering:k,payment_record_ids:$,preferred_language:G,priority:W,program:Y,registration_data_import:X,score_max:J,score_min:ae,search:re,status:se,urgency:le}})}static restBusinessAreasGrievanceTicketsDashboardRetrieve({businessAreaSlug:t}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/grievance-tickets/dashboard/",path:{business_area_slug:t}})}static restBusinessAreasHouseholdsList({businessAreaSlug:t,activeProgramsOnly:a,address:n,admin1:i,admin2:r,adminArea:l,countryOrigin:o,documentNumber:d,documentType:c,firstRegistrationDate:u,headOfHouseholdFullName:h,headOfHouseholdPhoneNoValid:m,isActiveProgram:g,lastRegistrationDateAfter:x,lastRegistrationDateBefore:f,limit:j,messageId:y,officeSearch:b,offset:C,orderBy:v,ordering:S,phoneNo:I,program:E,rdiId:D,rdiMergeStatus:F,recipientId:w,residenceStatus:O,search:k,sex:$,sizeGte:G,sizeLte:W,sizeRange:Y,sizeMax:X,sizeMin:J,surveyId:ae,unicefId:re,updatedAtAfter:se,updatedAtBefore:le,withdrawn:ce}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/households/",path:{business_area_slug:t},query:{active_programs_only:a,address:n,admin1:i,admin2:r,admin_area:l,country_origin:o,document_number:d,document_type:c,first_registration_date:u,head_of_household__full_name:h,head_of_household__phone_no_valid:m,is_active_program:g,last_registration_date_after:x,last_registration_date_before:f,limit:j,message_id:y,office_search:b,offset:C,order_by:v,ordering:S,phone_no:I,program:E,rdi_id:D,rdi_merge_status:F,recipient_id:w,residence_status:O,search:k,sex:$,size__gte:G,size__lte:W,size__range:Y,size_max:X,size_min:J,survey_id:ae,unicef_id:re,updated_at_after:se,updated_at_before:le,withdrawn:ce}})}static restBusinessAreasHouseholdsChoicesRetrieve({businessAreaSlug:t}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/households/choices/",path:{business_area_slug:t}})}static restBusinessAreasHouseholdsCountRetrieve({businessAreaSlug:t,activeProgramsOnly:a,address:n,admin1:i,admin2:r,adminArea:l,countryOrigin:o,documentNumber:d,documentType:c,firstRegistrationDate:u,headOfHouseholdFullName:h,headOfHouseholdPhoneNoValid:m,isActiveProgram:g,lastRegistrationDateAfter:x,lastRegistrationDateBefore:f,messageId:j,officeSearch:y,orderBy:b,ordering:C,phoneNo:v,program:S,rdiId:I,rdiMergeStatus:E,recipientId:D,residenceStatus:F,search:w,sex:O,sizeGte:k,sizeLte:$,sizeRange:G,sizeMax:W,sizeMin:Y,surveyId:X,unicefId:J,updatedAtAfter:ae,updatedAtBefore:re,withdrawn:se}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/households/count/",path:{business_area_slug:t},query:{active_programs_only:a,address:n,admin1:i,admin2:r,admin_area:l,country_origin:o,document_number:d,document_type:c,first_registration_date:u,head_of_household__full_name:h,head_of_household__phone_no_valid:m,is_active_program:g,last_registration_date_after:x,last_registration_date_before:f,message_id:j,office_search:y,order_by:b,ordering:C,phone_no:v,program:S,rdi_id:I,rdi_merge_status:E,recipient_id:D,residence_status:F,search:w,sex:O,size__gte:k,size__lte:$,size__range:G,size_max:W,size_min:Y,survey_id:X,unicef_id:J,updated_at_after:ae,updated_at_before:re,withdrawn:se}})}static restBusinessAreasImportDataRetrieve({businessAreaSlug:t,id:a}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/import-data/{id}/",path:{business_area_slug:t,id:a}})}static restBusinessAreasIndividualsList({businessAreaSlug:t,activeProgramsOnly:a,admin1:n,admin2:i,ageMax:r,ageMin:l,documentNumber:o,documentType:d,duplicatesOnly:c,excludedId:u,flags:h,fullName:m,householdId:g,isActiveProgram:x,lastRegistrationDateAfter:f,lastRegistrationDateBefore:j,limit:y,officeSearch:b,offset:C,orderBy:v,ordering:S,program:I,rdiId:E,rdiMergeStatus:D,search:F,sex:w,status:O,updatedAtAfter:k,updatedAtBefore:$,withdrawn:G}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/individuals/",path:{business_area_slug:t},query:{active_programs_only:a,admin1:n,admin2:i,age_max:r,age_min:l,document_number:o,document_type:d,duplicates_only:c,excluded_id:u,flags:h,full_name:m,household__id:g,is_active_program:x,last_registration_date_after:f,last_registration_date_before:j,limit:y,office_search:b,offset:C,order_by:v,ordering:S,program:I,rdi_id:E,rdi_merge_status:D,search:F,sex:w,status:O,updated_at_after:k,updated_at_before:$,withdrawn:G}})}static restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:t}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/individuals/choices/",path:{business_area_slug:t}})}static restBusinessAreasIndividualsCountRetrieve({businessAreaSlug:t,activeProgramsOnly:a,admin1:n,admin2:i,ageMax:r,ageMin:l,documentNumber:o,documentType:d,duplicatesOnly:c,excludedId:u,flags:h,fullName:m,householdId:g,isActiveProgram:x,lastRegistrationDateAfter:f,lastRegistrationDateBefore:j,officeSearch:y,orderBy:b,ordering:C,program:v,rdiId:S,rdiMergeStatus:I,search:E,sex:D,status:F,updatedAtAfter:w,updatedAtBefore:O,withdrawn:k}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/individuals/count/",path:{business_area_slug:t},query:{active_programs_only:a,admin1:n,admin2:i,age_max:r,age_min:l,document_number:o,document_type:d,duplicates_only:c,excluded_id:u,flags:h,full_name:m,household__id:g,is_active_program:x,last_registration_date_after:f,last_registration_date_before:j,office_search:y,order_by:b,ordering:C,program:v,rdi_id:S,rdi_merge_status:I,search:E,sex:D,status:F,updated_at_after:w,updated_at_before:O,withdrawn:k}})}static restBusinessAreasKoboImportDataRetrieve({businessAreaSlug:t,id:a}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/kobo-import-data/{id}/",path:{business_area_slug:t,id:a}})}static restBusinessAreasPaymentPlansList({businessAreaSlug:t,activeProgramsOnly:a,deliveryMechanism:n,endDate:i,fsp:r,isFollowUp:l,limit:o,name:d,officeSearch:c,offset:u,ordering:h,paymentVerificationSummaryStatus:m,program:g,programCycle:x,programCycleEndDate:f,programCycleStartDate:j,search:y,startDate:b,status:C,totalEntitledQuantityGte:v,totalEntitledQuantityLte:S,totalEntitledQuantityUsdFrom:I,totalEntitledQuantityUsdTo:E,updatedAtGte:D,updatedAtLte:F}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/payment-plans/",path:{business_area_slug:t},query:{active_programs_only:a,delivery_mechanism:n,end_date:i,fsp:r,is_follow_up:l,limit:o,name:d,office_search:c,offset:u,ordering:h,payment_verification_summary_status:m,program:g,program_cycle:x,program_cycle_end_date:f,program_cycle_start_date:j,search:y,start_date:b,status:C,total_entitled_quantity__gte:v,total_entitled_quantity__lte:S,total_entitled_quantity_usd_from:I,total_entitled_quantity_usd_to:E,updated_at__gte:D,updated_at__lte:F}})}static restBusinessAreasPaymentPlansCountRetrieve({businessAreaSlug:t,activeProgramsOnly:a,deliveryMechanism:n,endDate:i,fsp:r,isFollowUp:l,name:o,officeSearch:d,ordering:c,paymentVerificationSummaryStatus:u,program:h,programCycle:m,programCycleEndDate:g,programCycleStartDate:x,search:f,startDate:j,status:y,totalEntitledQuantityGte:b,totalEntitledQuantityLte:C,totalEntitledQuantityUsdFrom:v,totalEntitledQuantityUsdTo:S,updatedAtGte:I,updatedAtLte:E}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/payment-plans/count/",path:{business_area_slug:t},query:{active_programs_only:a,delivery_mechanism:n,end_date:i,fsp:r,is_follow_up:l,name:o,office_search:d,ordering:c,payment_verification_summary_status:u,program:h,program_cycle:m,program_cycle_end_date:g,program_cycle_start_date:x,search:f,start_date:j,status:y,total_entitled_quantity__gte:b,total_entitled_quantity__lte:C,total_entitled_quantity_usd_from:v,total_entitled_quantity_usd_to:S,updated_at__gte:I,updated_at__lte:E}})}static restBusinessAreasPaymentsList({businessAreaSlug:t,activeProgramsOnly:a,limit:n,officeSearch:i,offset:r,ordering:l}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/payments/",path:{business_area_slug:t},query:{active_programs_only:a,limit:n,office_search:i,offset:r,ordering:l}})}static restBusinessAreasPaymentsChoicesRetrieve({businessAreaSlug:t}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/payments/choices/",path:{business_area_slug:t}})}static restBusinessAreasPaymentsCountRetrieve({businessAreaSlug:t,activeProgramsOnly:a,officeSearch:n,ordering:i}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/payments/count/",path:{business_area_slug:t},query:{active_programs_only:a,office_search:n,ordering:i}})}static restBusinessAreasPaymentsPaymentPlansManagerialList({businessAreaSlug:t,deliveryMechanism:a,endDate:n,fsp:i,isFollowUp:r,limit:l,name:o,offset:d,ordering:c,paymentVerificationSummaryStatus:u,program:h,programCycle:m,programCycleEndDate:g,programCycleStartDate:x,search:f,startDate:j,status:y,totalEntitledQuantityGte:b,totalEntitledQuantityLte:C,totalEntitledQuantityUsdFrom:v,totalEntitledQuantityUsdTo:S,updatedAtGte:I,updatedAtLte:E}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/payments/payment-plans-managerial/",path:{business_area_slug:t},query:{delivery_mechanism:a,end_date:n,fsp:i,is_follow_up:r,limit:l,name:o,offset:d,ordering:c,payment_verification_summary_status:u,program:h,program_cycle:m,program_cycle_end_date:g,program_cycle_start_date:x,search:f,start_date:j,status:y,total_entitled_quantity__gte:b,total_entitled_quantity__lte:C,total_entitled_quantity_usd_from:v,total_entitled_quantity_usd_to:S,updated_at__gte:I,updated_at__lte:E}})}static restBusinessAreasPaymentsPaymentPlansManagerialBulkActionCreate({businessAreaSlug:t,requestBody:a}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/payments/payment-plans-managerial/bulk-action/",path:{business_area_slug:t},body:a,mediaType:"application/json"})}static restBusinessAreasProgramsList({businessAreaSlug:t,beneficiaryGroupMatch:a,budgetMax:n,budgetMin:i,compatibleDct:r,dataCollectingType:l,endDate:o,limit:d,name:c,numberOfHouseholdsMax:u,numberOfHouseholdsMin:h,offset:m,orderBy:g,ordering:x,search:f,sector:j,startDate:y,status:b,updatedAtAfter:C,updatedAtBefore:v}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/",path:{business_area_slug:t},query:{beneficiary_group_match:a,budget_max:n,budget_min:i,compatible_dct:r,data_collecting_type:l,end_date:o,limit:d,name:c,number_of_households_max:u,number_of_households_min:h,offset:m,order_by:g,ordering:x,search:f,sector:j,start_date:y,status:b,updated_at_after:C,updated_at_before:v}})}static restBusinessAreasProgramsCreate({businessAreaSlug:t,requestBody:a}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/",path:{business_area_slug:t},body:a,mediaType:"application/json"})}static restBusinessAreasProgramsActivityLogsList({businessAreaSlug:t,programSlug:a,businessArea:n,limit:i,module:r,objectId:l,offset:o,ordering:d,programId:c,search:u,user:h,userId:m}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/activity-logs/",path:{business_area_slug:t,program_slug:a},query:{business_area:n,limit:i,module:r,object_id:l,offset:o,ordering:d,program_id:c,search:u,user:h,user_id:m}})}static restBusinessAreasProgramsActivityLogsActionChoicesList({businessAreaSlug:t,programSlug:a,businessArea:n,limit:i,module:r,objectId:l,offset:o,ordering:d,programId:c,search:u,user:h,userId:m}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/activity-logs/action-choices/",path:{business_area_slug:t,program_slug:a},query:{business_area:n,limit:i,module:r,object_id:l,offset:o,ordering:d,program_id:c,search:u,user:h,user_id:m}})}static restBusinessAreasProgramsActivityLogsCountRetrieve({businessAreaSlug:t,programSlug:a,businessArea:n,module:i,objectId:r,ordering:l,programId:o,search:d,user:c,userId:u}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/activity-logs/count/",path:{business_area_slug:t,program_slug:a},query:{business_area:n,module:i,object_id:r,ordering:l,program_id:o,search:d,user:c,user_id:u}})}static restBusinessAreasProgramsCyclesList({businessAreaSlug:t,programSlug:a,endDate:n,limit:i,offset:r,ordering:l,program:o,search:d,startDate:c,status:u,title:h,totalDeliveredQuantityUsdFrom:m,totalDeliveredQuantityUsdTo:g,totalEntitledQuantityUsdFrom:x,totalEntitledQuantityUsdTo:f,updatedAtAfter:j,updatedAtBefore:y}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/cycles/",path:{business_area_slug:t,program_slug:a},query:{end_date:n,limit:i,offset:r,ordering:l,program:o,search:d,start_date:c,status:u,title:h,total_delivered_quantity_usd_from:m,total_delivered_quantity_usd_to:g,total_entitled_quantity_usd_from:x,total_entitled_quantity_usd_to:f,updated_at_after:j,updated_at_before:y}})}static restBusinessAreasProgramsCyclesCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/cycles/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsCyclesRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/cycles/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsCyclesUpdate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"PUT",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/cycles/{id}/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsCyclesPartialUpdate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"PATCH",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/cycles/{id}/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsCyclesDestroy({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"DELETE",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/cycles/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsCyclesFinishCreate({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/cycles/{id}/finish/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsCyclesReactivateCreate({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/cycles/{id}/reactivate/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsCyclesCountRetrieve({businessAreaSlug:t,programSlug:a,endDate:n,ordering:i,program:r,search:l,startDate:o,status:d,title:c,totalDeliveredQuantityUsdFrom:u,totalDeliveredQuantityUsdTo:h,totalEntitledQuantityUsdFrom:m,totalEntitledQuantityUsdTo:g,updatedAtAfter:x,updatedAtBefore:f}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/cycles/count/",path:{business_area_slug:t,program_slug:a},query:{end_date:n,ordering:i,program:r,search:l,start_date:o,status:d,title:c,total_delivered_quantity_usd_from:u,total_delivered_quantity_usd_to:h,total_entitled_quantity_usd_from:m,total_entitled_quantity_usd_to:g,updated_at_after:x,updated_at_before:f}})}static restBusinessAreasProgramsFeedbacksList({businessAreaSlug:t,programSlug:a,createdAtAfter:n,createdAtBefore:i,createdBy:r,isActiveProgram:l,issueType:o,limit:d,offset:c,orderBy:u,ordering:h,search:m}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/feedbacks/",path:{business_area_slug:t,program_slug:a},query:{created_at_after:n,created_at_before:i,created_by:r,is_active_program:l,issue_type:o,limit:d,offset:c,order_by:u,ordering:h,search:m}})}static restBusinessAreasProgramsFeedbacksCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/feedbacks/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsFeedbacksRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/feedbacks/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsFeedbacksPartialUpdate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"PATCH",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/feedbacks/{id}/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsFeedbacksMessageCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/feedbacks/{id}/message/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsFeedbacksCountRetrieve({businessAreaSlug:t,programSlug:a,createdAtAfter:n,createdAtBefore:i,createdBy:r,isActiveProgram:l,issueType:o,orderBy:d,ordering:c,search:u}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/feedbacks/count/",path:{business_area_slug:t,program_slug:a},query:{created_at_after:n,created_at_before:i,created_by:r,is_active_program:l,issue_type:o,order_by:d,ordering:c,search:u}})}static restBusinessAreasProgramsGenericImportUploadUploadCreate({businessAreaSlug:t,programSlug:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/generic-import-upload/upload/",path:{business_area_slug:t,program_slug:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasProgramsGrievanceTicketsList({businessAreaSlug:t,programSlug:a,admin1:n,admin2:i,area:r,areaStartswith:l,assignedTo:o,cashPlan:d,category:c,createdAtAfter:u,createdAtBefore:h,createdBy:m,documentNumber:g,documentType:x,fsp:f,grievanceStatus:j,grievanceType:y,household:b,householdId:C,id:v,idStartswith:S,individualId:I,isActiveProgram:E,isCrossArea:D,issueType:F,limit:w,offset:O,orderBy:k,ordering:$,paymentRecordIds:G,preferredLanguage:W,priority:Y,program:X,registrationDataImport:J,scoreMax:ae,scoreMin:re,search:se,status:le,urgency:ce}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/grievance-tickets/",path:{business_area_slug:t,program_slug:a},query:{admin1:n,admin2:i,area:r,area__startswith:l,assigned_to:o,cash_plan:d,category:c,created_at_after:u,created_at_before:h,created_by:m,document_number:g,document_type:x,fsp:f,grievance_status:j,grievance_type:y,household:b,household_id:C,id:v,id__startswith:S,individual_id:I,is_active_program:E,is_cross_area:D,issue_type:F,limit:w,offset:O,order_by:k,ordering:$,payment_record_ids:G,preferred_language:W,priority:Y,program:X,registration_data_import:J,score_max:ae,score_min:re,search:se,status:le,urgency:ce}})}static restBusinessAreasProgramsGrievanceTicketsCountRetrieve({businessAreaSlug:t,programSlug:a,admin1:n,admin2:i,area:r,areaStartswith:l,assignedTo:o,cashPlan:d,category:c,createdAtAfter:u,createdAtBefore:h,createdBy:m,documentNumber:g,documentType:x,fsp:f,grievanceStatus:j,grievanceType:y,household:b,householdId:C,id:v,idStartswith:S,individualId:I,isActiveProgram:E,isCrossArea:D,issueType:F,orderBy:w,ordering:O,paymentRecordIds:k,preferredLanguage:$,priority:G,program:W,registrationDataImport:Y,scoreMax:X,scoreMin:J,search:ae,status:re,urgency:se}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/grievance-tickets/count/",path:{business_area_slug:t,program_slug:a},query:{admin1:n,admin2:i,area:r,area__startswith:l,assigned_to:o,cash_plan:d,category:c,created_at_after:u,created_at_before:h,created_by:m,document_number:g,document_type:x,fsp:f,grievance_status:j,grievance_type:y,household:b,household_id:C,id:v,id__startswith:S,individual_id:I,is_active_program:E,is_cross_area:D,issue_type:F,order_by:w,ordering:O,payment_record_ids:k,preferred_language:$,priority:G,program:W,registration_data_import:Y,score_max:X,score_min:J,search:ae,status:re,urgency:se}})}static restBusinessAreasProgramsGrievanceTicketsDashboardRetrieve({businessAreaSlug:t,programSlug:a}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/grievance-tickets/dashboard/",path:{business_area_slug:t,program_slug:a}})}static restBusinessAreasProgramsHouseholdsList({businessAreaSlug:t,programSlug:a,address:n,admin1:i,admin2:r,adminArea:l,countryOrigin:o,documentNumber:d,documentType:c,firstRegistrationDate:u,headOfHouseholdFullName:h,headOfHouseholdPhoneNoValid:m,isActiveProgram:g,lastRegistrationDateAfter:x,lastRegistrationDateBefore:f,limit:j,messageId:y,offset:b,orderBy:C,ordering:v,phoneNo:S,program:I,rdiId:E,rdiMergeStatus:D,recipientId:F,residenceStatus:w,search:O,sex:k,sizeGte:$,sizeLte:G,sizeRange:W,sizeMax:Y,sizeMin:X,surveyId:J,unicefId:ae,updatedAtAfter:re,updatedAtBefore:se,withdrawn:le}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/households/",path:{business_area_slug:t,program_slug:a},query:{address:n,admin1:i,admin2:r,admin_area:l,country_origin:o,document_number:d,document_type:c,first_registration_date:u,head_of_household__full_name:h,head_of_household__phone_no_valid:m,is_active_program:g,last_registration_date_after:x,last_registration_date_before:f,limit:j,message_id:y,offset:b,order_by:C,ordering:v,phone_no:S,program:I,rdi_id:E,rdi_merge_status:D,recipient_id:F,residence_status:w,search:O,sex:k,size__gte:$,size__lte:G,size__range:W,size_max:Y,size_min:X,survey_id:J,unicef_id:ae,updated_at_after:re,updated_at_before:se,withdrawn:le}})}static restBusinessAreasProgramsHouseholdsRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/households/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsHouseholdsMembersList({businessAreaSlug:t,id:a,programSlug:n,limit:i,offset:r}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/households/{id}/members/",path:{business_area_slug:t,id:a,program_slug:n},query:{limit:i,offset:r}})}static restBusinessAreasProgramsHouseholdsPaymentsList({businessAreaSlug:t,id:a,programSlug:n,address:i,admin1:r,admin2:l,adminArea:o,countryOrigin:d,documentNumber:c,documentType:u,firstRegistrationDate:h,headOfHouseholdFullName:m,headOfHouseholdPhoneNoValid:g,isActiveProgram:x,lastRegistrationDateAfter:f,lastRegistrationDateBefore:j,limit:y,messageId:b,offset:C,orderBy:v,ordering:S,phoneNo:I,program:E,rdiId:D,rdiMergeStatus:F,recipientId:w,residenceStatus:O,search:k,sex:$,sizeGte:G,sizeLte:W,sizeRange:Y,sizeMax:X,sizeMin:J,surveyId:ae,unicefId:re,updatedAtAfter:se,updatedAtBefore:le,withdrawn:ce}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/households/{id}/payments/",path:{business_area_slug:t,id:a,program_slug:n},query:{address:i,admin1:r,admin2:l,admin_area:o,country_origin:d,document_number:c,document_type:u,first_registration_date:h,head_of_household__full_name:m,head_of_household__phone_no_valid:g,is_active_program:x,last_registration_date_after:f,last_registration_date_before:j,limit:y,message_id:b,offset:C,order_by:v,ordering:S,phone_no:I,program:E,rdi_id:D,rdi_merge_status:F,recipient_id:w,residence_status:O,search:k,sex:$,size__gte:G,size__lte:W,size__range:Y,size_max:X,size_min:J,survey_id:ae,unicef_id:re,updated_at_after:se,updated_at_before:le,withdrawn:ce}})}static restBusinessAreasProgramsHouseholdsPaymentsCountRetrieve({businessAreaSlug:t,id:a,programSlug:n,address:i,admin1:r,admin2:l,adminArea:o,countryOrigin:d,documentNumber:c,documentType:u,firstRegistrationDate:h,headOfHouseholdFullName:m,headOfHouseholdPhoneNoValid:g,isActiveProgram:x,lastRegistrationDateAfter:f,lastRegistrationDateBefore:j,messageId:y,orderBy:b,ordering:C,phoneNo:v,program:S,rdiId:I,rdiMergeStatus:E,recipientId:D,residenceStatus:F,search:w,sex:O,sizeGte:k,sizeLte:$,sizeRange:G,sizeMax:W,sizeMin:Y,surveyId:X,unicefId:J,updatedAtAfter:ae,updatedAtBefore:re,withdrawn:se}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/households/{id}/payments/count/",path:{business_area_slug:t,id:a,program_slug:n},query:{address:i,admin1:r,admin2:l,admin_area:o,country_origin:d,document_number:c,document_type:u,first_registration_date:h,head_of_household__full_name:m,head_of_household__phone_no_valid:g,is_active_program:x,last_registration_date_after:f,last_registration_date_before:j,message_id:y,order_by:b,ordering:C,phone_no:v,program:S,rdi_id:I,rdi_merge_status:E,recipient_id:D,residence_status:F,search:w,sex:O,size__gte:k,size__lte:$,size__range:G,size_max:W,size_min:Y,survey_id:X,unicef_id:J,updated_at_after:ae,updated_at_before:re,withdrawn:se}})}static restBusinessAreasProgramsHouseholdsWithdrawCreate({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/households/{id}/withdraw/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsHouseholdsAllAccountabilityCommunicationMessageRecipientsList({businessAreaSlug:t,programSlug:a,address:n,admin1:i,admin2:r,adminArea:l,countryOrigin:o,documentNumber:d,documentType:c,firstRegistrationDate:u,headOfHouseholdFullName:h,headOfHouseholdPhoneNoValid:m,isActiveProgram:g,lastRegistrationDateAfter:x,lastRegistrationDateBefore:f,limit:j,messageId:y,offset:b,orderBy:C,ordering:v,phoneNo:S,program:I,rdiId:E,rdiMergeStatus:D,recipientId:F,residenceStatus:w,search:O,sex:k,sizeGte:$,sizeLte:G,sizeRange:W,sizeMax:Y,sizeMin:X,surveyId:J,unicefId:ae,updatedAtAfter:re,updatedAtBefore:se,withdrawn:le}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/households/all-accountability-communication-message-recipients/",path:{business_area_slug:t,program_slug:a},query:{address:n,admin1:i,admin2:r,admin_area:l,country_origin:o,document_number:d,document_type:c,first_registration_date:u,head_of_household__full_name:h,head_of_household__phone_no_valid:m,is_active_program:g,last_registration_date_after:x,last_registration_date_before:f,limit:j,message_id:y,offset:b,order_by:C,ordering:v,phone_no:S,program:I,rdi_id:E,rdi_merge_status:D,recipient_id:F,residence_status:w,search:O,sex:k,size__gte:$,size__lte:G,size__range:W,size_max:Y,size_min:X,survey_id:J,unicef_id:ae,updated_at_after:re,updated_at_before:se,withdrawn:le}})}static restBusinessAreasProgramsHouseholdsAllFlexFieldsAttributesList({businessAreaSlug:t,programSlug:a,address:n,admin1:i,admin2:r,adminArea:l,countryOrigin:o,documentNumber:d,documentType:c,firstRegistrationDate:u,headOfHouseholdFullName:h,headOfHouseholdPhoneNoValid:m,isActiveProgram:g,lastRegistrationDateAfter:x,lastRegistrationDateBefore:f,limit:j,messageId:y,offset:b,orderBy:C,ordering:v,phoneNo:S,program:I,rdiId:E,rdiMergeStatus:D,recipientId:F,residenceStatus:w,search:O,sex:k,sizeGte:$,sizeLte:G,sizeRange:W,sizeMax:Y,sizeMin:X,surveyId:J,unicefId:ae,updatedAtAfter:re,updatedAtBefore:se,withdrawn:le}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/households/all-flex-fields-attributes/",path:{business_area_slug:t,program_slug:a},query:{address:n,admin1:i,admin2:r,admin_area:l,country_origin:o,document_number:d,document_type:c,first_registration_date:u,head_of_household__full_name:h,head_of_household__phone_no_valid:m,is_active_program:g,last_registration_date_after:x,last_registration_date_before:f,limit:j,message_id:y,offset:b,order_by:C,ordering:v,phone_no:S,program:I,rdi_id:E,rdi_merge_status:D,recipient_id:F,residence_status:w,search:O,sex:k,size__gte:$,size__lte:G,size__range:W,size_max:Y,size_min:X,survey_id:J,unicef_id:ae,updated_at_after:re,updated_at_before:se,withdrawn:le}})}static restBusinessAreasProgramsHouseholdsCountRetrieve({businessAreaSlug:t,programSlug:a,address:n,admin1:i,admin2:r,adminArea:l,countryOrigin:o,documentNumber:d,documentType:c,firstRegistrationDate:u,headOfHouseholdFullName:h,headOfHouseholdPhoneNoValid:m,isActiveProgram:g,lastRegistrationDateAfter:x,lastRegistrationDateBefore:f,messageId:j,orderBy:y,ordering:b,phoneNo:C,program:v,rdiId:S,rdiMergeStatus:I,recipientId:E,residenceStatus:D,search:F,sex:w,sizeGte:O,sizeLte:k,sizeRange:$,sizeMax:G,sizeMin:W,surveyId:Y,unicefId:X,updatedAtAfter:J,updatedAtBefore:ae,withdrawn:re}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/households/count/",path:{business_area_slug:t,program_slug:a},query:{address:n,admin1:i,admin2:r,admin_area:l,country_origin:o,document_number:d,document_type:c,first_registration_date:u,head_of_household__full_name:h,head_of_household__phone_no_valid:m,is_active_program:g,last_registration_date_after:x,last_registration_date_before:f,message_id:j,order_by:y,ordering:b,phone_no:C,program:v,rdi_id:S,rdi_merge_status:I,recipient_id:E,residence_status:D,search:F,sex:w,size__gte:O,size__lte:k,size__range:$,size_max:G,size_min:W,survey_id:Y,unicef_id:X,updated_at_after:J,updated_at_before:ae,withdrawn:re}})}static restBusinessAreasProgramsHouseholdsRecipientsList({businessAreaSlug:t,programSlug:a,address:n,admin1:i,admin2:r,adminArea:l,countryOrigin:o,documentNumber:d,documentType:c,firstRegistrationDate:u,headOfHouseholdFullName:h,headOfHouseholdPhoneNoValid:m,isActiveProgram:g,lastRegistrationDateAfter:x,lastRegistrationDateBefore:f,limit:j,messageId:y,offset:b,orderBy:C,ordering:v,phoneNo:S,program:I,rdiId:E,rdiMergeStatus:D,recipientId:F,residenceStatus:w,search:O,sex:k,sizeGte:$,sizeLte:G,sizeRange:W,sizeMax:Y,sizeMin:X,surveyId:J,unicefId:ae,updatedAtAfter:re,updatedAtBefore:se,withdrawn:le}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/households/recipients/",path:{business_area_slug:t,program_slug:a},query:{address:n,admin1:i,admin2:r,admin_area:l,country_origin:o,document_number:d,document_type:c,first_registration_date:u,head_of_household__full_name:h,head_of_household__phone_no_valid:m,is_active_program:g,last_registration_date_after:x,last_registration_date_before:f,limit:j,message_id:y,offset:b,order_by:C,ordering:v,phone_no:S,program:I,rdi_id:E,rdi_merge_status:D,recipient_id:F,residence_status:w,search:O,sex:k,size__gte:$,size__lte:G,size__range:W,size_max:Y,size_min:X,survey_id:J,unicef_id:ae,updated_at_after:re,updated_at_before:se,withdrawn:le}})}static restBusinessAreasProgramsImportDataUploadUploadXlsxFileCreate({businessAreaSlug:t,programSlug:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/import-data-upload/upload-xlsx-file/",path:{business_area_slug:t,program_slug:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasProgramsIndividualsList({businessAreaSlug:t,programSlug:a,admin1:n,admin2:i,ageMax:r,ageMin:l,documentNumber:o,documentType:d,duplicatesOnly:c,excludedId:u,flags:h,fullName:m,householdId:g,isActiveProgram:x,lastRegistrationDateAfter:f,lastRegistrationDateBefore:j,limit:y,offset:b,orderBy:C,ordering:v,program:S,rdiId:I,rdiMergeStatus:E,search:D,sex:F,status:w,updatedAtAfter:O,updatedAtBefore:k,withdrawn:$}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/individuals/",path:{business_area_slug:t,program_slug:a},query:{admin1:n,admin2:i,age_max:r,age_min:l,document_number:o,document_type:d,duplicates_only:c,excluded_id:u,flags:h,full_name:m,household__id:g,is_active_program:x,last_registration_date_after:f,last_registration_date_before:j,limit:y,offset:b,order_by:C,ordering:v,program:S,rdi_id:I,rdi_merge_status:E,search:D,sex:F,status:w,updated_at_after:O,updated_at_before:k,withdrawn:$}})}static restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/individuals/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsIndividualsPhotosRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/individuals/{id}/photos/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsIndividualsAllFlexFieldsAttributesList({businessAreaSlug:t,programSlug:a,admin1:n,admin2:i,ageMax:r,ageMin:l,documentNumber:o,documentType:d,duplicatesOnly:c,excludedId:u,flags:h,fullName:m,householdId:g,isActiveProgram:x,lastRegistrationDateAfter:f,lastRegistrationDateBefore:j,limit:y,offset:b,orderBy:C,ordering:v,program:S,rdiId:I,rdiMergeStatus:E,search:D,sex:F,status:w,updatedAtAfter:O,updatedAtBefore:k,withdrawn:$}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/individuals/all-flex-fields-attributes/",path:{business_area_slug:t,program_slug:a},query:{admin1:n,admin2:i,age_max:r,age_min:l,document_number:o,document_type:d,duplicates_only:c,excluded_id:u,flags:h,full_name:m,household__id:g,is_active_program:x,last_registration_date_after:f,last_registration_date_before:j,limit:y,offset:b,order_by:C,ordering:v,program:S,rdi_id:I,rdi_merge_status:E,search:D,sex:F,status:w,updated_at_after:O,updated_at_before:k,withdrawn:$}})}static restBusinessAreasProgramsIndividualsCountRetrieve({businessAreaSlug:t,programSlug:a,admin1:n,admin2:i,ageMax:r,ageMin:l,documentNumber:o,documentType:d,duplicatesOnly:c,excludedId:u,flags:h,fullName:m,householdId:g,isActiveProgram:x,lastRegistrationDateAfter:f,lastRegistrationDateBefore:j,orderBy:y,ordering:b,program:C,rdiId:v,rdiMergeStatus:S,search:I,sex:E,status:D,updatedAtAfter:F,updatedAtBefore:w,withdrawn:O}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/individuals/count/",path:{business_area_slug:t,program_slug:a},query:{admin1:n,admin2:i,age_max:r,age_min:l,document_number:o,document_type:d,duplicates_only:c,excluded_id:u,flags:h,full_name:m,household__id:g,is_active_program:x,last_registration_date_after:f,last_registration_date_before:j,order_by:y,ordering:b,program:C,rdi_id:v,rdi_merge_status:S,search:I,sex:E,status:D,updated_at_after:F,updated_at_before:w,withdrawn:O}})}static restBusinessAreasProgramsKoboImportDataUploadSaveKoboImportDataCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/kobo-import-data-upload/save-kobo-import-data/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsMessagesList({businessAreaSlug:t,programSlug:a,body:n,createdAtAfter:i,createdAtBefore:r,createdBy:l,limit:o,numberOfRecipients:d,numberOfRecipientsGte:c,numberOfRecipientsLte:u,offset:h,orderBy:m,ordering:g,paymentPlan:x,program:f,samplingType:j,search:y,title:b}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/messages/",path:{business_area_slug:t,program_slug:a},query:{body:n,created_at_after:i,created_at_before:r,created_by:l,limit:o,number_of_recipients:d,number_of_recipients__gte:c,number_of_recipients__lte:u,offset:h,order_by:m,ordering:g,payment_plan:x,program:f,sampling_type:j,search:y,title:b}})}static restBusinessAreasProgramsMessagesCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/messages/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsMessagesRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/messages/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsMessagesCountRetrieve({businessAreaSlug:t,programSlug:a,body:n,createdAtAfter:i,createdAtBefore:r,createdBy:l,numberOfRecipients:o,numberOfRecipientsGte:d,numberOfRecipientsLte:c,orderBy:u,ordering:h,paymentPlan:m,program:g,samplingType:x,search:f,title:j}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/messages/count/",path:{business_area_slug:t,program_slug:a},query:{body:n,created_at_after:i,created_at_before:r,created_by:l,number_of_recipients:o,number_of_recipients__gte:d,number_of_recipients__lte:c,order_by:u,ordering:h,payment_plan:m,program:g,sampling_type:x,search:f,title:j}})}static restBusinessAreasProgramsMessagesSampleSizeCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/messages/sample-size/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansList({businessAreaSlug:t,programSlug:a,deliveryMechanism:n,endDate:i,fsp:r,isFollowUp:l,limit:o,name:d,offset:c,ordering:u,paymentVerificationSummaryStatus:h,program:m,programCycle:g,programCycleEndDate:x,programCycleStartDate:f,search:j,startDate:y,status:b,totalEntitledQuantityGte:C,totalEntitledQuantityLte:v,totalEntitledQuantityUsdFrom:S,totalEntitledQuantityUsdTo:I,updatedAtGte:E,updatedAtLte:D}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/",path:{business_area_slug:t,program_slug:a},query:{delivery_mechanism:n,end_date:i,fsp:r,is_follow_up:l,limit:o,name:d,offset:c,ordering:u,payment_verification_summary_status:h,program:m,program_cycle:g,program_cycle_end_date:x,program_cycle_start_date:f,search:j,start_date:y,status:b,total_entitled_quantity__gte:C,total_entitled_quantity__lte:v,total_entitled_quantity_usd_from:S,total_entitled_quantity_usd_to:I,updated_at__gte:E,updated_at__lte:D}})}static restBusinessAreasProgramsPaymentPlansCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansPaymentsList({businessAreaSlug:t,paymentPlanPk:a,programSlug:n,collectorFullName:i,householdUnicefId:r,individualUnicefId:l,limit:o,offset:d,paymentUnicefId:c}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{payment_plan_pk}/payments/",path:{business_area_slug:t,payment_plan_pk:a,program_slug:n},query:{collector_full_name:i,household_unicef_id:r,individual_unicef_id:l,limit:o,offset:d,payment_unicef_id:c}})}static restBusinessAreasProgramsPaymentPlansPaymentsRetrieve({businessAreaSlug:t,paymentId:a,paymentPlanPk:n,programSlug:i}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{payment_plan_pk}/payments/{payment_id}/",path:{business_area_slug:t,payment_id:a,payment_plan_pk:n,program_slug:i}})}static restBusinessAreasProgramsPaymentPlansPaymentsMarkAsFailedRetrieve({businessAreaSlug:t,paymentId:a,paymentPlanPk:n,programSlug:i}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{payment_plan_pk}/payments/{payment_id}/mark-as-failed/",path:{business_area_slug:t,payment_id:a,payment_plan_pk:n,program_slug:i}})}static restBusinessAreasProgramsPaymentPlansPaymentsRevertMarkAsFailedCreate({businessAreaSlug:t,paymentId:a,paymentPlanPk:n,programSlug:i,requestBody:r}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{payment_plan_pk}/payments/{payment_id}/revert-mark-as-failed/",path:{business_area_slug:t,payment_id:a,payment_plan_pk:n,program_slug:i},body:r,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansPaymentsCountRetrieve({businessAreaSlug:t,paymentPlanPk:a,programSlug:n,collectorFullName:i,householdUnicefId:r,individualUnicefId:l,paymentUnicefId:o}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{payment_plan_pk}/payments/count/",path:{business_area_slug:t,payment_plan_pk:a,program_slug:n},query:{collector_full_name:i,household_unicef_id:r,individual_unicef_id:l,payment_unicef_id:o}})}static restBusinessAreasProgramsPaymentPlansSupportingDocumentsCreate({businessAreaSlug:t,paymentPlanPk:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{payment_plan_pk}/supporting-documents/",path:{business_area_slug:t,payment_plan_pk:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansSupportingDocumentsDestroy({businessAreaSlug:t,fileId:a,paymentPlanPk:n,programSlug:i}){return q(z,{method:"DELETE",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{payment_plan_pk}/supporting-documents/{file_id}/",path:{business_area_slug:t,file_id:a,payment_plan_pk:n,program_slug:i}})}static restBusinessAreasProgramsPaymentPlansSupportingDocumentsDownloadRetrieve({businessAreaSlug:t,fileId:a,paymentPlanPk:n,programSlug:i}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{payment_plan_pk}/supporting-documents/{file_id}/download/",path:{business_area_slug:t,file_id:a,payment_plan_pk:n,program_slug:i}})}static restBusinessAreasProgramsPaymentPlansRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansPartialUpdate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"PATCH",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansDestroy({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"DELETE",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansAbortCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/abort/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansApplyEngineFormulaCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/apply-engine-formula/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansApproveCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/approve/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansAssignFundsCommitmentsCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/assign-funds-commitments/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansAuthorizeCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/authorize/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansCloseRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/close/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansCreateFollowUpCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/create-follow-up/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansEntitlementExportXlsxRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/entitlement-export-xlsx/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansEntitlementImportXlsxCreate({businessAreaSlug:t,id:a,programSlug:n,formData:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/entitlement-import-xlsx/",path:{business_area_slug:t,id:a,program_slug:n},formData:i,mediaType:"multipart/form-data"})}static restBusinessAreasProgramsPaymentPlansExcludeBeneficiariesCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/exclude-beneficiaries/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansExportPdfPaymentPlanSummaryRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/export-pdf-payment-plan-summary/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansGenerateXlsxWithAuthCodeCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/generate-xlsx-with-auth-code/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansLockRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/lock/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansLockFspRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/lock-fsp/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansMarkAsReleasedCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/mark-as-released/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansReactivateAbortRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/reactivate-abort/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansReconciliationExportXlsxRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/reconciliation-export-xlsx/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansReconciliationImportXlsxCreate({businessAreaSlug:t,id:a,programSlug:n,formData:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/reconciliation-import-xlsx/",path:{business_area_slug:t,id:a,program_slug:n},formData:i,mediaType:"multipart/form-data"})}static restBusinessAreasProgramsPaymentPlansRejectCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/reject/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansSendForApprovalRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/send-for-approval/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansSendToPaymentGatewayRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/send-to-payment-gateway/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansSendXlsxPasswordRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/send-xlsx-password/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansSplitCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/split/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentPlansUnlockRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/unlock/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansUnlockFspRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/{id}/unlock-fsp/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentPlansCountRetrieve({businessAreaSlug:t,programSlug:a,deliveryMechanism:n,endDate:i,fsp:r,isFollowUp:l,name:o,ordering:d,paymentVerificationSummaryStatus:c,program:u,programCycle:h,programCycleEndDate:m,programCycleStartDate:g,search:x,startDate:f,status:j,totalEntitledQuantityGte:y,totalEntitledQuantityLte:b,totalEntitledQuantityUsdFrom:C,totalEntitledQuantityUsdTo:v,updatedAtGte:S,updatedAtLte:I}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/count/",path:{business_area_slug:t,program_slug:a},query:{delivery_mechanism:n,end_date:i,fsp:r,is_follow_up:l,name:o,ordering:d,payment_verification_summary_status:c,program:u,program_cycle:h,program_cycle_end_date:m,program_cycle_start_date:g,search:x,start_date:f,status:j,total_entitled_quantity__gte:y,total_entitled_quantity__lte:b,total_entitled_quantity_usd_from:C,total_entitled_quantity_usd_to:v,updated_at__gte:S,updated_at__lte:I}})}static restBusinessAreasProgramsPaymentPlansFspXlsxTemplateListList({businessAreaSlug:t,programSlug:a,deliveryMechanism:n,endDate:i,fsp:r,isFollowUp:l,limit:o,name:d,offset:c,ordering:u,paymentVerificationSummaryStatus:h,program:m,programCycle:g,programCycleEndDate:x,programCycleStartDate:f,search:j,startDate:y,status:b,totalEntitledQuantityGte:C,totalEntitledQuantityLte:v,totalEntitledQuantityUsdFrom:S,totalEntitledQuantityUsdTo:I,updatedAtGte:E,updatedAtLte:D}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-plans/fsp-xlsx-template-list/",path:{business_area_slug:t,program_slug:a},query:{delivery_mechanism:n,end_date:i,fsp:r,is_follow_up:l,limit:o,name:d,offset:c,ordering:u,payment_verification_summary_status:h,program:m,program_cycle:g,program_cycle_end_date:x,program_cycle_start_date:f,search:j,start_date:y,status:b,total_entitled_quantity__gte:C,total_entitled_quantity__lte:v,total_entitled_quantity_usd_from:S,total_entitled_quantity_usd_to:I,updated_at__gte:E,updated_at__lte:D}})}static restBusinessAreasProgramsPaymentVerificationsList({businessAreaSlug:t,programSlug:a,deliveryMechanism:n,endDate:i,fsp:r,isFollowUp:l,limit:o,name:d,offset:c,ordering:u,paymentVerificationSummaryStatus:h,program:m,programCycle:g,programCycleEndDate:x,programCycleStartDate:f,search:j,startDate:y,status:b,totalEntitledQuantityGte:C,totalEntitledQuantityLte:v,totalEntitledQuantityUsdFrom:S,totalEntitledQuantityUsdTo:I,updatedAtGte:E,updatedAtLte:D}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/",path:{business_area_slug:t,program_slug:a},query:{delivery_mechanism:n,end_date:i,fsp:r,is_follow_up:l,limit:o,name:d,offset:c,ordering:u,payment_verification_summary_status:h,program:m,program_cycle:g,program_cycle_end_date:x,program_cycle_start_date:f,search:j,start_date:y,status:b,total_entitled_quantity__gte:C,total_entitled_quantity__lte:v,total_entitled_quantity_usd_from:S,total_entitled_quantity_usd_to:I,updated_at__gte:E,updated_at__lte:D}})}static restBusinessAreasProgramsPaymentVerificationsVerificationsList({businessAreaSlug:t,paymentVerificationPk:a,programSlug:n,limit:i,offset:r,ordering:l,search:o,verificationChannel:d,verificationPlanId:c,verificationStatus:u}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{payment_verification_pk}/verifications/",path:{business_area_slug:t,payment_verification_pk:a,program_slug:n},query:{limit:i,offset:r,ordering:l,search:o,verification_channel:d,verification_plan_id:c,verification_status:u}})}static restBusinessAreasProgramsPaymentVerificationsVerificationsRetrieve({businessAreaSlug:t,id:a,paymentVerificationPk:n,programSlug:i}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{payment_verification_pk}/verifications/{id}/",path:{business_area_slug:t,id:a,payment_verification_pk:n,program_slug:i}})}static restBusinessAreasProgramsPaymentVerificationsVerificationsPartialUpdate({businessAreaSlug:t,id:a,paymentVerificationPk:n,programSlug:i,requestBody:r}){return q(z,{method:"PATCH",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{payment_verification_pk}/verifications/{id}/",path:{business_area_slug:t,id:a,payment_verification_pk:n,program_slug:i},body:r,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentVerificationsVerificationsCountRetrieve({businessAreaSlug:t,paymentVerificationPk:a,programSlug:n,ordering:i,search:r,verificationChannel:l,verificationPlanId:o,verificationStatus:d}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{payment_verification_pk}/verifications/count/",path:{business_area_slug:t,payment_verification_pk:a,program_slug:n},query:{ordering:i,search:r,verification_channel:l,verification_plan_id:o,verification_status:d}})}static restBusinessAreasProgramsPaymentVerificationsRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPaymentVerificationsActivateVerificationPlanCreate({businessAreaSlug:t,id:a,programSlug:n,verificationPlanId:i,requestBody:r}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{id}/activate-verification-plan/{verification_plan_id}/",path:{business_area_slug:t,id:a,program_slug:n,verification_plan_id:i},body:r,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentVerificationsCreateVerificationPlanCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{id}/create-verification-plan/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentVerificationsDeleteVerificationPlanCreate({businessAreaSlug:t,id:a,programSlug:n,verificationPlanId:i,requestBody:r}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{id}/delete-verification-plan/{verification_plan_id}/",path:{business_area_slug:t,id:a,program_slug:n,verification_plan_id:i},body:r,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentVerificationsDiscardVerificationPlanCreate({businessAreaSlug:t,id:a,programSlug:n,verificationPlanId:i,requestBody:r}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{id}/discard-verification-plan/{verification_plan_id}/",path:{business_area_slug:t,id:a,program_slug:n,verification_plan_id:i},body:r,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentVerificationsExportXlsxCreate({businessAreaSlug:t,id:a,programSlug:n,verificationPlanId:i,requestBody:r}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{id}/export-xlsx/{verification_plan_id}/",path:{business_area_slug:t,id:a,program_slug:n,verification_plan_id:i},body:r,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentVerificationsFinishVerificationPlanCreate({businessAreaSlug:t,id:a,programSlug:n,verificationPlanId:i,requestBody:r}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{id}/finish-verification-plan/{verification_plan_id}/",path:{business_area_slug:t,id:a,program_slug:n,verification_plan_id:i},body:r,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentVerificationsImportXlsxCreate({businessAreaSlug:t,id:a,programSlug:n,verificationPlanId:i,formData:r}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{id}/import-xlsx/{verification_plan_id}/",path:{business_area_slug:t,id:a,program_slug:n,verification_plan_id:i},formData:r,mediaType:"multipart/form-data"})}static restBusinessAreasProgramsPaymentVerificationsInvalidVerificationPlanCreate({businessAreaSlug:t,id:a,programSlug:n,verificationPlanId:i,requestBody:r}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{id}/invalid-verification-plan/{verification_plan_id}/",path:{business_area_slug:t,id:a,program_slug:n,verification_plan_id:i},body:r,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentVerificationsUpdateVerificationPlanPartialUpdate({businessAreaSlug:t,id:a,programSlug:n,verificationPlanId:i,requestBody:r}){return q(z,{method:"PATCH",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/{id}/update-verification-plan/{verification_plan_id}/",path:{business_area_slug:t,id:a,program_slug:n,verification_plan_id:i},body:r,mediaType:"application/json"})}static restBusinessAreasProgramsPaymentVerificationsCountRetrieve({businessAreaSlug:t,programSlug:a,deliveryMechanism:n,endDate:i,fsp:r,isFollowUp:l,name:o,ordering:d,paymentVerificationSummaryStatus:c,program:u,programCycle:h,programCycleEndDate:m,programCycleStartDate:g,search:x,startDate:f,status:j,totalEntitledQuantityGte:y,totalEntitledQuantityLte:b,totalEntitledQuantityUsdFrom:C,totalEntitledQuantityUsdTo:v,updatedAtGte:S,updatedAtLte:I}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/payment-verifications/count/",path:{business_area_slug:t,program_slug:a},query:{delivery_mechanism:n,end_date:i,fsp:r,is_follow_up:l,name:o,ordering:d,payment_verification_summary_status:c,program:u,program_cycle:h,program_cycle_end_date:m,program_cycle_start_date:g,search:x,start_date:f,status:j,total_entitled_quantity__gte:y,total_entitled_quantity__lte:b,total_entitled_quantity_usd_from:C,total_entitled_quantity_usd_to:v,updated_at__gte:S,updated_at__lte:I}})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsList({businessAreaSlug:t,programSlug:a,limit:n,offset:i,ordering:r,status:l,updatedAtAfter:o,updatedAtBefore:d}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/",path:{business_area_slug:t,program_slug:a},query:{limit:n,offset:i,ordering:r,status:l,updated_at_after:o,updated_at_before:d}})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsUpdate({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"PUT",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsPartialUpdate({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"PATCH",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsSaveDataCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/{id}/save_data/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsSendBackCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/{id}/send_back/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsSendForApprovalCreate({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/{id}/send_for_approval/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsUpdateAuthorizedUsersCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/{id}/update_authorized_users/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsBulkApproveCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/bulk_approve/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsBulkMergeCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/bulk_merge/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsCountRetrieve({businessAreaSlug:t,programSlug:a,ordering:n,status:i,updatedAtAfter:r,updatedAtBefore:l}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/count/",path:{business_area_slug:t,program_slug:a},query:{ordering:n,status:i,updated_at_after:r,updated_at_before:l}})}static restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsUsersAvailableList({businessAreaSlug:t,programSlug:a,limit:n,offset:i,ordering:r,permission:l,search:o,status:d,updatedAtAfter:c,updatedAtBefore:u}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-online-edits/users_available/",path:{business_area_slug:t,program_slug:a},query:{limit:n,offset:i,ordering:r,permission:l,search:o,status:d,updated_at_after:c,updated_at_before:u}})}static restBusinessAreasProgramsPeriodicDataUpdateTemplatesList({businessAreaSlug:t,programSlug:a,limit:n,offset:i,ordering:r,updatedAtAfter:l,updatedAtBefore:o}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-templates/",path:{business_area_slug:t,program_slug:a},query:{limit:n,offset:i,ordering:r,updated_at_after:l,updated_at_before:o}})}static restBusinessAreasProgramsPeriodicDataUpdateTemplatesCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-templates/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsPeriodicDataUpdateTemplatesRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-templates/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPeriodicDataUpdateTemplatesDownloadRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-templates/{id}/download/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPeriodicDataUpdateTemplatesExportCreate({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-templates/{id}/export/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPeriodicDataUpdateTemplatesCountRetrieve({businessAreaSlug:t,programSlug:a,ordering:n,updatedAtAfter:i,updatedAtBefore:r}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-templates/count/",path:{business_area_slug:t,program_slug:a},query:{ordering:n,updated_at_after:i,updated_at_before:r}})}static restBusinessAreasProgramsPeriodicDataUpdateUploadsList({businessAreaSlug:t,programSlug:a,limit:n,offset:i,ordering:r,updatedAtAfter:l,updatedAtBefore:o}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-uploads/",path:{business_area_slug:t,program_slug:a},query:{limit:n,offset:i,ordering:r,updated_at_after:l,updated_at_before:o}})}static restBusinessAreasProgramsPeriodicDataUpdateUploadsRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-uploads/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsPeriodicDataUpdateUploadsCountRetrieve({businessAreaSlug:t,programSlug:a,ordering:n,updatedAtAfter:i,updatedAtBefore:r}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-uploads/count/",path:{business_area_slug:t,program_slug:a},query:{ordering:n,updated_at_after:i,updated_at_before:r}})}static restBusinessAreasProgramsPeriodicDataUpdateUploadsUploadCreate({businessAreaSlug:t,programSlug:a,formData:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-data-update-uploads/upload/",path:{business_area_slug:t,program_slug:a},formData:n,mediaType:"multipart/form-data"})}static restBusinessAreasProgramsPeriodicFieldsList({businessAreaSlug:t,programSlug:a,limit:n,offset:i,ordering:r,updatedAtAfter:l,updatedAtBefore:o}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/periodic-fields/",path:{business_area_slug:t,program_slug:a},query:{limit:n,offset:i,ordering:r,updated_at_after:l,updated_at_before:o}})}static restBusinessAreasProgramsRegistrationDataImportsList({businessAreaSlug:t,programSlug:a,importDateAfter:n,importDateBefore:i,importedById:r,limit:l,name:o,nameStartswith:d,offset:c,orderBy:u,ordering:h,search:m,sizeMax:g,sizeMin:x,status:f,totalHouseholdsCountWithValidPhoneNoMax:j,totalHouseholdsCountWithValidPhoneNoMin:y,updatedAtAfter:b,updatedAtBefore:C}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/",path:{business_area_slug:t,program_slug:a},query:{import_date_after:n,import_date_before:i,imported_by__id:r,limit:l,name:o,name__startswith:d,offset:c,order_by:u,ordering:h,search:m,size_max:g,size_min:x,status:f,total_households_count_with_valid_phone_no_max:j,total_households_count_with_valid_phone_no_min:y,updated_at_after:b,updated_at_before:C}})}static restBusinessAreasProgramsRegistrationDataImportsCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsRegistrationDataImportsRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsRegistrationDataImportsDeduplicateCreate({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/{id}/deduplicate/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsRegistrationDataImportsEraseCreate({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/{id}/erase/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsRegistrationDataImportsMergeCreate({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/{id}/merge/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsRegistrationDataImportsRefuseCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/{id}/refuse/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsRegistrationDataImportsCountRetrieve({businessAreaSlug:t,programSlug:a,importDateAfter:n,importDateBefore:i,importedById:r,name:l,nameStartswith:o,orderBy:d,ordering:c,search:u,sizeMax:h,sizeMin:m,status:g,totalHouseholdsCountWithValidPhoneNoMax:x,totalHouseholdsCountWithValidPhoneNoMin:f,updatedAtAfter:j,updatedAtBefore:y}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/count/",path:{business_area_slug:t,program_slug:a},query:{import_date_after:n,import_date_before:i,imported_by__id:r,name:l,name__startswith:o,order_by:d,ordering:c,search:u,size_max:h,size_min:m,status:g,total_households_count_with_valid_phone_no_max:x,total_households_count_with_valid_phone_no_min:f,updated_at_after:j,updated_at_before:y}})}static restBusinessAreasProgramsRegistrationDataImportsRegistrationKoboImportCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/registration-kobo-import/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsRegistrationDataImportsRegistrationXlsxImportCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/registration-xlsx-import/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsRegistrationDataImportsRunDeduplicationCreate({businessAreaSlug:t,programSlug:a}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/run-deduplication/",path:{business_area_slug:t,program_slug:a}})}static restBusinessAreasProgramsRegistrationDataImportsStatusChoicesList({businessAreaSlug:t,programSlug:a}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/status-choices/",path:{business_area_slug:t,program_slug:a}})}static restBusinessAreasProgramsRegistrationDataImportsWebhookdeduplicationRetrieve({businessAreaSlug:t,programSlug:a}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/registration-data-imports/webhookdeduplication/",path:{business_area_slug:t,program_slug:a}})}static restBusinessAreasProgramsSurveysList({businessAreaSlug:t,programSlug:a,createdAtAfter:n,createdAtBefore:i,createdBy:r,limit:l,offset:o,orderBy:d,ordering:c,paymentPlan:u,program:h,search:m}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/surveys/",path:{business_area_slug:t,program_slug:a},query:{created_at_after:n,created_at_before:i,created_by:r,limit:l,offset:o,order_by:d,ordering:c,payment_plan:u,program:h,search:m}})}static restBusinessAreasProgramsSurveysCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/surveys/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsSurveysRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/surveys/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsSurveysExportSampleRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/surveys/{id}/export-sample/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsSurveysAvailableFlowsList({businessAreaSlug:t,programSlug:a,createdAtAfter:n,createdAtBefore:i,createdBy:r,orderBy:l,ordering:o,paymentPlan:d,program:c,search:u}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/surveys/available-flows/",path:{business_area_slug:t,program_slug:a},query:{created_at_after:n,created_at_before:i,created_by:r,order_by:l,ordering:o,payment_plan:d,program:c,search:u}})}static restBusinessAreasProgramsSurveysCategoryChoicesList({businessAreaSlug:t,programSlug:a,createdAtAfter:n,createdAtBefore:i,createdBy:r,limit:l,offset:o,orderBy:d,ordering:c,paymentPlan:u,program:h,search:m}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/surveys/category-choices/",path:{business_area_slug:t,program_slug:a},query:{created_at_after:n,created_at_before:i,created_by:r,limit:l,offset:o,order_by:d,ordering:c,payment_plan:u,program:h,search:m}})}static restBusinessAreasProgramsSurveysCountRetrieve({businessAreaSlug:t,programSlug:a,createdAtAfter:n,createdAtBefore:i,createdBy:r,orderBy:l,ordering:o,paymentPlan:d,program:c,search:u}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/surveys/count/",path:{business_area_slug:t,program_slug:a},query:{created_at_after:n,created_at_before:i,created_by:r,order_by:l,ordering:o,payment_plan:d,program:c,search:u}})}static restBusinessAreasProgramsSurveysSampleSizeCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/surveys/sample-size/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsTargetPopulationsList({businessAreaSlug:t,programSlug:a,createdAtGte:n,createdAtLte:i,deliveryMechanism:r,endDate:l,fsp:o,limit:d,name:c,offset:u,ordering:h,paymentVerificationSummaryStatus:m,program:g,programCycle:x,programCycleEndDate:f,programCycleStartDate:j,search:y,startDate:b,status:C,totalEntitledQuantityUsdFrom:v,totalEntitledQuantityUsdTo:S,totalHouseholdsCountGte:I,totalHouseholdsCountLte:E,totalIndividualsCountGte:D,totalIndividualsCountLte:F,updatedAtGte:w,updatedAtLte:O}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/",path:{business_area_slug:t,program_slug:a},query:{created_at__gte:n,created_at__lte:i,delivery_mechanism:r,end_date:l,fsp:o,limit:d,name:c,offset:u,ordering:h,payment_verification_summary_status:m,program:g,program_cycle:x,program_cycle_end_date:f,program_cycle_start_date:j,search:y,start_date:b,status:C,total_entitled_quantity_usd_from:v,total_entitled_quantity_usd_to:S,total_households_count__gte:I,total_households_count__lte:E,total_individuals_count__gte:D,total_individuals_count__lte:F,updated_at__gte:w,updated_at__lte:O}})}static restBusinessAreasProgramsTargetPopulationsCreate({businessAreaSlug:t,programSlug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/",path:{business_area_slug:t,program_slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsTargetPopulationsRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsTargetPopulationsPartialUpdate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"PATCH",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/{id}/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsTargetPopulationsDestroy({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"DELETE",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/{id}/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsTargetPopulationsApplyEngineFormulaCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/{id}/apply-engine-formula/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsTargetPopulationsCopyCreate({businessAreaSlug:t,id:a,programSlug:n,requestBody:i}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/{id}/copy/",path:{business_area_slug:t,id:a,program_slug:n},body:i,mediaType:"application/json"})}static restBusinessAreasProgramsTargetPopulationsLockRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/{id}/lock/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsTargetPopulationsMarkReadyRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/{id}/mark-ready/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsTargetPopulationsPendingPaymentsList({businessAreaSlug:t,id:a,programSlug:n,limit:i,offset:r,ordering:l}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/{id}/pending-payments/",path:{business_area_slug:t,id:a,program_slug:n},query:{limit:i,offset:r,ordering:l}})}static restBusinessAreasProgramsTargetPopulationsPendingPaymentsCountRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/{id}/pending-payments/count/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsTargetPopulationsRebuildRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/{id}/rebuild/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsTargetPopulationsUnlockRetrieve({businessAreaSlug:t,id:a,programSlug:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/{id}/unlock/",path:{business_area_slug:t,id:a,program_slug:n}})}static restBusinessAreasProgramsTargetPopulationsCountRetrieve({businessAreaSlug:t,programSlug:a,createdAtGte:n,createdAtLte:i,deliveryMechanism:r,endDate:l,fsp:o,name:d,ordering:c,paymentVerificationSummaryStatus:u,program:h,programCycle:m,programCycleEndDate:g,programCycleStartDate:x,search:f,startDate:j,status:y,totalEntitledQuantityUsdFrom:b,totalEntitledQuantityUsdTo:C,totalHouseholdsCountGte:v,totalHouseholdsCountLte:S,totalIndividualsCountGte:I,totalIndividualsCountLte:E,updatedAtGte:D,updatedAtLte:F}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{program_slug}/target-populations/count/",path:{business_area_slug:t,program_slug:a},query:{created_at__gte:n,created_at__lte:i,delivery_mechanism:r,end_date:l,fsp:o,name:d,ordering:c,payment_verification_summary_status:u,program:h,program_cycle:m,program_cycle_end_date:g,program_cycle_start_date:x,search:f,start_date:j,status:y,total_entitled_quantity_usd_from:b,total_entitled_quantity_usd_to:C,total_households_count__gte:v,total_households_count__lte:S,total_individuals_count__gte:I,total_individuals_count__lte:E,updated_at__gte:D,updated_at__lte:F}})}static restBusinessAreasProgramsRetrieve({businessAreaSlug:t,slug:a}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{slug}/",path:{business_area_slug:t,slug:a}})}static restBusinessAreasProgramsUpdate({businessAreaSlug:t,slug:a,requestBody:n}){return q(z,{method:"PUT",url:"/api/rest/business-areas/{business_area_slug}/programs/{slug}/",path:{business_area_slug:t,slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsPartialUpdate({businessAreaSlug:t,slug:a}){return q(z,{method:"PATCH",url:"/api/rest/business-areas/{business_area_slug}/programs/{slug}/",path:{business_area_slug:t,slug:a}})}static restBusinessAreasProgramsDestroy({businessAreaSlug:t,slug:a}){return q(z,{method:"DELETE",url:"/api/rest/business-areas/{business_area_slug}/programs/{slug}/",path:{business_area_slug:t,slug:a}})}static restBusinessAreasProgramsActivateCreate({businessAreaSlug:t,slug:a}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{slug}/activate/",path:{business_area_slug:t,slug:a}})}static restBusinessAreasProgramsCopyCreate({businessAreaSlug:t,slug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{slug}/copy/",path:{business_area_slug:t,slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsDeduplicationFlagsRetrieve({businessAreaSlug:t,slug:a}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{slug}/deduplication_flags/",path:{business_area_slug:t,slug:a}})}static restBusinessAreasProgramsFinishCreate({businessAreaSlug:t,slug:a}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{slug}/finish/",path:{business_area_slug:t,slug:a}})}static restBusinessAreasProgramsPaymentsList({businessAreaSlug:t,slug:a,beneficiaryGroupMatch:n,budgetMax:i,budgetMin:r,compatibleDct:l,dataCollectingType:o,endDate:d,limit:c,name:u,numberOfHouseholdsMax:h,numberOfHouseholdsMin:m,offset:g,orderBy:x,ordering:f,search:j,sector:y,startDate:b,status:C,updatedAtAfter:v,updatedAtBefore:S}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/{slug}/payments/",path:{business_area_slug:t,slug:a},query:{beneficiary_group_match:n,budget_max:i,budget_min:r,compatible_dct:l,data_collecting_type:o,end_date:d,limit:c,name:u,number_of_households_max:h,number_of_households_min:m,offset:g,order_by:x,ordering:f,search:j,sector:y,start_date:b,status:C,updated_at_after:v,updated_at_before:S}})}static restBusinessAreasProgramsUpdatePartnerAccessCreate({businessAreaSlug:t,slug:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/programs/{slug}/update_partner_access/",path:{business_area_slug:t,slug:a},body:n,mediaType:"application/json"})}static restBusinessAreasProgramsChoicesRetrieve({businessAreaSlug:t}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/choices/",path:{business_area_slug:t}})}static restBusinessAreasProgramsCountRetrieve({businessAreaSlug:t,beneficiaryGroupMatch:a,budgetMax:n,budgetMin:i,compatibleDct:r,dataCollectingType:l,endDate:o,name:d,numberOfHouseholdsMax:c,numberOfHouseholdsMin:u,orderBy:h,ordering:m,search:g,sector:x,startDate:f,status:j,updatedAtAfter:y,updatedAtBefore:b}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/programs/count/",path:{business_area_slug:t},query:{beneficiary_group_match:a,budget_max:n,budget_min:i,compatible_dct:r,data_collecting_type:l,end_date:o,name:d,number_of_households_max:c,number_of_households_min:u,order_by:h,ordering:m,search:g,sector:x,start_date:f,status:j,updated_at_after:y,updated_at_before:b}})}static restBusinessAreasSanctionListList({businessAreaSlug:t,fullName:a,fullNameStartswith:n,id:i,limit:r,offset:l,orderBy:o,ordering:d,referenceNumber:c,search:u}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/sanction-list/",path:{business_area_slug:t},query:{full_name:a,full_name__startswith:n,id:i,limit:r,offset:l,order_by:o,ordering:d,reference_number:c,search:u}})}static restBusinessAreasSanctionListRetrieve({businessAreaSlug:t,id:a}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/sanction-list/{id}/",path:{business_area_slug:t,id:a}})}static restBusinessAreasSanctionListCheckAgainstSanctionListCreate({businessAreaSlug:t,requestBody:a}){return q(z,{method:"POST",url:"/api/rest/business-areas/{business_area_slug}/sanction-list/check-against-sanction-list/",path:{business_area_slug:t},body:a,mediaType:"application/json"})}static restBusinessAreasSanctionListCountRetrieve({businessAreaSlug:t,fullName:a,fullNameStartswith:n,id:i,orderBy:r,ordering:l,referenceNumber:o,search:d}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/sanction-list/count/",path:{business_area_slug:t},query:{full_name:a,full_name__startswith:n,id:i,order_by:r,ordering:l,reference_number:o,search:d}})}static restBusinessAreasUsersList({businessAreaSlug:t,isFeedbackCreator:a,isMessageCreator:n,isSurveyCreator:i,isTicketCreator:r,limit:l,offset:o,orderBy:d,ordering:c,partner:u,program:h,roles:m,search:g,serializer:x,status:f}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/users/",path:{business_area_slug:t},query:{is_feedback_creator:a,is_message_creator:n,is_survey_creator:i,is_ticket_creator:r,limit:l,offset:o,order_by:d,ordering:c,partner:u,program:h,roles:m,search:g,serializer:x,status:f}})}static restBusinessAreasUsersChoicesRetrieve({businessAreaSlug:t}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/users/choices/",path:{business_area_slug:t}})}static restBusinessAreasUsersCountRetrieve({businessAreaSlug:t,isFeedbackCreator:a,isMessageCreator:n,isSurveyCreator:i,isTicketCreator:r,orderBy:l,ordering:o,partner:d,search:c,status:u}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/users/count/",path:{business_area_slug:t},query:{is_feedback_creator:a,is_message_creator:n,is_survey_creator:i,is_ticket_creator:r,order_by:l,ordering:o,partner:d,search:c,status:u}})}static restBusinessAreasUsersPartnerForGrievanceChoicesRetrieve({businessAreaSlug:t}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/users/partner-for-grievance-choices/",path:{business_area_slug:t}})}static restBusinessAreasUsersProfileRetrieve({businessAreaSlug:t,program:a}){return q(z,{method:"GET",url:"/api/rest/business-areas/{business_area_slug}/users/profile/",path:{business_area_slug:t},query:{program:a}})}static restBusinessAreasRetrieve({slug:t}){return q(z,{method:"GET",url:"/api/rest/business-areas/{slug}/",path:{slug:t}})}static restBusinessAreasAllFieldsAttributesList({slug:t,limit:a,offset:n,ordering:i,programId:r}){return q(z,{method:"GET",url:"/api/rest/business-areas/{slug}/all-fields-attributes/",path:{slug:t},query:{limit:a,offset:n,ordering:i,program_id:r}})}static restBusinessAreasAllKoboProjectsCreate({slug:t,ordering:a,requestBody:n}){return q(z,{method:"POST",url:"/api/rest/business-areas/{slug}/all-kobo-projects/",path:{slug:t},query:{ordering:a},body:n,mediaType:"application/json"})}static restBusinessAreasAllCollectorFieldsAttributesList({limit:t,offset:a,ordering:n}){return q(z,{method:"GET",url:"/api/rest/business-areas/all-collector-fields-attributes/",query:{limit:t,offset:a,ordering:n}})}static restBusinessAreasCountRetrieve({ordering:t}){return q(z,{method:"GET",url:"/api/rest/business-areas/count/",query:{ordering:t}})}static restChoicesCountriesList(){return q(z,{method:"GET",url:"/api/rest/choices/countries/"})}static restChoicesCurrenciesList(){return q(z,{method:"GET",url:"/api/rest/choices/currencies/"})}static restChoicesFeedbackIssueTypeList(){return q(z,{method:"GET",url:"/api/rest/choices/feedback-issue-type/"})}static restChoicesLanguagesList(){return q(z,{method:"GET",url:"/api/rest/choices/languages/"})}static restChoicesPaymentPlanBackgroundActionStatusList(){return q(z,{method:"GET",url:"/api/rest/choices/payment-plan-background-action-status/"})}static restChoicesPaymentPlanStatusList(){return q(z,{method:"GET",url:"/api/rest/choices/payment-plan-status/"})}static restChoicesPaymentRecordDeliveryTypeList(){return q(z,{method:"GET",url:"/api/rest/choices/payment-record-delivery-type/"})}static restChoicesPaymentVerificationPlanSamplingList(){return q(z,{method:"GET",url:"/api/rest/choices/payment-verification-plan-sampling/"})}static restChoicesPaymentVerificationPlanStatusList(){return q(z,{method:"GET",url:"/api/rest/choices/payment-verification-plan-status/"})}static restChoicesPaymentVerificationStatusList(){return q(z,{method:"GET",url:"/api/rest/choices/payment-verification-status/"})}static restChoicesPaymentVerificationSummaryStatusList(){return q(z,{method:"GET",url:"/api/rest/choices/payment-verification-summary-status/"})}static restConstanceRetrieve(){return q(z,{method:"GET",url:"/api/rest/constance/"})}static restDashboardDataRetrieve({businessAreaSlug:t}){return q(z,{method:"GET",url:"/api/rest/dashboard/{business_area_slug}/data/",path:{business_area_slug:t}})}static restDashboardGenerateCreate({businessAreaSlug:t}){return q(z,{method:"POST",url:"/api/rest/dashboard/generate/{business_area_slug}/",path:{business_area_slug:t}})}static restEngineRulesList({type:t,businessArea:a,deprecated:n,enabled:i,limit:r,offset:l,ordering:o}){return q(z,{method:"GET",url:"/api/rest/engine-rules/",query:{business_area:a,deprecated:n,enabled:i,limit:r,offset:l,ordering:o,type:t}})}static restGroupsList({limit:t,offset:a,ordering:n}){return q(z,{method:"GET",url:"/api/rest/groups/",query:{limit:t,offset:a,ordering:n}})}static restGroupsRetrieve({id:t}){return q(z,{method:"GET",url:"/api/rest/groups/{id}/",path:{id:t}})}static restGroupsCountRetrieve({ordering:t}){return q(z,{method:"GET",url:"/api/rest/groups/count/",query:{ordering:t}})}static restLookupsCountryList({limit:t,offset:a,ordering:n,search:i,updatedAtAfter:r,updatedAtBefore:l,validFromAfter:o,validFromBefore:d,validUntilAfter:c,validUntilBefore:u}){return q(z,{method:"GET",url:"/api/rest/lookups/country/",query:{limit:t,offset:a,ordering:n,search:i,updated_at_after:r,updated_at_before:l,valid_from_after:o,valid_from_before:d,valid_until_after:c,valid_until_before:u}})}static restLookupsDocumentRetrieve(){return q(z,{method:"GET",url:"/api/rest/lookups/document/"})}static restLookupsFinancialInstitutionList({limit:t,offset:a,ordering:n,type:i,updatedAtAfter:r,updatedAtBefore:l}){return q(z,{method:"GET",url:"/api/rest/lookups/financial-institution/",query:{limit:t,offset:a,ordering:n,type:i,updated_at_after:r,updated_at_before:l}})}static restLookupsMaritalstatusRetrieve(){return q(z,{method:"GET",url:"/api/rest/lookups/maritalstatus/"})}static restLookupsObserveddisabilityRetrieve(){return q(z,{method:"GET",url:"/api/rest/lookups/observeddisability/"})}static restLookupsProgramStatusesRetrieve(){return q(z,{method:"GET",url:"/api/rest/lookups/program-statuses/"})}static restLookupsRelationshipRetrieve(){return q(z,{method:"GET",url:"/api/rest/lookups/relationship/"})}static restLookupsResidencestatusRetrieve(){return q(z,{method:"GET",url:"/api/rest/lookups/residencestatus/"})}static restLookupsRoleRetrieve(){return q(z,{method:"GET",url:"/api/rest/lookups/role/"})}static restLookupsSexRetrieve(){return q(z,{method:"GET",url:"/api/rest/lookups/sex/"})}static restProgramsList({active:t,businessArea:a,limit:n,offset:i,ordering:r,status:l,updatedAtAfter:o,updatedAtBefore:d}){return q(z,{method:"GET",url:"/api/rest/programs/",query:{active:t,business_area:a,limit:n,offset:i,ordering:r,status:l,updated_at_after:o,updated_at_before:d}})}static restSystemsAuroraOfficesList({limit:t,offset:a}){return q(z,{method:"GET",url:"/api/rest/systems/aurora/offices/",query:{limit:t,offset:a}})}static restSystemsAuroraProjectsList({limit:t,offset:a,orgPk:n,orgSlug:i}){return q(z,{method:"GET",url:"/api/rest/systems/aurora/projects/",query:{limit:t,offset:a,org_pk:n,org_slug:i}})}static restSystemsAuroraRegistrationsList({limit:t,offset:a,orgPk:n,orgSlug:i,programmePk:r}){return q(z,{method:"GET",url:"/api/rest/systems/aurora/registrations/",query:{limit:t,offset:a,org_pk:n,org_slug:i,programme_pk:r}})}}function Bi(){const{businessArea:s}=ts();return s}function Zp(){const{programId:s}=ts();return s===void 0?"all":s}function U(){const s=Bi(),t=Zp(),a=`${s}/programs/${t}`;return{businessArea:s,programId:t,baseUrl:a,isAllPrograms:t==="all",isGlobal:s==="global",businessAreaSlug:s,programSlug:t}}const eg=()=>{const{businessAreaSlug:s,programSlug:t}=U(),{data:a}=V({queryKey:["profile",s,t],queryFn:()=>N.restBusinessAreasUsersProfileRetrieve({businessAreaSlug:s,program:t==="all"?void 0:t}),staleTime:300*1e3,gcTime:1800*1e3,refetchOnWindowFocus:!1,retry:!1}),n=ge();return A.useEffect(()=>{a&&(a.businessAreas.length<1?n("/access-denied"):n(`/${a.businessAreas[0].slug}/programs/all/list`))},[a,n]),null},sg=""+new URL("404_graphic-D8eUPzUS.png",import.meta.url).href,tg=""+new URL("404_hope_logo-Cn7xyLMl.png",import.meta.url).href,ag=T.div`
  background-color: #ffffff;
  text-align: center;
  padding-top: 150px;
  font-family: 'Roboto', sans-serif;
  height: 100vh;
`,ng=T.div`
  position: absolute;
  top: 20px;
  left: 20px;
`,ig=T.div`
  display: inline-block;
  background-color: white;
  padding: 20px;
  margin-bottom: 20px;
`,rg=T.div`
  max-width: 450px;
  text-align: center;
  margin: 0 auto;
`,lg=T.h1`
  font-size: 32px;
  font-weight: lighter;
  color: #233944;
  line-height: 32px;
`,og=T.p`
  font-size: 24px;
  color: #666666;
  line-height: 32px;
`,dg=()=>{const s=ge(),n=je().pathname.split("/")[2],i=()=>{s(-1)};return e.jsxs(ag,{children:[e.jsx(ng,{children:e.jsx("img",{src:tg,alt:"Hope Logo",width:"186",height:"101"})}),e.jsx(ig,{children:e.jsx("img",{src:sg,alt:"Brush with paint 404",width:"354",height:"293"})}),e.jsxs(rg,{children:[e.jsx(lg,{children:"Oops! Page Not Found"}),e.jsx(og,{children:"Looks like you've ventured off the map. Don't worry, we can help you get back on track. Please try again or explore our other exciting content."})]}),e.jsxs(P,{display:"flex",justifyContent:"center",alignItems:"center",children:[e.jsx(P,{mr:4,children:e.jsx(H,{endIcon:e.jsx(dc,{}),variant:"outlined",color:"primary",onClick:()=>{i()},"data-cy":"button-refresh-page",children:"REFRESH PAGE"})}),e.jsx(H,{endIcon:e.jsx(Lh,{}),color:"primary",variant:"contained",component:ys,"data-cy":"go-to-programme-management",to:`/${n}/programs/all/list`,children:"GO TO PROGRAMME MANAGEMENT"})]})]})},cg=""+new URL("access_denied-CEc2pi93.png",import.meta.url).href,ug=""+new URL("404_hope_logo-Cn7xyLMl.png",import.meta.url).href,hg=T.div`
  background-color: #ffffff;
  text-align: center;
  padding-top: 150px;
  font-family: 'Roboto', sans-serif;
  height: 100vh;
`,mg=T.div`
  position: absolute;
  top: 20px;
  left: 20px;
`,pg=T.div`
  display: inline-block;
  background-color: white;
  padding: 20px;
  margin-bottom: 20px;
`,gg=T.div`
  max-width: 450px;
  text-align: center;
  margin: 0 auto;
`,xg=T.h1`
  font-size: 32px;
  font-weight: lighter;
  color: #233944;
  line-height: 32px;
`,Do=T.p`
  font-size: 24px;
  color: #666666;
  line-height: 32px;
`,fg=T.p`
  font-size: 16px;
  color: #888;
  line-height: 24px;
  margin-top: 16px;
`;function yg(){const s=je(),t=new URLSearchParams(s.search),a=t.get("required_permissions"),n=t.get("detail"),i=a?a.split(","):[],r=()=>{window.history.back()},l=()=>{window.history.length>2?window.history.go(-2):window.history.back()};return e.jsxs(hg,{children:[e.jsx(mg,{children:e.jsx("img",{src:ug,alt:"Hope Logo",width:"186",height:"101"})}),e.jsx(pg,{children:e.jsx("img",{src:cg,alt:"Hand denying access",width:"354",height:"293"})}),e.jsxs(gg,{children:[e.jsx(xg,{children:"Access Denied"}),n&&e.jsx(Do,{children:n}),i.length===0?e.jsx(Do,{children:"Sorry, the page you're trying to reach either doesn't exist or you don't have the required permissions to view it."}):e.jsxs(fg,{children:[e.jsx("strong",{children:"Required Permissions:"}),e.jsx("br",{}),i.map((o,d)=>e.jsxs("span",{children:[o,d<i.length-1?", ":""]},o))]})]}),e.jsxs(P,{display:"flex",justifyContent:"center",alignItems:"center",children:[e.jsx(P,{mr:4,children:e.jsx(H,{endIcon:e.jsx(dc,{}),variant:"outlined",color:"primary",onClick:r,"data-cy":"button-refresh-page",children:"REFRESH PAGE"})}),e.jsx(H,{endIcon:e.jsx(cc,{}),color:"primary",variant:"contained",onClick:l,"data-cy":"button-go-back",children:"GO BACK"})]})]})}const bg=""+new URL("logo-transparent-Bm-Z-8pA.png",import.meta.url).href,jg=""+new URL("logo-with-subtitle-transparent-D7FKZ1Ev.png",import.meta.url).href,Ag=""+new URL("logo-BC-2ZgLE.jpg",import.meta.url).href,_g=""+new URL("logo-with-subtitle-xqn0OPW2.jpg",import.meta.url).href,Pg=T.img`
  height: ${s=>`${s.height}px`};
`;function Hc({transparent:s,displayLogoWithoutSubtitle:t,height:a}){let n;s?n=t===!0?bg:jg:n=t===!0?Ag:_g;const i=t===!0?64:206;return e.jsx(Pg,{height:a||i,src:n,alt:"HOPE Portal Logo"})}const To="/api/login/azuread-tenant-oauth2/",Rl="d MMM yyyy",Cg="d MMM yyyy h:mm a",Eg=15,vg=1e3*60*Eg,Sg=T.div`
  width: 100vw;
  height: 100vh;
  align-items: center;
  justify-content: center;
  display: flex;
`,Ig=T.div`
  text-align: center;
  height: 538px;
  width: 533px;
  border-radius: 4px;
  background-color: ${({theme:s})=>s.hctPalette.lightBlue};
  box-shadow:
    0 0 2px 0 rgba(0, 0, 0, 0.12),
    0 2px 2px 0 rgba(0, 0, 0, 0.24);
  padding: 50px;
`,Dg=T(ee)`
  && {
    color: #ffff;
    font-size: 24px;
    font-weight: 300;
    line-height: 32px;
    margin-top: ${({theme:s})=>s.spacing(13)};
  }
`,Tg=T.div`
  margin-left: ${({theme:s})=>s.spacing(11)};
  margin-right: ${({theme:s})=>s.spacing(11)};
`,Rg=T(H)`
  && {
    margin-top: ${({theme:s})=>s.spacing(6)};
    width: 100%;
    height: 64px;
    background-color: ${({theme:s})=>s.palette.primary.main};
    color: #ffff;
  }
`;function Fg(){const{t:s}=M(),t=je(),n=new URLSearchParams(t.search).get("next");return e.jsx(Sg,{children:e.jsxs(Ig,{children:[e.jsx(Hc,{transparent:!1,displayLogoWithoutSubtitle:!1}),e.jsx(Dg,{children:s("Login via Active Directory")}),e.jsx(Tg,{children:e.jsx(Rg,{variant:"contained",size:"large",component:"a",href:n?`${To}?next=${n}`:To,children:s("Sign in")})})]})})}const Ng=""+new URL("maintenance_graphic_painter-C9vHXaqW.png",import.meta.url).href,Lg=""+new URL("404_hope_logo-Cn7xyLMl.png",import.meta.url).href,Og=T.div`
  background-color: #ffffff;
  text-align: center;
  padding-top: 150px;
  font-family: 'Roboto', sans-serif;
  height: 100vh;
`,kg=T.div`
  position: absolute;
  top: 20px;
  left: 20px;
`,wg=T.div`
  display: inline-block;
  background-color: white;
  padding: 20px;
  margin-bottom: 20px;
`,Mg=T.div`
  max-width: 450px;
  text-align: center;
  margin: 0 auto;
`,$g=T.h1`
  font-size: 32px;
  font-weight: lighter;
  color: #233944;
  line-height: 32px;
`,Ug=T.p`
  font-size: 24px;
  color: #666666;
  line-height: 32px;
`,Vg=T.button`
  background-color: transparent;
  border: 2px solid #033f91;
  border-radius: 4px;
  padding: 6px 16px;
  font-size: 14px;
  font-weight: 600;
  line-height: 16px;
  letter-spacing: 1.25px;
  color: #033f91;
  cursor: pointer;
`,Bg=T.img`
  vertical-align: middle;
  margin-left: 5px;
  width: 28px;
  height: 28px;
`,Gg=()=>{const s=()=>{window.history.back()};return e.jsxs(Og,{children:[e.jsx(kg,{children:e.jsx("img",{src:Lg,alt:"Hope Logo",width:"186",height:"101"})}),e.jsx(wg,{children:e.jsx("img",{src:Ng,alt:"Brush with paint",width:"354",height:"293"})}),e.jsxs(Mg,{children:[e.jsx($g,{children:"System under maintenance"}),e.jsx(Ug,{children:"Sorry for the inconvenience. Maintenance is underway to enhance our services. System will be back shortly!"})]}),e.jsxs(Vg,{onClick:s,children:["REFRESH PAGE",e.jsx(Bg,{src:"./refresh_icon.png",alt:"Refresh Icon",width:"20",height:"20"})]})]})},zg=""+new URL("something_went_wrong_graphic-5NhFRnct.png",import.meta.url).href,qg=""+new URL("404_hope_logo-Cn7xyLMl.png",import.meta.url).href,Hg=T.div`
  background-color: #ffffff;
  text-align: center;
  padding-top: 30px;
  font-family: 'Roboto', sans-serif;
  height: 100vh;
  width: 100%;
`,Wg=T.div`
  position: absolute;
  top: 20px;
  left: 20px;
`,Kg=T.div`
  display: inline-block;
  background-color: white;
  padding: 20px;
  margin-bottom: 20px;
`,Yg=T.div`
  max-width: 450px;
  text-align: center;
  margin: 0 auto;
`,Qg=T.h1`
  font-size: 32px;
  font-weight: lighter;
  color: #233944;
  line-height: 32px;
`,yn=T.p`
  font-size: 18px;
  color: #666666;
  line-height: 32px;
`,Gi=({pathname:s,errorMessage:t,component:a,goBackAddress:n,specificError:i})=>{const r=je(),l=ge(),o=()=>{n?l(n):r.state?.lastSuccessfulPage?l(r.state.lastSuccessfulPage):window.history.back()},d=window.location.hostname.includes("localhost")||window.location.href.includes("dev")||window.location.href.includes("trn")||window.location.href.includes("stg"),c=r.state?.errorMessage||t;return e.jsxs(Hg,{children:[e.jsxs(Wg,{children:[e.jsx("img",{src:qg,alt:"Hope Logo",width:"130",height:"71"})," "]}),e.jsx(Kg,{children:e.jsx("img",{src:zg,alt:"Sad face",width:"248",height:"205"})}),e.jsxs(Yg,{children:[e.jsx(Qg,{children:"Oops! Something went wrong"}),i?e.jsxs(yn,{children:["Error: ",i]}):d&&c?e.jsxs(P,{display:"flex",flexDirection:"column",children:[s&&e.jsxs(yn,{style:{wordWrap:"break-word"},children:["Location: ",s]}),c&&e.jsxs(yn,{style:{wordWrap:"break-word"},children:["Error: ",c]}),a&&e.jsxs(yn,{children:["Component: ",a]})]}):e.jsx(yn,{children:"Don't worry! Our team is on it, working to fix the issue. Please try again later. Thank you for your patience."})]}),e.jsx(P,{display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(H,{endIcon:e.jsx(cc,{}),color:"primary",variant:"contained",onClick:o,"data-cy":"button-go-back",children:"GO BACK"})})]})};function et(s,t,a,n,i="smooth"){A.useEffect(()=>{t&&s.current&&(s.current.scrollIntoView({behavior:i}),n&&n())},[a,t,s,i,n])}function qt(s,t){const[a,n]=A.useState(s);return A.useEffect(()=>{const i=setTimeout(()=>{n(s)},t);return()=>{clearTimeout(i)}},[s]),a}const zi=T(ha)`
  width: 100%;
  .MuiFormControl-marginDense {
    margin-top: 4px;
  }
  .MuiAutocomplete-tag {
    max-height: 50px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .MuiAutocomplete-inputRoot {
    display: flex;
    flex-wrap: nowrap;
  }
  .MuiAutocomplete-inputRoot .MuiAutocomplete-input {
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
`,qi=T(ks)`
  & .MuiInputBase-input {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
`;function un({value:s,disabled:t,label:a,dataCy:n,loadData:i,loading:r,options:l,handleChange:o,handleClose:d,handleOptionSelected:c,handleOptionLabel:u,handleOpen:h,open:m,data:g,inputValue:x,onInputTextChange:f,debouncedInputText:j,startAdornment:y=null}){const b=A.useRef(s);return A.useEffect(()=>{b.current!==""&&s===""&&x!==""&&f(""),b.current=s},[s,f,x]),A.useEffect(()=>{i()},[i]),A.useEffect(()=>{m&&i()},[m,j,i]),g?e.jsx(zi,{freeSolo:!1,filterOptions:C=>C,value:s,"data-cy":n,open:m,options:l,onChange:o,onOpen:h,onClose:d,isOptionEqualToValue:(C,v)=>c(C,v),getOptionLabel:u,disabled:t,loading:r,renderInput:C=>e.jsx(qi,{...C,label:a,variant:"outlined",size:"small","data-cy":`${a}-input`,value:x,onChange:v=>f(v.target.value),slotProps:{input:{...C.InputProps,startAdornment:y,endAdornment:e.jsxs(e.Fragment,{children:[r?e.jsx(la,{color:"inherit",size:20}):null,C.InputProps.endAdornment]})}}})},b.current):null}function Bn({disabled:s,name:t,filter:a,value:n,label:i,initialFilter:r,appliedFilter:l,setAppliedFilter:o,setFilter:d,dataCy:c="assignee-autocomplete"}){const{businessArea:u}=U(),[h,m]=A.useState(!1),g=ge(),x=je(),[f,j]=A.useState(""),y=qt(f,800),[b,C]=A.useState({limit:20,businessAreaSlug:u,search:y||void 0,ordering:"first_name,last_name,email"}),{data:v,isLoading:S,refetch:I}=V({queryKey:["businessAreasUsersList",b,u],queryFn:()=>N.restBusinessAreasUsersList(b)});A.useEffect(()=>{C(G=>({...G,search:y||void 0}))},[y]);const E=A.useCallback(()=>{u&&I()},[u,I]),{handleFilterChange:D}=Ss(r,g,x,a,d,l,o),F=v?.results||[],w=F.map(G=>({id:G.id,name:`${G.firstName} ${G.lastName}`.trim()||G.email})),O=(G,W)=>typeof W=="string"?G?.id===W:G?.id===W?.id,k=G=>{if(typeof G=="string"){const W=F.find(Y=>Y.id===G);return W?`${W.firstName||""} ${W.lastName||""}`.trim()||W.email:G}return G?.name||""},$=G=>{j(G)};return e.jsx(un,{value:n,disabled:s,label:i,dataCy:c,loadData:E,loading:S,options:w,handleChange:(G,W)=>{W||$(""),Qa(t,W?.id,D)},handleOpen:()=>m(!0),open:h,handleClose:(G,W)=>{m(!1),W!=="select-option"&&$("")},handleOptionSelected:O,handleOptionLabel:k,data:v,inputValue:f,onInputTextChange:$,debouncedInputText:y})}function Xg({clearHandler:s,applyHandler:t}){const{t:a}=M(),n=A.useCallback(i=>{i.key==="Enter"&&t()},[t]);return A.useEffect(()=>{const i=r=>{n(r)};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[n]),e.jsx(p,{container:!0,spacing:3,sx:{justifyContent:"flex-end"},children:e.jsxs(P,{sx:{mt:6},children:[e.jsx(H,{color:"primary","data-cy":"button-filters-clear",onClick:s,children:a("Clear")}),e.jsx(H,{color:"primary",variant:"outlined","data-cy":"button-filters-apply",onClick:t,children:a("Apply")})]})})}const Jg=T(us)`
  width: 100%;
  background-color: #fff;
  padding: 8px 44px;
`,Ns=({children:s,clearHandler:t,applyHandler:a,isOnPaper:n=!0,withApplyClearButtons:i=!0})=>{const[r]=A.useState(!0),l=e.jsxs(e.Fragment,{children:[e.jsx(p,{container:!0,spacing:3,sx:{alignItems:"flex-end"},children:e.jsx(P,{sx:{pt:4,pb:4,display:"flex",alignItems:"center",justifyContent:"flex-start",width:"100%"}})}),e.jsx(yt,{in:r,children:e.jsxs(P,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:[s,e.jsx(P,{sx:{display:"flex",justifyContent:"flex-end",mb:2},children:i&&e.jsx(Xg,{clearHandler:t,applyHandler:a})})]})})]});return n?e.jsx(Jg,{children:l}):l},Zg=T(ks)`
  flex: 1;
  && {
    min-width: 150px;
  }
  .MuiOutlinedInput-root {
    border-radius: ${s=>s.$borderRadius};
  }
`;function Cs({icon:s=null,borderRadius:t="4px",fullWidth:a=!0,placeholder:n="Search",...i}){return e.jsx(Zg,{...i,size:"small",fullWidth:a,$borderRadius:t,variant:"outlined",placeholder:n,inputProps:{maxLength:200},InputProps:{startAdornment:e.jsx(dt,{position:"start",children:s||e.jsx(Pa,{})})}})}const ex=T(tt)`
  width: ${s=>s.fullWidth?"100%":"260px"};
  color: #5f6368;
  border-bottom: 0;
  .MuiOutlinedInput-root {
    border-radius: ${s=>s.borderRadius||"4px"};
  }
`,sx=T(dt)`
  margin-right: 0;
`,tx=T(dt)`
  margin-right: 10px;
`,ax=T(Ct)`
  color: #707070;
`,nx=T.div`
  flex: 1;
  display: flex;
  max-width: 100%;
`,ix=T(at)`
  && .MuiOutlinedInput-input {
    padding-right: 10px !important;
  }
  flex: 1;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,rx=T.div`
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 100%;
`,He=({label:s,children:t,onChange:a,icon:n=null,fullWidth:i=!0,disableClearable:r=!1,dataCy:l="select-filter",...o})=>{const c=(u=>Array.isArray(u)?u.length>0:!!u)(o.value);return e.jsx(nx,{children:e.jsx(ex,{fullWidth:i,variant:"outlined",size:"small","data-cy":l,children:e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsx(Rt,{children:s}),e.jsx(ix,{size:"small",onChange:a,variant:"outlined",label:s,MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},renderValue:u=>{const h=Array.isArray(u)?u:[u],m=A.Children.toArray(t).filter(g=>A.isValidElement(g)&&h.includes(g.props.value));return e.jsxs(P,{display:"flex",alignItems:"center",children:[n&&e.jsx(sx,{position:"start",children:n}),e.jsx(rx,{children:m.map(g=>g.props.children).join(" ")})]})},endAdornment:c&&!r&&e.jsx(tx,{position:"end",children:e.jsx(Ve,{size:"medium",onMouseDown:u=>{u.preventDefault(),a({target:{value:o.multiple?[]:""}})},children:e.jsx(ax,{fontSize:"small"})})}),...o,children:t})]})})})},Wc=A.createContext(null);function lx({children:s}){const[t,a]=A.useState(null);let n=t?.status===ht.ACTIVE;const i=t?.dataCollectingType?.type===Kr.SOCIAL,r=t?.dataCollectingType?.type===Kr.STANDARD,l=t?.pduFields&&t.pduFields.length>0;return t===null&&(n=!0),e.jsx(Wc.Provider,{value:{selectedProgram:t,setSelectedProgram:a,isActiveProgram:n,isSocialDctType:i,isStandardDctType:r,programHasPdu:l},children:s})}const Z=()=>A.useContext(Wc);function ox({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i}){const{t:r}=M(),l=ge(),o=je(),{selectedProgram:d}=Z(),c=d?.beneficiaryGroup,{handleFilterChange:u,applyFilterChanges:h,clearFilter:m}=Ss(a,l,o,s,t,n,i),g=()=>{h()},x=()=>{m()},f={program:"Programme",household:`${c?.groupLabel}`,individual:`${c?.memberLabel}`,grievanceticket:"Grievance Tickets",paymentverificationplan:"Payment Plan Payment Verification",targetpopulation:"Target Population",registrationdataimport:"Registration Data Import"};return e.jsx(Ns,{clearHandler:x,applyHandler:g,children:e.jsxs(p,{container:!0,spacing:3,sx:{alignItems:"center"},children:[e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{label:r("Search"),value:s.search,onChange:j=>u("search",j.target.value),"data-cy":"filters-search"})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:j=>u("module",j.target.value),label:r("Module"),value:s.module,icon:e.jsx(Oh,{}),SelectDisplayProps:{"data-cy":"filters-residence-status"},MenuProps:{"data-cy":"filters-residence-status-options"},children:Object.entries(f).sort().map(([j,y])=>e.jsx(de,{value:j,children:y},j))})}),e.jsx(p,{size:{xs:3},children:e.jsx(Bn,{label:r("User"),filter:s,name:"userId",value:s.userId,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})})]})})}const dx=T.div`
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  ${({absolute:s})=>s?"position: absolute;":""}
`;function Ne({isLoading:s=!0,absolute:t}){return s?e.jsx(dx,{absolute:t,"data-cy":"loading-container",children:e.jsx(la,{})}):null}const cx=T(ys)`
  color: rgba(0, 0, 0, 0.87);
  font-size: 16px;
  line-height: 32px;
  text-decoration: none;
`,ux=T(P)`
  color: rgba(0, 0, 0, 0.87);
  font-size: 16px;
  line-height: 32px;
  text-decoration: none;
  cursor: pointer;
`,hx=T.span`
  display: flex;
  align-items: center;
`,mx=T.div`
  display: flex;
  flex-direction: row;
`;function px({title:s,to:t,last:a=!1,onClick:n=()=>null}){return e.jsxs(hx,{"data-cy":"breadcrumbs-element-container",children:[t?e.jsx(cx,{to:t,"data-cy":"breadcrumbs-link",children:s}):e.jsx(ux,{onClick:n,"data-cy":"breadcrumbs-item-not-link",children:s}),a?null:e.jsx(kh,{"data-cy":"breadcrumbs-chevron-icon"})]})}function gx({breadCrumbs:s}){const t=s.map((a,n)=>{const i=n===s.length-1;return e.jsx(px,{title:a.title,to:a.to,onClick:a.handleClick,last:i,"data-cy":`breadcrumbs-element-${n}`},a.title)});return e.jsx(mx,{"data-cy":"breadcrumbs-container",children:t})}const xx=ut("div")({boxShadow:"0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12)",position:"relative",width:"100%",backgroundColor:"#fff"}),fx=ut("div")({display:"flex",alignItems:"center",padding:"28px 44px"}),yx=ut("div")({flex:1,display:"flex",justifyContent:"space-between",alignItems:"center",marginLeft:"20px"}),bx=ut("div")({display:"flex",alignItems:"center"}),jx=ut("div")({cursor:"pointer"}),Ax=ut("div")({margin:"0 0 0 20px"}),_x=ut("div")({width:"60%",minWidth:"600px",transform:"translateY(-12px)","& label:first-child":{fontSize:"24px"},"& input:first-child":{fontSize:"24px"},"& div:first-child":{margin:0}}),Px=ut("div")({width:"100%",wordWrap:"break-word",wordBreak:"break-all"});function Ze({title:s,children:t,breadCrumbs:a=null,tabs:n=null,hasInputComponent:i,flags:r,handleBack:l}){return e.jsxs(xx,{"data-cy":"page-header-container",children:[e.jsxs(fx,{children:[a&&a.length!==0?e.jsx(jx,{"data-cy":"arrow_back",onClick:()=>l?l():window.history.back(),children:e.jsx(wh,{fontSize:"large"})}):null,e.jsxs(yx,{children:[e.jsx("div",{children:A.isValidElement(s)&&i?e.jsx(_x,{"data-cy":"page-header-title",children:s}):e.jsxs(e.Fragment,{children:[a&&e.jsx(gx,{breadCrumbs:a}),e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsx(Px,{children:e.jsx(ee,{"data-cy":"page-header-title",variant:"h5",children:s})}),e.jsx(P,{"data-cy":"button-admin",display:"flex",ml:2,children:r})]})]})}),e.jsx(bx,{children:t||null})]})]}),e.jsx(Ax,{children:n})]})}const Cx=T.div`
  padding: 20px;
`,Ex=T(Mh)`
  && {
    font-size: 100px;
  }
`,vx=T.div`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  color: rgba(0, 0, 0, 0.38);
  padding: 70px;
  font-size: 50px;
  height: calc(100vh - 104px);
`,ur=T.div`
  font-size: 16px;
`;function Xe({permission:s}){const{t}=M(),a=Array.isArray(s)?s.join(", "):s;return e.jsx(Cx,{children:e.jsx(us,{children:e.jsxs(vx,{children:[e.jsx(Ex,{}),e.jsx(P,{children:t("Permission Denied")}),e.jsx(ur,{children:t("Ask the Administrator to get access to this page")}),e.jsx(ur,{children:"Permission:"}),e.jsx(ur,{children:a})]})})})}const Sx=T(us)`
  display: flex;
  padding: ${({theme:s})=>s.spacing(3)} ${({theme:s})=>s.spacing(4)};
  flex-direction: column;
  border-bottom: 1px solid rgba(224, 224, 224, 1);
  text-align: center;
`;function Ix(){const{t:s}=M();return e.jsx(Sx,{children:e.jsx(ee,{variant:"h6",children:s("No data")})})}const R={RDI_VIEW_LIST:"RDI_VIEW_LIST",RDI_VIEW_DETAILS:"RDI_VIEW_DETAILS",RDI_IMPORT_DATA:"RDI_IMPORT_DATA",RDI_RERUN_DEDUPE:"RDI_RERUN_DEDUPE",RDI_MERGE_IMPORT:"RDI_MERGE_IMPORT",RDI_REFUSE_IMPORT:"RDI_REFUSE_IMPORT",POPULATION_VIEW_HOUSEHOLDS_LIST:"POPULATION_VIEW_HOUSEHOLDS_LIST",POPULATION_VIEW_HOUSEHOLDS_DETAILS:"POPULATION_VIEW_HOUSEHOLDS_DETAILS",POPULATION_VIEW_INDIVIDUALS_LIST:"POPULATION_VIEW_INDIVIDUALS_LIST",POPULATION_VIEW_INDIVIDUALS_DETAILS:"POPULATION_VIEW_INDIVIDUALS_DETAILS",POPULATION_VIEW_INDIVIDUAL_DELIVERY_MECHANISMS_SECTION:"POPULATION_VIEW_INDIVIDUAL_DELIVERY_MECHANISMS_SECTION",USER_MANAGEMENT_VIEW_LIST:"USER_MANAGEMENT_VIEW_LIST",PROGRAMME_VIEW_LIST_AND_DETAILS:"PROGRAMME_VIEW_LIST_AND_DETAILS",PROGRAMME_VIEW_PAYMENT_RECORD_DETAILS:"PROGRAMME_VIEW_PAYMENT_RECORD_DETAILS",PROGRAMME_CREATE:"PROGRAMME_CREATE",PROGRAMME_UPDATE:"PROGRAMME_UPDATE",PROGRAMME_REMOVE:"PROGRAMME_REMOVE",PROGRAMME_ACTIVATE:"PROGRAMME_ACTIVATE",PROGRAMME_FINISH:"PROGRAMME_FINISH",PROGRAMME_MANAGEMENT_VIEW:"PROGRAMME_MANAGEMENT_VIEW",PROGRAMME_DUPLICATE:"PROGRAMME_DUPLICATE",PM_PROGRAMME_CYCLE_VIEW_LIST:"PM_PROGRAMME_CYCLE_VIEW_LIST",PM_PROGRAMME_CYCLE_VIEW_DETAILS:"PM_PROGRAMME_CYCLE_VIEW_DETAILS",PM_PROGRAMME_CYCLE_CREATE:"PM_PROGRAMME_CYCLE_CREATE",PM_PROGRAMME_CYCLE_UPDATE:"PM_PROGRAMME_CYCLE_UPDATE",PM_PROGRAMME_CYCLE_DELETE:"PM_PROGRAMME_CYCLE_DELETE",PM_VIEW_PAYMENT_LIST:"PM_VIEW_PAYMENT_LIST",PM_SEND_XLSX_PASSWORD:"PM_SEND_XLSX_PASSWORD",PM_ASSIGN_FUNDS_COMMITMENTS:"PM_ASSIGN_FUNDS_COMMITMENTS",TARGETING_VIEW_LIST:"TARGETING_VIEW_LIST",TARGETING_VIEW_DETAILS:"TARGETING_VIEW_DETAILS",TARGETING_CREATE:"TARGETING_CREATE",TARGETING_UPDATE:"TARGETING_UPDATE",TARGETING_DUPLICATE:"TARGETING_DUPLICATE",TARGETING_REMOVE:"TARGETING_REMOVE",TARGETING_LOCK:"TARGETING_LOCK",TARGETING_UNLOCK:"TARGETING_UNLOCK",TARGETING_SEND:"TARGETING_SEND",PDU_VIEW_LIST_AND_DETAILS:"PDU_VIEW_LIST_AND_DETAILS",PDU_TEMPLATE_CREATE:"PDU_TEMPLATE_CREATE",PDU_TEMPLATE_DOWNLOAD:"PDU_TEMPLATE_DOWNLOAD",PDU_UPLOAD:"PDU_UPLOAD",PAYMENT_VERIFICATION_VIEW_LIST:"PAYMENT_VERIFICATION_VIEW_LIST",PAYMENT_VERIFICATION_VIEW_DETAILS:"PAYMENT_VERIFICATION_VIEW_DETAILS",PAYMENT_VERIFICATION_CREATE:"PAYMENT_VERIFICATION_CREATE",PAYMENT_VERIFICATION_UPDATE:"PAYMENT_VERIFICATION_UPDATE",PAYMENT_VERIFICATION_ACTIVATE:"PAYMENT_VERIFICATION_ACTIVATE",PAYMENT_VERIFICATION_DISCARD:"PAYMENT_VERIFICATION_DISCARD",PAYMENT_VERIFICATION_DELETE:"PAYMENT_VERIFICATION_DELETE",PAYMENT_VERIFICATION_FINISH:"PAYMENT_VERIFICATION_FINISH",PAYMENT_VERIFICATION_EXPORT:"PAYMENT_VERIFICATION_EXPORT",PAYMENT_VERIFICATION_IMPORT:"PAYMENT_VERIFICATION_IMPORT",PAYMENT_VERIFICATION_VERIFY:"PAYMENT_VERIFICATION_VERIFY",PAYMENT_VERIFICATION_VIEW_PAYMENT_RECORD_DETAILS:"PAYMENT_VERIFICATION_VIEW_PAYMENT_RECORD_DETAILS",PM_ABORT:"PM_ABORT",PM_REACTIVATE_ABORT:"PM_REACTIVATE_ABORT",PM_VIEW_LIST:"PM_VIEW_LIST",PM_CREATE:"PM_CREATE",PM_VIEW_DETAILS:"PM_VIEW_DETAILS",PM_IMPORT_XLSX_WITH_ENTITLEMENTS:"PM_IMPORT_XLSX_WITH_ENTITLEMENTS",PM_APPLY_RULE_ENGINE_FORMULA_WITH_ENTITLEMENTS:"PM_APPLY_RULE_ENGINE_FORMULA_WITH_ENTITLEMENTS",PM_LOCK_AND_UNLOCK:"PM_LOCK_AND_UNLOCK",PM_LOCK_AND_UNLOCK_FSP:"PM_LOCK_AND_UNLOCK_FSP",PM_SEND_FOR_APPROVAL:"PM_SEND_FOR_APPROVAL",PM_ACCEPTANCE_PROCESS_APPROVE:"PM_ACCEPTANCE_PROCESS_APPROVE",PM_ACCEPTANCE_PROCESS_AUTHORIZE:"PM_ACCEPTANCE_PROCESS_AUTHORIZE",PM_ACCEPTANCE_PROCESS_FINANCIAL_REVIEW:"PM_ACCEPTANCE_PROCESS_FINANCIAL_REVIEW",PM_ACCEPTANCE_PROCESS_REJECT:"PM_ACCEPTANCE_PROCESS_REJECT",PM_IMPORT_XLSX_WITH_RECONCILIATION:"PM_IMPORT_XLSX_WITH_RECONCILIATION",PM_DOWNLOAD_XLSX_FOR_FSP:"PM_DOWNLOAD_XLSX_FOR_FSP",PM_SEND_TO_PAYMENT_GATEWAY:"PM_SEND_TO_PAYMENT_GATEWAY",PM_SPLIT:"PM_SPLIT",PM_MARK_PAYMENT_AS_FAILED:"PM_MARK_PAYMENT_AS_FAILED",PM_EXCLUDE_BENEFICIARIES_FROM_FOLLOW_UP_PP:"PM_EXCLUDE_BENEFICIARIES_FROM_FOLLOW_UP_PP",PM_EXPORT_PDF_SUMMARY:"PM_EXPORT_PDF_SUMMARY",PM_VIEW_FSP_AUTH_CODE:"PM_VIEW_FSP_AUTH_CODE",PM_UPLOAD_SUPPORTING_DOCUMENT:"PM_UPLOAD_SUPPORTING_DOCUMENT",PM_DELETE_SUPPORTING_DOCUMENT:"PM_DELETE_SUPPORTING_DOCUMENT",PM_DOWNLOAD_SUPPORTING_DOCUMENT:"PM_DOWNLOAD_SUPPORTING_DOCUMENT",PM_CLOSE_FINISHED:"PM_CLOSE_FINISHED",PAYMENT_VIEW_LIST_MANAGERIAL:"PAYMENT_VIEW_LIST_MANAGERIAL",GRIEVANCES_VIEW_DETAILS:"GRIEVANCES_VIEW_DETAILS",GRIEVANCES_VIEW_LIST:"GRIEVANCES_VIEW_LIST",GRIEVANCES_VIEW_DETAILS_EXCLUDING_SENSITIVE:"GRIEVANCES_VIEW_DETAILS_EXCLUDING_SENSITIVE",GRIEVANCES_VIEW_DETAILS_EXCLUDING_SENSITIVE_AS_CREATOR:"GRIEVANCES_VIEW_DETAILS_EXCLUDING_SENSITIVE_AS_CREATOR",GRIEVANCES_VIEW_DETAILS_EXCLUDING_SENSITIVE_AS_OWNER:"GRIEVANCES_VIEW_DETAILS_EXCLUDING_SENSITIVE_AS_OWNER",GRIEVANCES_VIEW_DETAILS_SENSITIVE:"GRIEVANCES_VIEW_DETAILS_SENSITIVE",GRIEVANCES_VIEW_DETAILS_SENSITIVE_AS_CREATOR:"GRIEVANCES_VIEW_DETAILS_SENSITIVE_AS_CREATOR",GRIEVANCES_VIEW_DETAILS_SENSITIVE_AS_OWNER:"GRIEVANCES_VIEW_DETAILS_SENSITIVE_AS_OWNER",GRIEVANCES_VIEW_HOUSEHOLD_DETAILS:"GRIEVANCES_VIEW_HOUSEHOLD_DETAILS",GRIEVANCES_VIEW_HOUSEHOLD_DETAILS_AS_CREATOR:"GRIEVANCES_VIEW_HOUSEHOLD_DETAILS_AS_CREATOR",GRIEVANCES_VIEW_HOUSEHOLD_DETAILS_AS_OWNER:"GRIEVANCES_VIEW_HOUSEHOLD_DETAILS_AS_OWNER",GRIEVANCES_VIEW_INDIVIDUALS_DETAILS:"GRIEVANCES_VIEW_INDIVIDUALS_DETAILS",GRIEVANCES_VIEW_INDIVIDUALS_DETAILS_AS_CREATOR:"GRIEVANCES_VIEW_INDIVIDUALS_DETAILS_AS_CREATOR",GRIEVANCES_VIEW_INDIVIDUALS_DETAILS_AS_OWNER:"GRIEVANCES_VIEW_INDIVIDUALS_DETAILS_AS_OWNER",GRIEVANCES_CREATE:"GRIEVANCES_CREATE",GRIEVANCES_UPDATE:"GRIEVANCES_UPDATE",GRIEVANCES_UPDATE_AS_CREATOR:"GRIEVANCES_UPDATE_AS_CREATOR",GRIEVANCES_UPDATE_AS_OWNER:"GRIEVANCES_UPDATE_AS_OWNER",GRIEVANCES_UPDATE_REQUESTED_DATA_CHANGE:"GRIEVANCES_UPDATE_REQUESTED_DATA_CHANGE",GRIEVANCES_UPDATE_REQUESTED_DATA_CHANGE_AS_CREATOR:"GRIEVANCES_UPDATE_REQUESTED_DATA_CHANGE_AS_CREATOR",GRIEVANCES_UPDATE_REQUESTED_DATA_CHANGE_AS_OWNER:"GRIEVANCES_UPDATE_REQUESTED_DATA_CHANGE_AS_OWNER",GRIEVANCES_ADD_NOTE:"GRIEVANCES_ADD_NOTE",GRIEVANCES_ADD_NOTE_AS_CREATOR:"GRIEVANCES_ADD_NOTE_AS_CREATOR",GRIEVANCES_ADD_NOTE_AS_OWNER:"GRIEVANCES_ADD_NOTE_AS_OWNER",GRIEVANCES_SET_IN_PROGRESS:"GRIEVANCES_SET_IN_PROGRESS",GRIEVANCES_SET_IN_PROGRESS_AS_CREATOR:"GRIEVANCES_SET_IN_PROGRESS_AS_CREATOR",GRIEVANCES_SET_IN_PROGRESS_AS_OWNER:"GRIEVANCES_SET_IN_PROGRESS_AS_OWNER",GRIEVANCES_SET_ON_HOLD:"GRIEVANCES_SET_ON_HOLD",GRIEVANCES_SET_ON_HOLD_AS_CREATOR:"GRIEVANCES_SET_ON_HOLD_AS_CREATOR",GRIEVANCES_SET_ON_HOLD_AS_OWNER:"GRIEVANCES_SET_ON_HOLD_AS_OWNER",GRIEVANCES_SEND_FOR_APPROVAL:"GRIEVANCES_SEND_FOR_APPROVAL",GRIEVANCES_SEND_FOR_APPROVAL_AS_CREATOR:"GRIEVANCES_SEND_FOR_APPROVAL_AS_CREATOR",GRIEVANCES_SEND_FOR_APPROVAL_AS_OWNER:"GRIEVANCES_SEND_FOR_APPROVAL_AS_OWNER",GRIEVANCES_SEND_BACK:"GRIEVANCES_SEND_BACK",GRIEVANCES_SEND_BACK_AS_CREATOR:"GRIEVANCES_SEND_BACK_AS_CREATOR",GRIEVANCES_SEND_BACK_AS_OWNER:"GRIEVANCES_SEND_BACK_AS_OWNER",GRIEVANCES_APPROVE_DATA_CHANGE:"GRIEVANCES_APPROVE_DATA_CHANGE",GRIEVANCES_APPROVE_DATA_CHANGE_AS_CREATOR:"GRIEVANCES_APPROVE_DATA_CHANGE_AS_CREATOR",GRIEVANCES_APPROVE_DATA_CHANGE_AS_OWNER:"GRIEVANCES_APPROVE_DATA_CHANGE_AS_OWNER",GRIEVANCES_APPROVE_FLAG_AND_DEDUPE:"GRIEVANCES_APPROVE_FLAG_AND_DEDUPE",GRIEVANCES_APPROVE_FLAG_AND_DEDUPE_AS_CREATOR:"GRIEVANCES_APPROVE_FLAG_AND_DEDUPE_AS_CREATOR",GRIEVANCES_APPROVE_FLAG_AND_DEDUPE_AS_OWNER:"GRIEVANCES_APPROVE_FLAG_AND_DEDUPE_AS_OWNER",GRIEVANCES_CLOSE_TICKET_EXCLUDING_FEEDBACK:"GRIEVANCES_CLOSE_TICKET_EXCLUDING_FEEDBACK",GRIEVANCES_CLOSE_TICKET_EXCLUDING_FEEDBACK_AS_CREATOR:"GRIEVANCES_CLOSE_TICKET_EXCLUDING_FEEDBACK_AS_CREATOR",GRIEVANCES_CLOSE_TICKET_EXCLUDING_FEEDBACK_AS_OWNER:"GRIEVANCES_CLOSE_TICKET_EXCLUDING_FEEDBACK_AS_OWNER",GRIEVANCES_CLOSE_TICKET_FEEDBACK:"GRIEVANCES_CLOSE_TICKET_FEEDBACK",GRIEVANCES_CLOSE_TICKET_FEEDBACK_AS_CREATOR:"GRIEVANCES_CLOSE_TICKET_FEEDBACK_AS_CREATOR",GRIEVANCES_CLOSE_TICKET_FEEDBACK_AS_OWNER:"GRIEVANCES_CLOSE_TICKET_FEEDBACK_AS_OWNER",GRIEVANCES_ASSIGN:"GRIEVANCE_ASSIGN",GRIEVANCES_APPROVE_PAYMENT_VERIFICATION:"GRIEVANCES_APPROVE_PAYMENT_VERIFICATION",GRIEVANCES_APPROVE_PAYMENT_VERIFICATION_AS_CREATOR:"GRIEVANCES_APPROVE_PAYMENT_VERIFICATION_AS_CREATOR",GRIEVANCES_APPROVE_PAYMENT_VERIFICATION_AS_OWNER:"GRIEVANCES_APPROVE_PAYMENT_VERIFICATION_AS_OWNER",GRIEVANCE_DOCUMENTS_UPLOAD:"GRIEVANCE_DOCUMENTS_UPLOAD",GRIEVANCES_VIEW_BIOMETRIC_RESULTS:"GRIEVANCES_VIEW_BIOMETRIC_RESULTS",ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_LIST:"ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_LIST",ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_DETAILS:"ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_DETAILS",ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_CREATE:"ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_CREATE",GRIEVANCES_FEEDBACK_VIEW_CREATE:"GRIEVANCES_FEEDBACK_VIEW_CREATE",GRIEVANCES_FEEDBACK_VIEW_LIST:"GRIEVANCES_FEEDBACK_VIEW_LIST",GRIEVANCES_FEEDBACK_VIEW_DETAILS:"GRIEVANCES_FEEDBACK_VIEW_DETAILS",GRIEVANCES_FEEDBACK_VIEW_UPDATE:"GRIEVANCES_FEEDBACK_VIEW_UPDATE",ACCOUNTABILITY_SURVEY_VIEW_CREATE:"ACCOUNTABILITY_SURVEY_VIEW_CREATE",ACCOUNTABILITY_SURVEY_VIEW_LIST:"ACCOUNTABILITY_SURVEY_VIEW_LIST",ACCOUNTABILITY_SURVEY_VIEW_DETAILS:"ACCOUNTABILITY_SURVEY_VIEW_DETAILS",ACTIVITY_LOG_VIEW:"ACTIVITY_LOG_VIEW",ALL_VIEW_PII_DATA_ON_LISTS:"ALL_VIEW_PII_DATA_ON_LISTS",DASHBOARD_VIEW_COUNTRY:"DASHBOARD_VIEW_COUNTRY",PDU_ONLINE_SAVE_DATA:"PDU_ONLINE_SAVE_DATA",PDU_ONLINE_APPROVE:"PDU_ONLINE_APPROVE",PDU_ONLINE_MERGE:"PDU_ONLINE_MERGE",SEARCH_BUSINESS_AREAS:"SEARCH_BUSINESS_AREAS"};function K(s,t){return!t||t===null?!1:Array.isArray(s)?t.some(a=>s.includes(a)):t.includes(s)}function hr(s,t){return!t||t===null?!1:t.some(a=>a.includes(s))}function Pt(s,t,a,n,i,r){return!r||r===null?!1:r.includes(s)||t&&r.includes(a)||n&&r.includes(i)}function ve(){const{businessAreaSlug:s,programSlug:t}=U(),{data:a,isLoading:n,error:i}=V({queryKey:["profile",s,t],queryFn:()=>N.restBusinessAreasUsersProfileRetrieve({businessAreaSlug:s,program:t==="all"?void 0:t}),staleTime:300*1e3,gcTime:1800*1e3,refetchOnWindowFocus:!1});return A.useMemo(()=>{if(n)return null;if(i)return console.error("Error fetching permissions:",i),[];const r=a?.permissionsInScope;return r?Array.isArray(r)?r:[r]:[]},[a,n,i])}const ln=T.div`
  width: 48px;
  border-bottom: 1px solid rgba(224, 224, 224, 1);
`,_a=T.div`
  width: 100%;
  display: flex;
  flex-direction: row;
  cursor: ${({hover:s})=>s?"pointer":"auto"};
  &:hover {
    background-color: ${({hover:s})=>s?"#e8e8e8":"transparent"};
  }
`,As=T.div`
  display: flex;
  flex: ${({weight:s})=>s||1};

  padding: 16px;
  font-size: 0.875rem;
  text-align: left;
  line-height: 1.43;
  border-bottom: 1px solid rgba(224, 224, 224, 1);
  letter-spacing: 0.01071em;
  vertical-align: inherit;
  overflow-wrap: break-word;
  word-wrap: break-word;

  -ms-word-break: break-all;
  /* This is the dangerous one in WebKit, as it breaks things wherever */
  word-break: break-all;
  /* Instead use this non-standard one: */
  word-break: break-word;

  /* Adds a hyphen where the word breaks, if supported (No Blink) */
  -ms-hyphens: auto;
  -moz-hyphens: auto;
  -webkit-hyphens: auto;
  hyphens: auto;
`;function bn({value:s,children:t,div:a=!0,className:n}){let i=s;return s==null&&(i=t),a?i==null||i===""?e.jsx("div",{className:n,children:"-"}):e.jsx("div",{className:n,children:i}):i==null||i===""?e.jsx(e.Fragment,{children:"-"}):e.jsx(e.Fragment,{children:i})}const qs=[{disablePadding:!1,label:"Date",id:"date",numeric:!1,weight:.8},{disablePadding:!1,label:"User",id:"user",numeric:!1,weight:.7},{disablePadding:!1,label:"Entity",id:"content_type__name",numeric:!1,weight:1},{disablePadding:!1,label:"Object",id:"object",numeric:!1,weight:1},{disablePadding:!1,label:"Action",id:"action",numeric:!1,weight:.4},{disablePadding:!1,label:"Changes",id:"changes",numeric:!1,weight:.4},{disablePadding:!1,label:"Change from",id:"changeFrom",numeric:!1,weight:1},{disablePadding:!1,label:"Change to",id:"changeTo",numeric:!1,weight:1}],Dx=T.div`
  border-bottom: 1px solid rgba(224, 224, 224, 1);
`,Tx=T(yt)`
  background-color: #fafafa;
`,Rx=T(ys)`
  color: #000;
`,Fx=T(Ve)`
  transform: rotate(0deg);
  transition: ${s=>s.theme.transitions.create("transform",{duration:400})};

  ${s=>s.expanded&&on.css`
      transform: rotate(180deg);
    `}
`;function Ro(s){return s&&s.replace(/([-_][a-z])/g,t=>t.replace("-"," ").replace("_"," "))}function Fo({logEntry:s}){const{baseUrl:t}=U(),a=s.objectId,{programSlug:n}=s,i=(s.contentType||"").toLowerCase().replace(/\s+/g,""),r={programme:`/${t}/details/${n}`,targetpopulation:`/${t}/target-population/${btoa("TargetPopulationNode:"+a)}`,grievanceticket:`/${t}/grievance/tickets/${s.isUserGenerated?"user-generated":"system-generated"}/${btoa("GrievanceTicketNode:"+a)}`,feedback:`/${t}/grievance/feedback/${btoa("FeedbackNode:"+a)}`,survey:`/${t}/accountability/surveys/${btoa("SurveyNode:"+a)}`,communication:`/${t}/accountability/communication/${btoa("CommunicationMessageNode:"+a)}`,household:`/${t}/population/household/${btoa("HouseholdNode:"+a)}`,individual:`/${t}/population/individuals/${btoa("IndividualNode:"+a)}`,registrationdataimport:`/${t}/registration-data-import/${btoa("RegistrationDataImportNode:"+a)}`,cashplanpaymentverification:`/${t}/csh-payment-verification/${btoa("CashPlanPaymentVerificationNode:"+a)}`,paymentverification:`/${t}/verification-records/${btoa("PaymentVerificationNode:"+a)}`};return!(i in r)||s.action==="DELETE"||s.action==="SOFT_DELETE"?e.jsx(e.Fragment,{children:s.objectId}):e.jsx(Rx,{to:r[i],children:s.objectId})}function Nx({logEntry:s}){const t=s.changes||{},[a,n]=A.useState(!1),i=Object.keys(t),{length:r}=i;return r<=1?e.jsxs(_a,{role:"checkbox","data-cy":"log-row-single-change",children:[e.jsx(As,{weight:qs[0].weight,"data-cy":"timestamp-cell",children:fs(s.timestamp).format("DD MMM YYYY HH:mm")}),e.jsx(As,{weight:qs[1].weight,"data-cy":"user-cell",children:s.user||"System"}),e.jsx(As,{weight:qs[2].weight,"data-cy":"content-type-cell",children:s.contentType}),e.jsx(As,{weight:qs[3].weight,"data-cy":"object-representation-cell",children:e.jsx(Fo,{logEntry:s})}),e.jsx(As,{weight:qs[4].weight,"data-cy":"action-cell",children:s.action}),e.jsx(As,{weight:qs[5].weight,"data-cy":"change-key-cell",children:e.jsx(bn,{children:Ro(i[0])})}),e.jsx(As,{weight:qs[6].weight,"data-cy":"from-value-cell",children:e.jsx(bn,{children:t[i[0]]?.from})}),e.jsx(As,{weight:qs[7].weight,"data-cy":"to-value-cell",children:e.jsx(bn,{children:t[i[0]]?.to})}),e.jsx(ln,{})]}):e.jsxs(e.Fragment,{children:[e.jsxs(_a,{onClick:()=>n(!a),hover:!0,"data-cy":"log-row-multiple-changes",children:[e.jsx(As,{weight:qs[0].weight,"data-cy":"timestamp-cell",children:fs(s.timestamp).format("DD MMM YYYY HH:mm")}),e.jsx(As,{weight:qs[1].weight,"data-cy":"user-cell",children:s.user||"System"}),e.jsx(As,{weight:qs[2].weight,"data-cy":"content-type-cell",children:s.contentType}),e.jsx(As,{weight:qs[3].weight,"data-cy":"object-representation-cell",children:e.jsx(Fo,{logEntry:s})}),e.jsx(As,{weight:qs[4].weight,"data-cy":"action-cell",children:s.action}),e.jsx(As,{weight:qs[5].weight,"data-cy":"changes-cell",children:"Multiple"}),e.jsx(As,{}),e.jsx(As,{}),e.jsx(Dx,{"data-cy":"expand-collapse-button-container",children:e.jsx(Fx,{expanded:a,onClick:()=>n(!a),"data-cy":"expand-collapse-button",children:e.jsx(za,{})})})]}),e.jsx(Tx,{in:a,"data-cy":"collapse-container",children:i.map(l=>e.jsxs(_a,{"data-cy":`detail-row-${l}`,children:[e.jsx(As,{weight:qs[0].weight}),e.jsx(As,{weight:qs[1].weight}),e.jsx(As,{weight:qs[2].weight}),e.jsx(As,{weight:qs[3].weight}),e.jsx(As,{weight:qs[4].weight}),e.jsx(As,{weight:qs[5].weight,"data-cy":"change-key-cell",children:Ro(l)}),e.jsx(As,{weight:qs[6].weight,"data-cy":"from-value-cell",children:e.jsx(bn,{children:t[l].from})}),e.jsx(As,{weight:qs[7].weight,"data-cy":"to-value-cell",children:e.jsx(bn,{children:t[l].to})}),e.jsx(ln,{})]},s.timestamp))})]})}const Lx=({location:s,children:t,componentName:a,...n})=>e.jsx($h,{fallback:({error:i})=>e.jsx(Gi,{pathname:s.pathname,errorMessage:i.message,component:a}),...n,children:t}),oe=(s,t)=>{const a=n=>{const i=je();return e.jsx(Lx,{location:i,beforeCapture:r=>{r.setTag("location",i.pathname),r.setTag("component",t)},componentName:t,children:e.jsx(s,{...n})})};return a.displayName=`WithErrorBoundary(${t})`,a},Ox=T.div`
  display: flex;
  flex-direction: column;
`,kx=T.div`
  display: flex;
  flex: ${({weight:s})=>s||1};
  padding: 16px;
  font-size: 12px;
  text-align: left;
  font-weight: 500;
  line-height: 1.43rem;
  border-bottom: 1px solid rgba(224, 224, 224, 1);
  letter-spacing: 0.01071em;
  vertical-align: inherit;
`,wx=T(us)`
  width: 100%;
  padding: ${({theme:s})=>s.spacing(5)} 0;
  margin-bottom: ${({theme:s})=>s.spacing(5)};
`;function Kc({logEntries:s,totalCount:t,rowsPerPage:a,page:n,onChangePage:i,onChangeRowsPerPage:r,loading:l=!1}){const[o]=A.useState(!0),d=()=>{const c=h=>{i(h,n-1)},u=h=>{i(h,n+1)};return e.jsxs(P,{sx:{flexShrink:0,ml:2.5},"data-cy":"pagination-actions",children:[e.jsx(Ve,{onClick:c,disabled:n===0||l,"aria-label":"previous page","data-cy":"previous-page-button",children:e.jsx(rl,{})}),e.jsx(Ve,{onClick:u,disabled:n>=Math.ceil(t/a)-1||l,"aria-label":"next page","data-cy":"next-page-button",children:e.jsx(ll,{})})]})};return e.jsx(wx,{"data-cy":"main-activity-log-table",children:e.jsxs(yt,{in:o,"data-cy":"table-collapse",children:[e.jsxs(Ox,{"data-cy":"activity-log-table",children:[e.jsxs(_a,{"data-cy":"table-header-row",children:[qs.map(c=>e.jsx(kx,{style:{flex:c.weight||1},"data-cy":`header-cell-${c.id}`,children:c.label},c.id)),e.jsx(ln,{})]}),s.map((c,u)=>e.jsx(Nx,{logEntry:c,"data-cy":`log-entry-row-${c.objectId}-${u}`},`${c.objectId}-${c.timestamp}-${u}`))]}),e.jsx(Ua,{rowsPerPageOptions:[5,10,15,20],component:"div",count:t,rowsPerPage:a,page:n,onPageChange:i,onRowsPerPageChange:r,ActionsComponent:d,"data-cy":"table-pagination"})]})})}oe(Kc,"MainActivityLogTable");const Mx=T(us)`
  margin: 20px;
`;function $x(s){const t={};return s.userId!==""?t.userId=s.userId:t.userId=void 0,s.module!==""?t.module=s.module:t.module=void 0,s.search!==""&&s.search!==null&&s.search!==void 0?t.search=s.search:t.search=void 0,t}function Yc(){const{t:s}=M(),t=je(),[a,n]=A.useState(0),[i,r]=A.useState(20),{businessArea:l,programId:o,isAllPrograms:d}=U(),c={search:"",module:"",userId:""},u=ve(),[h,m]=A.useState(Ke(t,c)),[g,x]=A.useState(Ke(t,c)),[f,j]=A.useState(!1),y=A.useRef(null);et(y,f,g,()=>j(!1));const{data:b,isLoading:C}=V({queryKey:["activityLogs",l,o,d,a,i,g],queryFn:()=>{const F={businessAreaSlug:l,limit:i,offset:a*i,...$x(g)};return d?N.restBusinessAreasActivityLogsList(F):N.restBusinessAreasProgramsActivityLogsList({...F,programSlug:o})},enabled:!!(l&&u&&K(R.ACTIVITY_LOG_VIEW,u))}),{data:v}=V({queryKey:["activityLogsCount",l,o,d],queryFn:()=>d?N.restBusinessAreasActivityLogsCountRetrieve({businessAreaSlug:l}):N.restBusinessAreasProgramsActivityLogsCountRetrieve({businessAreaSlug:l,programSlug:o}),enabled:!!(l&&u&&K(R.ACTIVITY_LOG_VIEW,u))});if(u===null)return null;if(!K(R.ACTIVITY_LOG_VIEW,u))return e.jsx(Xe,{permission:R.ACTIVITY_LOG_VIEW});if(!b&&!C)return e.jsx(Ix,{});if(!b&&C)return e.jsx(Ne,{});const S=b.results,I=v?.count??0,E=(F,w)=>{n(w)},D=F=>{const w=parseInt(F.target.value,10);r(w),n(0)};return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:s("Activity Log")}),e.jsx(ox,{filter:h,setFilter:m,initialFilter:c,appliedFilter:g,setAppliedFilter:F=>{x(F),j(!0)}}),e.jsx("div",{ref:y,children:e.jsx(Mx,{children:e.jsx(Kc,{totalCount:I,rowsPerPage:i,logEntries:S,page:a,loading:C,onChangePage:E,onChangeRowsPerPage:D})})})]})}const Ux=T(ys)`
  color: #000;
  max-width: ${s=>s.fullWidth?"100%":"200px"};
  overflow-wrap: break-word;
`,Vx=T.a`
  color: #000;
  max-width: ${s=>s.fullWidth?"100%":"200px"};
  overflow-wrap: break-word;
`,Bx=T.button`
  color: #000;
  background: none;
  border: none;
  padding: 0;
  margin: 0;
  cursor: pointer;
  max-width: ${s=>s.fullWidth?"100%":"200px"};
  overflow-wrap: break-word;
  text-decoration: underline;
  font: inherit;
`,me=s=>{if("button"in s&&s.button){const{children:r,...l}=s;return e.jsx(Bx,{...l,children:r})}if("newTab"in s&&s.newTab){const{children:r,to:l="/",...o}=s,d={};return Object.keys(o).forEach(c=>{["href","target","rel","onClick","style","className","id","title","tabIndex","aria-label","aria-labelledby","aria-describedby","aria-current","download","ref","fullWidth"].includes(c)&&(d[c]=o[c])}),e.jsx(Vx,{...d,href:l,target:"_blank",rel:"noopener noreferrer",onClick:c=>{o.onClick&&o.onClick(c),c.stopPropagation()},children:r})}const{children:t,to:a="/",...n}=s,i={};return Object.keys(n).forEach(r=>{["replace","state","to","onClick","style","className","id","title","tabIndex","aria-label","aria-labelledby","aria-describedby","aria-current","ref","fullWidth"].includes(r)&&(i[r]=n[r])}),e.jsx(Ux,{...i,to:a,onClick:r=>{n.onClick&&n.onClick(r),r.stopPropagation()},children:t})},Gx=T(us)`
  display: flex;
  flex: 1;
  width: 100%;
  background-color: #fff;
  padding: 32px 44px;
  flex-direction: column;
  && > div {
    margin: 5px;
  }
`;function Fs({children:s}){return e.jsx(Gx,{children:s})}const zx=T.span`
  ${({theme:s})=>s.styledMixins.label}
`,qx=T.span`
  font-family: ${({theme:s})=>s.hctTypography.fontFamily};
  color: #253b46;
  font-size: 14px;
  line-height: 19px;
  overflow-wrap: break-word;
`;function L({value:s,children:t,label:a,dataCy:n,dashed:i=!0}){let r;t!==void 0?r=t:r=s;let l=t;return i&&r!==0&&!r?l="-":l=e.jsx(qx,{color:"textSecondary",children:r}),e.jsxs("div",{"data-cy":n&&`labelized-field-container-${n}`,children:[e.jsx(zx,{color:"textSecondary",children:a}),e.jsx("div",{"data-cy":`label-${a}`,children:l})]})}function ke({loading:s,children:t,...a}){return e.jsx(H,{...a,disabled:a.disabled||s,endIcon:s?e.jsx(la,{color:"inherit",size:20}):a.endIcon,children:t})}const Qc=A.createContext({message:"",showMessage:()=>null,showRestApiError:()=>null}),Hx=({children:s})=>{const[t,a]=A.useState(!1),[n,i]=A.useState(""),{t:r}=M(),l=u=>{let h=u;return h=h.replace(/\[|\]|"|'/g,""),h},o=u=>{a(!0),i(l(u))},d=(u,h)=>{let m=r(h||"An error occurred while executing this operation.");try{m=u.message}catch{}try{m=u.body.join(`
`)}catch{}o(m)},c=()=>{a(!1),i("")};return e.jsx(Qc.Provider,{value:{showMessage:o,message:n,showRestApiError:d},children:e.jsxs(e.Fragment,{children:[s,e.jsx(Uh,{open:t,anchorOrigin:{vertical:"bottom",horizontal:"center"},autoHideDuration:5e3,onClose:c,message:n})]})})},Ae=()=>A.useContext(Qc),Wx=T.span`
  font-size: 12px;
  color: rgba(0, 0, 0, 0.6);
`;function Fl({children:s}){return e.jsx(Wx,{children:s})}const Kx=T(ha)`
  width: ${s=>s.fullWidth?"100%":"232px"};
  .MuiFormControl-marginDense {
    margin-top: 4px;
  }
`,Yx=({value:s,onChange:t,disabled:a,level:n,parentId:i,onClear:r,additionalOnChange:l,dataCy:o})=>{const{t:d}=M(),[c,u]=A.useState(""),h=qt(c,800),[,m]=A.useState(null),{businessArea:g}=U(),{data:x,isLoading:f,error:j}=V({queryKey:["adminAreas",h,g,n,i,s],queryFn:()=>N.restBusinessAreasGeoAreasList({businessAreaSlug:g,level:n===1?1:2,name:h||void 0,id:s||void 0,parentId:i||void 0}),enabled:!!g}),y=f;A.useEffect(()=>{Array.isArray(x)&&m(typeof s=="string"?x.find(C=>C.name===s):s)},[x,s]);const b=(C,v,S)=>{u(v?.name),t(C,v,S),l&&l(),S==="clear"&&r&&r()};return j?e.jsxs("div",{children:["Error: ",j instanceof Error?j.message:"An error occurred"]}):e.jsx(P,{mt:1,children:e.jsx(Kx,{options:x||[],defaultValue:x&&typeof s=="string"?x.find(C=>C.id===s):s,getOptionLabel:C=>C?`${C.name}`:"",isOptionEqualToValue:(C,v)=>typeof v=="string"?C?.id===v:C?.id===v?.id,onChange:b,disabled:a,fullWidth:!0,renderInput:C=>e.jsx(ks,{...C,size:"small",label:d(n===1?"Administrative Level 1":"Administrative Level 2"),variant:"outlined",value:c,onChange:v=>u(v.target.value),InputProps:{...C.InputProps,endAdornment:e.jsxs(e.Fragment,{children:[y?e.jsx(la,{color:"inherit",size:20}):null,C.InputProps.endAdornment]})}}),"data-cy":o||"admin-area-autocomplete"})})};function Hi({field:s,form:t,disabled:a,level:n,parentId:i,onClear:r,additionalOnChange:l,dataCy:o,...d}){const{label:c}=d,u=(h,m)=>{m?t.setFieldValue(s.name,m.id):t.setFieldValue(s.name,null)};return e.jsxs(P,{display:"flex",flexDirection:"column",children:[c&&e.jsx(Fl,{children:c}),e.jsx(Yx,{disabled:a,value:s.value,onChange:u,level:n,parentId:i,onClear:r,additionalOnChange:l,dataCy:o,...d})]})}const Qx=T(dt)`
  margin-right: 0;
`,Xx=T(dt)`
  margin-right: 10px;
`,Jx=T(Ct)`
  color: #707070;
`;function We({field:s,form:t,multiple:a,icon:n=null,disableClearable:i=!1,onChange:r,onClear:l,...o}){const d=!!(Os(t.errors,s.name)&&(Os(t.touched,s.name)||t.submitCount>0||t.errors)),c=a?s.value||o.value||[]:s.value||o.value||"",m=(g=>Array.isArray(g)?g.length>0:!!g)(o.value||s.value)&&!i&&!o.disabled;return e.jsxs(tt,{variant:"outlined",size:"small",fullWidth:!0,...o,error:d,children:[e.jsx(Rt,{error:d,children:o.label}),e.jsx(at,{...s,...o,onChange:g=>{s.onChange(g),r&&r(g)},size:"small",name:s.name,multiple:a,value:c,id:`textField-${s.name}`,error:d,renderValue:g=>{if(Array.isArray(g))return g.map(f=>{const j=o.choices.find(y=>y.value===f||y.name===f||y.label===f);return j?j.labelEn||j.name||j.label:f}).join(", ");const x=o.choices.find(f=>f.value===g||f.name===g);return x?x.labelEn||x.name||x.label:g},SelectDisplayProps:{"data-cy":`select-${s.name}`},MenuProps:{"data-cy":`select-options-${s.name}`,getContentAnchorEl:null,MenuListProps:{"data-cy":"select-options-container"}},endAdornment:m&&e.jsx(Xx,{position:"end",children:e.jsx(Ve,{size:"small",onClick:()=>{t.setFieldValue(s.name,a?[]:""),l&&l()},children:e.jsx(Jx,{fontSize:"small"})})}),startAdornment:n?e.jsx(Qx,{position:"start",children:n}):null,children:o.choices.map(g=>e.jsx(de,{value:g.value?g.value:g.name||"","data-cy":`select-option-${g.name||g.label||g.value}`,disabled:g.disabled||!1,children:g.description?e.jsx(ia,{primary:g.labelEn||g.name||g.label,secondary:g.description,primaryTypographyProps:{noWrap:!0},secondaryTypographyProps:{style:{whiteSpace:"normal",maxWidth:"300px"}}}):g.labelEn||g.name||g.label},g.value?g.value:g.name||""))}),d&&e.jsx(Ls,{children:Os(t.errors,s.name)})]})}const Zx=T(ks)`
  input[type='number']::-webkit-inner-spin-button,
  input[type='number']::-webkit-outer-spin-button {
    -webkit-appearance: none;
  }
  input[type='number'] {
    -moz-appearance: textfield;
  }
  .MuiFormHelperText-root {
    white-space: pre-line;
  }
`;function Se({field:s,form:t,decoratorStart:a,decoratorEnd:n,type:i,precision:r,integer:l,maxLength:o,...d}){const c=!!(Os(t.errors,s.name)&&(Os(t.touched,s.name)||t.submitCount>0||t.errors)),u=g=>{i==="number"&&["e","E","+","-"].includes(g.key)&&g.preventDefault(),l&&[",","."].includes(g.key)&&g.preventDefault()},h=g=>{const x={...g};i==="number"&&r!==void 0&&(x.target.value=parseFloat(g.target.value).toFixed(2)),t.handleBlur(x)},m=g=>{i==="number"&&g.target.value>999999999||t.handleChange(g)};return e.jsx(Zx,{...s,...d,name:s.name,id:`textField-${s.name}`,size:"small",value:s.value,onChange:m,onBlur:h,error:c,autoComplete:"off",type:i,helperText:c&&Os(t.errors,s.name),label:d.label,InputProps:{onKeyPress:u,startAdornment:a&&e.jsx(dt,{position:"start",children:a}),endAdornment:n&&e.jsx(dt,{position:"end",children:n})},inputProps:{"data-cy":`input-${s.name}`,maxLength:o||void 0}})}const Ce=(s,t,a)=>{const n=t?Il(t):{},i={...s,...n};if(a?.withPagination){const r=a.rowsPerPage||10,l=a.pageNumber||0;return{...i,limit:n.limit!==void 0?n.limit:r,offset:n.offset!==void 0?n.offset:l*r}}return i},ef=Q.object().shape({issueType:Q.string().required("Issue Type is required").nullable(),admin2:Q.mixed().test("admin2-id-or-null","Admin2 must be a string id or an object with an id",s=>s===null||typeof s=="string"||typeof s=="object"&&s!==null&&typeof s.id=="string").nullable(),description:Q.string().nullable().required("Description is required"),consent:Q.bool(),area:Q.string().nullable(),language:Q.string().nullable(),comments:Q.string().nullable()}),sf=()=>{const s=ge(),{t}=M(),{id:a}=ts(),{baseUrl:n,businessArea:i,isAllPrograms:r}=U(),l=ve(),{showMessage:o}=Ae(),{selectedProgram:d}=Z(),c=d?.beneficiaryGroup,{data:u,isLoading:h}=V({queryKey:["businessAreasFeedbacksRetrieve",i,a],queryFn:()=>N.restBusinessAreasFeedbacksRetrieve({businessAreaSlug:i,id:a})}),{data:m,isLoading:g}=V({queryKey:["choicesFeedbackIssueTypeList",i],queryFn:()=>N.restChoicesFeedbackIssueTypeList()}),{data:x,isLoading:f}=V({queryKey:["businessAreasProgramsList",{limit:100},i],queryFn:()=>N.restBusinessAreasProgramsList(Ce({businessAreaSlug:i,limit:100},{withPagination:!1}))}),{mutateAsync:j,isPending:y}=xe({mutationFn:({businessAreaSlug:F,id:w,requestBody:O})=>N.restBusinessAreasFeedbacksPartialUpdate({businessAreaSlug:F,id:w,requestBody:O})});if(h||g||f)return e.jsx(Ne,{});if(l===null)return null;if(!K(R.GRIEVANCES_FEEDBACK_VIEW_CREATE,l))return e.jsx(Xe,{permission:R.GRIEVANCES_FEEDBACK_VIEW_CREATE});if(!m||!u||!x)return null;const b=[{title:t("Feedback"),to:`/${n}/grievance/feedback/${a}`}],C=u,v={issueType:C.issueType,selectedHousehold:C.householdId?{id:C.householdId,unicefId:C.householdUnicefId}:null,selectedIndividual:C.individualId?{id:C.individualId,unicefId:C.individualUnicefId}:null,description:C.description||null,comments:C.comments||null,admin2:C.admin2||null,area:C.area||null,language:C.language||null,consent:C.consent||!1,programId:C.programId||null},S=F=>({issueType:F.issueType,householdLookup:F.selectedHousehold?.id,individualLookup:F.selectedIndividual?.id,description:F.description,comments:F.comments,admin2:typeof F.admin2=="object"&&F.admin2!==null?F.admin2.id:F.admin2,area:F.area,language:F.language||"",consent:F.consent,programId:F.programId||null}),I=K(R.POPULATION_VIEW_HOUSEHOLDS_DETAILS,l),E=K(R.POPULATION_VIEW_INDIVIDUALS_DETAILS,l),D=x?.results?.map(F=>({name:F.name,value:F.id}));return e.jsx(B.Formik,{initialValues:v,enableReinitialize:!0,onSubmit:async F=>{try{await j({businessAreaSlug:i,id:a,requestBody:S(F)}),o(t("Feedback updated")),s(`/${n}/grievance/feedback/${a}`)}catch(w){fe(w,o,"Error updating feedback")}},validationSchema:ef,children:({submitForm:F})=>e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`Edit Feedback #${C.unicefId}`,breadCrumbs:K(R.GRIEVANCES_FEEDBACK_VIEW_LIST,l)?b:null,children:e.jsxs(P,{sx:{display:"flex",alignContent:"center"},children:[e.jsx(P,{sx:{mr:3},children:e.jsx(H,{component:ys,to:`/${n}/grievance/feedback/${C.id}`,children:t("Cancel")})}),e.jsx(ke,{loading:y,color:"primary",variant:"contained",onClick:F,"data-cy":"button-submit",children:t("Save")})]})}),e.jsx(p,{container:!0,spacing:3,children:e.jsx(p,{size:{xs:12},children:e.jsx(P,{sx:{p:3},children:e.jsx(Fs,{children:e.jsxs(P,{sx:{p:3},children:[e.jsxs(P,{sx:{mb:3},children:[e.jsxs(p,{container:!0,size:{xs:6},spacing:6,children:[e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:t("Category"),children:t("Feedback")})}),e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:t("Issue Type"),children:C.issueType==="POSITIVE_FEEDBACK"?"Positive Feedback":"Negative Feedback"})})]}),e.jsxs(p,{container:!0,size:{xs:6},spacing:6,children:[e.jsx(p,{size:{xs:6},children:e.jsxs(L,{label:t(`${c?.groupLabel} ID`),children:[" ",C.householdId&&I&&!r?e.jsx(me,{to:`/${n}/population/household/${C.householdId}`,children:C.householdUnicefId}):e.jsx("div",{children:C.householdId?C.householdUnicefId:"-"})]})}),e.jsx(p,{size:{xs:6},children:e.jsxs(L,{label:t(`${c?.memberLabel} ID`),children:[" ",C.individualId&&E&&!r?e.jsx(me,{to:`/${n}/population/individuals/${C.individualId}`,children:C.individualUnicefId}):e.jsx("div",{children:C.individualId?C.individualUnicefId:"-"})]})})]}),e.jsx(P,{sx:{mt:6,mb:6},children:e.jsx(In,{})})]}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"description",multiline:!0,fullWidth:!0,variant:"outlined",label:t("Description"),required:!0,component:Se})}),e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"comments",multiline:!0,fullWidth:!0,variant:"outlined",label:t("Comments"),component:Se})}),e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"admin2",variant:"outlined",component:Hi})}),e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"area",fullWidth:!0,variant:"outlined",label:t("Area / Village / Pay point"),component:Se})}),e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"language",multiline:!0,fullWidth:!0,variant:"outlined",label:t("Languages Spoken"),component:Se})}),e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:"programId",label:t("Programme Name"),fullWidth:!0,variant:"outlined",choices:D,component:We,disabled:!r||!!C.programId})})]})]})})})})})]})})},tf=oe(sf,"EditFeedbackPage");function Bs(){const{submitForm:s}=B.useFormikContext();return A.useEffect(()=>{const t=a=>{a.key==="Enter"&&s()};return window.addEventListener("keypress",t),()=>{window.removeEventListener("keypress",t)}},[s]),e.jsx(e.Fragment,{})}const af=T(tt)`
  width: 100%;
`,jt=({field:s,form:t,decoratorStart:a,decoratorEnd:n,tooltip:i=null,required:r=!1,dataCy:l="date-picker-filter",...o})=>{const d=Os(t.errors,s.name)&&(Os(t.touched,s.name)||t.submitCount>0);let c=null;s.value&&typeof s.value=="string"&&(c=Gt.parseISO(s.value));const u=e.jsx(af,{"data-cy":l,size:"small",children:e.jsx(uc.DesktopDatePicker,{...s,...o,label:r?`${o.label}*`:o.label,format:"yyyy-MM-dd",name:s.name,slotProps:{textField:{size:"small",error:d,helperText:d&&Os(t.errors,s.name),inputProps:{"data-cy":`date-input-${s.name}`}}},sx:{"& .MuiSvgIcon-root":{outline:"none"}},slots:{TextField:h=>e.jsx(ks,{...h,variant:"outlined",size:"small",fullWidth:!0,error:d,helperText:d&&Os(t.errors,s.name),InputProps:{startAdornment:a&&e.jsx(dt,{position:"start",children:a}),endAdornment:n&&e.jsx(dt,{position:"end",children:n})},required:r,inputProps:{...h.inputProps,"data-cy":`date-input-${s.name}`}})},value:c||null,onBlur:()=>{setTimeout(()=>{t.handleBlur({target:{name:s.name}})},0)},onChange:h=>{h instanceof Date&&!isNaN(h.getTime())?s.onChange({target:{value:fs(h).format("YYYY-MM-DD"),name:s.name}}):(console.error("Invalid date:",h),s.onChange({target:{value:null,name:s.name}}))}})});return i?e.jsx(Ms,{title:i,children:e.jsx("div",{children:u})}):u};function Gn({field:s,form:t,label:a}){return e.jsxs(P,{style:{height:"100%"},display:"flex",flexDirection:"column",children:[a&&e.jsx(ee,{variant:"caption",color:"textSecondary",sx:{mb:.5},children:a}),e.jsx(P,{display:"flex",alignItems:"center",children:e.jsx("input",{type:"file",accept:"image/*","data-cy":`input-${s.name}`,onChange:n=>{const i=n.currentTarget.files?.[0];i&&t.setFieldValue(s.name,i)}})})]})}const Ie=T.div`
  width: 100%;
  padding-bottom: ${({theme:s})=>s.spacing(8)};
`,zt=(s,t,a,n)=>{const i=[...a],r=i.indexOf(s);r!==-1?i.splice(r,1):i.push(s),n(t,i)},Ba=(s,t,a)=>{const n=s?.findIndex(i=>i.id===t);n!==-1&&a.remove(n)},Ai=(s,t)=>{if(!t)return-1;const a=s.findIndex(n=>n.id===t);return a!==-1?a:0},jn=s=>s?.map(t=>{const a={...t};return delete a.id,a});function Nl({id:s,baseName:t,baseNameArray:a,onDelete:n,countryChoices:i,identityTypeChoices:r,isEdited:l,values:o}){const{t:d}=M(),c=`${t}.${Ai(a||o[t],s)}`,h=je().pathname.indexOf("edit-ticket")!==-1;return e.jsxs(p,{container:!0,spacing:3,sx:{alignItems:"center"},children:[e.jsx(p,{size:{xs:4},children:e.jsx(B.Field,{name:`${c}.partner`,fullWidth:!0,variant:"outlined",label:d("Partner"),component:We,choices:r,required:!h,disabled:h})}),e.jsx(p,{size:{xs:4},children:e.jsx(B.Field,{name:`${c}.country`,fullWidth:!0,variant:"outlined",label:d("Country"),component:We,choices:i,required:!h,disabled:h})}),e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:`${c}.number`,fullWidth:!0,variant:"outlined",label:d("Identity Number"),component:Se,required:!h,disabled:h})}),l?null:e.jsx(p,{size:{xs:1},children:e.jsx(Ve,{disabled:h,onClick:n,children:e.jsx(Rs,{})})})]})}function Ks(s){return e.jsx(is,{"data-cy":"dialog-root",...s})}function Gs(s){return e.jsx(os,{"data-cy":"dialog-actions-container",...s})}const ss=T.div`
  padding: 12px 16px;
  margin: 0;
  border-top: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  text-align: right;
`;function nf({setTurnAngle:s,setDialogOpen:t}){return e.jsx(ss,{children:e.jsx(Gs,{children:e.jsx(H,{"data-cy":"button-cancel",onClick:()=>{t(!1),s(90)},children:"CANCEL"})})})}const Ye=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
`;function rf({turnAngle:s,setTurnAngle:t}){const a=()=>{document.getElementById("modalImg").setAttribute("style",`transform: rotate(${s}deg)`),t(n=>n+90)};return e.jsx(Ve,{"data-cy":"button-rotate-image",onClick:()=>a(),children:e.jsx(Vh,{})})}function lf({turnAngle:s,setTurnAngle:t,title:a,showRotate:n}){return e.jsx(Ye,{children:e.jsx(Le,{children:e.jsxs(P,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx("span",{children:a}),n?e.jsx(rf,{turnAngle:s,setTurnAngle:t}):null]})})})}const of=T(ys)`
  color: #000;
  width: 200px;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
  display: inline-block;
`,df=T.img`
  width: 100%;
  height: 100%;
  max-width: 700px;
  max-height: 700px;
  pointer-events: none;
  transition: 0.4s ease-in-out;
`,mr=T.div`
  height: 45px;
  width: 45px;
  cursor: pointer;
  background-position: center;
  background-repeat: no-repeat;
  background-image: url(${({src:s})=>s});
  background-size: cover;
`;function cf({src:s,linkText:t,variant:a="picture",title:n="Photo",closeHandler:i,showRotate:r=!0,alt:l="photo"}){const[o,d]=A.useState(!1),[c,u]=A.useState(90),{t:h}=M(),m=()=>{let g;switch(a){case"picture":g=e.jsx(mr,{"data-cy":"mini-image",alt:l,src:s,onClick:()=>d(!0)});break;case"button":g=e.jsx(H,{"data-cy":"button-show-photo",color:"primary",variant:"outlined",onClick:()=>{d(!0)},children:h("Show Photo")});break;case"link":g=e.jsx(of,{"data-cy":"link-show-photo",onClick:()=>{d(!0)},to:null,children:t});break;case"pictureClose":g=e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsx(mr,{"data-cy":"mini-image-close",alt:l,src:s,onClick:()=>d(!0)}),e.jsx(Ve,{"data-cy":"close-icon",onClick:()=>i(),children:e.jsx(Ct,{})})]});break;default:g=e.jsx(mr,{"data-cy":"mini-image",alt:"photo",src:s,onClick:()=>d(!0)})}return g};return e.jsxs(e.Fragment,{children:[m(),e.jsxs(Ks,{open:o,onClose:()=>d(!1),"aria-labelledby":"form-dialog-title",children:[e.jsx(lf,{title:n,turnAngle:c,setTurnAngle:u,showRotate:r}),e.jsx(Be,{children:e.jsx(P,{p:3,children:e.jsx(yo.TransformWrapper,{children:e.jsx(yo.TransformComponent,{children:e.jsx(df,{id:"modalImg",alt:"photo",src:s})})})})}),e.jsx(nf,{setTurnAngle:u,setDialogOpen:d})]})]})}const nt=oe(cf,"PhotoModal");function uf({photoSrc:s,setFieldValue:t,fieldName:a}){const[n,i]=A.useState(!1),r=s;return e.jsx(P,{style:{height:"100%"},display:"flex",alignItems:"center",children:n||!r?e.jsx(P,{style:{height:"100%"},display:"flex",alignItems:"center",children:e.jsx("input",{type:"file",accept:"image/*",onChange:l=>{t(a,l.currentTarget.files[0])}})}):e.jsx(nt,{src:r,variant:"pictureClose",closeHandler:()=>{i(!0),t(a,null)},showRotate:!1})})}function Ll({id:s,baseName:t,baseNameArray:a,onDelete:n,countryChoices:i,documentTypeChoices:r,isEdited:l,setFieldValue:o,photoSrc:d,values:c}){const{t:u}=M(),m=je().pathname.indexOf("edit-ticket")!==-1,g=`${t}.${Ai(a||c[t],s)}`;return e.jsx(P,{mt:2,children:e.jsxs(p,{container:!0,alignItems:"center",spacing:3,children:[e.jsx(p,{size:3,children:e.jsx(B.Field,{name:`${g}.key`,fullWidth:!0,variant:"outlined",label:u("Type"),component:We,choices:r,required:!m,disabled:m})}),e.jsx(p,{size:2,children:e.jsx(B.Field,{name:`${g}.country`,fullWidth:!0,variant:"outlined",label:u("Country"),component:We,choices:i,required:!m,disabled:m})}),e.jsx(p,{size:3,children:e.jsx(B.Field,{name:`${g}.number`,fullWidth:!0,variant:"outlined",label:u("Document Number"),component:Se,required:!m,disabled:m})}),e.jsx(p,{size:3,children:e.jsx(uf,{photoSrc:d,setFieldValue:o,fieldName:`${g}.photo`})}),l?null:e.jsx(p,{size:1,children:e.jsx(Ve,{disabled:m,onClick:n,children:e.jsx(Rs,{})})})]})})}const No=s=>{switch(s){case"YES":return!0;case"NO":return!1;default:return null}};function Wi({field:s,form:t,multiple:a,required:n,...i}){const r=Os(t.errors,s.name)&&(Os(t.touched,s.name)||t.submitCount>0),l=[{key:"Yes",value:"YES"},{key:"No",value:"NO"}];n||l.push({key:"None",value:""});let o;switch(s.value){case!1:o="NO";break;case!0:o="YES";break;default:o=""}A.useEffect(()=>{s.value===""&&t.setFieldValue(s.name,No(s.value))},[s.value]);const d=c=>{const u=c.target.value,h=No(u);t.setFieldValue(s.name,h)};return e.jsxs(tt,{required:n,variant:"outlined",fullWidth:!0,size:"small",...i,children:[e.jsx(P,{mb:1,children:e.jsx(Rt,{children:i.label})}),e.jsx(at,{...s,...i,name:s.name,onChange:d,multiple:a,value:o,id:`textField-${s.name}`,error:r,SelectDisplayProps:{"data-cy":`select-${s.name}`},MenuProps:{"data-cy":`select-options-${s.name}`,MenuListProps:{"data-cy":"select-options-container"},getContentAnchorEl:null},children:l.map((c,u)=>e.jsx(de,{value:c.value,"data-cy":`select-option-${u}`,children:c.key},c.value))}),r&&e.jsx(Ls,{error:!0,children:Os(t.errors,s.name)})]})}function Lo({field:s,flexField:t}){let a;const i=je().pathname.indexOf("edit-ticket")!==-1;switch(s.type){case"DECIMAL":a={component:Se};break;case"INTEGER":a={component:Se,type:"number"};break;case"STRING":a={component:Se};break;case"SELECT_ONE":a={choices:s.choices,component:We};break;case"SELECT_MANY":a={choices:s.choices,component:We,multiple:!0};break;case"SELECT_MULTIPLE":a={choices:s.choices,component:We};break;case"DATE":a={component:jt,decoratorEnd:e.jsx(bt,{color:"disabled"})};break;case"BOOL":a={component:Wi,required:s.required};break;case"IMAGE":a={component:Gn};break;default:a={}}return e.jsxs(e.Fragment,{children:[e.jsx(p,{size:8,children:e.jsx(B.Field,{name:`individualData${t?".flexFields":""}.${Zs(s.name)}`,fullWidth:!0,variant:"outlined",label:s.labelEn,required:s.required,disabled:i,...a})}),e.jsx(p,{size:4})]})}function hf({values:s,setFieldValue:t}){const{t:a}=M(),i=je().pathname.indexOf("edit-ticket")!==-1,{selectedProgram:r}=Z(),l=r?.beneficiaryGroup,{businessAreaSlug:o}=U(),{data:d,isLoading:c}=V({queryKey:["addIndividualFieldsAttributes",o],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllAddIndividualsFieldsAttributesList({businessAreaSlug:o})}),{data:u,isLoading:h}=V({queryKey:["businessAreasGrievanceTicketsChoices",o],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:o})}),{data:m,isLoading:g}=V({queryKey:["individualChoices",o],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:o})}),{data:x,isLoading:f}=V({queryKey:["countriesList"],queryFn:()=>N.restChoicesCountriesList()});if(c||h||g||f)return e.jsx(Ne,{});const j={results:d||[],countriesChoices:x||[],documentTypeChoices:u?.documentTypeChoices||[],identityTypeChoices:m?.identityTypeChoices||[]},y=j.results.filter(C=>C.isFlexField)||[],b=j.results.filter(C=>!C.isFlexField)||[];return!i&&e.jsxs(e.Fragment,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a(`${l?.memberLabel} Data`)})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:12,children:a("Core Fields")}),b.map(C=>e.jsx(Lo,{field:C},C.name)),y.length>0&&e.jsx(p,{size:12,children:a("Flex Fields")}),y.map(C=>e.jsx(Lo,{field:C,flexField:!0},C.name))]}),e.jsx(p,{container:!0,spacing:3,children:e.jsx(B.FieldArray,{name:"individualData.documents",render:C=>e.jsxs(e.Fragment,{children:[s.individualData?.documents?.map(v=>e.jsx(Ll,{id:v?.id,onDelete:()=>Ba(s.individualData.documents,v?.id,C),countryChoices:j.countriesChoices,documentTypeChoices:j.documentTypeChoices,baseName:"individualData.documents",baseNameArray:s.individualData.documents,setFieldValue:t,values:s},`${v?.id}-${v?.country}-${v?.type?.key}`)),e.jsx(p,{size:8}),e.jsx(p,{size:12,children:e.jsx(H,{color:"primary",startIcon:e.jsx(Et,{}),disabled:i,onClick:()=>{C.push({id:crypto.randomUUID(),country:null,key:null,number:""})},children:a("Add Document")})})]})})}),e.jsx(p,{container:!0,spacing:3,children:e.jsx(B.FieldArray,{name:"individualData.identities",render:C=>e.jsxs(e.Fragment,{children:[s.individualData?.identities?.map(v=>e.jsx(Nl,{id:v?.id,onDelete:()=>Ba(s.individualData.identities,v?.id,C),countryChoices:j.countriesChoices,identityTypeChoices:j.identityTypeChoices,baseName:"individualData.identities",baseNameArray:s.individualData.identities,values:s},v?.id)),e.jsx(p,{size:8}),e.jsx(p,{size:12,children:e.jsx(H,{color:"primary",startIcon:e.jsx(Et,{}),onClick:()=>{C.push({id:crypto.randomUUID(),country:null,partner:null,number:""})},children:a("Add Identity")})})]})})})]})}const Xc=oe(hf,"AddIndividualDataChange"),mf=T.div`
  .MuiStepper-root {
    padding: 0 !important;
  }
`;function pf({activeStep:s,steps:t}){return e.jsx(mf,{children:e.jsx(Ta,{activeStep:s,children:t.map(a=>{const n={},i={};return e.jsx(Ra,{...n,children:e.jsx(qa,{...i,children:a})},a)})})})}const Jc=(s,t)=>!t||!s?"":t?s.replace(/Individual/g,t.memberLabel).replace(/Household/g,t.groupLabel):s;function Zc(s){const t=s?.toString();return t===De.SENSITIVE_GRIEVANCE||t===De.DATA_CHANGE||t===De.NEEDS_ADJUDICATION||t===De.GRIEVANCE_COMPLAINT}const eu=s=>s&&Oi[s]?.toLowerCase()?.replace(/_/g," ")?.replace(/\b\w/g,t=>t.toUpperCase())||"",su=(s,t)=>{const a=t[s.category]?.subCategories||[],n=Object.entries(a).map(([r,l])=>({name:l,value:r})),i=s.issueType.toString();return n.find(r=>r.value===i)?.name||"-"},sl={PRIMARY:"Primary collector",ALTERNATE:"Alternate collector"};function gf(s){return s?s.map(t=>{const a={...t};return delete a.accountType,delete a.isNew,a}):[]}function pr(s){if(Array.isArray(s))return s.map(t=>{if(t&&t.photo instanceof File){const{photo:a,...n}=t;return{...n,new_photo:a}}return t});if(s&&typeof s=="object"){if(s.photo instanceof File){const{photo:t,...a}=s;return{...a,new_photo:t}}return s}return s}function xf(s){const t={},a=parseInt(s.category,10),n=s.issueType?parseInt(s.issueType,10):void 0;if(a===parseInt(De.POSITIVE_FEEDBACK,10)?t.category={positiveFeedbackTicketExtras:{household:s.selectedHousehold?.id,individual:s.selectedIndividual?.id}}:a===parseInt(De.NEGATIVE_FEEDBACK,10)?t.category={negativeFeedbackTicketExtras:{household:s.selectedHousehold?.id,individual:s.selectedIndividual?.id}}:a===parseInt(De.REFERRAL,10)?t.category={referralTicketExtras:{household:s.selectedHousehold?.id,individual:s.selectedIndividual?.id}}:a===parseInt(De.GRIEVANCE_COMPLAINT,10)?t.category={grievanceComplaintTicketExtras:{household:s.selectedHousehold?.id,individual:s.selectedIndividual?.id,paymentRecord:s.selectedPaymentRecords?.map(i=>i.id)||null}}:a===parseInt(De.SENSITIVE_GRIEVANCE,10)&&(t.category={sensitiveGrievanceTicketExtras:{household:s.selectedHousehold?.id,individual:s.selectedIndividual?.id,paymentRecord:s.selectedPaymentRecords?.map(i=>i.id)||null}}),a===parseInt(De.DATA_CHANGE,10)&&n){if(n===parseInt($e.ADD_INDIVIDUAL,10)){let i=s.individualData?.flexFields;if(i){i={...i};for(const[o,d]of Object.entries(i))d===""&&delete i[o]}const r=jn(s.individualData?.documents),l=jn(s.individualData?.identities);t.issueType={addIndividualIssueTypeExtras:{household:s.selectedHousehold?.id,individualData:{...s.individualData,documents:r,identities:l,flexFields:i}}}}else if(n===parseInt($e.DELETE_INDIVIDUAL,10))t.issueType={individualDeleteIssueTypeExtras:{individual:s.selectedIndividual?.id}};else if(n===parseInt($e.DELETE_HOUSEHOLD,10))t.issueType={householdDeleteIssueTypeExtras:{household:s.selectedHousehold?.id}};else if(n===parseInt($e.EDIT_INDIVIDUAL,10)){const i=s.individualDataUpdateFields.filter(c=>c.fieldName&&!c.isFlexField).reduce((c,u)=>(c[Zs(u.fieldName)]=u.fieldValue,c),{}),r=s.individualDataUpdateFields.filter(c=>c.fieldName&&c.isFlexField).reduce((c,u)=>(c[u.fieldName]=u.fieldValue,c),{});i.flexFields=r;const l=jn(s.individualDataUpdateFieldsDocuments),o=jn(s.individualDataUpdateFieldsIdentities),d=jn(s.individualDataUpdateFieldsAccounts);t.issueType={individualDataUpdateIssueTypeExtras:{individual:s.selectedIndividual?.id,individualData:{...i,documents:pr(l),documentsToRemove:pr(s.individualDataUpdateDocumentsToRemove),documentsToEdit:pr(s.individualDataUpdateDocumentsToEdit),identities:o,identitiesToRemove:s.individualDataUpdateIdentitiesToRemove,identitiesToEdit:s.individualDataUpdateIdentitiesToEdit,accounts:d,accounts_to_edit:gf(s.individualDataUpdateAccountsToEdit)}}}}else if(n===parseInt($e.EDIT_HOUSEHOLD,10)){const i=s.householdDataUpdateFields.filter(l=>l.fieldName&&!l.isFlexField).reduce((l,o)=>(l[o.fieldName]=o.fieldValue,l),{}),r=s.householdDataUpdateFields.filter(l=>l.fieldName&&l.isFlexField).reduce((l,o)=>(l[o.fieldName]=o.fieldValue,l),{});if(Array.isArray(s.roles)&&s.roles.length>0){const l=s.roles.filter(o=>{const d=o.new_role||o.newRole;return d&&typeof d=="string"&&d.trim()!==""}).map(o=>({...o,new_role:o.new_role||o.newRole}));l.length>0?i.roles=l:i.roles&&delete i.roles}else i.roles&&delete i.roles;t.issueType={householdDataUpdateIssueTypeExtras:{household:s.selectedHousehold?.id,householdData:{...i,flexFields:r,...Array.isArray(i.roles)&&i.roles.length>0?{roles:i.roles}:{}}}}}}return{description:s.description,assignedTo:s.assignedTo,category:a,issueType:n,admin:s.admin,area:s.area,language:s.language,consent:s.consent,linkedTickets:s.selectedLinkedTickets||[],extras:Object.keys(t).length>0?t:{},priority:s.priority==="Not set"||s.priority===null?0:s.priority,urgency:s.urgency==="Not set"||s.urgency===null?0:s.urgency,partner:s.partner?parseInt(s.partner,10):void 0,program:s.program,comments:s.comments,linkedFeedbackId:s.linkedFeedbackId,documentation:s.documentation||[]}}const tu=s=>{if(!s)return null;const t=s.toString();return[De.PAYMENT_VERIFICATION,De.NEEDS_ADJUDICATION,De.SYSTEM_FLAGGING].includes(t)?"system-generated":"user-generated"},$t=(s,t,a)=>!s||!t?null:`/${a}/grievance/tickets/${tu(t)}/${s}`,ff=(s,t,a)=>!s||!t?null:`/${a}/grievance/edit-ticket/${tu(t)}/${s}`,yf=[{category:"Data Change",color:"#FFAA20"},{category:"Grievance Complaint",color:"#023E90"},{category:"Needs Adjudication",color:"#05C9B7"},{category:"Negative Feedback",color:"#FF0200"},{category:"Payment Verification",color:"#FFE399"},{category:"Positive Feedback",color:"#13CB17"},{category:"Referral",color:"#FFAA20"},{category:"Sensitive Grievance",color:"#7FCB28"},{category:"System Flagging",color:"#00867B"}],bf=T.div`
  display: flex;
  align-items: center;
  flex-direction: row;
`;function vt({children:s}){return e.jsx(bf,{children:s})}function au({index:s,baseName:t,onDelete:a,isEdited:n,setFieldValue:i}){const{t:r}=M();return e.jsxs(e.Fragment,{children:[e.jsx(p,{size:4,children:e.jsx(B.Field,{name:`${t}[${s}].name`,fullWidth:!0,variant:"outlined",label:r("Document Name"),component:Se,required:!0,maxLength:100})}),e.jsx(p,{size:4,children:e.jsx(P,{style:{height:"100%"},display:"flex",alignItems:"center",children:e.jsx("input",{type:"file",accept:".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,.pdf,image/*,.xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onChange:l=>{i(`${t}[${s}].file`,l.currentTarget.files[0])}})})}),n?null:e.jsx(p,{size:4,children:e.jsx(Ve,{onClick:a,children:e.jsx(Rs,{})})})]})}function nu({values:s,setFieldValue:t,errors:a}){const{t:n}=M();return e.jsx(p,{container:!0,size:12,spacing:3,children:e.jsx(B.FieldArray,{name:"documentation",render:i=>e.jsxs(e.Fragment,{children:[s.documentation?.map((r,l)=>e.jsx(p,{container:!0,size:12,direction:"row",alignItems:"center",spacing:3,sx:{mb:2},children:e.jsx(au,{index:l,onDelete:()=>i.remove(l),baseName:"documentation",setFieldValue:t})},`${l}-documentation-file`)),e.jsx(p,{size:12,children:e.jsx(H,{"data-cy":"add-documentation",color:"primary",onClick:()=>{i.push({name:"",file:null})},startIcon:e.jsx(Et,{}),children:n(s.documentation?.length>0?"Add more grievance supporting documents":"Add grievance supporting documents")})}),a?.documentation&&e.jsx(Ls,{error:!0,children:a?.documentation})]})})})}const jf=T.div`
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1.5px solid #043e91;
  border-radius: 5px;
  color: #033f91;
  font-size: 16px;
  text-align: center;
  padding: 25px;
  font-weight: 500;
  cursor: pointer;
`,Af=T.div`
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1.5px solid #a0b6d6;
  border-radius: 5px;
  color: #a0b6d6;
  font-size: 16px;
  text-align: center;
  padding: 25px;
  font-weight: 500;
  cursor: pointer;
`,Oo=T.span`
  margin-right: 5px;
`;function Ol({title:s,handleClick:t,placeholder:a}){return a?e.jsxs(Af,{onClick:()=>null,children:[e.jsx(Oo,{children:e.jsx(Pa,{})}),e.jsx("span",{children:s})]}):e.jsxs(jf,{"data-cy":"look-up-button",onClick:t,children:[e.jsx(Oo,{children:e.jsx(Pa,{})}),e.jsx("span",{children:s})]})}const Fn=T.div`
  border: ${({disabled:s})=>s?0:1.5}px solid #043e91;
  border-radius: 5px;
  font-size: 16px;
  padding: 16px;
  background-color: #f7faff;
`,ot=T.span`
  color: #033f91;
  font-weight: 500;
  font-size: 16px;
`,kl=T.span`
  color: #949494;
  margin-right: 10px;
  cursor: pointer;
`,Nn=T.span`
  color: #757575;
  cursor: pointer;
`;function _f({ticketId:s}){const{businessArea:t}=U(),{data:a}=V({queryKey:["grievanceTicket",s,t],queryFn:()=>N.restBusinessAreasGrievanceTicketsRetrieve({businessAreaSlug:t,id:s}),enabled:!!s});return e.jsx(ot,{"data-cy":"linked-ticket-id",children:a?.unicefId})}const Pf=({values:s,setLookUpDialogOpen:t,onValueChange:a,disabled:n=!1})=>{const{t:i}=M(),l=je().pathname.indexOf("edit-ticket")!==-1,o=()=>{a("selectedLinkedTickets",[])},d=()=>s.selectedLinkedTickets.length?s.selectedLinkedTickets.map(c=>e.jsx(_f,{ticketId:c,"data-cy":"linked-ticket"},c)):e.jsx(ot,{children:"-"});return e.jsx(Fn,{disabled:n,children:e.jsxs(p,{container:!0,justifyContent:"space-between",children:[e.jsx(p,{children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[i("Ticket ID"),":",d()]})}),!l&&!n&&e.jsx(p,{children:e.jsx(P,{p:2,children:e.jsxs(p,{container:!0,justifyContent:"center",alignItems:"center",children:[e.jsx(p,{children:e.jsx(kl,{children:e.jsx(ma,{color:"inherit",fontSize:"small",onClick:()=>t(!0),"data-cy":"button-edit"})})}),e.jsx(p,{children:e.jsx(Nn,{children:e.jsx(Rs,{color:"inherit",fontSize:"small",onClick:()=>o(),"data-cy":"button-delete"})})})]})})})]})})};function Cf({value:s,disabled:t,label:a,dataCy:n,loadData:i,loading:r,allEdges:l,handleChange:o,handleClose:d,handleOptionSelected:c,handleOptionLabel:u,handleOpen:h,open:m,data:g,inputValue:x,onInputTextChange:f,debouncedInputText:j,startAdornment:y=null}){const b=A.useRef(s);return A.useEffect(()=>{b.current!==""&&s===""&&x!==""&&f(""),b.current=s},[s,f,x]),A.useEffect(()=>{i()},[i]),A.useEffect(()=>{m&&i()},[m,j,i]),g?e.jsx(zi,{freeSolo:!1,filterOptions:C=>C,value:s,"data-cy":n,open:m,options:l,onChange:o,onOpen:h,onClose:d,isOptionEqualToValue:(C,v)=>c(C,v),getOptionLabel:u,disabled:t,loading:r,renderInput:C=>e.jsx(qi,{...C,label:a,variant:"outlined",size:"small","data-cy":`${a}-input`,value:x,onChange:v=>f(v.target.value),slotProps:{input:{...C.InputProps,startAdornment:y,endAdornment:e.jsxs(e.Fragment,{children:[r?e.jsx(la,{color:"inherit",size:20}):null,C.InputProps.endAdornment]})}}})},b.current):null}function ua({disabled:s,name:t,level:a,filter:n,value:i,initialFilter:r,appliedFilter:l,setAppliedFilter:o,setFilter:d,dataCy:c}){const{t:u}=M(),[h,m]=A.useState(!1),[g,x]=A.useState(""),f=qt(g,800),j=ge(),y=je(),{businessArea:b}=U(),[C,v]=A.useState({limit:20,search:f||void 0});A.useEffect(()=>{v(G=>({...G,search:f||void 0}))},[f]);const{data:S,isLoading:I,refetch:E}=V({queryKey:["adminAreas",C,b,a],queryFn:()=>N.restBusinessAreasGeoAreasList({businessAreaSlug:b,level:a,name:C.search}),enabled:h&&!!b,staleTime:0,refetchOnWindowFocus:!1}),D=A.useCallback(()=>{b&&E()},[b,E]),{handleFilterChange:F}=Ss(r,j,y,n,d,l,o),w=S||[],O=(G,W)=>typeof W=="string"?G?.id===W:G?.id===W?.id,k=G=>{if(typeof G=="string"){const W=w.find(Y=>Y.id===G);return W?W.name:G}return G?.name||""},$=G=>{x(G)};return e.jsx(Cf,{value:i,disabled:s,label:u(`Admin Level ${a}`),dataCy:c,loadData:D,loading:I,allEdges:w,handleChange:(G,W)=>{W||$(""),Qa(t,W?.id,F)},handleOpen:()=>m(!0),open:h,handleClose:(G,W)=>{m(!1),W!=="select-option"&&$("")},handleOptionSelected:O,handleOptionLabel:k,data:S,inputValue:g,onInputTextChange:$,debouncedInputText:f})}const ms=({topLabel:s=null,onChange:t,value:a=null,dataCy:n="date-picker-filter",...i})=>{let r=null;a&&(/^\d{4}-\d{2}-\d{2}$/.test(a)?r=Gt.parseISO(`${a}T00:00:00.000Z`):r=Gt.parseISO(a));const l=n==="date-picker-filter"?`date-picker-filter-${i?.label||i?.placeholder||""}`:n;return e.jsxs(P,{display:"flex",flexDirection:"column",children:[s?e.jsx(Fl,{children:s}):null,e.jsx(tt,{"data-cy":l,size:"small",children:e.jsx(uc.DesktopDatePicker,{slotProps:{textField:{size:"small"}},onChange:o=>{if(o){const d=o.getFullYear(),c=String(o.getMonth()+1).padStart(2,"0"),u=String(o.getDate()).padStart(2,"0");t(`${d}-${c}-${u}`)}else t(null)},value:r||null,format:"yyyy-MM-dd",...i})})]})};function Ef({filter:s,choicesData:t,setFilter:a,initialFilter:n,appliedFilter:i,setAppliedFilter:r}){const{t:l}=M(),o=je(),d=ge(),{handleFilterChange:c,applyFilterChanges:u,clearFilter:h}=Ss(n,d,o,s,a,i,r),m=()=>{u()},g=()=>{h()};return e.jsx(Ns,{clearHandler:g,applyHandler:m,isOnPaper:!1,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{label:l("Search"),value:s.search,onChange:x=>c("search",x.target.value),"data-cy":"filters-search"})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:x=>c("status",x.target.value),label:l("Status"),value:s.status||null,"data-cy":"filters-status",children:t.grievanceTicketStatusChoices.map(x=>e.jsx(de,{value:x.value,children:x.name},x.value))})}),e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{label:l("FSP"),value:s.fsp,onChange:x=>c("fsp",x.target.value),"data-cy":"filters-fsp"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{topLabel:l("Creation Date"),label:"From",onChange:x=>c("createdAtRangeMin",x),value:s.createdAtRangeMin,dataCy:"filters-creation-date-from"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{label:l("To"),onChange:x=>c("createdAtRangeMax",x),value:s.createdAtRangeMax,dataCy:"filters-creation-date-to"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ua,{level:2,name:"admin2",value:s.admin2,setFilter:a,filter:s,initialFilter:n,appliedFilter:i,setAppliedFilter:r,dataCy:"filters-admin"})})]})})}const Es=T.div`
  padding: 20px;
`,vf=T.span`
  border: 0;
  clip: rect(0 0 0 0);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  top: 20px;
  width: 1px;
`,Sf=T(kn)`
  & {
    font-size: 12px;
  }
`,If=T.span`
  font-size: 12px;
`;function wl(s){const{order:t,orderBy:a,headCells:n,onRequestSort:i,allowSort:r=!0,onSelectAllClick:l,rowCount:o,numSelected:d=0,data:c=[]}=s,u=m=>g=>{i(g,m)},h=ve();return e.jsx(hs,{children:e.jsxs(be,{children:[l&&c.length?e.jsx(_,{padding:"checkbox",children:e.jsx(ns,{color:"primary",indeterminate:d>0&&d<o,"data-cy":"checkbox-select-all",checked:o>0&&d===o,onChange:m=>l(m,c),slotProps:{input:{"aria-label":"select all"}}})}):null,n.map(m=>(!m.requiredPermission||K(m.requiredPermission,h))&&e.jsx(_,{align:m.numeric?"right":"left",padding:m.disablePadding?"none":"normal",sortDirection:a===m.id?t:!1,"data-cy":m.dataCy,children:r&&!m.disableSort?e.jsxs(Sf,{"data-cy":"table-label",active:a===m.id,direction:a===m.id?t:"asc",onClick:u(m.id),children:[m.label,a===m.id&&e.jsx(vf,{children:t==="desc"?"sorted descending":"sorted ascending"})]}):e.jsx(If,{"data-cy":"table-label",children:m.label})},m.id.toString()))]})})}const Df=Ft(hc)(({theme:s})=>({paddingLeft:s.spacing(6),paddingRight:s.spacing(1),color:s.palette.text.primary,backgroundColor:"white"})),Tf=Ft(ee)({flex:"1 1 100%"});function Ml({title:s}){return e.jsx(Df,{children:e.jsx(Tf,{"data-cy":"table-title",variant:"h6",children:s})})}function Rf(s){const{count:t,page:a,rowsPerPage:n,onPageChange:i}=s,r=c=>{i(c,0)},l=c=>{i(c,a-1)},o=c=>{i(c,a+1)},d=c=>{i(c,Math.max(0,Math.ceil(t/n)-1))};return e.jsxs(P,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(Ve,{onClick:r,disabled:a===0,"aria-label":"first page",children:e.jsx(Bh,{})}),e.jsx(Ve,{onClick:l,disabled:a===0,"aria-label":"previous page",children:e.jsx(rl,{})}),e.jsx(Ve,{onClick:o,disabled:a>=Math.ceil(t/n)-1,"aria-label":"next page",children:e.jsx(ll,{})}),e.jsx(Ve,{onClick:d,disabled:a>=Math.ceil(t/n)-1,"aria-label":"last page",children:e.jsx(Gh,{})})]})}const Ff=T("div")`
  width: 100%;
`,Nf=T(us)`
  width: 100%;
  margin-bottom: 8px;
  overflow: clip;
`,Lf=T(gs)`
  min-width: 750px;
`,gr=T(be)`
  height: 70px;
  min-height: 70px;
`,xr=T(_)`
  col-span: ${s=>s.colSpan};

  && {
    white-space: nowrap;
    overflow: auto;
  }
`,Of=T(Ut)``,ko=T(P)`
  display: flex;
  justify-content: space-between;
`,kf=T(Lf)`
  aria-labelledby: 'tableTitle';
  size: 'medium';
  aria-label: 'enhanced table';
  data-cy: 'table-title';
`,wf=T.div`
  display: flex;
  width: 100%;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  color: #a9a9a9;
  font-size: 24px;
  line-height: 28px;
  text-align: center;
  padding: 70px;
`,Mf=T(P)`
  font-size: 16px;
  color: #a9a9a9;
`,$f=T(P)`
  font-size: 50px;
`,Uf=T(mc)`
  & svg {
    color: #9e9e9e;
  }
`;function Vf({title:s="",renderRow:t,data:a,headCells:n,rowsPerPageOptions:i,rowsPerPage:r,page:l,itemsCount:o,handleChangePage:d,handleChangeRowsPerPage:c,handleRequestSort:u,order:h,orderBy:m,onSelectAllClick:g,loading:x=!1,allowSort:f=!0,isOnPaper:j=!0,actions:y=[],numSelected:b=0,hidePagination:C=!1,customHeadRenderer:v,noEmptyMessage:S=!1}){const{t:I}=M();let E=r-Math.min(r,o-l*r);(isNaN(E)||E<0)&&(E=0);let D;x?D=Array.from({length:r}).map((w,O)=>e.jsx(gr,{"data-cy":"table-row",children:e.jsx(xr,{colSpan:n.length,children:e.jsx(pc,{variant:"rectangular",width:"100%",height:70})})},O)):a.length?D=e.jsx(e.Fragment,{children:a.map(w=>t(w))}):S?D=e.jsx(gr,{"data-cy":"table-row",style:{height:70*E||70},children:e.jsx(xr,{colSpan:n.length})}):D=e.jsx(gr,{"data-cy":"table-row",style:{height:70*E||70},children:e.jsx(xr,{colSpan:n.length,children:e.jsxs(wf,{children:[e.jsx($f,{children:e.jsx(Uf,{fontSize:"inherit"})}),e.jsx(P,{mt:2,children:I("No results")}),e.jsx(Mf,{mt:2,children:I("Try adjusting your search or your filters to find what you are looking for.")})]})})});const F=e.jsxs(e.Fragment,{children:[e.jsxs(Of,{children:[e.jsxs(ko,{children:[s?e.jsx(Ml,{title:s}):null,e.jsx(ko,{p:5,children:y||null})]}),e.jsxs(kf,{children:[v?typeof v=="function"?v({order:h,headCells:n,orderBy:m,onRequestSort:u,rowCount:a.length,allowSort:f,onSelectAllClick:g,data:a,numSelected:b}):v:e.jsx(wl,{order:h,headCells:n,orderBy:m,onRequestSort:u,rowCount:a.length,allowSort:f,onSelectAllClick:g,data:a,numSelected:b}),e.jsx(cs,{children:D})]})]}),!C&&typeof o=="number"&&o>=0&&e.jsx(Ua,{rowsPerPageOptions:i,component:"div",count:o,rowsPerPage:r,page:l,onPageChange:d,onRowsPerPageChange:c,ActionsComponent:Rf,"data-cy":"table-pagination"})]});return e.jsx(Ff,{children:j?e.jsx(Nf,{children:F}):F})}const ds=({rowsPerPageOptions:s=[5,10,15],renderRow:t,headCells:a,title:n,getTitle:i,isOnPaper:r,actions:l,onSelectAllClick:o,defaultOrderBy:d,defaultOrderDirection:c="asc",numSelected:u=0,allowSort:h=!0,data:m,error:g,isLoading:x,queryVariables:f,setQueryVariables:j,itemsCount:y,initialRowsPerPage:b,hidePagination:C,customHeadRenderer:v,noEmptyMessage:S=!1,page:I,setPage:E})=>{const[D,F]=A.useState(b||s[0]),[w,O]=A.useState(d),[k,$]=A.useState(c),[G,W]=A.useState(0),Y=typeof I=="number"?I:G,X=typeof E=="function"?E:W,J=A.useMemo(()=>({...Il(f),businessAreaSlug:f.businessAreaSlug,...f.ordering?{ordering:f.ordering}:{}}),[f]);if(A.useEffect(()=>{const le={...J,offset:Y*D,limit:D},ce=w?Fp(w,k):J.ordering;ce&&(le.ordering=ce);const _e=le;mt.isEqual(_e,f)||j(_e)},[Y,D,w,k,J,j,f]),g)return console.error(g),rt(g)?e.jsx(Xe,{permission:"Permission Denied"}):e.jsx("div",{children:"Unexpected error"});let ae=n;i&&(ae=i(m));const se=(m?.results||[]).map(le=>le);return e.jsx(Vf,{"data-cy":"universal-rest-table",title:ae,actions:l,data:se,loading:x,renderRow:t,isOnPaper:r,headCells:a,rowsPerPageOptions:s,rowsPerPage:D,page:Y,itemsCount:y,handleChangePage:(le,ce)=>{X(ce)},handleChangeRowsPerPage:le=>{const ce=parseInt(le.target.value,10);F(ce),X(0)},handleRequestSort:(le,ce)=>{const _e=w===ce&&k==="asc"?"desc":"asc";O(ce),$(_e),X(0)},orderBy:w,order:k,onSelectAllClick:o,numSelected:u,allowSort:h,hidePagination:C,customHeadRenderer:v,noEmptyMessage:S})},Bf=[{disablePadding:!1,label:"Ticket ID",id:"unicefId",numeric:!1,dataCy:"ticket-id"},{disablePadding:!1,label:"Status",id:"status",numeric:!1,dataCy:"status"},{disablePadding:!1,label:"Category",id:"category",numeric:!1,dataCy:"category"},{disablePadding:!1,label:"Household ID",id:"household",numeric:!1,dataCy:"householdId"},{disablePadding:!1,label:"Assigned to",id:"assignedTo",numeric:!1,dataCy:"assignedTo"},{disablePadding:!1,label:"Administrative Level 2",id:"admin",numeric:!1,dataCy:"admin"}],Gf=T(be)`
  cursor: pointer;
  && {
    white-space: nowrap;
    overflow: auto;
  }
`;function wo(){let s="";return window.getSelection!==void 0?s=window.getSelection().toString():document.selection!==void 0&&document.selection.type==="Text"&&(s=document.selection.createRange().text),s}function rs({onClick:s,...t}){const[a,n]=A.useState("");let i,r;return s&&(r=()=>{n(wo())},i=l=>{l.getModifierState("Alt")||a.length===0&&wo().length>0||s(l)}),e.jsx(Gf,{...t,onMouseDown:r,onClick:i})}const zf=T.div`
  min-width: 120px;
  max-width: 300px;
`,qf=T.div`
  color: ${({$status:s,$statusToColor:t,theme:a})=>t(a,s)};
  background-color: ${({$status:s,$statusToColor:t,theme:a})=>`${t(a,s)}${wc(.15)}`};
  border-radius: 16px;
  font-family: Roboto;
  font-size: 10px;
  font-weight: 500;
  letter-spacing: 1.2px;
  line-height: 16px;
  padding: 4px;
  text-align: center;
  margin-right: 20px;
`,we=({status:s,statusToColor:t,statusNameMapping:a,statusDisplay:n,dataCy:i})=>{const r=/_/g;return s?e.jsx(zf,{children:e.jsx(qf,{className:"status-box-container",$status:s,$statusToColor:t,"data-cy":i||"status-container",children:a?a(s):n||s?.replace(r," ")})}):e.jsx(e.Fragment,{children:"-"})};function Hf({ticket:s,selected:t,checkboxClickHandler:a,statusChoices:n,categoryChoices:i}){const{baseUrl:r}=U(),o=(c=>t.includes(c))(s.id),d=$t(s.id,s.category,r);return e.jsxs(rs,{onClick:c=>a(c,s.id),hover:!0,role:"checkbox",children:[e.jsx(_,{padding:"checkbox",children:e.jsx(ns,{color:"primary",onClick:c=>a(c,s.id),checked:o,inputProps:{"aria-labelledby":s.id}})}),e.jsx(_,{align:"left",children:e.jsx(me,{to:d,children:s.unicefId})}),e.jsx(_,{align:"left",children:e.jsx(we,{status:n[s.status],statusToColor:Vn})}),e.jsx(_,{align:"left",children:i[s.category]}),e.jsx(_,{align:"left",children:s.householdUnicefId||"-"}),e.jsx(_,{align:"left",children:va(s.assignedTo)}),e.jsx(_,{align:"left",children:s.admin})]},s.id)}function Wf({businessArea:s,programId:t,filter:a,setFieldValue:n,initialValues:i}){const{data:r,isLoading:l}=V({queryKey:["businessAreasGrievanceTicketsChoices",s],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:s})}),o=A.useMemo(()=>({businessAreaSlug:s,programSlug:t,search:a.search?.trim()||"",documentType:r?.documentTypeChoices?.[0]?.value,documentNumber:a.documentNumber?.trim()||"",status:a.status?[a.status]:void 0,fsp:a.fsp||void 0,createdAtAfter:Yt(a.createdAtRangeMin,"startOfDay"),createdAtBefore:Yt(a.createdAtRangeMax,"endOfDay"),admin2:a?.admin2?.id}),[s,t,a.search,a.documentNumber,a.status,a.fsp,a.createdAtRangeMin,a.createdAtRangeMax,a?.admin2?.id,r?.documentTypeChoices]),[d,c]=A.useState(o);A.useEffect(()=>{c(o)},[o]);const[u,h]=A.useState(0),[m,g]=A.useState(i.selectedLinkedTickets),{data:x,isLoading:f,error:j}=V({queryKey:[t?"businessAreasProgramsGrievanceTicketsList":"businessAreasGrievanceTicketsList",d,s,t],queryFn:()=>t?N.restBusinessAreasProgramsGrievanceTicketsList(Ce({businessAreaSlug:s,programSlug:t},d,{withPagination:!0})):N.restBusinessAreasGrievanceTicketsList(Ce({businessAreaSlug:s},d,{withPagination:!0})),enabled:!l&&!!r}),{data:y}=V({queryKey:[t?"businessAreasProgramsGrievanceTicketsCount":"businessAreasGrievanceTicketsCount",s,t],queryFn:()=>t?N.restBusinessAreasProgramsGrievanceTicketsCountRetrieve(Ce({businessAreaSlug:s,programSlug:t},d)):N.restBusinessAreasGrievanceTicketsCountRetrieve(Ce({businessAreaSlug:s},d)),enabled:!l&&!!r&&u===0});if(l)return null;const b=_s(r.grievanceTicketStatusChoices),C=_s(r.grievanceTicketCategoryChoices),v=(D,F)=>{const w=m.indexOf(F),O=[...m];w===-1?O.push(F):O.splice(w,1),g(O),n("selectedLinkedTickets",O)},S=(D,F)=>{if(!m.length){const w=F.map(O=>O.id);g(w),n("selectedLinkedTickets",w);return}g([]),n("selectedLinkedTickets",[])},I=m.length,E=D=>e.jsx(Hf,{ticket:D,statusChoices:b,categoryChoices:C,checkboxClickHandler:v,selected:m},D.id);return e.jsx(Es,{children:e.jsx(ds,{headCells:Bf,rowsPerPageOptions:[10,15,20],onSelectAllClick:S,numSelected:I,data:x,error:j,isLoading:f,queryVariables:d,setQueryVariables:c,itemsCount:y?.count,renderRow:E,page:u,setPage:h})})}const Kf=({onValueChange:s,initialValues:t,lookUpDialogOpen:a,setLookUpDialogOpen:n})=>{const{businessArea:i}=U(),{t:r}=M(),l=je(),{data:o,isLoading:d}=V({queryKey:["businessAreasGrievanceTicketsChoices",i],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:i})}),c={search:"",documentType:o?.documentTypeChoices?.[0]?.value,documentNumber:"",status:"",fsp:"",createdAtRangeMin:null,createdAtRangeMax:null,admin2:""},[u,h]=A.useState(Ke(l,c)),[m,g]=A.useState(Ke(l,c)),[x,f]=A.useState(!1),j=A.useRef(null);if(et(j,x,m,()=>f(!1)),!o)return null;if(d)return e.jsx(Ne,{});const y=b=>{s("selectedLinkedTickets",b.selectedLinkedTickets),n(!1)};return e.jsx(B.Formik,{initialValues:t,onSubmit:b=>{y(b)},children:({submitForm:b,setFieldValue:C})=>e.jsxs(is,{maxWidth:"lg",fullWidth:!0,open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[a&&e.jsx(Bs,{}),e.jsx(Ye,{children:e.jsx(Le,{children:r("Look up Linked Tickets")})}),e.jsxs(Be,{children:[e.jsx(Ef,{choicesData:o,filter:u,setFilter:h,initialFilter:c,appliedFilter:m,setAppliedFilter:v=>{g(v),f(!0)}}),e.jsx("div",{ref:j,children:e.jsx(Wf,{filter:m,businessArea:i,setFieldValue:C,initialValues:t})})]}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{"data-cy":"button-cancel",onClick:()=>n(!1),children:r("CANCEL")}),e.jsx(H,{type:"submit",color:"primary",variant:"contained",onClick:()=>{b()},"data-cy":"button-submit",children:r("SAVE")})]})})]})})};function iu({onValueChange:s,values:t,disabled:a}){const{t:n}=M(),i=je(),[r,l]=A.useState(!1),o=i.pathname.includes("edit-ticket");return e.jsxs(e.Fragment,{children:[t.selectedLinkedTickets.length?e.jsx(Pf,{setLookUpDialogOpen:l,values:t,disabled:a,onValueChange:s}):!o&&e.jsx(Ol,{title:n("Look up Linked Ticket"),handleClick:()=>l(!0)}),e.jsx(Kf,{lookUpDialogOpen:r,setLookUpDialogOpen:l,initialValues:t,onValueChange:s})]})}const Yf=({values:s,setLookUpDialogOpen:t,onValueChange:a,disabled:n=!1})=>{const{t:i}=M(),r=()=>{a("selectedPaymentRecords",[])},l=()=>s.selectedPaymentRecords.length?s.selectedPaymentRecords.map(o=>e.jsx(ot,{"data-cy":"payment-record",children:o.unicefId},o.id)):e.jsx(ot,{children:"-"});return e.jsx(Fn,{disabled:n,children:e.jsxs(p,{container:!0,children:[e.jsx(p,{children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[i("Payment ID"),":",l()]})}),n||e.jsx(p,{children:e.jsx(P,{p:2,children:e.jsxs(p,{container:!0,justifyContent:"center",alignItems:"center",children:[e.jsx(p,{children:e.jsx(kl,{children:e.jsx(ma,{color:"inherit",fontSize:"small",onClick:()=>t(!0)})})}),e.jsx(p,{children:e.jsx(Nn,{children:e.jsx(Rs,{color:"inherit",fontSize:"small",onClick:()=>r()})})})]})})})]})})},Mo=[{disablePadding:!1,label:"Payment ID",id:"caId",numeric:!1},{disablePadding:!1,label:"Payment Record Status",id:"status",numeric:!1},{disablePadding:!1,label:"Programme Name",id:"parent__program__name",numeric:!1,disableSort:!0},{disablePadding:!1,label:"Delivered",id:"delivered_quantity",numeric:!0},{disablePadding:!1,label:"Received",id:"payment_verification__received_amount",disableSort:!0,numeric:!0}];function $o({paymentRecord:s,selected:t,checkboxClickHandler:a}){const{baseUrl:n,isAllPrograms:i}=U(),l=(u=>t.some(h=>h.id===u.id))(s),o=s?.verification?.receivedAmount,c=`/${n}/payment-module/payments/${s.id}`;return e.jsxs(rs,{onClick:u=>a(u,s),hover:!0,role:"checkbox",children:[e.jsx(_,{padding:"checkbox",children:e.jsx(ns,{color:"primary",onClick:u=>a(u,s),checked:l,inputProps:{"aria-labelledby":s.id}})}),e.jsx(_,{align:"left",children:i?e.jsx("span",{children:s.unicefId}):e.jsx(me,{to:c,children:s.unicefId})}),e.jsx(_,{align:"left",children:s.status?e.jsx(we,{status:s.status,statusToColor:Na}):"-"}),e.jsx(_,{align:"left",children:s.programName}),e.jsx(_,{align:"right",children:Ps(s.deliveredQuantity,s.currency)}),e.jsx(_,{align:"right",children:o==null?"-":Ps(o,s.currency)})]},s.id)}function Qf({openInNewTab:s=!1,setFieldValue:t,initialValues:a}){const{businessArea:n,programId:i}=U(),l=je().pathname.indexOf("edit-ticket")!==-1,o=A.useMemo(()=>({householdId:a?.selectedHousehold?.id,businessAreaSlug:n,slug:i==="all"?null:i}),[a?.selectedHousehold?.id,n,i]),[d,c]=A.useState(o);A.useEffect(()=>{c(o)},[o]);const[u,h]=A.useState(0),[m,g]=A.useState(0),{data:x,isLoading:f,error:j}=V({queryKey:[i==="all"||!i?"businessAreasPaymentsList":"businessAreasProgramsPaymentsList",d,a?.selectedHousehold?.id,n,i,i==="all"||!i?u:m],queryFn:()=>i==="all"||!i?N.restBusinessAreasPaymentsList(Ce({householdId:a?.selectedHousehold?.id,businessAreaSlug:n},{},{withPagination:!0})):N.restBusinessAreasProgramsPaymentsList(Ce({householdId:a?.selectedHousehold?.id,businessAreaSlug:n,slug:i},{},{withPagination:!0}))}),{data:y}=V({queryKey:["businessAreasPaymentsCount",d,a?.selectedHousehold?.id,n,u],queryFn:()=>N.restBusinessAreasPaymentsCountRetrieve(Ce({householdId:a?.selectedHousehold?.id,businessAreaSlug:n},{})),enabled:(i==="all"||!i)&&u===0}),{data:b}=V({queryKey:["businessAreasProgramsPaymentPlansPaymentsCount",d,a?.selectedHousehold?.id,n,i,m],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansPaymentsCountRetrieve(Ce({householdId:a?.selectedHousehold?.id,businessAreaSlug:n,paymentPlanPk:i,programSlug:i},{})),enabled:i!=="all"&&!!i&&m===0}),[C,v]=A.useState(a.selectedPaymentRecords),S=(D,F)=>{const w=C.indexOf(F),O=[...C];w===-1?O.push(F):O.splice(w,1),v(O),t("selectedPaymentRecords",O)},I=(D,F)=>{if(!C.length){const w=F;v(w),t("selectedPaymentRecords",w);return}v([]),t("selectedPaymentRecords",[])},E=C.length;return l?e.jsx(ds,{headCells:Mo,data:x,isLoading:f,error:j,queryVariables:d,setQueryVariables:c,renderRow:D=>e.jsx($o,{openInNewTab:s,paymentRecord:D,checkboxClickHandler:S,selected:C},D.id),page:i==="all"||!i?u:m,setPage:i==="all"||!i?h:g,itemsCount:i==="all"||!i?y?.count:b?.count}):e.jsx(ds,{headCells:Mo,onSelectAllClick:I,numSelected:E,data:x,isLoading:f,error:j,queryVariables:d,setQueryVariables:c,renderRow:D=>e.jsx($o,{openInNewTab:s,paymentRecord:D,checkboxClickHandler:S,selected:C},D.id),page:i==="all"||!i?u:m,setPage:i==="all"||!i?h:g,itemsCount:i==="all"||!i?y?.count:b?.count})}function Xf({onValueChange:s,initialValues:t,lookUpDialogOpen:a,setLookUpDialogOpen:n}){const{t:i}=M();return e.jsx(B.Formik,{initialValues:t,onSubmit:r=>{s("selectedPaymentRecords",r.selectedPaymentRecords),n(!1)},children:({submitForm:r,setFieldValue:l})=>e.jsxs(is,{maxWidth:"lg",fullWidth:!0,open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[a&&e.jsx(Bs,{}),e.jsx(Ye,{children:e.jsx(Le,{children:i("Look up Payment Record")})}),e.jsx(Be,{children:e.jsx(Qf,{openInNewTab:!0,setFieldValue:l,initialValues:t})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>n(!1),children:i("CANCEL")}),e.jsx(H,{type:"submit",color:"primary",variant:"contained",onClick:r,"data-cy":"button-submit",children:i("SAVE")})]})})]})})}function ru({onValueChange:s,values:t,disabled:a}){const{t:n}=M(),i=je(),{isSocialDctType:r}=Z(),l=i.pathname.includes("edit-ticket"),[o,d]=A.useState(!1),c=()=>!t.selectedHousehold&&!r;return e.jsxs(e.Fragment,{children:[t.selectedPaymentRecords?.length?e.jsx(Yf,{setLookUpDialogOpen:d,values:t,disabled:a,onValueChange:s}):!l&&e.jsx(Ol,{placeholder:c(),title:n("Look up Payment Record"),handleClick:()=>d(!0)}),e.jsx(Xf,{lookUpDialogOpen:o,setLookUpDialogOpen:d,initialValues:t,onValueChange:s})]})}const Uo=T.div`
  padding: 15px 0;
`,Jf=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  border-top: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  padding: 15px 0;
`,Vo=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  padding: 15px 0;
`;function Zf({values:s,showIssueType:t,issueTypeToDisplay:a,baseUrl:n,choicesData:i,programsData:r,setFieldValue:l,errors:o,permissions:d,isLinkedFromUrl:c}){const{t:u}=M(),{isAllPrograms:h,businessArea:m}=U(),{data:g}=V({queryKey:["partnerForGrievanceChoices",m],queryFn:()=>N.restBusinessAreasUsersPartnerForGrievanceChoicesRetrieve({businessAreaSlug:m})}),{selectedProgram:x,isSocialDctType:f}=Z(),j=x?.beneficiaryGroup;A.useEffect(()=>{s.selectedIndividual?.program?.id?l("program",s.selectedIndividual?.program?.id):s.selectedHousehold?.programId&&l("program",s.selectedHousehold?.programId)},[s.selectedHousehold,s.selectedIndividual,l]);const y=_s(i?.grievanceTicketCategoryChoices||[]),b=i?.grievanceTicketPriorityChoices,C=i?.grievanceTicketUrgencyChoices,v=K(R.GRIEVANCE_DOCUMENTS_UPLOAD,d),S=K(R.POPULATION_VIEW_HOUSEHOLDS_DETAILS,d),I=K(R.POPULATION_VIEW_INDIVIDUALS_DETAILS,d),E=r?.results?.map(F=>({name:F.name,value:F.id})),D=!s.selectedHousehold?.id&&!s.selectedIndividual?.id;return e.jsxs(e.Fragment,{children:[e.jsxs(Uo,{children:[e.jsx(vt,{children:e.jsx(p,{container:!0,spacing:6,children:[{label:u("Category"),value:e.jsx("span",{children:y[s.category]}),size:6},t(s)&&{label:u("Issue Type"),value:e.jsx("span",{children:Jc(a,j)}),size:6},{label:`${j?.groupLabel} ID`,value:e.jsx("span",{children:s.selectedHousehold?.id&&S&&!h?e.jsx(me,{to:`/${n}/population/household/${s.selectedHousehold?.id}`,children:s.selectedHousehold.unicefId}):e.jsx("div",{children:s.selectedHousehold?.unicefId||"-"})}),size:6},{label:`${j?.memberLabel} ID`,value:e.jsx("span",{children:s.selectedIndividual?.id&&I&&!h?e.jsx(me,{to:`/${n}/population/individuals/${s.selectedIndividual?.id}`,children:s.selectedIndividual.unicefId}):e.jsx("div",{children:s.selectedIndividual?.unicefId||"-"})}),size:6}].filter(F=>f?F.label!==`${j?.groupLabel} ID`:F).map(F=>e.jsx(p,{size:{xs:F.size},children:e.jsx(L,{label:F.label,children:F.value})},F.label))})}),e.jsx(Vo,{}),e.jsx(Uo,{}),e.jsxs(p,{container:!0,spacing:3,children:[s.issueType===$e.PARTNER_COMPLAINT&&e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:"partner",fullWidth:!0,variant:"outlined",label:u("Partner*"),choices:g||[],component:We})}),e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"description",multiline:!0,fullWidth:!0,variant:"outlined",label:s.issueType===$e.DELETE_HOUSEHOLD||s.issueType===$e.DELETE_INDIVIDUAL?u("Withdrawal Reason*"):u("Description*"),component:Se})}),e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"comments",multiline:!0,fullWidth:!0,variant:"outlined",label:u("Comments"),component:Se})}),e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"admin",variant:"outlined",component:Hi,disabled:!!s.selectedHousehold?.admin2})}),e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"area",fullWidth:!0,variant:"outlined",label:u("Area / Village / Pay point"),component:Se})}),e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"language",multiline:!0,fullWidth:!0,variant:"outlined",label:u("Languages Spoken"),component:Se})}),e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:"priority",multiline:!0,fullWidth:!0,variant:"outlined",label:u("Priority"),choices:b,component:We})}),e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:"urgency",multiline:!0,fullWidth:!0,variant:"outlined",label:u("Urgency"),choices:C,component:We})}),e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:"program",label:u("Programme Name"),fullWidth:!0,variant:"outlined",choices:E,component:We,disabled:!h||!D})})]}),e.jsx(P,{sx:{pt:5},children:e.jsx(Jf,{children:e.jsxs(p,{container:!0,spacing:4,children:[e.jsx(p,{size:{xs:6},children:e.jsx(P,{sx:{py:3},children:e.jsx(iu,{values:s,onValueChange:l,disabled:c})})}),(s.issueType===$e.PAYMENT_COMPLAINT||s.issueType===$e.FSP_COMPLAINT)&&e.jsxs(p,{size:{xs:6},children:[e.jsx(P,{sx:{py:3},children:e.jsx(ru,{values:s,onValueChange:l})}),e.jsx(Ls,{error:!0,children:o.selectedPaymentRecords},"selectedPaymentRecords")]})]})})})]}),v&&e.jsx(P,{sx:{mt:3},children:e.jsxs(Vo,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:u("Grievance Supporting Documents: upload of documents for the ticket")})}),e.jsx(nu,{values:s,setFieldValue:l,errors:o})]})})]})}const ey=oe(Zf,"Description");function Hs(s,t,a){const n=(l,o)=>{let d,c;return bo(t)?d=t(o):d=Os(o,t),bo(a)?c=a(o):c=a==="*"?o:Os(o,a),l[d]=c,l},[i,r]=A.useState(()=>(Array.isArray(s)?s:[]).reduce(n,{}));return A.useEffect(()=>{r((Array.isArray(s)?s:[]).reduce(n,{}))},[s]),i}const sy=T.div`
  height: 50px;
  width: 100%;
  display: flex;
  align-items: center;
`,ty=T.div`
  border-top: 1px solid #b1b1b5;
  height: 1px;
  width: 100%;
`;function St(){return e.jsx(sy,{children:e.jsx(ty,{})})}function ay({handleChange:s,choicesData:t,setFieldValue:a,showIssueType:n,values:i,redirectedFromRelatedTicket:r}){const{t:l}=M(),{isSocialDctType:o}=Z(),d=Hs(t?.grievanceTicketIssueTypeChoices,"category","*"),{selectedProgram:c}=Z(),u=c?.beneficiaryGroup,h=[{name:`${u?.groupLabel} Data Update`,value:"13"},{name:`${u?.memberLabel} Data Update`,value:"14"}];function m(E,D){return E?E.map(F=>{let w=F.name;return D?.memberLabel&&(w=w.replace(/Individual/g,D.memberLabel)),D?.groupLabel&&(w=w.replace(/Household/g,D.groupLabel)),{...F,name:w}}):[]}const g=d[i.category]?.subCategories||[],x=Object.entries(g).map(([E,D])=>({name:D,value:E})),f=m(x,u),j=Nc(u),y=Lc(u),v=(E=>E?o?E.map(D=>D.value==="16"||D.value==="13"||D.value==="17"?{...D,disabled:!0}:D):E:[])(r?h:r?h:f),S=j[jl[i.category]]||"",I=y[Oi[i.issueType]]||"";return e.jsxs(p,{container:!0,columnSpacing:3,children:[e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"category",label:"Category",onChange:E=>{a("issueType",null),s(E)},variant:"outlined",choices:t.grievanceTicketManualCategoryChoices,component:We,disabled:r,required:!0})}),n(i)&&e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"issueType",label:"Issue Type",variant:"outlined",choices:v,component:We,required:!0})}),i.category&&e.jsxs(e.Fragment,{children:[e.jsx(St,{}),e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:l("Category Description"),children:S})}),I&&e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:l("Issue Type Description"),children:I})})]})]})}const ny=oe(ay,"Selection");function ws({field:s,form:t,label:a,initValue:n,displayValue:i="",container:r=!0,...l}){const o=()=>{t.setFieldValue(s.name,!s.value)},d=Os(t.errors,s.name)&&(Os(t.touched,s.name)||t.submitCount>0);A.useEffect(()=>{n!=null&&t.setFieldValue(s.name,n)},[n]);let c=s.value;return typeof c=="string"&&(c=!1),A.useEffect(()=>{typeof c=="string"&&t.setFieldValue(s.name,!1)},[c]),e.jsxs(p,{container:r,children:[e.jsx(sa,{control:e.jsx(ns,{...l,color:"primary",checked:c,onChange:o,"data-cy":`input-${s.name}`}),label:i?"":a,style:{whiteSpace:"nowrap"}}),i&&e.jsx(p,{size:9,children:e.jsx(L,{label:a,children:i})}),d&&Os(t.errors,s.name)&&e.jsx(Ls,{error:!0,"data-cy":"checkbox-error",children:Os(t.errors,s.name)})]})}const iy=T.p`
  font-size: 14px;
  color: #585858;
`;function lu(){const{t:s}=M();return e.jsx(iy,{children:s("Do you give your consent to UNICEF and its partners to view, edit and update your personal details and, if applicable, that of your household and dependants the purpose of the integrity UNICEFs beneficiary management system? Do you declare that the information you have provided is true and correct to the best of your knowledge?")})}const ry=T("a")`
  font-family: ${({theme:s})=>s.hctTypography.fontFamily};
  color: #000;
  font-size: 14px;
  line-height: 19px;
  max-width: ${s=>s.fullWidth?"100%":"200px"}
  overflow-wrap: break-word;
`;function Us({href:s,children:t,download:a=!1,fullWidth:n=!1}){return e.jsx(ry,{download:a,href:s,fullWidth:n,children:t})}function ly({values:s,programSlug:t}){const{baseUrl:a,businessArea:n,programId:i}=U(),{t:r}=M(),{selectedProgram:l}=Z(),o=l?.beneficiaryGroup,d=typeof s.selectedHousehold=="object"&&s.selectedHousehold!==null?s.selectedHousehold.id:s.selectedHousehold,{data:c,isLoading:u,error:h}=V({queryKey:["household",n,d,t,i],queryFn:()=>N.restBusinessAreasProgramsHouseholdsRetrieve({businessAreaSlug:n,id:d,programSlug:t}),enabled:!!d&&!!t});if(u)return e.jsx(Ne,{});if(h)return e.jsxs("div",{children:["Error loading ",o?.groupLabel," data"]});const m=c;return m?e.jsx(p,{container:!0,spacing:6,children:[{name:"questionnaire_size",label:r(`${o?.groupLabel} Size`),value:m.size,size:3},{name:"questionnaire_maleChildrenCount",label:r("Number of Male Children"),value:m.maleChildrenCount?.toString(),size:3},{name:"questionnaire_femaleChildrenCount",label:r("Number of Female Children"),value:m.femaleChildrenCount?.toString(),size:3},{name:"questionnaire_childrenDisabledCount",label:r("Number of Disabled Children"),value:m.childrenDisabledCount?.toString(),size:3},{name:"questionnaire_headOfHousehold",label:r(`Head of ${o?.groupLabel}`),value:m.headOfHousehold?e.jsx(Us,{href:`/${a}/population/individuals/${m.headOfHousehold.id}`,children:m.headOfHousehold.fullName}):"-",size:3},{name:"questionnaire_countryOrigin",label:r("Country of Origin"),value:m.countryOrigin,size:3},{name:"questionnaire_address",label:r("Address"),value:m.address,size:3},{name:"questionnaire_village",label:r("Village"),value:m.village,size:3},{name:"questionnaire_admin1",label:r("Administrative Level 1"),value:m.admin1?.name,size:3},{name:"questionnaire_admin2",label:r("Administrative Level 2"),value:m.admin2?.name,size:3},{name:"questionnaire_admin3",label:r("Administrative Level 3"),value:m.admin3?.name,size:3},{name:"questionnaire_admin4",label:r("Administrative Level 4"),value:m.admin4?.name,size:3},{name:"questionnaire_months_displaced_h_f",label:r("LENGTH OF TIME SINCE ARRIVAL"),value:m.flexFields?.months_displaced_h_f,size:3}].map(g=>e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:g.name,"data-cy":`input-${g.name}`,label:g.label,displayValue:g.value||"-",color:"primary",component:ws})},g.name))}):null}const ou=oe(ly,"HouseholdQuestionnaire"),oy=({values:s})=>{const{t}=M(),{baseUrl:a}=U(),{isSocialDctType:n,selectedProgram:i}=Z(),r=s.selectedIndividual||s.selectedHousehold.headOfHousehold,l=i?.beneficiaryGroup,o=n?[{name:"questionnaire_fullName",label:t(`${l?.memberLabel} Full Name`),value:e.jsx(Us,{href:`/${a}/population/individuals/${r.id}`,children:r.fullName}),size:3},{name:"questionnaire_birthDate",label:t("Birth Date"),value:r.birthDate,size:3},{name:"questionnaire_sex",label:t("Gender"),value:r.sex,size:3},{name:"questionnaire_phoneNo",label:t("Phone Number"),value:r.phoneNo,size:3},{name:"questionnaire_countryOrigin",label:t("Country of Origin"),value:r?.countryOrigin,size:3},{name:"questionnaire_address",label:t("Address"),value:r?.household?.address,size:3},{name:"questionnaire_village",label:t("Village"),value:r?.household?.village,size:3},{name:"questionnaire_adminLevel1",label:t("Administrative Level 1"),value:r?.household?.admin1?.name,size:3},{name:"questionnaire_adminLevel2",label:t("Administrative Level 2"),value:r?.household?.admin2?.name,size:3},{name:"questionnaire_adminLevel3",label:t("Administrative Level 3"),value:r?.household?.admin3?.name,size:3},{name:"questionnaire_adminLevel4",label:t("Administrative Level 4"),value:r?.household?.admin4?.name,size:3}]:[{name:"questionnaire_fullName",label:`${l?.memberLabel} full name`,value:e.jsx(Us,{href:`/${a}/population/individuals/${r.id}`,children:r.fullName}),size:3},{name:"questionnaire_birthDate",label:t("Birth Date"),value:r.birthDate,size:3},{name:"questionnaire_sex",label:t("Gender"),value:r.sex,size:3},{name:"questionnaire_phoneNo",label:t("Phone Number"),value:r.phoneNo,size:3},{name:"questionnaire_relationship",label:`Relationship to Head of ${l?.groupLabel}`,value:r.relationship,size:3}];return e.jsx(p,{container:!0,spacing:6,children:o.map(d=>e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{"data-cy":`input-${d.name}`,name:d.name,label:d.label,displayValue:d.value||"-",color:"primary",component:ws})},d.name))})},du=oe(oy,"IndividualQuestionnaire"),dy=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  border-top: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  padding: 15px 0;
`,cy=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  padding: 15px 0;
`;function uy({values:s,programSlug:t}){const{t:a}=M(),{selectedProgram:n,isSocialDctType:i}=Z(),r=n?.beneficiaryGroup;return e.jsxs(dy,{children:[e.jsxs(e.Fragment,{children:[s.selectedHousehold&&!i&&e.jsxs(P,{py:4,children:[e.jsx(ee,{variant:"subtitle2",children:`${r?.groupLabel} Questionnaire`}),e.jsx(P,{py:4,children:e.jsx(ou,{values:s,programSlug:t})})]}),s.selectedIndividual&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{variant:"subtitle2",children:`${r?.memberLabel} Questionnaire`}),e.jsx(P,{py:4,children:e.jsx(du,{values:s})}),e.jsx(cy,{})]})]}),e.jsx(lu,{}),e.jsx(B.Field,{name:"consent",label:a("Received Consent"),color:"primary",required:!0,fullWidth:!0,container:!1,component:ws})]})}const hy=oe(uy,"Verification");function my({flexField:s,householdId:t}){const{businessArea:a,programId:n}=U(),{selectedProgram:i}=Z(),{data:r}=V({queryKey:["household",a,t,n,i?.slug],queryFn:()=>N.restBusinessAreasProgramsHouseholdsRetrieve({businessAreaSlug:a,id:t,programSlug:n||i?.slug||""}),enabled:!!a&&!!t&&(!!n||!!i?.slug)});if(!r)return null;const l=r.flexFields?.[s.name];return e.jsx(P,{style:{height:"100%"},display:"flex",alignItems:"center",children:l?e.jsx(nt,{src:l}):e.jsx(P,{style:{height:"100%"},display:"flex",alignItems:"center",children:"-"})})}function py({field:s,value:t,values:a}){const{t:n}=M();let i;if(s?.name==="country"||s?.name==="country_origin"||s?.name==="admin_area_title")i=t||"-";else switch(s?.type){case"SELECT_ONE":i=s.choices.find(r=>r.value===t)?.labelEn||"-";break;case"SELECT_MANY":i=s.choices.find(r=>r.value===t)?.labelEn||"-",t instanceof Array&&(i=t.map(r=>s.choices.find(l=>l.value===r)?.labelEn||"-").join(", "));break;case"BOOL":i=t===null?"-":t?"Yes":"No";break;case"IMAGE":return e.jsx(p,{size:3,children:e.jsx(my,{flexField:s,householdId:a?.selectedHousehold?.id||null})});default:i=t}return e.jsx(p,{size:12,children:e.jsx(L,{label:n("Current Value"),value:i})})}const gy=T(ks)`
  input[type='number']::-webkit-inner-spin-button,
  input[type='number']::-webkit-outer-spin-button {
    -webkit-appearance: none;
  }
  input[type='number'] {
    -moz-appearance: textfield;
  }
`;function Ln({field:s,form:t,decoratorStart:a,decoratorEnd:n,...i}){const r=Os(t.errors,s.name)&&(Os(t.touched,s.name)||t.submitCount>0),l=d=>{["e","E","+","-"].includes(d.key)&&d.preventDefault()},o=d=>{d.target.value>999999999||t.setFieldValue(s.name,d.target.value.toString(),!0)};return e.jsx(gy,{...s,...i,name:s.name,id:`textField-${s.name}`,size:"small",value:s.value,onChange:o,error:r,autoComplete:"off",type:"number",helperText:r&&Os(t.errors,s.name),InputProps:{onKeyPress:l,startAdornment:a&&e.jsx(dt,{position:"start",children:a}),endAdornment:n&&e.jsx(dt,{position:"end",children:n})},inputProps:{"data-cy":`input-${s.name}`}})}function $l({isCurrent:s,isIndividual:t,field:a,form:n,flexField:i}){const[r,l]=A.useState(!1),{id:o}=ts(),{businessArea:d}=U(),{data:c}=V({queryKey:["grievanceTicket",o,d],queryFn:()=>N.restBusinessAreasGrievanceTicketsRetrieve({businessAreaSlug:d,id:o}),enabled:!!o});if(!c)return null;const u=t?c.ticketDetails?.individualDataUpdateTicketDetails?.individualData?.flexFields:c.ticketDetails?.householdDataUpdateTicketDetails?.householdData?.flexFields,h=s?u[i.name]?.previousValue:u[i.name]?.value;return e.jsx(P,{style:{height:"100%"},display:"flex",alignItems:"center",children:r||!h?e.jsx(P,{style:{height:"100%"},display:"flex",alignItems:"center",children:e.jsx(Gn,{field:a,form:n})}):e.jsx(nt,{src:h,variant:"pictureClose",closeHandler:()=>l(!0)})})}function Ki({field:s,form:t,choices:a,label:n,required:i=!1}){const r=a.find(c=>c.value===s.value),l=(c,u)=>{u?t.setFieldValue(s.name,u.value):t.setFieldValue(s.name,null)},o=!!(t.touched[s.name]&&t.errors[s.name]),d=o?t.errors[s.name]:"";return e.jsx(P,{mt:2,children:e.jsx(ha,{id:"combo-box-demo",size:"small",options:a,onChange:l,value:r,getOptionLabel:c=>c.labelEn,renderInput:c=>e.jsx(ks,{...c,label:n,variant:"outlined",required:i,error:o,helperText:d})})})}function cu({field:s,form:t,label:a,restEndpoint:n,fetchData:i,variables:r}){const[l,o]=A.useState(null),[d,c]=A.useState(""),[u,h]=A.useState([]),m=y=>y?.results?y.results.map(b=>({labelEn:`${b.name} - ${b.pCode}`,value:b.pCode})):[],{data:g,isLoading:x}=V({queryKey:["asyncAutocomplete",n,d,r],queryFn:async()=>n==="adminAreas"?N.restBusinessAreasGeoAreasList({businessAreaSlug:r?.businessArea||"",name:d||void 0}):null,enabled:!!r?.businessArea&&!!n});A.useEffect(()=>{if(g){const y=i?i(g):m(g);h(y||[])}},[g,i]);const f=(y,b)=>{o(b),b?t.setFieldValue(s.name,b.value):t.setFieldValue(s.name,null)},j=(y,b)=>{c(b)};return e.jsx(ha,{renderInput:y=>e.jsx(ks,{...y,label:a,variant:"outlined"}),filterOptions:y=>y,autoComplete:!0,noOptionsText:"No results",options:u,loading:x,isOptionEqualToValue:(y,b)=>y.value===b.value,getOptionLabel:y=>y.labelEn,value:l,onChange:f,onInputChange:j})}const xy=({name:s,field:t})=>{const{businessArea:a}=U(),n=je(),i=n.pathname.indexOf("new-ticket")!==-1,r=n.pathname.indexOf("edit-ticket")!==-1;let l;if(!t)return null;switch(t.type){case"DECIMAL":l={component:Ln};break;case"STRING":l={component:Se};break;case"INTEGER":l={component:Se,type:"number"};break;case"SELECT_ONE":l={choices:t.choices,component:Ki},t.name==="admin_area_title"?l={component:cu,restEndpoint:"adminAreas",fetchData:o=>o?.results?.map(d=>({labelEn:`${d.name} - ${d.pCode}`,value:d.pCode})),variables:{businessArea:a}}:l={choices:t.choices,component:We};break;case"SELECT_MANY":l={choices:t.choices,component:We,multiple:!0};break;case"SELECT_MULTIPLE":l={choices:t.choices,component:We};break;case"DATE":l={component:jt,decoratorEnd:e.jsx(bt,{color:"disabled"})};break;case"BOOL":l={component:Wi,required:t.required};break;case"IMAGE":l={component:i?Gn:$l,flexField:t,isIndividual:!1};break;default:l={}}return e.jsx(p,{size:12,children:e.jsx(B.Field,{name:s,fullWidth:!0,variant:"outlined",label:t.labelEn,required:t.required,disabled:r,...l})})},fy=({fields:s,household:t,index:a,itemValue:n,notAvailableFields:i,onDelete:r,values:l})=>{const{t:o}=M(),c=je().pathname.indexOf("edit-ticket")!==-1,u=s?.find(g=>g.name===n.fieldName),[,,h]=B.useField(`householdDataUpdateFields[${a}].isFlexField`),m=u?.isFlexField?n.fieldName:Zs(n.fieldName);return A.useEffect(()=>{h.setValue(u?.isFlexField)},[n.fieldName]),e.jsxs(p,{container:!0,size:12,spacing:2,alignItems:"center",children:[e.jsx(p,{size:4,children:e.jsx(B.Field,{name:`householdDataUpdateFields[${a}].fieldName`,fullWidth:!0,variant:"outlined",label:o("Field"),required:!0,component:We,choices:s?.filter(g=>!i.includes(g.name)||g.name===n?.fieldName)?.map(g=>({value:g.name,name:g.labelEn})),disabled:c})}),e.jsx(p,{size:4,children:e.jsx(py,{field:u,value:u?.isFlexField?t.flexFields[m]:t[m],values:l})}),e.jsx(p,{size:3,children:n.fieldName?e.jsx(xy,{name:`householdDataUpdateFields[${a}].fieldValue`,field:u}):null}),e.jsx(p,{size:1,children:n.fieldName&&e.jsx(Ve,{disabled:c,onClick:r,children:e.jsx(Rs,{})})})]})};function yy({values:s,setFieldValue:t,programSlug:a}){const{businessArea:n,programId:i}=U(),r=a||(i!=="all"?i:typeof s.selectedHousehold=="object"&&s.selectedHousehold?.program?.slug||typeof s.selectedHousehold=="object"&&s.selectedHousehold?.programSlug||typeof s.selectedIndividual=="object"&&s.selectedIndividual?.program?.slug||typeof s.selectedIndividual=="object"&&s.selectedIndividual?.programSlug),{data:l}=V({queryKey:["individualsChoices",n],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:n}),enabled:!!n}),o=l?.roleChoicesForGrievance||[],{t:d}=M(),c=je(),{selectedProgram:u}=Z(),h=u?.beneficiaryGroup,m=c.pathname.includes("edit-ticket"),g=s.selectedHousehold,{data:x,isLoading:f}=V({queryKey:["householdFields",n,i],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllEditHouseholdFieldsAttributesList({businessAreaSlug:n}),enabled:!!n}),{data:j,isLoading:y,refetch:b}=V({queryKey:[n,g.id,r,i],queryFn:()=>N.restBusinessAreasProgramsHouseholdsRetrieve({businessAreaSlug:n,id:g.id,programSlug:r}),enabled:!!(g&&n&&r)}),{data:C,isLoading:v}=V({queryKey:["householdMembers",n,g.id,r],queryFn:()=>N.restBusinessAreasProgramsHouseholdsMembersList({businessAreaSlug:n,id:g.id,programSlug:r}),enabled:!!(g&&n&&r)});A.useEffect(()=>{s.selectedHousehold&&b()},[s.selectedHousehold]),A.useEffect(()=>{(!s.householdDataUpdateFields||s.householdDataUpdateFields.length===0)&&t("householdDataUpdateFields",[{fieldName:null,fieldValue:""}])},[]),A.useEffect(()=>{if(C&&(!s.roles||s.roles.length===0)){const E=C.results.filter(D=>D.role&&D.role!==null);t("roles",E.map(D=>({individual:D.id,newRole:""})))}},[C,t,s.roles]);const S=x;if(!g)return e.jsx("div",{children:`You have to select a ${h?.groupLabel} earlier`});if(y||f||!j||v||!C)return e.jsx(Ne,{});const I=(s.householdDataUpdateFields||[]).map(E=>E.fieldName);return!m&&e.jsxs(e.Fragment,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:`${h?.groupLabel} Data`})}),e.jsx(p,{container:!0,spacing:3,children:e.jsx(B.FieldArray,{name:"householdDataUpdateFields",render:E=>e.jsxs(e.Fragment,{children:[(s.householdDataUpdateFields||[]).map((D,F)=>e.jsx(fy,{itemValue:D,index:F,household:j,fields:S,notAvailableFields:I,onDelete:()=>E.remove(F),values:s},`${F}-${D.fieldName}`)),e.jsx(p,{size:4,children:e.jsx(H,{color:"primary",startIcon:e.jsx(Et,{}),onClick:()=>{E.push({fieldName:null,fieldValue:null})},"data-cy":"button-add-new-field",children:d("Add new field")})})]})})}),e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:d("Roles in Household")})}),e.jsxs(p,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(p,{size:4,children:e.jsx("strong",{children:d("Full Name")})}),e.jsx(p,{size:4,children:e.jsx("strong",{children:d("Current Role")})}),e.jsx(p,{size:3,children:e.jsx("strong",{children:d("New Role")})}),e.jsx(p,{size:1}),(s.roles||[]).map((E,D)=>{const F=j.rolesInHousehold.find($=>$.individual.id===E.individual),w=(s.roles||[]).map(($,G)=>G!==D?$.individual:null),O=C.results.map($=>({value:$.id,label:$.fullName})).filter($=>!w.includes($.value)),k=!F;return e.jsxs(Js.Fragment,{children:[e.jsx(p,{size:4,children:e.jsx(B.Field,{name:`roles.${D}.individual`,component:We,label:d("Individual"),choices:O,fullWidth:!0})}),e.jsx(p,{size:4,children:F?sl[F.role]||F.role:"No role"}),e.jsx(p,{size:3,children:e.jsx(B.Field,{name:`roles.${D}.newRole`,component:We,label:d("New Role"),choices:o,fullWidth:!0})}),e.jsx(p,{size:1,children:k&&e.jsx(H,{color:"secondary",onClick:()=>{const $=[...s.roles||[]];$.splice(D,1),t("roles",$)},"data-cy":`button-remove-role-${D}`,children:e.jsx(Nn,{children:e.jsx(Rs,{})})})})]},E.individual+"-"+D)}),e.jsx(p,{size:12,sx:{marginTop:12},children:(()=>{const E=(s.roles||[]).map(w=>w.individual),D=C.results.filter(w=>!E.includes(w.id)),F=D.length===0;return e.jsx(Ms,{title:F?d("No more roles available"):"",placement:"top",arrow:!0,disableHoverListener:!F,children:e.jsx("span",{children:e.jsx(H,{color:"primary",startIcon:e.jsx(Et,{}),onClick:()=>{if(D.length>0){const w=D[0].id,O=j.rolesInHousehold.find(k=>k.individual.id===w);(!O||O.role!=="")&&t("roles",[...s.roles||[],{individual:w,newRole:""}])}},"data-cy":"button-add-new-role",disabled:F,children:d("Add a New Role")})})})})()})]})]})}const uu=oe(yy,"EditHouseholdDataChange"),by=({name:s,field:t})=>{const a=je(),n=a.pathname.indexOf("new-ticket")!==-1,i=a.pathname.indexOf("edit-ticket")!==-1;let r;if(!t)return null;switch(t.type){case"DECIMAL":r={fullWidth:!0,component:Ln};break;case"INTEGER":r={component:Se,type:"number"};break;case"STRING":r={fullWidth:!0,component:Se};break;case"SELECT_ONE":r={choices:t.choices,fullWidth:!0,component:We};break;case"SELECT_MANY":r={choices:t.choices,fullWidth:!0,component:We,multiple:!0};break;case"SELECT_MULTIPLE":r={choices:t.choices,fullWidth:!0,component:We};break;case"DATE":r={component:jt,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"})};break;case"BOOL":r={component:Wi,required:t.required};break;case"IMAGE":r={component:n?Gn:$l,flexField:t,isIndividual:!0};break;default:r={}}return e.jsx(p,{size:12,children:e.jsx(B.Field,{name:s,variant:"outlined",label:t.labelEn,required:t.required,"data-cy":`input-individual-data-${t.labelEn}`,disabled:i,...r})})};function hn({field:s,isCurrent:t,isIndividual:a}){const{id:n}=ts(),{businessAreaSlug:i}=U(),{data:r}=V({queryKey:["businessAreasGrievanceTicketsRetrieve",i,n],queryFn:()=>N.restBusinessAreasGrievanceTicketsRetrieve({businessAreaSlug:i,id:n})});if(!r)return null;const l=a?r?.ticketDetails?.individualData?.flex_fields:r.ticketDetails?.householdDataUpdateTicketDetails?.householdData?.flex_fields,o=t?l[s.name]?.previousValue:l[s.name]?.value;return o?e.jsx(nt,{src:o}):e.jsx(P,{style:{height:"100%"},display:"flex",alignItems:"center",children:"-"})}function hu({flexField:s,individualId:t}){const{businessArea:a,programId:n}=U(),{selectedProgram:i}=Z(),{data:r}=V({queryKey:["individual",a,n,t,i?.slug],queryFn:()=>N.restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:a,programSlug:n||i?.slug||"",id:t}),enabled:!!a&&!!t&&(!!n||!!i?.slug)});if(!r)return null;const l=r.flexFields?.[s.name];return e.jsx(P,{style:{height:"100%"},display:"flex",alignItems:"center",children:l?e.jsx(nt,{src:l}):e.jsx(P,{style:{height:"100%"},display:"flex",alignItems:"center",children:"-"})})}function On({isCurrent:s,individualId:t,photoPath:a}){const{businessArea:n}=U(),{selectedProgram:i}=Z(),{data:r}=V({queryKey:["individualPhotos",n,i?.slug,t],queryFn:()=>N.restBusinessAreasProgramsIndividualsPhotosRetrieve({businessAreaSlug:n,programSlug:i?.slug||"",id:t||""}),enabled:!!s&&!!n&&!!i?.slug&&!!t}),l=s?r?.photo:a||null;return l?e.jsx(nt,{src:l}):e.jsx(e.Fragment,{children:"-"})}function jy({field:s,value:t,values:a}){const i=je().pathname.indexOf("new-ticket")!==-1,{t:r}=M();let l=t;switch(s?.type){case"SELECT_ONE":l=s.choices.find(o=>o.value===t)?.labelEn||"-";break;case"SELECT_MANY":l=s.choices.find(o=>o.value===t)?.labelEn||"-",t instanceof Array&&(l=t.map(o=>s.choices.find(d=>d.value===o)?.labelEn||"-").join(", "));break;case"BOOL":l=t===null?"-":r(t?"Yes":"No");break;case"IMAGE":return s?.name==="photo"&&!s?.isFlexField?e.jsx(p,{size:3,children:e.jsx(On,{isCurrent:!0,individualId:a?.selectedIndividual?.id||null})}):i?e.jsx(p,{size:3,children:e.jsx(hu,{flexField:s,individualId:a?.selectedIndividual?.id||null})}):e.jsx(p,{size:3,children:e.jsx(hn,{isCurrent:!0,isIndividual:!0,field:s})});default:l=t}return e.jsx(p,{size:12,children:e.jsx(L,{label:"Current Value",value:l})})}const Ay=({fields:s,individual:t,index:a,itemValue:n,notAvailableFields:i,onDelete:r,values:l})=>{const d=je().pathname.indexOf("edit-ticket")!==-1,c=s.find(h=>h.name===n.fieldName),[,,u]=B.useField(`individualDataUpdateFields[${a}].isFlexField`);return A.useEffect(()=>{u.setValue(c?.isFlexField)},[n.fieldName]),e.jsxs(p,{container:!0,spacing:2,alignItems:"center",mb:2,children:[e.jsx(p,{size:4,children:e.jsx(B.Field,{name:`individualDataUpdateFields[${a}].fieldName`,fullWidth:!0,variant:"outlined",label:"Field",required:!0,disabled:d,component:We,choices:s.filter(h=>!i.includes(h.name)||h.name===n?.fieldName).map(h=>({value:h.name,name:h.labelEn}))})}),e.jsx(p,{size:4,children:e.jsx(jy,{field:c,value:c?.isFlexField?t.flexFields[n.fieldName]:t[Zs(n.fieldName)],values:l})}),e.jsx(p,{size:3,children:n.fieldName?e.jsx(by,{name:`individualDataUpdateFields[${a}].fieldValue`,field:c}):null}),e.jsx(p,{size:1,children:n.fieldName&&e.jsx(Ve,{disabled:d,onClick:r,children:e.jsx(Rs,{})})})]})},fr=T.div`
  filter: opacity(${({disabled:s})=>s?.5:1});
`;function _y({setFieldValue:s,values:t,document:a,arrayHelpers:n,addIndividualFieldsData:i,id:r}){const{t:l}=M(),[o,d]=A.useState(!1),u=je().pathname.indexOf("edit-ticket")!==-1,h=t?.individualDataUpdateDocumentsToRemove||[],m=h.includes(a.id);return o?e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:11,children:e.jsx(Ll,{id:r,onDelete:()=>Ba(t.individualDataUpdateDocumentsToEdit,a.id,n),countryChoices:i.countriesChoices,documentTypeChoices:i.documentTypeChoices,baseName:"individualDataUpdateDocumentsToEdit",isEdited:o,photoSrc:a.photo,setFieldValue:s,values:t},`${r}-${a.country}-${a.type.label}`)}),e.jsx(p,{size:1,children:e.jsx(P,{display:"flex",alignItems:"center",children:e.jsx(Ve,{onClick:()=>{n.remove({id:a.id,country:a.country.isoCode3,key:a.type.key,number:a.documentNumber,photo:a.photo}),d(!1)},children:e.jsx(Ct,{})})})})]}):e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:3,children:e.jsx(fr,{disabled:m,children:e.jsx(L,{label:l("ID TYPE"),value:a.type.label})})}),e.jsx(p,{size:3,children:e.jsx(fr,{disabled:m,children:e.jsx(L,{label:l("Country"),value:a.country.name})})}),e.jsx(p,{size:3,children:e.jsx(fr,{disabled:m,children:e.jsx(L,{label:l("ID Number"),value:a.documentNumber})})}),e.jsx(p,{size:2,children:e.jsx(nt,{showRotate:!1,src:a.photo})}),e.jsx(p,{size:1,children:m?e.jsx(P,{display:"flex",alignItems:"center",height:48,color:"red",children:l("REMOVED")}):!u&&e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsx(Ve,{onClick:()=>{s(`individualDataUpdateDocumentsToRemove[${h.length}]`,a.id)},children:e.jsx(Rs,{})}),e.jsx(Ve,{onClick:()=>{n.push({id:a.id,country:a.country.isoCode3,key:a.type.key,number:a.documentNumber,photo:a.photo}),d(!0)},children:e.jsx(ma,{})})]})})]},a.id)}function mu({setFieldValue:s,values:t,individual:a,addIndividualFieldsData:n}){const r=je().pathname.indexOf("edit-ticket")!==-1;return a?.documents?.length>0?e.jsx(p,{container:!0,size:12,spacing:3,children:e.jsx(B.FieldArray,{name:"individualDataUpdateDocumentsToEdit",render:l=>e.jsx(e.Fragment,{children:a.documents.map(o=>e.jsx(p,{size:12,children:e.jsx(_y,{setFieldValue:s,values:t,document:o,id:o.id,arrayHelpers:l,addIndividualFieldsData:n})},o.id))})})}):r&&e.jsx(P,{ml:2,children:"-"})}const yr=T.div`
  filter: opacity(${({disabled:s})=>s?.5:1});
`;function Py({setFieldValue:s,values:t,identity:a,arrayHelpers:n,addIndividualFieldsData:i,id:r}){const o=je().pathname.includes("edit-ticket"),{t:d}=M(),[c,u]=A.useState(!1),h=t?.individualDataUpdateIdentitiesToRemove||[],m=h.includes(a.id);return c?e.jsxs(p,{container:!0,alignItems:"center",spacing:3,children:[e.jsx(Nl,{id:r.toString(),onDelete:()=>Ba(t.individualDataUpdateDocumentsToEdit,a.id.toString(),n),countryChoices:i.countriesChoices,identityTypeChoices:i.identityTypeChoices,baseName:"individualDataUpdateIdentitiesToEdit",isEdited:c,values:t},`${r}-${a.number}-${a.partner}`),e.jsx(P,{display:"flex",alignItems:"center",children:e.jsx(Ve,{onClick:()=>{n.remove({country:a.country.isoCode3,partner:a.partner,number:a.number}),u(!1)},children:e.jsx(Ct,{})})})]}):e.jsxs(p,{container:!0,alignItems:"center",spacing:3,children:[e.jsx(p,{size:4,children:e.jsx(yr,{disabled:m,children:e.jsx(L,{label:d("ID AGENCY1"),value:a.partner})})}),e.jsx(p,{size:4,children:e.jsx(yr,{disabled:m,children:e.jsx(L,{label:d("Country"),value:a.country.name})})}),e.jsx(p,{size:3,children:e.jsx(yr,{disabled:m,children:e.jsx(L,{label:d("ID Number"),value:a.number})})}),e.jsx(p,{size:1,children:m?e.jsx(P,{display:"flex",alignItems:"center",height:48,color:"red",children:d("REMOVED")}):!o&&e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsx(Ve,{onClick:()=>{s(`individualDataUpdateIdentitiesToRemove[${h.length}]`,a.id)},children:e.jsx(Rs,{})}),e.jsx(Ve,{onClick:()=>{n.push({id:a.id,country:a.country.isoCode3,partner:a.partner,number:a.number}),u(!0)},children:e.jsx(ma,{})})]})})]},a.id)}function Cy({setFieldValue:s,values:t,individual:a,addIndividualFieldsData:n}){const r=je().pathname.indexOf("edit-ticket")!==-1;return a?.identities?.length>0?e.jsx(p,{container:!0,spacing:3,children:e.jsx(B.FieldArray,{name:"individualDataUpdateIdentitiesToEdit",render:l=>e.jsx(e.Fragment,{children:a.identities.map(o=>e.jsx(p,{size:12,children:e.jsx(Py,{setFieldValue:s,values:t,identity:o,id:o.id,arrayHelpers:l,addIndividualFieldsData:n})},o.id))})})}):r&&e.jsx(P,{ml:2,children:"-"})}function pu({addIndividualFieldsData:s,values:t,setFieldValue:a}){const{t:n}=M(),r=je().pathname.indexOf("edit-ticket")!==-1;return e.jsx(p,{container:!0,spacing:3,children:e.jsx(B.FieldArray,{name:"individualDataUpdateFieldsDocuments",render:l=>e.jsxs(e.Fragment,{children:[t.individualDataUpdateFieldsDocuments?.map(o=>e.jsx(p,{size:12,children:e.jsx(Ll,{id:o?.id,onDelete:()=>Ba(t.individualDataUpdateFieldsDocuments,o?.id,l),countryChoices:s.countriesChoices,documentTypeChoices:s.documentTypeChoices,baseName:"individualDataUpdateFieldsDocuments",setFieldValue:a,values:t})},`${o?.id}-${o?.country}-${o?.type?.key}`)),e.jsx(p,{size:8}),e.jsx(p,{size:12,children:e.jsx(H,{color:"primary",disabled:r,onClick:()=>{l.push({id:crypto.randomUUID(),country:null,key:null,number:""})},startIcon:e.jsx(Et,{}),children:n("Add Document")})})]})})})}const Ey=({addIndividualFieldsData:s,values:t})=>{const n=je().pathname.indexOf("edit-ticket")!==-1,{t:i}=M();return e.jsx(p,{container:!0,spacing:3,children:e.jsx(B.FieldArray,{name:"individualDataUpdateFieldsIdentities",render:r=>e.jsxs(e.Fragment,{children:[t.individualDataUpdateFieldsIdentities?.map(l=>e.jsx(p,{size:12,children:e.jsx(Nl,{id:l?.id,onDelete:()=>Ba(t.individualDataUpdateFieldsIdentities,l?.id,r),countryChoices:s.countriesChoices,identityTypeChoices:s.identityTypeChoices,baseName:"individualDataUpdateFieldsIdentities",values:t})},`${l?.id}-${l?.country}-${l?.partner}`)),e.jsx(p,{size:8}),e.jsx(p,{size:12,children:e.jsx(H,{color:"primary",onClick:()=>{r.push({id:crypto.randomUUID(),country:null,partner:null,number:""})},startIcon:e.jsx(Et,{}),disabled:n,children:i("Add Identity")})})]})})})};function gu({id:s,baseName:t,onDelete:a,account:n,values:i,accountTypeChoices:r,accountFinancialInstitutionChoices:l}){const{t:o}=M(),d=Ai(i[t],s),c=`${t}.${d}`,h=je().pathname.indexOf("edit-ticket")!==-1,m=`${c}.dataFields`,g=(j,y)=>j?e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:o("Current Value"),value:y(j)})}):null,x=n?5:8,f=l.find(j=>j.value===n?.financialInstitution)?.name||n?.financialInstitution;return e.jsxs(e.Fragment,{children:[e.jsx(p,{size:{xs:11}}),e.jsx(p,{size:{xs:1},children:e.jsx(Ve,{disabled:h,onClick:a,children:e.jsx(Rs,{})})}),e.jsxs(A.Fragment,{children:[e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:o("Account Item"),value:"Account Type"})}),e.jsx(p,{size:{xs:8},children:e.jsx(B.Field,{name:`${c}.accountType`,variant:"outlined",label:o("New Value"),component:We,choices:r,disabled:!!n,required:!0})})]},"type"),e.jsxs(A.Fragment,{children:[e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:o("Account Item"),value:"Number"})}),g(n,j=>j.number),e.jsx(p,{size:{xs:x},children:e.jsx(B.Field,{fullWidth:!0,name:`${c}.number`,variant:"outlined",label:o("New Value"),component:Se,required:!0})})]},"number"),e.jsxs(A.Fragment,{children:[e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:o("Account Item"),value:"Financial Institution"})}),g(n,()=>f),e.jsx(p,{size:{xs:x},children:e.jsx(B.Field,{name:`${c}.financialInstitution`,variant:"outlined",label:o("New Value"),component:We,choices:l,required:!0})})]},"financialInstitution"),e.jsx(B.FieldArray,{name:m,children:({push:j,remove:y,form:b})=>e.jsxs(e.Fragment,{children:[b.values[t][Ai(i[t],s)]?.dataFields?.map((C,v)=>e.jsxs(A.Fragment,{children:[e.jsx(p,{size:{xs:4},children:e.jsx(B.Field,{name:`${m}.${v}.key`,component:Se,label:o("Field Name"),variant:"outlined",fullWidth:!0,disabled:!!n&&!C.isNew,required:!0})}),g(n,S=>S.dataFields.find(I=>C.key===I.key)?.value),e.jsx(p,{size:{xs:x-1},children:e.jsx(B.Field,{name:`${m}.${v}.value`,component:Se,label:o("Field Value"),variant:"outlined",fullWidth:!0,required:!0})}),e.jsx(p,{size:{xs:1},children:C.isNew&&e.jsx(Ve,{onClick:()=>y(v),children:e.jsx(Rs,{})})})]},v)),e.jsx(p,{size:{xs:12},children:e.jsx(H,{variant:"outlined",startIcon:e.jsx(pa,{}),onClick:()=>j({key:"",value:"",isNew:!0}),children:o("Add Field")})})]})})]})}function vy({values:s,account:t,arrayHelpers:a,id:n,individualChoicesData:i}){const l=je().pathname.includes("edit-ticket"),[o,d]=A.useState(!1),c=t.dataFields,u=i.accountFinancialInstitutionChoices.find(h=>h.value===t.financialInstitution)?.name||t.financialInstitution;return o?e.jsxs(e.Fragment,{children:[e.jsx(gu,{id:n,baseName:"individualDataUpdateAccountsToEdit",isEdited:o,account:t,values:s,accountTypeChoices:i.accountTypeChoices,accountFinancialInstitutionChoices:i.accountFinancialInstitutionChoices,onDelete:()=>{}},`${n}-${t.id}`),e.jsx(P,{display:"flex",alignItems:"center",children:e.jsx(H,{variant:"outlined",color:"primary",startIcon:e.jsx(Ct,{}),onClick:()=>{a.remove({id:t.id,...t.dataFields}),d(!1)},children:"Cancel Edit"})})]}):e.jsxs(A.Fragment,{children:[e.jsx(p,{size:4,children:e.jsx(L,{label:"type",value:String(t.name)})},"type"),e.jsx(p,{size:4,children:e.jsx(L,{label:"Number",value:t.number})}),e.jsx(p,{size:4,children:e.jsx(L,{label:"Financial Institution",value:u})}),c.map(({key:h,value:m})=>{const g=String(m);return e.jsx(p,{size:4,children:e.jsx(L,{label:h,value:g})},h)}),e.jsx(p,{size:11}),e.jsx(p,{size:1,children:e.jsx(P,{display:"flex",alignItems:"center",children:e.jsx(Ve,{onClick:()=>{a.push({id:t.id,dataFields:[...t.dataFields],financialInstitution:t.financialInstitution,number:t.number,accountType:t.accountTypeKey}),d(!0)},disabled:l,children:e.jsx(ma,{})})})})]},t.id)}function xu({values:s,individual:t,individualChoicesData:a}){const i=je().pathname.indexOf("edit-ticket")!==-1;return e.jsx(p,{container:!0,spacing:3,direction:"column",children:e.jsx(B.FieldArray,{name:"individualDataUpdateAccountsToEdit",render:r=>t?.accounts?.length>0?e.jsx(e.Fragment,{children:t.accounts.map(l=>e.jsx(p,{size:12,children:e.jsx(p,{container:!0,direction:"row",alignItems:"center",spacing:3,children:e.jsx(vy,{values:s,account:l,id:l.id,arrayHelpers:r,individualChoicesData:a})})},l.id))}):i&&e.jsx(P,{ml:2,children:"-"})})})}function fu({values:s,individualChoicesData:t}){const{t:a}=M(),i=je().pathname.indexOf("edit-ticket")!==-1;return e.jsx(p,{container:!0,spacing:3,children:e.jsx(B.FieldArray,{name:"individualDataUpdateFieldsAccounts",render:r=>e.jsxs(e.Fragment,{children:[s.individualDataUpdateFieldsAccounts?.map(l=>{const o=l.node?.id||l.id;return e.jsx(gu,{id:o,onDelete:()=>Ba(s.individualDataUpdateFieldsAccounts,o,r),baseName:"individualDataUpdateFieldsAccounts",values:s,accountTypeChoices:t.accountTypeChoices,accountFinancialInstitutionChoices:t.accountFinancialInstitutionChoices},o)}),e.jsx(p,{size:8}),e.jsx(p,{size:12,children:e.jsx(H,{color:"primary",onClick:()=>{r.push({id:crypto.randomUUID()})},disabled:i,startIcon:e.jsx(Et,{}),children:a("Add Account")})})]})})})}const si=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  padding: 15px 0;
`;function Sy({values:s,setFieldValue:t,programSlug:a}){const{t:n}=M(),i=je(),{selectedProgram:r}=Z(),{businessArea:l,programId:o}=U(),d=r?.beneficiaryGroup,c=a||(o!=="all"?o:typeof s.selectedHousehold=="object"&&s.selectedHousehold?.program?.slug||typeof s.selectedHousehold=="object"&&s.selectedHousehold?.programSlug||typeof s.selectedIndividual=="object"&&s.selectedIndividual?.program?.slug||typeof s.selectedIndividual=="object"&&s.selectedIndividual?.programSlug),u=i.pathname.indexOf("edit-ticket")!==-1,h=s.selectedIndividual,{data:m,isLoading:g}=V({queryKey:["allAddIndividualsFieldsAttributes",l],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllAddIndividualsFieldsAttributesList({businessAreaSlug:l}),enabled:!!l}),{data:x,isLoading:f}=V({queryKey:["grievanceTicketsChoices",l],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:l}),enabled:!!l}),{data:j,isLoading:y}=V({queryKey:["individualsChoices",l],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:l}),enabled:!!l}),{data:b,isLoading:C}=V({queryKey:["countriesList"],queryFn:()=>N.restChoicesCountriesList()}),{data:v,isLoading:S}=V({queryKey:["individual",l,h?.id,c,o],queryFn:()=>N.restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:l,id:h.id,programSlug:c}),enabled:!!(h&&l&&c)});if(A.useEffect(()=>{(!s.individualDataUpdateFields||s.individualDataUpdateFields.length===0)&&t("individualDataUpdateFields",[{fieldName:null,fieldValue:null}])},[]),!h)return e.jsx("div",{children:n(`You have to select a ${d?.memberLabel} earlier`)});if(g||S||f||y||C||!v||!m)return e.jsx("div",{children:e.jsx(Ne,{})});const I={allAddIndividualsFieldsAttributes:m||[],countriesChoices:b||[],documentTypeChoices:x?.documentTypeChoices||[],identityTypeChoices:j?.identityTypeChoices||[]},E=(s.individualDataUpdateFields||[]).map(D=>D.fieldName);return e.jsxs(e.Fragment,{children:[!u&&e.jsxs(si,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Bio Data")})}),e.jsx(p,{container:!0,spacing:3,children:e.jsx(B.FieldArray,{name:"individualDataUpdateFields",render:D=>e.jsxs(e.Fragment,{children:[s.individualDataUpdateFields.map((F,w)=>e.jsx(p,{size:12,children:e.jsx(Ay,{itemValue:F,index:w,individual:v,fields:I.allAddIndividualsFieldsAttributes,notAvailableFields:E,onDelete:()=>D.remove(w),values:s})},`${w}-${F?.fieldName}`)),e.jsx(p,{size:4,children:e.jsx(H,{color:"primary",onClick:()=>{D.push({fieldName:null,fieldValue:""})},startIcon:e.jsx(Et,{}),"data-cy":"button-add-new-field",disabled:u,children:n("Add new field")})})]})})})]}),e.jsx(si,{children:e.jsxs(P,{mt:3,children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Documents: change/upload of document with other info (country, number etc.): add label beneficiary personal documents")})}),e.jsx(mu,{values:s,setFieldValue:t,individual:v,addIndividualFieldsData:I}),!u&&e.jsx(pu,{values:s,addIndividualFieldsData:I,setFieldValue:t})]})}),e.jsx(si,{children:e.jsxs(P,{mt:3,children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Identities")})}),e.jsx(Cy,{values:s,setFieldValue:t,individual:v,addIndividualFieldsData:I}),!u&&e.jsx(Ey,{values:s,addIndividualFieldsData:I})]})}),e.jsx(si,{children:e.jsxs(P,{mt:3,children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Accounts")})}),e.jsx(xu,{values:s,setFieldValue:t,individual:v,individualChoicesData:j}),!u&&e.jsx(fu,{values:s,individualChoicesData:j})]})})]})}const yu=oe(Sy,"EditIndividualDataChange"),Iy=({name:s,field:t})=>{const a=je(),n=a.pathname.indexOf("new-ticket")!==-1,i=a.pathname.indexOf("edit-ticket")!==-1,{businessArea:r}=U();let l;if(!t)return null;switch(t.type){case"DECIMAL":l={fullWidth:!0,component:Ln};break;case"INTEGER":l={component:Se,type:"number"};break;case"STRING":l={fullWidth:!0,component:Se};break;case"SELECT_ONE":l={choices:t.choices,component:Ki},t.name==="admin_area_title"?l={component:cu,restEndpoint:"adminAreas",fetchData:o=>o?.results?.map(d=>({labelEn:`${d.name} - ${d.pCode}`,value:d.pCode})),variables:{businessArea:r}}:l={choices:t.choices,component:We};break;case"SELECT_MANY":l={choices:t.choices,fullWidth:!0,component:We,multiple:!0};break;case"SELECT_MULTIPLE":l={choices:t.choices,fullWidth:!0,component:We};break;case"DATE":l={component:jt,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"})};break;case"BOOL":l={component:Wi,required:t.required};break;case"IMAGE":l={component:n?Gn:$l,flexField:t,isIndividual:!0};break;default:l={}}return e.jsx(p,{size:3,children:e.jsx(B.Field,{name:s,variant:"outlined",label:t.labelEn,required:t.required,"data-cy":`input-individual-data-${t.labelEn}`,disabled:i,...l})})};function Dy({field:s,value:t,values:a}){const i=je().pathname.indexOf("new-ticket")!==-1,{t:r}=M();let l=t;switch(s?.type){case"SELECT_ONE":l=s.choices.find(o=>o.value===t)?.labelEn||"-";break;case"SELECT_MANY":l=s.choices.find(o=>o.value===t)?.labelEn||"-",t instanceof Array&&(l=t.map(o=>s.choices.find(d=>d.value===o)?.labelEn||"-").join(", "));break;case"BOOL":l=t===null?"-":r(t?"Yes":"No");break;case"IMAGE":return i?e.jsx(p,{size:3,children:e.jsx(hu,{flexField:s,individualId:a?.selectedIndividual?.id||null})}):e.jsx(p,{size:3,children:e.jsx(hn,{isCurrent:!0,isIndividual:!0,field:s})});default:l=t}return e.jsx(p,{size:12,children:e.jsx(L,{label:"Current Value",value:l})})}const Ty=({fields:s,individual:t,index:a,itemValue:n,notAvailableFields:i,onDelete:r,values:l})=>{const d=je().pathname.indexOf("edit-ticket")!==-1,c=s.find(h=>h.name===n.fieldName),[,,u]=B.useField(`individualDataUpdateFields[${a}].isFlexField`);return A.useEffect(()=>{u.setValue(c?.isFlexField)},[n.fieldName]),e.jsxs(p,{container:!0,spacing:2,alignItems:"center",mb:2,children:[e.jsx(p,{size:4,children:e.jsx(B.Field,{name:`individualDataUpdateFields[${a}].fieldName`,fullWidth:!0,variant:"outlined",label:"Field",required:!0,disabled:d,component:We,choices:s.filter(h=>!i.includes(h.name)||h.name===n?.fieldName).map(h=>({value:h.name,name:h.labelEn}))})}),e.jsx(p,{size:4,children:e.jsx(Dy,{field:c,value:c?.isFlexField?t.flexFields[n.fieldName]:t[Zs(n.fieldName)],values:l})}),n.fieldName?e.jsx(Iy,{name:`individualDataUpdateFields[${a}].fieldValue`,field:c}):null,e.jsx(p,{size:1,children:n.fieldName&&e.jsx(Ve,{disabled:d,onClick:r,children:e.jsx(Rs,{})})})]})},br=T.div`
  border-bottom: 1px solid #d8d8d8;
  padding: 15px 0;
`;function Ry({values:s,setFieldValue:t,programSlug:a}){const{t:n}=M(),i=je(),{businessArea:r,programId:l}=U(),o=i.pathname.indexOf("edit-ticket")!==-1,d=s.selectedIndividual,c=a||(l!=="all"?l:typeof s.selectedHousehold=="object"&&s.selectedHousehold?.program?.slug||typeof s.selectedHousehold=="object"&&s.selectedHousehold?.programSlug||typeof s.selectedIndividual=="object"&&s.selectedIndividual?.program?.slug||typeof s.selectedIndividual=="object"&&s.selectedIndividual?.programSlug),{data:u,isLoading:h}=V({queryKey:["allEditPeopleFieldsAttributes",r],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllEditPeopleFieldsAttributesList({businessAreaSlug:r})}),{data:m,isLoading:g}=V({queryKey:["grievanceTicketsChoices",r],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:r})}),{data:x,isLoading:f}=V({queryKey:["individualsChoices",r],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:r})}),{data:j,isLoading:y}=V({queryKey:["countriesList"],queryFn:()=>N.restChoicesCountriesList()}),{data:b,isLoading:C}=V({queryKey:["businessAreaProgramIndividual",r,c,d?.id,s.selectedIndividual],queryFn:()=>N.restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:r,programSlug:c,id:d?.id}),enabled:!!(d&&r&&c)});if(A.useEffect(()=>{(!s.individualDataUpdateFields||s.individualDataUpdateFields.length===0)&&t("individualDataUpdateFields",[{fieldName:null,fieldValue:null}])},[]),!d)return e.jsx("div",{children:n("You have to select an individual earlier")});if(h||C||g||f||y||!b||!u)return e.jsx("div",{children:e.jsx(Ne,{})});const v={results:u||[],countriesChoices:j||[],documentTypeChoices:m?.documentTypeChoices||[],identityTypeChoices:x?.identityTypeChoices||[]},S=(s.individualDataUpdateFields||[]).map(I=>I.fieldName);return e.jsxs(e.Fragment,{children:[!o&&e.jsxs(br,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Bio Data")})}),e.jsx(B.FieldArray,{name:"individualDataUpdateFields",render:I=>e.jsxs(e.Fragment,{children:[s.individualDataUpdateFields.map((E,D)=>e.jsx(p,{size:12,children:e.jsx(Ty,{itemValue:E,index:D,individual:b,fields:v.results,notAvailableFields:S,onDelete:()=>I.remove(D),values:s},`${D}-${E?.fieldName}`)},`${D}-${E?.fieldName}`)),e.jsx(p,{size:4,children:e.jsx(H,{color:"primary",onClick:()=>{I.push({fieldName:null,fieldValue:""})},startIcon:e.jsx(Et,{}),"data-cy":"button-add-new-field",disabled:o,children:n("Add new field")})})]})})]}),e.jsx(br,{children:e.jsxs(P,{mt:3,children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Documents: change/upload of document with other info (country, number etc.): add label beneficiary personal documents")})}),e.jsx(mu,{values:s,setFieldValue:t,individual:b,addIndividualFieldsData:v}),!o&&e.jsx(pu,{values:s,addIndividualFieldsData:v,setFieldValue:t})]})}),e.jsx(br,{children:e.jsxs(P,{mt:3,children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Accounts")})}),e.jsx(xu,{values:s,setFieldValue:t,individual:b,individualChoicesData:x}),!o&&e.jsx(fu,{values:s,individualChoicesData:x})]})})]})}const Fy=oe(Ry,"EditPeopleDataChange"),Ny=T.div`
  ${({index:s,value:t})=>s!==t&&on.css`
      display: none;
    `}
`;function Qt({children:s,index:t,value:a}){return e.jsx(Ny,{index:t,value:a,children:s})}const Tt=Ft(Ma)({"&.Mui-selected":{outline:"none"},"&:focus":{outline:"none"},"&:focus-visible":{outline:"none"}}),La=Ft(ol)({"&.Mui-selected":{outline:"none"},"&:focus":{outline:"none"},"&:focus-visible":{outline:"none"}}),Ul=({onChange:s,type:t,number:a,choices:n=[]})=>{const{t:i}=M();return e.jsxs(p,{container:!0,size:{xs:6},spacing:0,children:[e.jsx(p,{size:{xs:4},children:e.jsx(He,{onChange:r=>s("documentType",r.target.value),label:i("Document Type"),value:t,borderRadius:"0px 4px 4px 0px","data-cy":"filters-document-type",fullWidth:!0,disableClearable:!0,children:n.map(({name:r,value:l})=>e.jsx(de,{value:l,children:r},l))})}),e.jsx(p,{size:{xs:8},children:e.jsx(Cs,{value:a,label:i("Document Number"),placeholder:"Document Number",onChange:r=>s("documentNumber",r.target.value),"data-cy":"filters-document-number",borderRadius:"4px 0px 0px 4px"})})]})},Ly=T(ks)`
  input[type='number']::-webkit-inner-spin-button,
  input[type='number']::-webkit-outer-spin-button {
    -webkit-appearance: none;
  }
  input[type='number'] {
    -moz-appearance: textfield;
  }
`;function js({topLabel:s=null,value:t,placeholder:a,onChange:n,icon:i=null,...r}){return e.jsxs(P,{display:"flex",flexDirection:"column",children:[s?e.jsx(Fl,{children:s}):null,e.jsx(Ly,{...r,value:t,size:"small",placeholder:a,onChange:n,variant:"outlined",type:"number",InputProps:i?{startAdornment:e.jsx(dt,{position:"start",children:i})}:null})]})}function bu({filter:s,programs:t,choicesData:a,setFilter:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,isOnPaper:o=!0}){const{t:d}=M(),{selectedProgram:c}=Z(),u=c?.beneficiaryGroup,h=ge(),m=je(),{isAllPrograms:g}=U(),{handleFilterChange:x,applyFilterChanges:f,clearFilter:j}=Ss(i,h,m,s,n,r,l),y=()=>{f()},b=()=>{j()},C=Oc(u);return e.jsx(Ns,{clearHandler:b,applyHandler:y,isOnPaper:o,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{label:d("Search"),value:s.search,onChange:v=>x("search",v.target.value),"data-cy":"hh-filters-search"})}),e.jsx(Ul,{onChange:x,type:s.documentType,number:s.documentNumber,choices:a?.documentTypeChoices}),g&&e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:v=>x("program",v.target.value),label:d("Programme"),value:s.program,fullWidth:!0,icon:e.jsx(Si,{}),"data-cy":"hh-filters-program",children:t?.map(v=>e.jsx(de,{value:v.id,children:v.name},v.id))})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:v=>x("residenceStatus",v.target.value),label:d("Residence Status"),fullWidth:!0,value:s.residenceStatus,icon:e.jsx(gc,{}),"data-cy":"hh-filters-residence-status",children:a.residenceStatusChoices?.map(v=>e.jsx(de,{value:v.value,children:v.name},v.value))})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{topLabel:`${u?.groupLabel} ${d("Size")}`,value:s.householdSizeMin,placeholder:d("From"),icon:e.jsx(ct,{}),fullWidth:!0,onChange:v=>x("householdSizeMin",v.target.value),"data-cy":"hh-filters-household-size-from"})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{value:s.householdSizeMax,placeholder:d("To"),icon:e.jsx(ct,{}),fullWidth:!0,onChange:v=>x("householdSizeMax",v.target.value),"data-cy":"hh-filters-household-size-to"})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:v=>x("orderBy",v.target.value),label:d("Sort by"),value:s.orderBy,"data-cy":"hh-filters-order-by",disableClearable:!0,children:C?.map(v=>e.jsx(de,{value:v.value,children:v.name},v.value))})}),e.jsx(p,{size:{xs:3},children:e.jsxs(He,{onChange:v=>x("withdrawn",v.target.value),label:d("Status"),value:s.withdrawn,"data-cy":"hh-filters-status",children:[e.jsx(de,{value:"null",children:"All"},"all"),e.jsx(de,{value:"false",children:"Active"},"active"),e.jsx(de,{value:"true",children:"Inactive (Withdrawn)"},"inactive")]})}),g&&e.jsx(p,{size:{xs:3},children:e.jsxs(He,{onChange:v=>x("programState",v.target.value),label:d("Programme State"),value:s.programState,fullWidth:!0,disableClearable:!0,"data-cy":"filters-program-state",children:[e.jsx(de,{value:"active",children:d("Active Programmes")}),e.jsx(de,{value:"all",children:d("All Programmes")})]})}),e.jsx(p,{size:{xs:3},children:e.jsx(ua,{name:"admin1",level:1,value:s.admin1,filter:s,setFilter:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,disabled:s.admin2,dataCy:"hh-filters-admin1"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ua,{name:"admin2",level:2,value:s.admin2,filter:s,setFilter:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,disabled:s.admin1,dataCy:"hh-filters-admin2"})})]})})}function Vl({filter:s,programs:t,choicesData:a,setFilter:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,isOnPaper:o=!0}){const{t:d}=M(),c=ge(),u=je(),{isAllPrograms:h}=U(),{selectedProgram:m}=Z(),g=m?.beneficiaryGroup,{handleFilterChange:x,applyFilterChanges:f,clearFilter:j}=Ss(i,c,u,s,n,r,l),y=()=>{f()},b=()=>{j()},C=m?.dataCollectingType?.type?.toUpperCase()==="SOCIAL",v=kc(g);return e.jsx(Ns,{clearHandler:b,applyHandler:y,isOnPaper:o,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{label:d("Search"),value:s.search,onChange:S=>x("search",S.target.value),"data-cy":"ind-filters-search"})}),e.jsx(Ul,{onChange:x,type:s.documentType,number:s.documentNumber,choices:a?.documentTypeChoices}),h&&e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:S=>x("program",S.target.value),label:d("Programme"),value:s.program,fullWidth:!0,icon:e.jsx(Si,{}),"data-cy":"filters-program",children:t?.map(S=>e.jsx(de,{value:S.id,children:S.name},S.id))})}),C&&e.jsx(p,{size:{xs:3},children:e.jsx(ua,{level:2,name:"admin2",value:s.admin2,setFilter:n,filter:s,initialFilter:i,appliedFilter:r,setAppliedFilter:l,dataCy:"ind-filters-admin2"})}),e.jsx(p,{size:{xs:3},children:e.jsxs(He,{onChange:S=>x("sex",S.target.value),value:s.sex,label:d("Gender"),"data-cy":"ind-filters-gender",fullWidth:!0,children:[e.jsx(de,{value:"FEMALE",children:d("Female")}),e.jsx(de,{value:"MALE",children:d("Male")}),e.jsx(de,{value:"OTHER",children:d("Other")}),e.jsx(de,{value:"NOT_COLLECTED",children:d("Not Collected")}),e.jsx(de,{value:"NOT_ANSWERED",children:d("Not Answered")})]})}),e.jsx(p,{size:{xs:2},children:e.jsx(js,{fullWidth:!0,topLabel:d("Age"),placeholder:d("From"),value:s.ageMin,"data-cy":"ind-filters-age-from",onChange:S=>{S.target.value<0||S.target.value>120||x("ageMin",S.target.value)},icon:e.jsx(fi,{})})}),e.jsx(p,{size:{xs:2},children:e.jsx(js,{fullWidth:!0,placeholder:d("To"),value:s.ageMax,"data-cy":"ind-filters-age-to",onChange:S=>{S.target.value<0||S.target.value>120||x("ageMax",S.target.value)},icon:e.jsx(fi,{})})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:S=>x("flags",S.target.value),label:d("Flags"),multiple:!0,fullWidth:!0,value:s.flags,"data-cy":"ind-filters-flags",children:a?.flagChoices.map((S,I)=>e.jsx(de,{value:S.value,"data-cy":`select-option-${I}`,children:S.name},S.value))})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:S=>x("orderBy",S.target.value),label:d("Sort by"),value:s.orderBy,fullWidth:!0,"data-cy":"ind-filters-order-by",disableClearable:!0,children:v.map(S=>e.jsx(de,{value:S.value,children:S.name},S.value))})}),e.jsx(p,{size:{xs:2},children:e.jsxs(He,{onChange:S=>x("status",S.target.value),label:d("Status"),value:s.status,"data-cy":"ind-filters-status",children:[e.jsx(de,{value:"ACTIVE",children:"Active"},"active"),e.jsx(de,{value:"DUPLICATE",children:"Duplicate"},"duplicate"),e.jsx(de,{value:"WITHDRAWN",children:"Withdrawn"},"withdrawn")]})}),e.jsx(p,{size:{xs:2},children:e.jsx(ms,{topLabel:d("Registration Date"),placeholder:d("From"),onChange:S=>x("lastRegistrationDateMin",S),value:s.lastRegistrationDateMin,dataCy:"ind-filters-reg-date-from"})}),e.jsx(p,{size:{xs:2},children:e.jsx(ms,{placeholder:d("To"),onChange:S=>x("lastRegistrationDateMax",S),value:s.lastRegistrationDateMax,dataCy:"ind-filters-reg-date-to"})}),h&&e.jsx(p,{size:{xs:2},children:e.jsxs(He,{onChange:S=>x("programState",S.target.value),label:d("Programme State"),value:s.programState,fullWidth:!0,disableClearable:!0,"data-cy":"filters-program-state",children:[e.jsx(de,{value:"active",children:d("Active Programmes")}),e.jsx(de,{value:"all",children:d("All Programmes")})]})})]})})}const Oy=[{disablePadding:!1,label:"",id:"radio",numeric:!1,dataCy:"radio-id"},{disablePadding:!1,label:"Household ID",id:"unicefId",numeric:!1,dataCy:"household-id"},{disablePadding:!1,label:"Head of Household",id:"head_of_household__full_name",numeric:!1,dataCy:"household-full-name"},{disablePadding:!1,label:"Household Size",id:"size",numeric:!1,dataCy:"household-size"},{disablePadding:!1,label:"Administrative Level 2",id:"admin_area__name",numeric:!1,dataCy:"household-admin-level-2"},{disablePadding:!1,label:"Registration Date",id:"last_registration_date",numeric:!1,dataCy:"household-last-registration-date"}];function pe({children:s,withTime:t}){const a=t?Cg:Rl,n=s?new Date(s):null,i=n?Gt.format(n,a):"-",r=n?n.getTime().toString():"";return n?e.jsx("time",{dateTime:r,children:i}):e.jsx(e.Fragment,{children:i})}function ky({household:s,radioChangeHandler:t,selectedHousehold:a,checkboxClickHandler:n,selected:i,householdMultiSelect:r,redirectedFromRelatedTicket:l,isFeedbackWithHouseholdOnly:o}){const{baseUrl:d,isAllPrograms:c}=U(),h=(j=>i.includes(j))(s.id),m=ve(),g=K(R.POPULATION_VIEW_HOUSEHOLDS_DETAILS,m),x=j=>{j.preventDefault(),r?n(j,s.id):t(s)},f=l||o||!1;return e.jsxs(rs,{onClick:j=>{l||o||x(j)},hover:!0,role:"checkbox","data-cy":"household-table-row",children:[e.jsx(_,{padding:"checkbox",children:r?e.jsx(ns,{color:"primary",onClick:j=>n(j,s.id),checked:h,"data-cy":"input-checkbox-household",slotProps:{input:{"aria-labelledby":s.id}},disabled:f}):e.jsx(kt,{color:"primary",checked:a?.id===s.id,onChange:()=>{t(s)},value:s.id,name:"radio-button-household",slotProps:{input:{"aria-label":s.id}},"data-cy":"input-radio-household",disabled:f})}),e.jsx(_,{align:"left",children:!c&&g?e.jsx(me,{to:`/${d}/population/household/${s.id}`,children:s.unicefId}):e.jsx("span",{children:s.unicefId})}),e.jsx(_,{align:"left",children:s.headOfHousehold}),e.jsx(_,{align:"left",children:s.size}),e.jsx(_,{align:"left",children:s?.admin2?.name||"-"}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.lastRegistrationDate})}),c&&e.jsx(_,{align:"left",children:s.programId?e.jsx(me,{to:`/${d}/details/${s.programId}`,children:s.programName}):"-"})]},s.id)}function vs(s,t){const[a,n]=A.useState(void 0);return A.useEffect(()=>{s===0&&t?.count!==void 0&&n(t.count)},[s,t]),a}const wy=T.div`
  .MuiPaper-elevation1 {
    box-shadow: none;
    padding: 0 !important;
  }
`;function My({businessArea:s,filter:t,choicesData:a,setFieldValue:n,selectedHousehold:i,setSelectedIndividual:r,setSelectedHousehold:l,noTableStyling:o=!1,householdMultiSelect:d,redirectedFromRelatedTicket:c,isFeedbackWithHouseholdOnly:u}){const{isAllPrograms:h,programId:m}=U(),{selectedProgram:g}=Z(),x=g?.beneficiaryGroup,f=A.useMemo(()=>{const _e=()=>{if(t.withdrawn==="true")return!0;if(t.withdrawn==="false")return!1};return{businessAreaSlug:s,programSlug:m,familySize:JSON.stringify({before:t.householdSizeMin,after:t.householdSizeMax}),search:t.search.trim(),documentType:t.documentType,documentNumber:t.documentNumber.trim(),admin1:t.admin1,admin2:t.admin2,residenceStatus:t.residenceStatus,withdrawn:_e(),rdiMergeStatus:bl.MERGED}},[s,m,t.householdSizeMin,t.householdSizeMax,t.search,t.documentType,t.documentNumber,t.admin1,t.admin2,t.residenceStatus,t.withdrawn]),[j,y]=A.useState(f);A.useEffect(()=>{y(f)},[f]);const[b,C]=A.useState(0),{data:v,isLoading:S,error:I}=V({queryKey:["businessAreasProgramsHouseholdsList",j,m,s],queryFn:()=>N.restBusinessAreasProgramsHouseholdsList(Ce({businessAreaSlug:s,programSlug:m},j,{withPagination:!0})),enabled:!!s&&!h}),{data:E}=V({queryKey:["businessAreasProgramsHouseholdsCountRetrieve",s,m],queryFn:()=>N.restBusinessAreasProgramsHouseholdsCountRetrieve({businessAreaSlug:s,programSlug:m}),enabled:!!s&&!h&&b===0}),{data:D,isLoading:F,error:w}=V({queryKey:["businessAreasHouseholdsList",j,s],queryFn:()=>{const _e=Object.fromEntries(Object.entries(j).filter(([ne])=>ne!=="programSlug"));return N.restBusinessAreasHouseholdsList(Ce({businessAreaSlug:s},_e,{withPagination:!0}))},enabled:h}),{data:O}=V({queryKey:["businessAreasHouseholdsCountRetrieve",s,j],queryFn:()=>{const _e=Object.fromEntries(Object.entries(j).filter(([ne])=>ne!=="programSlug"));return N.restBusinessAreasHouseholdsCountRetrieve(Ce({businessAreaSlug:s},_e))},enabled:h&&b===0}),[k,$]=A.useState(d?[...i]:[i]),G=(_e,ne)=>{const Ue=k.indexOf(ne),Te=[...k];Ue===-1?Te.push(ne):Te.splice(Ue,1),r===void 0&&d&&l(Te),$(Te)},W=(_e,ne)=>{_e.preventDefault();let Ue=[];k.length?$([]):(Ue=ne.map(Te=>Te.id),$(Ue)),r===void 0&&d&&l(Ue)},Y=_e=>{l(_e),n("selectedHousehold",_e),n("selectedIndividual",null),r!==void 0&&r(null),n("identityVerified",!1)},J=$s(Oy,x,{unicefId:_e=>`${_e?.groupLabel} ID`,head_of_household__full_name:_e=>`Head of ${_e?.groupLabel}`,size:_e=>`${_e?.groupLabel} Size`}),ae=[...J,{disablePadding:!1,label:"Programme",id:"programs",numeric:!1,dataCy:"programs"}],re=h?ae:J,le=vs(b,h?O:E),ce=()=>e.jsx(ds,{renderRow:_e=>_e?e.jsx(ky,{household:_e,radioChangeHandler:Y,selectedHousehold:i,choicesData:a,checkboxClickHandler:G,selected:k,householdMultiSelect:d,redirectedFromRelatedTicket:c,isFeedbackWithHouseholdOnly:u},_e.id):e.jsx(e.Fragment,{}),itemsCount:le,headCells:d?re.slice(1):re,allowSort:!1,onSelectAllClick:d&&W,numSelected:d&&k.length,data:h?D:v,error:h?w:I,isLoading:h?F:S,queryVariables:j,setQueryVariables:y,page:b,setPage:C});return o?e.jsx(wy,{children:ce()}):e.jsx(Es,{children:ce()})}const $y=[{disablePadding:!1,label:"",id:"radio",numeric:!1,dataCy:"radio-id"},{disablePadding:!1,label:"Individual ID",id:"unicefId",numeric:!1,dataCy:"individual-id"},{disablePadding:!1,label:"Full Name",id:"fullName",numeric:!1,dataCy:"individual-name"},{disablePadding:!1,label:"Household ID",id:"household__id",numeric:!1,dataCy:"household-id"},{disablePadding:!1,label:"Age",id:"-birthDate",numeric:!0,dataCy:"individual-age"},{disablePadding:!1,label:"Gender",id:"sex",numeric:!1,dataCy:"individual-sex"},{disablePadding:!1,label:"Administrative Level 2",id:"household__admin_area__name",numeric:!1,dataCy:"individual-location"},{disablePadding:!1,label:"Registration Date",id:"individual__last-registraton-date",numeric:!1,dataCy:"individual-location"}],Uy=[{disablePadding:!1,label:"",id:"radio",numeric:!1,dataCy:"radio-id"},{disablePadding:!1,label:"Individual ID",id:"unicefId",numeric:!1,dataCy:"individual-id"},{disablePadding:!1,label:"Full Name",id:"fullName",numeric:!1,dataCy:"individual-name"},{disablePadding:!1,label:"Age",id:"-birthDate",numeric:!0,dataCy:"individual-age"},{disablePadding:!1,label:"Gender",id:"sex",numeric:!1,dataCy:"individual-sex"},{disablePadding:!1,label:"Administrative Level 2",id:"household__admin_area__name",numeric:!1,dataCy:"individual-location"},{disablePadding:!1,label:"Registration Date",id:"individual__last-registraton-date",numeric:!1,dataCy:"individual-location"}];function Vy({individual:s,radioChangeHandler:t,selectedIndividual:a}){const{baseUrl:n,isAllPrograms:i}=U(),{isSocialDctType:r}=Z();return e.jsxs(rs,{onClick:()=>{t(s)},hover:!0,role:"checkbox","data-cy":"individual-table-row",children:[e.jsx(_,{padding:"checkbox",children:e.jsx(kt,{color:"primary",checked:a?.id===s.id,onChange:()=>{t(s)},value:s.id,name:"radio-button-household",slotProps:{input:{"aria-label":s.id}}})}),e.jsx(_,{align:"left",children:i?e.jsx("span",{children:s.unicefId||"-"}):e.jsx(me,{to:`/${n}/population/individuals/${s.id}`,children:s.unicefId})}),e.jsx(_,{align:"left",children:s.fullName}),!r&&e.jsx(_,{align:"left",children:s.household?s.household.unicefId:"-"}),e.jsx(_,{align:"right",children:s.age}),e.jsx(_,{align:"left",children:ga(s.sex)}),e.jsx(_,{align:"left",children:s.household?.admin2?.name||"-"}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.lastRegistrationDate})}),i&&e.jsx(_,{align:"left",children:s.program?e.jsx(me,{to:`/${n}/details/${s.program.id}`,children:s.program.name}):"-"})]},s.id)}const By=T.div`
  .MuiPaper-elevation1 {
    box-shadow: none;
    padding: 0 !important;
  }
`;function ju({filter:s,setFieldValue:t,valuesInner:a,selectedIndividual:n,setSelectedIndividual:i,setSelectedHousehold:r,ticket:l,excludedId:o,noTableStyling:d=!1}){const{isSocialDctType:c}=Z(),{businessArea:u,programId:h,isAllPrograms:m}=U(),{selectedProgram:g}=Z(),x=g?.beneficiaryGroup,f=le=>{i(le),le.household&&(r(le.household),t("selectedHousehold",le.household)),t("selectedIndividual",le),t("identityVerified",!1)};let j;"household"in s?j=s.household:j=a.selectedHousehold?a.selectedHousehold.id:null;const y=A.useMemo(()=>({age:JSON.stringify({min:s.ageMin,max:s.ageMax}),sex:[s.sex],search:s.search.trim(),documentType:s.documentType,documentNumber:s.documentNumber.trim(),admin2:[s.admin2],flags:s.flags,status:s.status,lastRegistrationDate:JSON.stringify({min:s.lastRegistrationDateMin,max:s.lastRegistrationDateMax}),orderBy:s.orderBy,householdId:j,excludedId:o||l?.individual?.id||null,programId:m?s.program:h,isActiveProgram:s.programState==="active"?!0:null,withdrawn:!1,rdiMergeStatus:bl.MERGED}),[s.ageMin,s.ageMax,s.sex,s.search,s.documentType,s.documentNumber,s.admin2,s.flags,s.status,s.lastRegistrationDateMin,s.lastRegistrationDateMax,s.orderBy,s.program,s.programState,j,o,l?.individual?.id,m,h]),[b,C]=A.useState(y);A.useEffect(()=>{C(y)},[y]);const[v,S]=A.useState(0),{data:I,isLoading:E,error:D}=V({queryKey:["businessAreasProgramsIndividualsList",b,h,u],queryFn:()=>N.restBusinessAreasProgramsIndividualsList(Ce({businessAreaSlug:u,programSlug:h},b,{withPagination:!0})),enabled:!!u&&!!h&&!m}),{data:F}=V({queryKey:["businessAreasProgramsIndividualsCountRetrieve",u,h,b],queryFn:()=>N.restBusinessAreasProgramsIndividualsCountRetrieve(Ce({businessAreaSlug:u,programSlug:h},b)),enabled:!!u&&!!h&&!m&&v===0}),{data:w,isLoading:O,error:k}=V({queryKey:["businessAreasIndividualsList",b,u],queryFn:()=>N.restBusinessAreasIndividualsList(Ce({businessAreaSlug:u},b,{withPagination:!0})),enabled:!!u&&m}),{data:$}=V({queryKey:["businessAreasIndividualsCountRetrieve",u,b],queryFn:()=>N.restBusinessAreasIndividualsCountRetrieve(Ce({businessAreaSlug:u},b)),enabled:!!u&&m&&v===0}),Y=$s(c?Uy:$y,x,{unicefId:le=>`${le?.memberLabel} ID`,household__id:le=>`${le?.groupLabel} ID`}),X=[...Y,{disablePadding:!1,label:"Programme",id:"household__programme",numeric:!1,dataCy:"individual-programme"}],J=m?X:Y,re=vs(v,m?$:F),se=()=>e.jsx(ds,{headCells:J,allowSort:!1,rowsPerPageOptions:[5,10,15,20],filterOrderBy:s.orderBy,queryVariables:b,setQueryVariables:C,data:m?w:I,error:m?k:D,isLoading:m?O:E,itemsCount:re,renderRow:le=>e.jsx(Vy,{radioChangeHandler:f,selectedIndividual:n,individual:le},le.id),page:v,setPage:S});return d?e.jsx(By,{children:se()}):e.jsx(Es,{children:se()})}const Gy=T(La)`
  && {
    max-width: 500px;
  }
`;function zy({onValueChange:s,initialValues:t,selectedIndividual:a,selectedHousehold:n,setSelectedIndividual:i,setSelectedHousehold:r,redirectedFromRelatedTicket:l,isFeedbackWithHouseholdOnly:o}){const d=je(),{businessArea:c,isAllPrograms:u,programId:h}=U(),{isSocialDctType:m}=Z(),[g,x]=A.useState(m?1:0),{data:f,isLoading:j}=V({queryKey:["householdChoices",c],queryFn:()=>N.restBusinessAreasHouseholdsChoicesRetrieve({businessAreaSlug:c})}),{data:y,isLoading:b}=V({queryKey:["individualChoices",c],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:c})}),C={program:u?"":h,search:"",documentType:f?.documentTypeChoices?.[0]?.value,documentNumber:"",residenceStatus:"",admin1:"",admin2:"",householdSizeMin:"",householdSizeMax:"",orderBy:"unicef_id",withdrawn:"",programState:"active"},v={program:u?"":h,search:"",documentType:y?.documentTypeChoices?.[0]?.value,documentNumber:"",admin2:"",sex:"",ageMin:"",ageMax:"",flags:[],orderBy:"unicef_id",status:"",programState:"active"},[S,I]=A.useState(Ke(d,v)),[E,D]=A.useState(Ke(d,v)),[F,w]=A.useState(Ke(d,C)),[O,k]=A.useState(Ke(d,C)),{selectedProgram:$}=Z(),G=$?.beneficiaryGroup,{data:W,isLoading:Y}=V({queryKey:["businessAreasProgramsList",{limit:100},c],queryFn:()=>N.restBusinessAreasProgramsList(Ce({businessAreaSlug:c,limit:100},{withPagination:!1}))});if(j||b||Y)return e.jsx(Ne,{});if(!y||!f||!W)return null;const X=(ae,re)=>{s(ae,re)},J=W?.results;return e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsx(P,{id:"scroll-dialog-title",children:e.jsxs(Gy,{value:m?0:g,onChange:(ae,re)=>{x(re)},indicatorColor:"primary",textColor:"primary",variant:"fullWidth","aria-label":"look up tabs",children:[!m&&e.jsx(Tt,{"data-cy":"look-up-household",label:`LOOK UP ${G?.groupLabel}`}),e.jsx(Tt,{disabled:t.issueType===$e.ADD_INDIVIDUAL||t.issueType===$e.DELETE_HOUSEHOLD||t.issueType===$e.EDIT_HOUSEHOLD,"data-cy":"look-up-individual",label:`LOOK UP ${G?.memberLabel}`})]})})}),e.jsxs(P,{children:[!m&&e.jsxs(Qt,{value:g,index:0,children:[e.jsx(P,{mt:2,children:e.jsx(bu,{filter:F,choicesData:f,setFilter:w,initialFilter:C,appliedFilter:O,setAppliedFilter:k,isOnPaper:!1,programs:J})}),e.jsx(My,{filter:O,businessArea:c,choicesData:f,setFieldValue:X,selectedHousehold:n,setSelectedHousehold:r,setSelectedIndividual:i,redirectedFromRelatedTicket:l,isFeedbackWithHouseholdOnly:o,noTableStyling:!0})]}),e.jsxs(Qt,{value:g,index:1,children:[e.jsx(Vl,{filter:S,choicesData:y,setFilter:I,initialFilter:v,appliedFilter:E,setAppliedFilter:D,isOnPaper:!1,programs:J}),e.jsx(ju,{filter:E,setFieldValue:X,valuesInner:t,selectedHousehold:n,setSelectedHousehold:r,selectedIndividual:a,setSelectedIndividual:i,noTableStyling:!0})]})]})]})}const jr={household:"household",individual:"individual"},Bo=T.div`
  .MuiSvgIcon-root {
    display: flex;
  }
`,qy=({onValueChange:s,disableUnselectIndividual:t,disableUnselectHousehold:a,selectedHousehold:n,setSelectedHousehold:i,selectedIndividual:r,setSelectedIndividual:l})=>{const{selectedProgram:o,isSocialDctType:d}=Z(),c=o?.beneficiaryGroup,u=h=>{h===jr.household?(s("selectedHousehold",null),s("selectedIndividual",null),i(null),l(null)):(s("selectedIndividual",null),l(null)),s("identityVerified",!1)};return e.jsxs(p,{container:!0,spacing:5,children:[!d&&e.jsx(p,{size:{xs:4},children:e.jsx(Fn,{disabled:a,children:e.jsxs(p,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{children:e.jsxs(P,{display:"flex",children:[`${c?.groupLabel} ID`,":",e.jsxs(ot,{children:[" ",n?.unicefId||"-"]})]})}),!a&&n?.unicefId&&e.jsx(p,{children:e.jsx(Nn,{children:e.jsx(Bo,{children:e.jsx(Rs,{color:"inherit",fontSize:"small",onClick:()=>u(jr.household)})})})})]})})}),e.jsx(p,{size:{xs:4},children:e.jsx(Fn,{disabled:t,children:e.jsxs(p,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{children:e.jsxs(P,{display:"flex",children:[`${c?.memberLabel} ID`,":",e.jsxs(ot,{children:[" ",r?.unicefId||"-"]})]})}),!t&&r?.unicefId&&e.jsx(p,{children:e.jsx(Nn,{children:e.jsx(Bo,{children:e.jsx(Rs,{color:"inherit",fontSize:"small",onClick:()=>u(jr.individual)})})})})]})})})]})};function Au({onValueChange:s,values:t,errors:a,touched:n,redirectedFromRelatedTicket:i,isFeedbackWithHouseholdOnly:r}){const{isSocialDctType:l}=Z(),[o,d]=A.useState(t.selectedHousehold),[c,u]=A.useState(t.selectedIndividual);return A.useEffect(()=>{o?.admin2?(s("admin",o.admin2.id),s("admin2",o.admin2.id)):(s("admin",null),s("admin2",null))},[o,s]),e.jsxs(e.Fragment,{children:[e.jsx(zy,{initialValues:t,onValueChange:s,selectedIndividual:c,selectedHousehold:o,setSelectedHousehold:d,setSelectedIndividual:u,redirectedFromRelatedTicket:i,isFeedbackWithHouseholdOnly:r}),e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(qy,{disableUnselectHousehold:i||r,disableUnselectIndividual:i,onValueChange:s,selectedHousehold:o,setSelectedHousehold:d,selectedIndividual:c,setSelectedIndividual:u}),Zr("selectedIndividual",a,n)&&e.jsxs(p,{container:!0,spacing:4,children:[!l&&e.jsx(p,{size:{xs:4}}),e.jsx(p,{size:{xs:4},children:!c&&e.jsx(Ls,{error:!0,children:a?.selectedIndividual})})]}),Zr("selectedHousehold",a,n)&&!o&&e.jsx(Ls,{error:!0,children:a?.selectedHousehold})]})]})}const aa=T(us)`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 26px 22px;
  overflow-x: scroll;
`,Bl=T(gs)`
  && {
    min-width: 100px;
  }
`,_i=T.div`
  color: ${({theme:s})=>s.hctPalette.navyBlue};
  font-weight: 500;
  cursor: pointer;
`;function _u({values:s}){const{t}=M(),{baseUrl:a,businessAreaSlug:n}=U(),{selectedProgram:i}=Z(),r=i?.beneficiaryGroup,[l,o]=A.useState(!1),{data:d,isLoading:c}=V({queryKey:["grievanceTickets",n,s?.selectedHousehold?.id],queryFn:()=>N.restBusinessAreasGrievanceTicketsList({businessAreaSlug:n,household:Ea(s?.selectedHousehold?.id)||"294cfa7e-b16f-4331-8014-a22ffb2b8b3c"}),enabled:!!n});if(c)return e.jsx(Ne,{});if(!d)return null;const u=d.results||[],h=x=>x.length?x.map(f=>{const j=$t(f.id,f.category,a);return e.jsx(P,{mb:1,children:e.jsx(Us,{href:j,children:f.unicefId})},f.id)}):e.jsx(e.Fragment,{children:"-"}),m=u.length?u.filter(x=>x.status!==ze.CLOSED):[],g=u.length?u.filter(x=>x.status===ze.CLOSED):[];return u.length?e.jsxs(aa,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:t("Other Related Tickets")})}),e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(L,{label:`For ${r?.groupLabel} ${s?.selectedHousehold?.unicefId||"-"}`,children:e.jsx(e.Fragment,{children:h(m)})}),!l&&g.length?e.jsx(P,{mt:3,children:e.jsxs(_i,{onClick:()=>o(!0),children:[t("SHOW CLOSED TICKETS")," (",g.length,")"]})}):null,l&&e.jsxs(P,{mb:3,mt:3,children:[e.jsx(ee,{children:t("Closed Tickets")}),e.jsx(L,{label:`For ${r?.groupLabel} ${s?.selectedHousehold?.unicefId||"-"}`,children:e.jsx(e.Fragment,{children:h(g)})})]}),l&&g.length?e.jsxs(_i,{onClick:()=>o(!1),children:[t("HIDE CLOSED TICKETS")," (",g.length,")"]}):null]})]}):null}const Hy=T(us)`
  border: 1px solid ${({theme:s})=>s.hctPalette.orange};
  border-radius: 3px;
  background-color: #fff;
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 26px 22px;
`,Wy=T.div`
  color: ${({theme:s})=>s.hctPalette.orange};
`,Ky=T(Ii)`
  position: relative;
  top: 5px;
  margin-right: 10px;
`;function Yy({values:s}){const{baseUrl:t,businessAreaSlug:a}=U(),{t:n}=M(),{data:i,isLoading:r}=V({queryKey:["existingGrievanceTickets",a,s.category,s.issueType,s.selectedHousehold?.id,s.selectedIndividual?.id,s.selectedPaymentRecords],queryFn:()=>N.restBusinessAreasGrievanceTicketsList({businessAreaSlug:a,category:s.category,issueType:s.issueType,household:Ea(s.selectedHousehold?.id),individualId:Ea(s.selectedIndividual?.id),paymentRecordIds:Array.isArray(s.selectedPaymentRecords)?s.selectedPaymentRecords.map(c=>c.id).join(","):s.selectedPaymentRecords}),enabled:!!(a&&s.category)});if(r)return e.jsx(Ne,{});if(!i)return null;const l=i.results||[],o=l?.map(c=>{const u=$t(c.id,c.category,t);return e.jsx(P,{mb:1,children:e.jsx(Us,{href:u,children:c.unicefId})},c.id)}),d=!!s.category&&(!!s.selectedHousehold?.id||!!s.selectedIndividual?.id);return l.length&&d?e.jsx(p,{size:6,children:e.jsxs(Hy,{children:[e.jsx(Wy,{children:e.jsxs(ee,{variant:"h6",children:[e.jsx(Ky,{}),l.length===1?n("Ticket already exists"):n("Tickets already exist")]})}),e.jsx(ee,{variant:"body2",children:n("There is an open ticket(s) in the same category for the related entity. Please review them before proceeding.")}),e.jsx(P,{mt:3,display:"flex",flexDirection:"column",children:o})]})}):null}function Pi(s){return s==null||s===""}function Qy(s,t,a,n,i){const r=s.category?.toString(),l=s.issueType?.toString(),o={};if(r===De.DATA_CHANGE&&(l===$e.ADD_INDIVIDUAL&&(s.selectedHousehold||(o.selectedHousehold=`${i?.groupLabel} is Required`),s.individualData?.documents?.length&&s.individualData.documents.filter(d=>d).forEach(d=>{const c=d.value||d;(!c.country||!c.key||!c.number)&&(o.individualData="Document type, country and number are required")})),l===$e.EDIT_HOUSEHOLD&&(s.selectedHousehold||(o.selectedHousehold=`${i?.groupLabel} is Required`),s.selectedHousehold&&!s.householdDataUpdateFields?.[0]?.fieldName&&(o.householdDataUpdateFields=`${i?.groupLabel} Data Change is Required`),s.householdDataUpdateFields?.length&&s.householdDataUpdateFields?.[0]?.fieldName&&s.householdDataUpdateFields.forEach(d=>{if(d?.fieldName){const c=n[d.fieldName];if(!c)return;const{required:u}=c;d.fieldValue===0?delete o.householdDataUpdateFields:(!d.fieldName||Pi(d.fieldValue)&&u)&&(o.householdDataUpdateFields="Field and field value are required")}})),l===$e.DELETE_INDIVIDUAL&&(s.selectedIndividual||(o.selectedIndividual=`${i?.memberLabel} is Required`)),l===$e.DELETE_HOUSEHOLD&&(s.selectedHousehold||(o.selectedHousehold=`${i?.groupLabel} is Required`)),l===$e.EDIT_INDIVIDUAL&&(s.selectedIndividual||(o.selectedIndividual=`${i?.memberLabel} is Required`),s.selectedIndividual&&!s.individualDataUpdateFields[0]?.fieldName&&!s.individualDataUpdateFieldsDocuments?.length&&!s.individualDataUpdateDocumentsToRemove?.length&&!s.individualDataUpdateFieldsIdentities?.length&&!s.individualDataUpdateIdentitiesToRemove?.length&&!s.individualDataUpdateDocumentsToEdit?.length&&!s.individualDataUpdateIdentitiesToEdit?.length&&(o.individualDataUpdateFields=`${i?.memberLabel} Data Change is Required`),s.individualDataUpdateFields?.length&&s.individualDataUpdateFields.forEach(d=>{if(d?.fieldName&&a[d.fieldName]){const{required:c}=a[d.fieldName];d.fieldValue===0?delete o.individualDataUpdateFields:(!d.fieldName||Pi(d.fieldValue)&&c)&&(o.individualDataUpdateFields="Field and field value are required")}}),s.individualDataUpdateFieldsDocuments?.length&&s.individualDataUpdateFieldsDocuments.filter(d=>d).forEach(d=>{const c=d.value||d;(!c.country||!c.key||!c.number)&&(o.individualDataUpdateFieldsDocuments="Document type, country and number are required")}),s.individualDataUpdateFieldsDocumentsToEdit?.length&&s.individualDataUpdateFieldsDocumentsToEdit.filter(d=>d).forEach(d=>{const c=d.value||d;(!c.country||!c.key||!c.number)&&(o.individualDataUpdateFieldsDocumentsToEdit="Document type, country and number are required")}),s.individualDataUpdateFieldsIdentities?.length&&s.individualDataUpdateFieldsIdentities.filter(d=>d).forEach(d=>{const c=d.value||d,u=c.partner||c.agency;(!c.country||!u||!c.number)&&(o.individualDataUpdateFieldsIdentities="Identity partner, country and number are required")}),s.individualDataUpdateFieldsIdentitiesToEdit?.length&&s.individualDataUpdateFieldsIdentitiesToEdit.filter(d=>d).forEach(d=>{const c=d.value||d,u=c.partner||c.agency;(!c.country||!u||!c.number)&&(o.individualDataUpdateFieldsIdentitiesToEdit="Identity partner, country and number are required")}))),(r===De.SENSITIVE_GRIEVANCE||r===De.DATA_CHANGE||r===De.GRIEVANCE_COMPLAINT||r===De.NEEDS_ADJUDICATION)&&(l||(o.issueType="Issue Type is required")),r===De.DATA_CHANGE&&l===$e.ADD_INDIVIDUAL){const d={},c=s.individualData||{};if(t)for(const u of t){const h=Zs(u.name);u.required&&(c[h]===null||c[h]===void 0)&&(d[h]="Field Required"),Object.keys(d).length>0&&(o.individualData=d)}}return s.documentation?.length&&s.documentation.filter(d=>d).forEach(d=>{(!d.name||!d.file)&&(o.documentation="Grievance Supporting Document name and file are required")}),s.documentationToUpdate?.length&&s.documentationToUpdate.filter(d=>d).forEach(d=>{(!d.name||!d.file)&&(o.documentationToUpdate="Grievance Supporting Document name and file are required")}),o}function Xy(s,t,a,n,i,r,l){const o=s.category?.toString(),d=s.issueType?.toString(),c={};if(o===De.DATA_CHANGE&&(d===$e.ADD_INDIVIDUAL&&!s.selectedHousehold&&i===Qs.Lookup&&(c.selectedHousehold=`${l?.groupLabel} is Required`),d===$e.EDIT_HOUSEHOLD&&(!s.selectedHousehold&&i===Qs.Lookup&&(c.selectedHousehold=`${l?.groupLabel} is Required`),s.selectedHousehold&&!s.householdDataUpdateFields?.[0]?.fieldName&&!s.roles?.length&&i===Qs.Description&&(c.householdDataUpdateFields=`${l?.groupLabel} Data Change is Required`),s.householdDataUpdateFields?.length&&s.householdDataUpdateFields?.[0]?.fieldName&&s.householdDataUpdateFields.forEach(h=>{if(h?.fieldName){const m=n[h.fieldName];if(!m)return;const{required:g}=m;h.fieldValue===0?delete c.householdDataUpdateFields:(!h.fieldName||Pi(h.fieldValue)&&g)&&(c.householdDataUpdateFields="Field and field value are required")}})),d===$e.DELETE_INDIVIDUAL&&!s.selectedIndividual&&i===Qs.Lookup&&(c.selectedIndividual=`${l?.memberLabel} is Required`),d===$e.DELETE_HOUSEHOLD&&!s.selectedHousehold&&i===Qs.Lookup&&(c.selectedHousehold=`${l?.groupLabel} is Required`),d===$e.EDIT_INDIVIDUAL&&(s.selectedIndividual&&s.individualDataUpdateFields?.length&&!s.individualDataUpdateFields[0]?.fieldName&&!s.individualDataUpdateFieldsDocuments?.length&&!s.individualDataUpdateDocumentsToRemove?.length&&!s.individualDataUpdateFieldsIdentities?.length&&!s.individualDataUpdateIdentitiesToRemove?.length&&!s.individualDataUpdateDocumentsToEdit?.length&&!s.individualDataUpdateIdentitiesToEdit?.length&&!s.individualDataUpdateAccountsToEdit?.length&&!s.individualDataUpdateFieldsAccounts?.length&&i===Qs.Description&&(c.individualDataUpdateFields=`${l?.memberLabel} Data Change is Required`),s.individualDataUpdateFields?.length&&s.individualDataUpdateFields.forEach(h=>{if(h?.fieldName&&a[h.fieldName]){const{required:m}=a[h.fieldName];h.fieldValue===0?delete c.individualDataUpdateFields:(!h.fieldName||Pi(h.fieldValue)&&m)&&(c.individualDataUpdateFields="Field and field value are required")}}),s.individualDataUpdateFieldsDocuments?.length&&s.individualDataUpdateFieldsDocuments.forEach((h,m)=>{const g=s.individualDataUpdateFieldsDocuments[m],x=g.value||g;(!x.country||!x.key||!x.number)&&(c.individualDataUpdateFieldsDocuments="Document type, country and number are required")}),s.individualDataUpdateFieldsDocumentsToEdit?.length&&s.individualDataUpdateFieldsDocumentsToEdit.forEach((h,m)=>{const g=s.individualDataUpdateFieldsDocumentsToEdit[m],x=g.value||g;(!x.country||!x.key||!x.number)&&(c.individualDataUpdateFieldsDocumentsToEdit="Document type, country and number are required")}),s.individualDataUpdateFieldsIdentities?.length&&s.individualDataUpdateFieldsIdentities.forEach((h,m)=>{const g=s.individualDataUpdateFieldsIdentities[m],x=g.value||g,f=x.partner||x.agency;(!x.country||!f||!x.number)&&(c.individualDataUpdateFieldsIdentities="Identity partner, country and number are required")}),s.individualDataUpdateFieldsIdentitiesToEdit?.length&&s.individualDataUpdateFieldsIdentitiesToEdit.forEach((h,m)=>{const g=s.individualDataUpdateFieldsIdentitiesToEdit[m],x=g.value||g,f=x.partner||x.agency;(!x.country||!f||!x.number)&&(c.individualDataUpdateFieldsIdentitiesToEdit="Identity partner, country and number are required")}),s.individualDataUpdateFieldsAccounts?.length&&s.individualDataUpdateFieldsAccounts.filter(h=>h).forEach(h=>{h.number||(c.individualDataUpdateFieldsAccounts="Account Number is required"),h.accountType||(c.individualDataUpdateFieldsAccounts="Account Type is required"),h.financialInstitution||(c.individualDataUpdateFieldsAccounts="Account Financial Institution is required"),h.dynamicFields?.forEach(m=>{(!m.key||!m.value)&&(c.individualDataUpdateFieldsAccounts="New Account fields need to have both key/value")})}),s.individualDataUpdateAccountsToEdit?.length&&s.individualDataUpdateAccountsToEdit.filter(h=>h).forEach(h=>{h.number||(c.individualDataUpdateAccountsToEdit="Account Number is required"),h.financialInstitution||(c.individualDataUpdateAccountsToEdit="Account Financial Institution is required"),h.dynamicFields?.forEach(m=>{(!m.key||!m.value)&&(c.individualDataUpdateFieldsAccounts="Edited Account fields need to have both key/value")})}))),o===De.DATA_CHANGE&&d===$e.ADD_INDIVIDUAL&&i===Qs.Description){const h={},m=s.individualData||{};if(t)for(const g of t){const x=Zs(g.name);g.required&&(m[x]===null||m[x]===void 0)&&(h[x]="Field Required"),Object.keys(h).length>0&&(c.individualData=h)}m?.documents?.length&&m.documents.forEach((g,x)=>{const f=s.individualData.documents[x],j=f.value||f;(!j.country||!j.key||!j.number)&&(c.individualDataUpdateFieldsDocuments="Document type, country and number are required")}),m?.identities?.length&&m.identities.forEach((g,x)=>{const f=s.individualData.identities[x],j=f.value||f,y=j.partner||j.agency;(!j.country||!y||!j.number)&&(c.individualDataUpdateFieldsIdentities="Identity partner, country and number are required")})}const u=[$e.PAYMENT_COMPLAINT,$e.FSP_COMPLAINT];if(i===Qs.Lookup&&!s.selectedHousehold&&u.includes(s.issueType)&&(c.selectedHousehold=`${l?.groupLabel} is Required`),i===Qs.Lookup){const h=[$e.EDIT_INDIVIDUAL,$e.DELETE_INDIVIDUAL],g=[$e.EDIT_HOUSEHOLD,$e.DELETE_HOUSEHOLD].includes(s.issueType);h.includes(s.issueType)&&!s.selectedIndividual?c.selectedIndividual=`${l?.memberLabel} is Required`:g&&!s.selectedHousehold&&(c.selectedHousehold=`${l?.groupLabel} is Required`)}return i===Qs.Description&&(s.issueType===$e.PAYMENT_COMPLAINT&&!Object.keys(s.selectedPaymentRecords).length?c.selectedPaymentRecords="Payment Records are required":s.issueType===$e.PARTNER_COMPLAINT&&!s.partner&&(c.partner="Partner is required"),r(!0)),s.documentation?.length&&s.documentation.filter(h=>h).forEach(h=>{(!h.name||!h.file)&&(c.documentation="Grievance Supporting Document name and file are required")}),c}const Pu=Q.array().of(Q.object().shape({id:Q.string(),caId:Q.string()})).nullable(),Jy=Q.object().shape({description:Q.string().required("Description is required"),category:Q.string().required("Category is required").nullable(),admin:Q.string().nullable(),area:Q.string(),language:Q.string(),consent:Q.bool().oneOf([!0],"Consent is required"),selectedPaymentRecords:Pu,selectedLinkedTickets:Q.array().of(Q.string()).nullable()}),Zy=s=>{const t={category:Q.string().required("Category is required").nullable(),issueType:Q.string().nullable(),admin:Q.string().nullable(),description:Q.string(),consent:Q.bool(),area:Q.string(),language:Q.string(),selectedPaymentRecords:Pu,selectedRelatedTickets:Q.array().of(Q.string()).nullable()};return s===Qs.Description&&(t.description=Q.string().required(t.issueType===$e.DELETE_HOUSEHOLD||t.issueType===$e.DELETE_INDIVIDUAL?"Withdrawal Reason is required":"Description is required")),s>=Qs.Verification&&(t.consent=Q.bool().oneOf([!0],"Consent is required")),Q.object().shape(t)},eb=T.div`
  .MuiPaper-root {
    padding: 32px 20px;
  }
`,Go=T.div`
  padding: 20px;
`,sb=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  border-top: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  padding: 15px 0;
`;function tb(){return null}function ab({fetchedHousehold:s,fetchedIndividual:t}){const{values:a,setFieldValue:n}=B.useFormikContext();return Js.useEffect(()=>{s&&a.selectedHousehold!==s&&n("selectedHousehold",s)},[s,a.selectedHousehold,n]),Js.useEffect(()=>{t&&a.selectedIndividual!==t&&n("selectedIndividual",t)},[t,a.selectedIndividual,n]),null}const nb=()=>{const s=je(),t=ge(),{t:a}=M(),{baseUrl:n,businessArea:i,programId:r,isAllPrograms:l}=U(),{isSocialDctType:o,selectedProgram:d}=Z(),c=ve(),{showMessage:u}=Ae(),h=d?.beneficiaryGroup,[m,g]=A.useState(Qs.Selection),[x,f]=A.useState(!1),j={[De.DATA_CHANGE]:{[$e.ADD_INDIVIDUAL]:Xc,[$e.EDIT_INDIVIDUAL]:o?Fy:yu,[$e.EDIT_HOUSEHOLD]:uu}},[y]=zh(),b=y.get("linked"),C=s.state?.linkedTicketId,v=b||C,S=!!b,I=s.state?.selectedHousehold,E=s.state?.feedbackProgramId,{data:D,isLoading:F}=V({queryKey:["businessAreasProgramsList",{limit:100},i],queryFn:()=>N.restBusinessAreasProgramsList(Ce({businessAreaSlug:i,limit:100},{withPagination:!1}))}),{data:w,isLoading:O}=V({queryKey:["linkedTicket",i,b],queryFn:()=>N.restBusinessAreasGrievanceTicketsRetrieve({businessAreaSlug:i,id:b}),enabled:!!b}),$=(E?D?.results?.find(lt=>lt.id===E):void 0)?.slug,G=!!(I&&(typeof I=="string"||typeof I=="number")),W=$||(r!=="all"?r:void 0),{data:Y,isLoading:X}=V({queryKey:["household",i,W,I],queryFn:()=>N.restBusinessAreasProgramsHouseholdsRetrieve({businessAreaSlug:i,programSlug:W,id:String(I)}),enabled:G&&!!W}),J=s.state?.selectedIndividual,ae=!!(J&&(typeof J=="string"||typeof J=="number")),{data:re,isLoading:se}=V({queryKey:["individual",i,W,J],queryFn:()=>N.restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:i,programSlug:W,id:String(J)}),enabled:ae&&!!W}),le=s.state?.category,ce=s.state?.linkedFeedbackId,_e=!!le,ne=s.state?.isFeedbackWithHouseholdOnly,Te={description:(S&&w?w.description:"")||"",category:typeof le=="number"?le:Number(le)||null,language:"",consent:!1,admin:I?.admin2?.id||null,area:"",selectedHousehold:I||null,selectedIndividual:J||null,selectedPaymentRecords:[],selectedLinkedTickets:v?[v]:[],identityVerified:!1,issueType:null,priority:null,urgency:null,partner:null,program:l?"":d?.id||"",comments:null,linkedFeedbackId:ce||null,documentation:[],individualDataUpdateFields:[{fieldName:null,fieldValue:null}],roles:[]},{data:ie,isLoading:Pe}=V({queryKey:["businessAreasGrievanceTicketsChoices",i],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:i})}),{mutateAsync:ue,isPending:Ge}=xe({mutationFn:lt=>N.restBusinessAreasGrievanceTicketsCreate({businessAreaSlug:i,formData:lt})}),{data:ls,isLoading:qe}=V({queryKey:["addIndividualFieldsAttributes",i],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllAddIndividualsFieldsAttributesList({businessAreaSlug:i})}),{data:xs,isLoading:Oe}=V({queryKey:["householdFieldsAttributes",i],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllEditHouseholdFieldsAttributesList({businessAreaSlug:i})}),{data:es,isLoading:ye}=V({queryKey:["editPeopleFieldsAttributes",i],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllEditPeopleFieldsAttributesList({businessAreaSlug:i})}),as=Hs(ls,"name","*"),he=Hs(xs,"name","*"),Re=Hs(es,"name","*"),Me=Hs(ie?.grievanceTicketIssueTypeChoices,"category","*"),ps=o?Re:as,Je=lt=>lt.category?.toString()===De.SENSITIVE_GRIEVANCE||lt.category?.toString()===De.DATA_CHANGE||lt.category?.toString()===De.GRIEVANCE_COMPLAINT;if(Pe||qe||Oe||F||ye||se&&ae||X||O&&S)return e.jsx(Ne,{});if(c===null)return null;if(!K(R.GRIEVANCES_CREATE,c))return e.jsx(Xe,{permission:R.GRIEVANCES_CREATE});const Ts=[{title:a("Grievance and Feedback"),to:`/${n}/grievance/tickets/user-generated`}],It=lt=>["householdDataUpdateFields","individualDataUpdateFields","individualDataUpdateFieldsDocuments","individualDataUpdateFieldsIdentities","individualDataUpdateFieldsAccounts","individualDataUpdateAccountsToEdit","verificationRequired"].map(Is=>e.jsx(Ls,{error:!0,children:lt[Is]},Is)),xa=()=>{g(lt=>lt+1)},gn=()=>{g(lt=>lt-1)};let fo=o?["Category Selection",`${h?.memberLabel} Look up`,"Identity Verification","Description"]:["Category Selection",`${h?.groupLabel}/${h?.memberLabel} Look up`,"Identity Verification","Description"];return ce&&I&&J&&(fo=["Category Selection","Identity Verification","Description"]),e.jsx(B.Formik,{initialValues:Te,onSubmit:async lt=>{if(m===Qs.Description)try{const Is=xf(lt),Qn=(await ue(Is)||[])[0];let fn,Xa;const Xn=lt.selectedPaymentRecords.length;Xn>1?(fn=`${Xn} ${a("Grievance Tickets created")}.`,Xa=`/${n}/grievance/tickets/user-generated`):(fn=a("Grievance Ticket created."),Xa=$t(Qn.id,Qn.category,n)),u(fn),t(Xa)}catch(Is){fe(Is,u,"An error occurred while creating the grievance ticket")}else f(!1),xa(),m===0&&ce&&I&&J&&xa()},validateOnChange:m<Qs.Verification||x,validateOnBlur:m<Qs.Verification||x,validate:lt=>Xy(lt,ls||null,ps,he,m,f,h),validationSchema:Zy(m),children:({submitForm:lt,values:Is,setFieldValue:xn,errors:Yn,touched:Qn,handleChange:fn})=>{const Xa=$||(r!=="all"?r:typeof Is.selectedHousehold=="object"&&Is.selectedHousehold?.program?.slug||typeof Is.selectedHousehold=="object"&&Is.selectedHousehold?.programSlug||typeof Is.selectedIndividual=="object"&&Is.selectedIndividual?.program?.slug||typeof Is.selectedIndividual=="object"&&Is.selectedIndividual?.programSlug),Xn=Ui(Is,j,tb),Fh=Is.issueType?su(Is,Me):"",Nh=()=>!!(!Is.category||Je(Is)&&!Is.issueType);return e.jsxs(e.Fragment,{children:[e.jsx(ab,{fetchedHousehold:G?Y:Is.selectedHousehold,fetchedIndividual:ae?re:Is.selectedIndividual}),e.jsx(Bs,{}),e.jsx(Ze,{title:"New Ticket",breadCrumbs:K(R.GRIEVANCES_VIEW_LIST,c)?Ts:null}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:12},children:e.jsx(Go,{children:e.jsx(eb,{children:e.jsxs(Fs,{children:[e.jsx(pf,{activeStep:m,steps:fo}),m===Qs.Selection&&e.jsx(ny,{handleChange:fn,choicesData:ie,setFieldValue:xn,showIssueType:Je,values:Is,redirectedFromRelatedTicket:_e}),m===Qs.Lookup&&e.jsx(sb,{children:e.jsx(P,{sx:{display:"flex",flexDirection:"column"},children:e.jsx(Au,{values:Is,onValueChange:xn,errors:Yn,touched:Qn,redirectedFromRelatedTicket:_e,isFeedbackWithHouseholdOnly:ne})})}),m===Qs.Verification&&e.jsx(hy,{values:Is,programSlug:Xa}),m===Qs.Description&&e.jsxs(e.Fragment,{children:[e.jsx(ey,{values:Is,showIssueType:Je,issueTypeToDisplay:Fh,baseUrl:n,choicesData:ie,programsData:D,setFieldValue:xn,errors:Yn,permissions:c,isLinkedFromUrl:S}),e.jsx(Xn,{values:Is,setFieldValue:xn,programSlug:Xa})]}),It(Yn),e.jsxs(P,{sx:{pt:3,display:"flex",flexDirection:"row"},children:[e.jsx(P,{sx:{mr:3},children:e.jsx(H,{component:ys,to:`/${n}/grievance/tickets/user-generated`,children:a("Cancel")})}),e.jsxs(P,{sx:{display:"flex",ml:"auto"},children:[e.jsx(H,{disabled:m===0,onClick:gn,children:a("Back")}),e.jsx(ke,{loading:Ge,color:"primary",variant:"contained",onClick:lt,"data-cy":"button-submit",disabled:Nh(),children:m===Qs.Description?a("Save"):a("Next")})]})]})]})})})}),m===Qs.Selection&&e.jsx(p,{size:{xs:12},children:e.jsx(Go,{children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(Yy,{values:Is}),e.jsx(p,{size:{xs:6},children:e.jsx(_u,{values:Is})})]})})})]})]})}})},ib=oe(nb,"CreateGrievancePage"),zo=T.div`
  filter: opacity(${({disabled:s})=>s?.5:1});
`;function rb({setFieldValue:s,values:t,document:a,arrayHelpers:n,index:i}){const{t:r}=M(),[l,o]=A.useState(!1),d=t?.documentationToDelete||[],c=d.includes(a.id);return l?e.jsxs(p,{container:!0,size:12,spacing:3,children:[e.jsx(au,{index:i,onDelete:()=>n.remove(i),baseName:"documentationToUpdate",setFieldValue:s,isEdited:l},`${i}-documentation-file`),e.jsx(p,{size:1}),e.jsx(p,{children:e.jsx(H,{onClick:()=>{n.remove(i),o(!1)},children:r("CANCEL")})})]},a.id):e.jsxs(p,{container:!0,children:[e.jsx(p,{size:3,children:e.jsx(zo,{disabled:c,children:e.jsx(L,{label:r("Name"),value:a.name})})}),e.jsx(p,{size:3,children:e.jsx(zo,{disabled:c,children:e.jsx(L,{label:r("File Type"),value:a.contentType})})}),a.contentType.includes("image")?e.jsx(p,{size:1,children:e.jsx(nt,{showRotate:!1,src:a.filePath})}):e.jsx(p,{size:1}),e.jsx(p,{size:1,children:c?e.jsx(P,{display:"flex",alignItems:"center",height:48,color:"red",children:r("REMOVED")}):e.jsxs(P,{ml:2,display:"flex","align-items":"center",children:[e.jsx(Ve,{onClick:()=>{n.replace(i,{id:a.id,name:a.name,file:null,contentType:a.contentType}),o(!0)},children:e.jsx(ma,{})}),!l&&e.jsx(Ve,{onClick:()=>{s(`documentationToDelete[${d.length}]`,a.id)},children:e.jsx(Rs,{})})]})})]},a.id)}function lb({values:s,setFieldValue:t,errors:a,ticket:n}){return e.jsx(p,{container:!0,spacing:3,children:e.jsx(B.FieldArray,{name:"documentationToUpdate",render:i=>e.jsxs(e.Fragment,{children:[n.documentation?.map((r,l)=>e.jsx(p,{size:12,children:e.jsx(rb,{setFieldValue:t,values:s,document:r,arrayHelpers:i,index:l})},r.id)),a?.documentationToUpdate&&e.jsx(Ls,{error:!0,children:a?.documentationToUpdate})]})})})}function ob(s,t){const a=s;a.selectedHousehold=t.household;const n={...t.ticketDetails.individualData},i=n.flexFields;return delete n.flexFields,a.individualData=Object.entries(n).reduce((r,l)=>(r[Zs(l[0])]=l[1].value,r),{}),a.individualData.flexFields=Object.entries(i).reduce((r,l)=>(r[Zs(l[0])]=l[1].value,r),{}),a}function qo(s){return Object.entries(s||{}).map(([t,a])=>a.value!==void 0?{fieldName:t,fieldValue:a.value}:null).filter(Boolean)}function db(s,t){const{individual:a,ticketDetails:n}=t,{documents:i,documentsToRemove:r,documentsToEdit:l,identities:o,identitiesToRemove:d,identitiesToEdit:c,accounts:u,accountsToEdit:h,...m}=n.individualData,{flexFields:g,...x}=m,f=qo(x),j=qo(g);return{...s,selectedIndividual:a,individualDataUpdateFields:[...f,...j],individualDataUpdateFieldsDocuments:da(i),individualDataUpdateDocumentsToRemove:da(r),individualDataUpdateFieldsIdentities:da(o),individualDataUpdateIdentitiesToRemove:da(d),individualDataUpdateDocumentsToEdit:da(l),individualDataUpdateIdentitiesToEdit:da(c),individualDataUpdateAccountsToEdit:da(h),individualDataUpdateFieldsAccounts:da(u)}}function cb(s,t){const a=s;a.selectedHousehold=t.household;const n={...t.ticketDetails&&t.ticketDetails.householdData||{}},i=n.flexFields||{};delete n.flexFields;const r=Object.entries(n||{}).map(o=>({fieldName:o[0],fieldValue:o[1]?.value})),l=Object.entries(i||{}).map(o=>({fieldName:o[0],fieldValue:o[1]?.value}));return a.householdDataUpdateFields=[...r,...l],a}const ub={[De.DATA_CHANGE]:{[$e.ADD_INDIVIDUAL]:ob,[$e.EDIT_INDIVIDUAL]:db,[$e.EDIT_HOUSEHOLD]:cb}};function hb(s){let t={priority:s.priority===0?"Not set":s.priority,urgency:s.urgency===0?"Not set":s.urgency,partner:s.partner?.id,comments:s.comments||"",program:s.programs[0]?.id||"",description:s.description||"",assignedTo:s?.assignedTo?.id||"",category:s.category||"",language:s.language||"",admin:s.admin2?s.admin2?.id:null,area:s.area||"",selectedHousehold:s.household||null,selectedIndividual:s.individual||null,issueType:s.issueType||"",paymentRecord:s?.paymentRecord?.id||null,selectedPaymentRecords:s?.paymentRecord?.id?[s.paymentRecord]:[],selectedLinkedTickets:s.linkedTickets.map(n=>n.id),documentation:null,documentationToUpdate:null,documentationToDelete:null};return t=Ui(s,ub,n=>n)(t,s),t}function mb(){return null}const pb={[De.DATA_CHANGE]:{[$e.ADD_INDIVIDUAL]:Xc,[$e.EDIT_INDIVIDUAL]:yu,[$e.EDIT_HOUSEHOLD]:uu}};function gb(s,t){return{...s,linkedTickets:t.selectedLinkedTickets,extras:{category:{positiveFeedbackTicketExtras:{household:t.selectedHousehold?.id,individual:t.selectedIndividual?.id}}}}}function xb(s,t){return{...s,linkedTickets:t.selectedLinkedTickets,extras:{category:{negativeFeedbackTicketExtras:{household:t.selectedHousehold?.id,individual:t.selectedIndividual?.id}}}}}function fb(s,t){return{...s,linkedTickets:t.selectedLinkedTickets,extras:{category:{referralTicketExtras:{household:t.selectedHousehold?.id,individual:t.selectedIndividual?.id}}}}}function yb(s,t){return{...s,issueType:t.issueType,linkedTickets:t.selectedLinkedTickets}}function bb(s,t){return{...s,linkedTickets:t.selectedLinkedTickets}}function jb(s,t){let{flexFields:a}=t.individualData;if(a){a={...a};for(const[n,i]of Object.entries(a))i===""&&delete a[n]}return{...s,linkedTickets:t.selectedLinkedTickets,extras:{addIndividualIssueTypeExtras:{individualData:{...t.individualData,flexFields:a}}}}}function Ab(s,t){return{...s,linkedTickets:t.selectedLinkedTickets}}function _b(s,t){const a=t.individualDataUpdateFields.filter(r=>r.fieldName&&!r.isFlexField).reduce((r,l)=>(r[Zs(l.fieldName)]=l.fieldValue,r),{}),n=t.individualDataUpdateFields.filter(r=>r.fieldName&&r.isFlexField).reduce((r,l)=>(r[Zs(l.fieldName)]=l.fieldValue,r),{});a.flexFields=n;const i=r=>!r||!Array.isArray(r)?r:r.map(l=>l.value&&typeof l.value=="object"?l.value:l);return{...s,linkedTickets:t.selectedLinkedTickets,extras:{individualDataUpdateIssueTypeExtras:{individualData:{...a,documents:i(t.individualDataUpdateFieldsDocuments),documentsToRemove:t.individualDataUpdateDocumentsToRemove,documentsToEdit:i(t.individualDataUpdateDocumentsToEdit),identities:i(t.individualDataUpdateFieldsIdentities),identitiesToRemove:t.individualDataUpdateIdentitiesToRemove,identitiesToEdit:i(t.individualDataUpdateIdentitiesToEdit),accountsToEdit:t.individualDataUpdateAccountsToEdit}}}}}function Pb(s,t){const a=t.householdDataUpdateFields.filter(i=>i.fieldName&&!i.isFlexField).reduce((i,r)=>(i[Zs(r.fieldName)]=r.fieldValue,i),{}),n=t.householdDataUpdateFields.filter(i=>i.fieldName&&i.isFlexField).reduce((i,r)=>(i[r.fieldName]=r.fieldValue,i),{});return a.flexFields=n,Array.isArray(t.roles)&&t.roles.length>0?a.roles=t.roles:a.roles&&delete a.roles,{...s}}function Cb(s,t){return{...s,linkedTickets:t.selectedLinkedTickets}}const Eb={[De.NEGATIVE_FEEDBACK]:xb,[De.POSITIVE_FEEDBACK]:gb,[De.REFERRAL]:fb,[De.GRIEVANCE_COMPLAINT]:yb,[De.SENSITIVE_GRIEVANCE]:bb,[De.DATA_CHANGE]:{[$e.ADD_INDIVIDUAL]:jb,[$e.DELETE_INDIVIDUAL]:Ab,[$e.EDIT_INDIVIDUAL]:_b,[$e.EDIT_HOUSEHOLD]:Pb}},vb={[De.NEGATIVE_FEEDBACK]:!1,[De.POSITIVE_FEEDBACK]:!1,[De.REFERRAL]:!1,[De.GRIEVANCE_COMPLAINT]:!1,[De.SENSITIVE_GRIEVANCE]:"IGNORE",[De.DATA_CHANGE]:!0};function Sb(s,t,a){const n=l=>l?l.filter(o=>o).map(o=>({id:o.id,name:o.name,file:o.file})):null,i={ticketId:a.id,description:t.description,assignedTo:t.assignedTo,language:t.language,admin:t?.admin,area:t.area,household:t.selectedHousehold?.id,individual:t.selectedIndividual?.id,priority:t.priority==="Not set"||t.priority===null||t.priority===""?0:t.priority,urgency:t.urgency==="Not set"||t.urgency===null||t.urgency===""?0:t.urgency,partner:t.partner,comments:t.comments,program:a.programs?.[0]?.id||t?.program,paymentRecord:t.selectedPaymentRecords?t.selectedPaymentRecords[0]?.id:null,documentation:t.documentation||null,documentationToUpdate:n(t.documentationToUpdate),documentationToDelete:t.documentationToDelete||null};return Ui(t,Eb,Cb,vb)(i,t)}const Cu=(s,t,a,n)=>{const i=Pt(R.GRIEVANCES_VIEW_HOUSEHOLD_DETAILS,s,R.GRIEVANCES_VIEW_HOUSEHOLD_DETAILS_AS_CREATOR,t,R.GRIEVANCES_VIEW_HOUSEHOLD_DETAILS_AS_OWNER,n),r=Pt(R.GRIEVANCES_VIEW_INDIVIDUALS_DETAILS,s,R.GRIEVANCES_VIEW_INDIVIDUALS_DETAILS_AS_CREATOR,t,R.GRIEVANCES_VIEW_INDIVIDUALS_DETAILS_AS_OWNER,n),l=Pt(R.GRIEVANCES_UPDATE,s,R.GRIEVANCES_UPDATE_AS_CREATOR,t,R.GRIEVANCES_UPDATE_AS_OWNER,n),o=Pt(R.GRIEVANCES_ADD_NOTE,s,R.GRIEVANCES_ADD_NOTE_AS_CREATOR,t,R.GRIEVANCES_ADD_NOTE_AS_OWNER,n),d=Pt(R.GRIEVANCES_SET_IN_PROGRESS,s,R.GRIEVANCES_SET_IN_PROGRESS_AS_CREATOR,t,R.GRIEVANCES_SET_IN_PROGRESS_AS_OWNER,n),c=Pt(R.GRIEVANCES_SET_ON_HOLD,s,R.GRIEVANCES_SET_ON_HOLD_AS_CREATOR,t,R.GRIEVANCES_SET_ON_HOLD_AS_OWNER,n),u=Pt(R.GRIEVANCES_SEND_FOR_APPROVAL,s,R.GRIEVANCES_SEND_FOR_APPROVAL_AS_CREATOR,t,R.GRIEVANCES_SEND_FOR_APPROVAL_AS_OWNER,n),h=Pt(R.GRIEVANCES_SEND_BACK,s,R.GRIEVANCES_SEND_BACK_AS_CREATOR,t,R.GRIEVANCES_SEND_BACK_AS_OWNER,n),m=[De.POSITIVE_FEEDBACK,De.NEGATIVE_FEEDBACK,De.REFERRAL].includes(a?.category?.toString()),g=m&&Pt(R.GRIEVANCES_CLOSE_TICKET_FEEDBACK,s,R.GRIEVANCES_CLOSE_TICKET_FEEDBACK_AS_CREATOR,t,R.GRIEVANCES_CLOSE_TICKET_FEEDBACK_AS_OWNER,n)||!m&&Pt(R.GRIEVANCES_CLOSE_TICKET_EXCLUDING_FEEDBACK,s,R.GRIEVANCES_CLOSE_TICKET_EXCLUDING_FEEDBACK_AS_CREATOR,t,R.GRIEVANCES_CLOSE_TICKET_EXCLUDING_FEEDBACK_AS_OWNER,n),x=Pt(R.GRIEVANCES_APPROVE_DATA_CHANGE,s,R.GRIEVANCES_APPROVE_DATA_CHANGE_AS_CREATOR,t,R.GRIEVANCES_APPROVE_DATA_CHANGE_AS_OWNER,n),f=Pt(R.GRIEVANCES_APPROVE_FLAG_AND_DEDUPE,s,R.GRIEVANCES_APPROVE_FLAG_AND_DEDUPE_AS_CREATOR,t,R.GRIEVANCES_APPROVE_FLAG_AND_DEDUPE_AS_OWNER,n),j=Pt(R.GRIEVANCES_APPROVE_PAYMENT_VERIFICATION,s,R.GRIEVANCES_APPROVE_PAYMENT_VERIFICATION_AS_CREATOR,t,R.GRIEVANCES_APPROVE_PAYMENT_VERIFICATION_AS_OWNER,n),y=K(R.GRIEVANCES_ASSIGN,n);return{canViewHouseholdDetails:i,canViewIndividualDetails:r,canEdit:l,canAddNote:o,canSetInProgress:d,canSetOnHold:c,canSendForApproval:u,canSendBack:h,canClose:g,canApproveDataChange:x,canApproveFlagAndAdjudication:f,canAssign:y,canApprovePaymentVerification:j}},Ar=T.div`
  padding: 15px 0;
`,Ho=T.div`
  padding: 20px;
`,Ib=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  padding: 15px 0;
`,Db=()=>{const s=ge(),{t}=M(),{baseUrl:a,businessAreaSlug:n,programSlug:i,isAllPrograms:r}=U(),{selectedProgram:l,isSocialDctType:o}=Z(),d=ve(),{showMessage:c}=Ae(),{id:u}=ts(),h=l?.beneficiaryGroup,m=Fe(),{data:g,isLoading:x,error:f}=V({queryKey:["businessAreaProgram",n,u],queryFn:()=>N.restBusinessAreasGrievanceTicketsRetrieve({businessAreaSlug:n,id:u})}),{data:j,isLoading:y}=V({queryKey:["profile",n,i],queryFn:()=>N.restBusinessAreasUsersProfileRetrieve({businessAreaSlug:n,program:i==="all"?void 0:i}),staleTime:300*1e3,gcTime:1800*1e3,refetchOnWindowFocus:!1}),{data:b,isLoading:C}=V({queryKey:["businessAreasGrievanceTicketsChoices",n],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:n})}),{mutateAsync:v,isPending:S}=xe({mutationFn:Oe=>N.restBusinessAreasGrievanceTicketsPartialUpdate({businessAreaSlug:n,id:Oe.id,formData:Oe.formData})}),{mutateAsync:I}=xe({mutationFn:Oe=>N.restBusinessAreasGrievanceTicketsStatusChangeCreate({businessAreaSlug:n,id:Oe.id,formData:Oe.formData}),onSuccess:()=>{m.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",n,u]})}}),{data:E,isLoading:D}=V({queryKey:["addIndividualFieldsAttributes",n],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllAddIndividualsFieldsAttributesList({businessAreaSlug:n})}),{data:F,isLoading:w}=V({queryKey:["householdFieldsAttributes",n],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllEditHouseholdFieldsAttributesList({businessAreaSlug:n})}),{data:O,isLoading:k}=V({queryKey:["editPeopleFieldsAttributes",n],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllEditPeopleFieldsAttributesList({businessAreaSlug:n})}),{data:$,isLoading:G}=V({queryKey:["businessAreasProgramsList",{limit:100},n],queryFn:()=>N.restBusinessAreasProgramsList(Ce({businessAreaSlug:n,limit:100},{withPagination:!1}))}),W=Hs(E,"name","*"),Y=Hs(F?.results,"name","*"),X=Hs(O?.results,"name","*"),J=Hs(b?.grievanceTicketIssueTypeChoices,"category","*");if(C||x||D||k||w||y||G)return e.jsx(Ne,{});if(rt(f))return e.jsx(Xe,{permission:R.GRIEVANCES_UPDATE});const ae=_s(b.grievanceTicketCategoryChoices),re=j.id,se=g,le=se.createdBy?.id===re,ce=se.assignedTo?.id===re,{canViewHouseholdDetails:_e,canViewIndividualDetails:ne}=Cu(le,ce,se,d);if(!Pt(R.GRIEVANCES_UPDATE,le,R.GRIEVANCES_UPDATE_AS_CREATOR,ce,R.GRIEVANCES_UPDATE_AS_OWNER,d))return e.jsx(Xe,{permission:[R.GRIEVANCES_UPDATE,R.GRIEVANCES_UPDATE_AS_CREATOR,R.GRIEVANCES_UPDATE_AS_OWNER]});const Ue=async Oe=>{try{await I({id:se.id,formData:{status:Oe}}),c(t("Ticket status updated successfully."))}catch(es){fe(es,c,"An error occurred while updating the grievance ticket")}},Te=hb(se),ie=[{title:t("Grievance and Feedback"),to:$t(se.id,se.category,a)}],Pe=Oe=>Oe.category===parseInt(De.SENSITIVE_GRIEVANCE,10)||Oe.category===parseInt(De.DATA_CHANGE,10)||Oe.category===parseInt(De.GRIEVANCE_COMPLAINT,10),ue=(Oe,es)=>["householdDataUpdateFields","individualDataUpdateFields","individualDataUpdateFieldsDocuments","individualDataUpdateFieldsIdentities","individualDataUpdateDocumentsToEdit","individualDataUpdateIdentitiesToEdit","individualDataUpdateFieldsAccounts","individualDataUpdateAccountsToEdit","peopleDataUpdateFields"].map(ye=>Zr(ye,Oe,es)&&e.jsx(Ls,{error:!0,children:Oe[ye]},Oe[ye])),Ge=K(R.GRIEVANCE_DOCUMENTS_UPLOAD,d),ls=$t(se.id,se.category,a),qe=$?.results?.map(Oe=>({name:Oe.name,value:Oe.id})),xs=o?X:W;return e.jsx(B.Formik,{initialValues:Te,onSubmit:async Oe=>{try{const es=Sb(n,Oe,se);await v({id:se.id,formData:es}),c(t("Grievance Ticket edited.")),s(ls)}catch(es){fe(es,c)}(se.status===ze.FOR_APPROVAL||se.status===ze.ON_HOLD)&&Ue(ze.IN_PROGRESS)},validate:Oe=>Qy(Oe,E||null,xs,Y,h),validationSchema:Jy,children:({submitForm:Oe,values:es,setFieldValue:ye,errors:as,touched:he})=>{const Re=Ui(es,pb,mb),Me=Nc(h),ps=Lc(h),Je=Me[jl[es.category]]||"",Ts=ps[Oi[es.issueType]]||"";return e.jsxs(e.Fragment,{children:[e.jsx(Bs,{}),e.jsx(Ze,{title:`${t("Edit Ticket")} #${se.unicefId}`,breadCrumbs:ie,children:e.jsxs(P,{display:"flex",alignContent:"center",children:[e.jsx(P,{mr:3,children:e.jsx(H,{component:ys,to:ls,children:t("Cancel")})}),e.jsx(ke,{loading:S,color:"primary",variant:"contained",onClick:Oe,"data-cy":"button-submit",children:t("Save")})]})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:12},children:e.jsx(Ho,{children:e.jsxs(Fs,{children:[e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("Category"),children:ae[se.category]})}),Pe(es)?e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:t("Issue Type"),children:su(es,J)})}):null,es.category&&e.jsxs(e.Fragment,{children:[e.jsx(St,{}),e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:t("Category Description"),children:Je})}),Ts&&e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:t("Issue Type Description"),children:Ts})}),e.jsx(St,{})]}),e.jsxs(p,{container:!0,size:{xs:12},children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:`${h?.groupLabel}`,children:e.jsx("span",{children:se.household?.id&&_e&&!r?e.jsx(me,{to:`/${a}/population/household/${se.household.id}`,children:se.household.unicefId}):e.jsx("div",{children:se.household?.id?se.household.unicefId:"-"})})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("Individual ID"),children:e.jsx("span",{children:se.individual?.id&&ne&&!r?e.jsx(me,{to:`/${a}/population/individuals/${se.individual.id}`,children:se.individual.unicefId}):e.jsx("div",{children:se.individual?.id?se.individual.unicefId:"-"})})})})]})]}),e.jsxs(Ar,{children:[e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"description",multiline:!0,fullWidth:!0,disabled:!!se.description,variant:"outlined",label:"Description",required:!0,component:Se})}),e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"comments",multiline:!0,fullWidth:!0,disabled:!!se.comments,variant:"outlined",label:"Comments",component:Se})}),e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"admin",disabled:!!se.admin,variant:"outlined",component:Hi})}),e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"area",fullWidth:!0,disabled:!!se.area,variant:"outlined",label:t("Area / Village / Pay point"),component:Se})}),e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"language",multiline:!0,fullWidth:!0,disabled:!!se.language,variant:"outlined",label:t("Languages Spoken"),component:Se})}),e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:"priority",multiline:!0,fullWidth:!0,variant:"outlined",label:t("Priority"),choices:b.grievanceTicketPriorityChoices,component:We})}),e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:"urgency",multiline:!0,fullWidth:!0,variant:"outlined",label:t("Urgency"),choices:b.grievanceTicketUrgencyChoices,component:We})}),e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:"program",label:t("Programme Name"),fullWidth:!0,variant:"outlined",choices:qe,component:We,disabled:!r||!!se.programs?.[0]?.id})})]}),Ge&&e.jsxs(P,{mt:3,children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:t("Grievance Supporting Documents: upload of document: support documentation for the ticket")})}),e.jsx(lb,{values:es,setFieldValue:ye,errors:as,ticket:se}),e.jsx(nu,{values:es,setFieldValue:ye,errors:as})]})]}),e.jsxs(Ar,{children:[e.jsx(p,{size:{xs:6},children:e.jsx(P,{py:3,children:e.jsx(iu,{values:es,onValueChange:ye,disabled:!!se.linkedTickets})})}),(se.issueType?.toString()===$e.PAYMENT_COMPLAINT||se.issueType?.toString()===$e.FSP_COMPLAINT)&&e.jsx(Ib,{children:e.jsx(p,{size:{xs:6},children:e.jsx(P,{py:3,children:e.jsx(ru,{values:es,disabled:!!se.paymentRecord,onValueChange:ye})})})})]}),Pt(R.GRIEVANCES_UPDATE_REQUESTED_DATA_CHANGE,le,R.GRIEVANCES_UPDATE_REQUESTED_DATA_CHANGE_AS_CREATOR,ce,R.GRIEVANCES_UPDATE_REQUESTED_DATA_CHANGE_AS_OWNER,d)&&e.jsx(e.Fragment,{children:e.jsxs(Ar,{children:[e.jsx(Re,{values:es,setFieldValue:ye}),ue(as,he)]})})]})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ho,{children:e.jsx(_u,{values:es})})})]})]})}})},Wo=oe(Db,"EditGrievancePage"),gt=({adminUrl:s,...t})=>s?e.jsx("a",{href:s,children:e.jsx(qh,{color:"primary",...t})}):null;function Tb({message:s,buttonText:t,closeButtonText:a="dismiss",title:n="Error"}){const[i,r]=A.useState(!1),l=()=>{r(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(H,{color:"primary",variant:"contained",onClick:()=>r(!0),children:t}),e.jsxs(is,{open:i,onClose:l,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(Le,{id:"alert-dialog-title",children:n}),e.jsx(Be,{children:e.jsx(dl,{id:"alert-dialog-description",children:s})}),e.jsx(os,{children:e.jsx(H,{onClick:l,color:"primary",autoFocus:!0,children:a})})]})]})}const Eu=({open:s,title:t,content:a,continueText:n,extraContent:i,warningContent:r,onSubmit:l,onClose:o,disabled:d=!1,type:c="primary"})=>{const{t:u}=M();return e.jsxs(is,{fullWidth:!0,scroll:"paper",open:s,children:[e.jsx(Ye,{children:e.jsx(Le,{children:t||u("Confirmation")})}),e.jsxs(Be,{children:[i?e.jsx(ee,{variant:"body2",style:{marginBottom:"16px"},children:i}):null,e.jsx(ee,{variant:"body2",style:{marginBottom:r?"16px":"inherit"},children:a}),r?e.jsx(ee,{color:"primary",variant:"body2",style:{fontWeight:"bold"},children:r}):null]}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{"data-cy":"button-cancel",color:"primary",onClick:o,autoFocus:!0,children:u("Cancel")}),e.jsx(H,{variant:"contained",color:c,disabled:d,onClick:l,"data-cy":"button-confirm",children:n||u("Continue")})]})})]})},vu=A.createContext(Promise.reject.bind(Promise)),Nt=()=>A.useContext(vu);function Rb({children:s}){const[t,a]=A.useState(null),n=A.useRef(null),i=({catchOnCancel:o=!1,...d})=>(a({catchOnCancel:o,...d}),new Promise((c,u)=>{n.current={resolve:c,reject:u}})),r=()=>{t?.catchOnCancel&&n.current&&n.current.reject(),a(null)},l=()=>{n.current&&n.current.resolve(),a(null)};return e.jsxs(vu.Provider,{value:i,children:[s,e.jsx(Eu,{open:!!t,onSubmit:l,onClose:r,...t})]})}const Fb=T.div`
  width: 1px;
  height: 28px;
  border: 1px solid
    ${({theme:s})=>s.hctPalette.lightGray};
  margin: 0 28px;
`,Nb=s=>{let t=0,a=0;return s.flat(2).filter(i=>typeof i=="object"&&i!==null&&"approve_status"in i&&typeof i.approve_status=="boolean").forEach(i=>{i.approve_status===!0?t+=1:a+=1}),{approved:t,notApproved:a}},Lb=({ticket:s,canEdit:t,canSetInProgress:a,canSetOnHold:n,canSendForApproval:i,canSendBack:r,canClose:l,canAssign:o})=>{const{t:d}=M(),{showMessage:c}=Ae(),{baseUrl:u,businessArea:h}=U(),m=Fe(),g=Nt(),x=ge(),{isActiveProgram:f,selectedProgram:j}=Z(),y=j?.beneficiaryGroup,b=[{title:d("Grievance and Feedback"),to:`/${u}/grievance/tickets/user-generated`}],{mutateAsync:C,isPending:v}=xe({mutationFn:({status:Oe})=>N.restBusinessAreasGrievanceTicketsStatusChangeCreate({businessAreaSlug:h,id:s.id,formData:{status:Oe}}),onError:Oe=>{fe(Oe,c)},onSuccess:()=>{m.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",h,s.id]})}}),S=s.status===ze.NEW,I=s.status===ze.ASSIGNED,E=s.status===ze.IN_PROGRESS,D=s.status===ze.FOR_APPROVAL,F=s.status===ze.ON_HOLD,O=!(s.status===ze.CLOSED),k=s.category.toString()===De.POSITIVE_FEEDBACK||s.category.toString()===De.NEGATIVE_FEEDBACK||s.category.toString()===De.REFERRAL||s.category.toString()===De.BENEFICIARY,$=s.category.toString()===De.BENEFICIARY,G=()=>{const Oe=s.ticketDetails?.householdData||{},es=s.ticketDetails?.individualData||{},ye={...Oe,...es,...Oe?.flexFields,...es?.flexFields},as=Je=>{const Ts=["previous_documents","previous_identities","previous_payment_channels","flex_fields"];return Object.keys(Je).filter(It=>!Ts.includes(It)).reduce((It,xa)=>({...It,[xa]:Je[xa]}),{})},he=(Je,Ts)=>Ts?Je?`You approved ${`${Je} change${Je>1?"s":""}`}. Remaining change requests (${Ts}) will be automatically rejected.`:d("You approved 0 changes, remaining proposed changes will be automatically rejected upon ticket closure."):"",Re=as(ye),{approved:Me,notApproved:ps}=Nb(Object.values(Re));return he(Me,ps)},W=()=>{const Oe=s.category?.toString()===De.DATA_CHANGE,es=s.category?.toString()===De.NEEDS_ADJUDICATION,ye=s.category?.toString()===De.SYSTEM_FLAGGING;if(!(Oe||es||ye))return"";const he=s.issueType?.toString()===$e.DELETE_INDIVIDUAL,Re=s.issueType?.toString()===$e.ADD_INDIVIDUAL,Me=he&&s.ticketDetails?.approveStatus===!1,ps=Re&&s.ticketDetails?.approveStatus===!1,Je=ye&&s.ticketDetails?.approveStatus===!1;let Ts="";return Me?Ts=d("You did not approve any changes. Are you sure you want to close the ticket?"):ps?Ts=d("You did not approve any changes."):Je?Ts="":es&&(Ts=d(`By continuing you acknowledge that ${y?.memberLabelPlural} in this ticket were reviewed and all were deemed either distinct or duplicates in the system.`)),Ts},Y=()=>{switch(s.issueType?.toString()){case $e.EDIT_HOUSEHOLD:return G();case $e.EDIT_INDIVIDUAL:return G();default:return W()}},X=d("Are you sure you want to close the ticket?"),J=s?.postponeDeduplication===!0?d("This ticket will be closed without running the deduplication process."):null,ae=async Oe=>{await C({status:Oe})},re=()=>{const Oe=s.category.toString()===De.NEEDS_ADJUDICATION,es=s.category?.toString()===De.SYSTEM_FLAGGING;let ye="";es&&s.ticketDetails?.approveStatus===!1&&(ye=d(`By continuing you acknowledge that ${y?.memberLabelPlural} in this ticket were compared with the sanction list. No matches were found`));const he=s.household?.activeIndividualsCount===1;return(Oe||es)&&he&&(ye+=d(`When you close this ticket, the ${y?.groupLabel} that this ${y?.memberLabel} is a member of will be deactivated.`)),Oe?Y()+ye:`${X}${ye}`},se=s.category.toString()===De.NEEDS_ADJUDICATION,le=s?.ticketDetails?.hasDuplicatedDocument,ce=s?.ticketDetails?.isMultipleDuplicatesVersion,_e=s?.ticketDetails?.selectedIndividual,ne=s?.ticketDetails?.selectedDuplicates?.length,Ue=se&&le&&(ce&&ne||!ce&&_e),Te=s.ticketDetails?.householdData?.roles||s.ticketDetails?.roles||[],ie=Te.some(Oe=>Oe?.previous_value==="PRIMARY"),Pe=Te.some(Oe=>Oe?.value==="PRIMARY"),ue=ie&&!Pe,Ge=Oe=>ue?e.jsx(Ms,{title:d("Ticket cannot be closed, primary collector role has to be reassigned"),children:e.jsx("span",{children:Oe})}):Oe,ls=Ue?e.jsx(Tb,{title:d("Duplicate Document Conflict"),buttonText:d("Close Ticket"),message:d(`The ${y?.memberLabelPlural} have matching document numbers. HOPE requires that document numbers are unique. Please resolve before closing the ticket.`)}):e.jsx(ke,{loading:v,color:"primary",variant:"contained",onClick:()=>g({title:d("Close ticket"),extraContent:se?X:Y(),content:re(),warningContent:J,continueText:d("close ticket")}).then(async()=>{try{await ae(ze.CLOSED)}catch{}}),"data-cy":"button-close-ticket",disabled:!f||ue,children:d("Close Ticket")}),qe=()=>[$e.PAYMENT_COMPLAINT,$e.FSP_COMPLAINT].includes(s.issueType?.toString()),xs=ff(s.id,s.category,u);return e.jsx(Ze,{title:`Ticket ID: ${s.unicefId}`,breadCrumbs:b,flags:e.jsx(gt,{adminUrl:s.adminUrl}),children:e.jsxs(P,{display:"flex",alignItems:"center",children:[O&&t&&e.jsx(P,{mr:3,children:e.jsx(H,{color:"primary",variant:"outlined",component:ys,to:xs,startIcon:e.jsx(Ha,{}),"data-cy":"button-edit",disabled:!f,"data-perm":R.GRIEVANCES_UPDATE,children:d("Edit")})}),$&&e.jsx(P,{mr:3,children:e.jsx(H,{color:"primary",variant:"contained",component:ys,to:`/${u}/grievance/new-ticket?linked=${s.id}`,"data-cy":"button-create-linked-ticket",disabled:!f,children:d("Create Linked Ticket")})}),S&&t&&o&&e.jsx(Fb,{}),S&&t&&o&&e.jsx(ke,{loading:v,color:"primary",variant:"contained",onClick:()=>ae(ze.ASSIGNED),"data-cy":"button-assign-to-me",disabled:!f,children:d("ASSIGN TO ME")}),I&&a&&e.jsx(P,{mr:3,children:e.jsx(ke,{loading:v,color:"primary",variant:"contained",onClick:()=>{ae(ze.IN_PROGRESS)},"data-cy":"button-set-to-in-progress",disabled:!f,"data-perm":R.GRIEVANCES_SET_IN_PROGRESS,children:d("Set to in progress")})}),E&&e.jsxs(e.Fragment,{children:[n&&e.jsx(P,{mr:3,children:e.jsx(ke,{loading:v,color:"primary",variant:"outlined",onClick:()=>ae(ze.ON_HOLD),"data-cy":"button-set-on-hold","data-perm":R.GRIEVANCES_SET_ON_HOLD,disabled:!f,children:d("Set On Hold")})}),i&&e.jsx(P,{mr:3,children:e.jsx(ke,{loading:v,color:"primary",variant:"contained",onClick:()=>ae(ze.FOR_APPROVAL),"data-cy":"button-send-for-approval","data-perm":R.GRIEVANCES_SEND_FOR_APPROVAL,disabled:!f,children:d("Send For Approval")})}),k&&l&&Ge(e.jsx(H,{color:"primary",variant:"contained","data-perm":R.GRIEVANCES_CLOSE_TICKET_EXCLUDING_FEEDBACK,onClick:()=>g({content:X,continueText:"close ticket"}).then(()=>ae(ze.CLOSED)),"data-cy":"button-close-ticket",disabled:!f||ue,children:d("Close Ticket")}))]}),F&&e.jsxs(e.Fragment,{children:[a&&e.jsx(P,{mr:3,children:e.jsx(ke,{loading:v,color:"primary",variant:"contained","data-perm":R.GRIEVANCES_SET_IN_PROGRESS,onClick:()=>ae(ze.IN_PROGRESS),"data-cy":"button-set-to-in-progress",disabled:!f,children:d("Set to in progress")})}),i&&e.jsx(P,{mr:3,children:e.jsx(ke,{loading:v,color:"primary",variant:"contained","data-perm":R.GRIEVANCES_SEND_FOR_APPROVAL,onClick:()=>ae(ze.FOR_APPROVAL),"data-cy":"button-send-for-approval",disabled:!f,children:d("Send For Approval")})}),k&&l&&Ge(e.jsx(ke,{loading:v,color:"primary",variant:"contained","data-perm":R.GRIEVANCES_CLOSE_TICKET_EXCLUDING_FEEDBACK,onClick:()=>g({content:X,continueText:"close ticket"}).then(()=>ae(ze.CLOSED)),"data-cy":"button-close-ticket",disabled:!f||ue,children:d("Close Ticket")}))]}),D&&e.jsxs(e.Fragment,{children:[r&&e.jsx(P,{mr:3,children:e.jsx(ke,{loading:v,color:"primary",variant:"contained","data-perm":R.GRIEVANCES_SEND_BACK,onClick:()=>ae(ze.IN_PROGRESS),"data-cy":"button-send-back",disabled:!f,children:d("Send Back")})}),qe()&&e.jsx(P,{mr:3,children:e.jsx(H,{onClick:()=>x(`/${u}/grievance/new-ticket`,{state:{category:De.DATA_CHANGE,selectedIndividual:s.individual,selectedHousehold:s.household,linkedTicketId:s.id}}),variant:"outlined",color:"primary","data-cy":"button-create-data-change",disabled:!f,children:d("Create a Data Change ticket")})}),l&&Ge(ls)]})]})})};function Ob({ticket:s,canApproveDataChange:t}){const{t:a}=M(),{businessArea:n,businessAreaSlug:i}=U(),r=Fe(),{data:l,isLoading:o}=V({queryKey:["addIndividualFieldsAttributes",n],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllAddIndividualsFieldsAttributesList({businessAreaSlug:n})}),{mutateAsync:d}=xe({mutationFn:({grievanceTicketId:D,approveStatus:F})=>N.restBusinessAreasGrievanceTicketsApproveStatusUpdateCreate({businessAreaSlug:n,id:D,formData:{approveStatus:F}}),onSuccess:()=>{r.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",i,s.id]})}}),{selectedProgram:c}=Z(),u=c?.beneficiaryGroup,h=Nt(),{showMessage:m}=Ae();if(o)return e.jsx(Ne,{});if(!l)return null;const g=l?.reduce((D,F)=>({...D,[Zs(F?.name)]:F}),{})||{},x={...s.ticketDetails?.individualData},f=x?.documents,j=x?.identities;delete x.documents,delete x.identities;const y=x?.flexFields;delete x?.flexFields;const b=Object.entries(x||{}).map(([D,F])=>{let w=F;const O=g[D];return O?.type==="BOOL"&&(w=Va(F)),O?.type==="SELECT_ONE"&&(w=O.choices.find(k=>k.value===F)?.labelEn||"-"),Array.isArray(F)&&(w=F.map(k=>cl(k)).join(", ")),O?.type==="IMAGE"||D==="photo"?e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:Rn(D).replace(/_/g," "),value:F?e.jsx(nt,{src:F}):"-"})},D):e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:D==="sex"?a("GENDER"):Rn(D).replace(/_/g," "),value:e.jsx("span",{children:w})})},D)})||[],C=Object.entries(y||{}).map(([D,F])=>e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:D.replaceAll("_i_f","").replace(/_/g," "),value:Mp(D,F,g[D])})},D))||[],v=f?.map(D=>e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:D?.key?.replace(/_/g," "),value:D.number})},D?.country+D?.key))||[],S=j?.map(D=>{const F=D.partner||D.agency;return e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:F,value:D.number})},D.country+F)})||[],I=[...b,...C,...v,...S];let E=a(`You did not approve the following add ${u?.memberLabel} data. Are you sure you want to continue?`);return s.ticketDetails.approveStatus||(E=a(`You are approving the following Add ${u?.memberLabel} data. Are you sure you want to continue?`)),e.jsxs(aa,{children:[e.jsx(Ie,{children:e.jsxs(P,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(ee,{variant:"h6",children:a(`${u?.memberLabel} Data`)}),t&&e.jsx(H,{"data-cy":"button-approve","data-perm":R.GRIEVANCES_APPROVE_DATA_CHANGE,onClick:async()=>{try{await h({title:a("Warning"),content:E}),await d({grievanceTicketId:s.id,approveStatus:!s.ticketDetails.approveStatus}),s.ticketDetails.approveStatus&&m(a("Changes Disapproved")),s.ticketDetails.approveStatus||m(a("Changes Approved"))}catch(D){fe(D,m)}},variant:s.ticketDetails?.approveStatus?"outlined":"contained",color:"primary",disabled:s.status!==ze.FOR_APPROVAL,children:s.ticketDetails.approveStatus?a("Disapprove"):a("Approve")})]})}),e.jsx(p,{container:!0,spacing:6,children:I})]})}const kb=oe(Ob,"AddIndividualGrievanceDetails"),zs=T.div`
  width: 700px;
`,wb=T(P)`
  background-color: #fafafa;
  width: 100%;
`;function Su({children:s,...t}){return e.jsx(wb,{...t,children:s})}const Mb=T.div`
  margin-bottom: ${({theme:s})=>s.spacing(3)};
  .MuiFormLabel-root {
    color: ${({theme:s})=>s.palette.text.primary};
  }
  .MuiFormLabel-root.Mui-focused {
    color: ${({theme:s})=>s.palette.text.primary};
  }
  .MuiFormLabel-root:focus {
    color: ${({theme:s})=>s.palette.text.primary};
  }
`;function ea({field:s,form:t,withGreyBox:a=!1,alignItems:n="start",...i}){const r=l=>{t.setFieldValue(s.name,l.target.value),i.onChange&&i.onChange(l)};return e.jsxs(P,{mt:i.noMargin?0:6,mb:i.noMargin?0:2,children:[e.jsx(Mb,{children:e.jsx(ee,{variant:"caption",children:i.label})}),A.createElement(wn,{...s,...i,onChange:r,name:s.name,value:t.values[s.name],id:`radioGroup-${s.name}`,key:t.values[s.name]},i.choices.map(l=>e.jsx(P,{children:e.jsxs(P,{mb:1,display:"flex",alignItems:n,children:[e.jsx(kt,{color:"primary",value:l.value,checked:s.value===l.value,"data-cy":l?.dataCy}),a?e.jsx(Su,{p:2,children:e.jsx(P,{ml:2,children:l.optionLabel||l.name})}):e.jsx(P,{ml:2,children:l.optionLabel||l.name})]})},l.value)))]})}const $b=T(ma)`
  color: ${({theme:s})=>s.hctPalette.darkerBlue};
`,Ko=({ticket:s,type:t})=>{const{t:a}=M(),[n,i]=A.useState(!1),r=Fe(),{businessAreaSlug:l}=U(),{showMessage:o}=Ae(),d=s.status===ze.FOR_APPROVAL,{approveStatus:c,reasonHousehold:u}=s.ticketDetails,{selectedProgram:h}=Z(),m=h?.beneficiaryGroup,g=xe({mutationFn:({approveStatus:y,reasonHhId:b})=>N.restBusinessAreasGrievanceTicketsApproveDeleteHouseholdCreate({businessAreaSlug:l,id:s.id,formData:{approveStatus:y,reasonHhId:b}}),onSuccess:()=>{r.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",l,s.id]})}}),x=Q.object().shape({reasonHhId:Q.string().when("withdrawReason",y=>String(y)==="duplicate"&&!c?Q.string().required(`${m?.groupLabel} Unicef Id is required`).max(15,"Too long"):Q.string())}),f=()=>a(c&&t!=="edit"?"Warning":"Reason of withdrawal"),j=()=>!!(c&&t==="edit"||!c&&t==="button");return e.jsx(B.Formik,{enableReinitialize:!0,initialValues:{withdrawReason:u?"duplicate":"other",reasonHhId:t==="edit"?u?.unicefId:""},validationSchema:x,onSubmit:async(y,{resetForm:b})=>{try{await g.mutateAsync({approveStatus:t==="edit"?!0:!c,reasonHhId:y.withdrawReason==="duplicate"?y.reasonHhId:""}),t==="edit"&&o(a("Changes Approved")),c&&o(a("Changes Disapproved")),c||o(a("Changes Approved")),i(!1),b()}catch(C){fe(C,o)}},children:({values:y,submitForm:b,resetForm:C})=>e.jsxs(e.Fragment,{children:[e.jsx(P,{sx:{p:2},children:t==="edit"?e.jsx(Ve,{"data-cy":"edit-button",onClick:()=>i(!0),children:e.jsx($b,{})}):e.jsx(H,{"data-cy":"button-approve","data-perm":R.GRIEVANCES_APPROVE_DATA_CHANGE,onClick:()=>i(!0),variant:c?"outlined":"contained",color:"primary",disabled:!d,children:a(c?"Disapprove":"Approve")})}),e.jsxs(Ks,{open:n,onClose:()=>i(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:f()})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsxs(P,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(P,{sx:{mt:2},children:e.jsx(ee,{variant:"body2",children:j()?a(`Please provide the reason of withdrawal of this ${m?.groupLabel}.`):a(`You did not approve the following ${m?.groupLabel} to be withdrawn. Are you sure you want to continue?`)})}),j()&&e.jsxs(P,{children:[e.jsx(B.Field,{name:"withdrawReason",choices:[{value:"duplicate",name:`This ${m?.groupLabel} is a duplicate of another ${m?.groupLabel}`}],component:ea,noMargin:!0}),y.withdrawReason==="duplicate"&&e.jsx(p,{container:!0,children:e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"reasonHhId",fullWidth:!0,variant:"outlined",label:`${m?.groupLabel} Unicef Id`,component:Se,required:!0})})}),e.jsx(B.Field,{name:"withdrawReason",choices:[{value:"other",name:"Other"}],component:ea,noMargin:!0})]})]})})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>{i(!1),C()},children:a("CANCEL")}),e.jsx(H,{type:"submit",color:"primary",variant:"contained",onClick:b,"data-cy":"button-submit",children:a("Confirm")})]})})]})]})})},Ub=T(dn)`
  color: ${({theme:s})=>s.hctPalette.gray};
  margin-right: 10px;
`;function Vb({ticket:s,canApproveDataChange:t}){const{t:a}=M(),{baseUrl:n,businessArea:i,isAllPrograms:r}=U(),{selectedProgram:l}=Z(),o=l?.beneficiaryGroup,{data:d,isLoading:c}=V({queryKey:["householdChoices",i],queryFn:()=>N.restBusinessAreasHouseholdsChoicesRetrieve({businessAreaSlug:i})});if(c)return e.jsx(Ne,{});if(!d)return null;const u=_s(d.residenceStatusChoices),{approveStatus:h}=s.ticketDetails;return e.jsxs(aa,{children:[e.jsx(Ie,{children:e.jsxs(P,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(ee,{variant:"h6",children:`${o?.groupLabel} to be withdrawn`}),h&&s.ticketDetails.reasonHousehold&&e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsx(Ub,{}),e.jsx(P,{mr:2,children:e.jsxs("p",{children:["This ",o?.groupLabel," is a duplicate of a"," ",o?.groupLabel," ID:"]})}),r?e.jsx("span",{children:s.ticketDetails.reasonHousehold.unicefId}):e.jsx(me,{to:`/${n}/population/household/${s.ticketDetails.reasonHousehold.id}`,children:s.ticketDetails.reasonHousehold.unicefId}),t&&e.jsx(Ko,{type:"edit",ticket:s})]}),t&&e.jsx(Ko,{type:"button",ticket:s})]})}),e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:3,children:e.jsx(L,{label:`${o?.groupLabel} Size`,children:s.household.size})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Residence Status"),children:u[s.household.residenceStatus]})}),e.jsx(p,{size:3,children:e.jsx(L,{label:`Head of ${o?.groupLabel}`,children:e.jsx(Us,{href:`/${n}/population/individuals/${s.household.headOfHousehold.id}`,children:s.household.headOfHousehold.fullName})})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Country"),children:s.household.country})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Country of Origin"),children:s.household.countryOrigin})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Address"),children:s.household.address})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Village"),children:s.household.village})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Administrative Level 1"),children:s.household.admin1?.name})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Administrative Level 2"),children:s.household.admin2?.name})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Geolocation"),children:s.household?.geopoint||"-"})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("UNHCR CASE ID"),children:s.household?.unhcrId})})]})]})}function Bb({ticket:s,canApproveDataChange:t}){const{t:a}=M(),{showMessage:n}=Ae(),{businessAreaSlug:i}=U(),r=Nt(),{selectedProgram:l}=Z(),o=l?.beneficiaryGroup,d=s.status===ze.FOR_APPROVAL,c=s?.individual?.id===s?.household?.headOfHousehold?.id,u=s?.household?.activeIndividualsCount===1,h=s?.individual?.rolesInHouseholds.filter(w=>w.role==="PRIMARY").length+(c?1:0),m=Object.values(s.ticketDetails.roleReassignData)?.filter(w=>w.role==="PRIMARY"||w.role==="HEAD").length,g=()=>!!(u&&d||d&&h===m),{businessArea:x}=U(),f=Fe(),{data:j,isLoading:y}=V({queryKey:["allAddIndividualsFieldsAttributes",x],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllAddIndividualsFieldsAttributesList({businessAreaSlug:x})}),b=xe({mutationFn:({grievanceTicketId:w,approveStatus:O})=>N.restBusinessAreasGrievanceTicketsApproveStatusUpdateCreate({businessAreaSlug:x,id:w,formData:{approveStatus:O}}),onSuccess:()=>{f.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",i,s.id]})}});if(y)return e.jsx(Ne,{});if(!j)return null;const C=s.individual?.documents,v=j?.reduce((w,O)=>({...w,[O?.name]:O}),{}),S=["household","documents","rolesInHouseholds","identities","headingHousehold","flexFields","id","sanctionListLastCheck","createdAt","updatedAt","typeName","commsDisability"],I=Object.entries(s.individual||{}).filter(([w])=>{const O=jo(w);return v[O]&&!S.includes(w)}).map(([w,O])=>{let k=O;const $=jo(w),G=v[$];return(G?.type==="SELECT_MANY"||G?.type==="SELECT_ONE")&&(O instanceof Array?k=O.map(W=>G.choices.find(Y=>Y.value===W)?.labelEn||"-").join(", "):(k=k==="A_"?null:k,k=k?G.choices.find(W=>W.value===k)?.labelEn:"-")),G?.type==="DATE"&&(k=e.jsx(pe,{children:k})),e.jsx(p,{size:6,children:e.jsx(L,{label:$==="sex"?a("GENDER"):$.replace(/_/g," "),value:e.jsx(e.Fragment,{children:k})})},w)})||[],E=C?.map(w=>{const O=w;return e.jsx(p,{size:6,children:e.jsx(L,{label:O.type.label.replace(/_/g," "),value:O.documentNumber})},O.country+O.type.label)})||[],D=[...I,...E];let F=a(`You did not approve the following ${o?.memberLabel} to be withdrawn. Are you sure you want to continue?`);return s.ticketDetails.approveStatus||(F=a(`You are approving the following ${o?.memberLabel} to be withdrawn. Are you sure you want to continue?`)),e.jsxs(aa,{children:[e.jsx(Ie,{children:e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(ee,{variant:"h6",children:a(`${o?.memberLabel} to be withdrawn`)}),t&&e.jsx(H,{"data-cy":"button-approve","data-perm":R.GRIEVANCES_APPROVE_DATA_CHANGE,onClick:()=>r({title:a("Warning"),content:F}).then(async()=>{try{await b.mutateAsync({grievanceTicketId:s.id,approveStatus:!s.ticketDetails?.approveStatus}),s.ticketDetails.approveStatus&&n(a("Changes Disapproved")),s.ticketDetails.approveStatus||n(a("Changes Approved"))}catch(w){fe(w,n)}}),variant:s.ticketDetails?.approveStatus?"outlined":"contained",color:"primary",disabled:!g(),children:s.ticketDetails?.approveStatus?a("Disapprove"):a("Approve")})]})}),e.jsx(p,{container:!0,spacing:6,children:D})]})}const Gb=T(Hh)`
  color: ${({theme:s,confirmed:t})=>t?"deeppink":s.hctPalette.orange};
`;function Ga({confirmed:s,message:t="",handleClick:a}){return e.jsx(Ms,{onClick:a,title:t,children:e.jsx(Gb,{confirmed:s})})}function zb({individual:s}){return e.jsxs(be,{children:[e.jsx(_,{align:"left",children:s.referenceNumber}),e.jsx(_,{align:"left",children:s.fullName}),e.jsx(_,{align:"left",children:s.datesOfBirth.map(t=>fs(t.date).format(Rl)).join(", ")||"-"}),e.jsx(_,{align:"left",children:s.documents.map(t=>t.documentNumber).join(", ")||"-"})]})}const qb=[{disablePadding:!1,label:"Ref. No. on Sanction List",id:"referenceNumber",numeric:!1,dataCy:"refNo"},{disablePadding:!1,label:"Full Name",id:"fullName",numeric:!1,dataCy:"fullName"},{disablePadding:!1,label:"Dates of Birth",id:"datesOfBirth",numeric:!1,dataCy:"datesOfBirth"},{disablePadding:!1,label:"National Ids",id:"documents",numeric:!1,dataCy:"documents"}];function Hb({filter:s}){const{businessAreaSlug:t}=U(),a=A.useMemo(()=>({businessAreaSlug:t,fullName:s.fullName||void 0,referenceNumber:s.referenceNumber||void 0}),[t,s.fullName,s.referenceNumber]),[n,i]=A.useState(a);A.useEffect(()=>{i(a)},[a]);const[r,l]=A.useState(0),{data:o,isLoading:d,error:c}=V({queryKey:["restSanctionListList",n],queryFn:()=>N.restBusinessAreasSanctionListList({...n})});return e.jsx(ds,{title:"",headCells:qb,queryVariables:n,setQueryVariables:i,data:o,isLoading:d,error:c,itemsCount:o?.results?.length,page:r,setPage:l,renderRow:u=>e.jsx(zb,{individual:u},u.id)})}function Wb({referenceNumber:s}){const{t}=M(),[a,n]=A.useState(!1),i={fullName:"",referenceNumber:s},[r,l]=A.useState({fullName:"",referenceNumber:s}),o=qt(r,500),d=(c,u)=>l({...r,[u]:c.target.value});return e.jsxs(e.Fragment,{children:[e.jsx(H,{color:"primary",onClick:()=>n(!0),children:t("VIEW SANCTION LIST")}),e.jsxs(Ks,{fullWidth:!0,maxWidth:"md",open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Sanction List View")})}),e.jsxs(Be,{children:[e.jsx(P,{mb:3,children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{children:e.jsx(Cs,{label:t("Reference Number"),value:r.referenceNumber,onChange:c=>d(c,"referenceNumber"),"data-cy":"filters-search"})}),e.jsx(p,{children:e.jsx(Cs,{label:t("Full Name"),value:r.fullName,onChange:c=>d(c,"fullName"),"data-cy":"filters-search"})})]})}),e.jsx(Hb,{filter:o})]}),e.jsx(ss,{children:e.jsx(os,{children:e.jsx(H,{onClick:()=>{l(i),n(!1)},children:t("CLOSE")})})})]})]})}const Kb=T(gs)`
  min-width: 100px;
`,Yb=({ticket:s,canApproveFlag:t})=>{const{t:a}=M(),n=Nt(),{businessArea:i,businessAreaSlug:r}=U(),l=Fe(),o=xe({mutationFn:({grievanceTicketId:m,approveStatus:g})=>N.restBusinessAreasGrievanceTicketsApproveStatusUpdateCreate({businessAreaSlug:i,id:m,formData:{approveStatus:g}}),onSuccess:()=>{l.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",r,s.id]})}}),d=a("Are you sure you want to confirm flag (sanction list match) ?"),c=a("Are you sure you want to remove the flag ?"),u=s.ticketDetails,h=u.approveStatus;return e.jsxs(aa,{children:[e.jsx(Ie,{children:e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(ee,{variant:"h6",children:a("Flag Details")}),e.jsxs(P,{children:[e.jsx(Wb,{referenceNumber:u.sanctionListIndividual.referenceNumber}),t&&e.jsx(H,{disabled:s.status!==ze.FOR_APPROVAL,onClick:()=>n({content:h?c:d}).then(()=>o.mutateAsync({grievanceTicketId:s.id,approveStatus:!u.approveStatus})),variant:"outlined",color:"primary",children:a(h?"REMOVE FLAG":"CONFIRM FLAG")})]})]})}),e.jsxs(Kb,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{align:"left",children:a("Ref. No. on Sanction List")}),e.jsx(_,{align:"left",children:a("Full Name")}),e.jsx(_,{align:"left",children:a("Date of Birth")}),e.jsx(_,{align:"left",children:a("National Ids")}),e.jsx(_,{align:"left",children:a("Source")})]})}),e.jsxs(cs,{children:[e.jsxs(be,{children:[e.jsx(_,{align:"left",children:h?e.jsx(Ga,{message:a("Sanction List Confirmed Match"),confirmed:!0}):""}),e.jsx(_,{align:"left",children:"-"}),e.jsx(_,{align:"left",children:u.goldenRecordsIndividual.fullName}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:u.goldenRecordsIndividual.birthDate})}),e.jsx(_,{align:"left",children:u.goldenRecordsIndividual.documents.filter(m=>m.type.key==="NATIONAL_ID").map(m=>m.documentNumber).join(", ")||"-"}),e.jsx(_,{align:"left",children:a("Golden Record")})]}),e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{align:"left",children:u.sanctionListIndividual.referenceNumber}),e.jsx(_,{align:"left",children:u.sanctionListIndividual.fullName}),e.jsx(_,{align:"left",children:u.sanctionListIndividual.datesOfBirth.map(m=>fs(m.date).format(Rl)).join(", ")||"-"}),e.jsx(_,{align:"left",children:u.sanctionListIndividual.documents.map(m=>m.documentNumber).join(", ")||"-"}),e.jsx(_,{align:"left",children:u.sanctionListIndividual.sanctionListName})]})]})]})]})},Yo=()=>e.jsx(P,{display:"flex",justifyContent:"center",alignItems:"center",width:"45%",height:"200px",border:"1px solid #ccc","data-cy":"placeholder",children:e.jsx(Wa,{color:"primary",style:{fontSize:100}})}),Qb=({ticketId:s,similarityScore:t,individual1:a,individual2:n,statusCode:i})=>{const{t:r}=M(),[l,o]=A.useState(!1),d=ve(),c=K(R.GRIEVANCES_VIEW_BIOMETRIC_RESULTS,d),{selectedProgram:u}=Z(),h=u?.beneficiaryGroup,{businessAreaSlug:m}=U(),{showMessage:g}=Ae(),{mutateAsync:x}=xe({mutationFn:()=>N.restBusinessAreasGrievanceTicketsRetrieve({businessAreaSlug:m,id:s}),onError:f=>{fe(f,g)}});return e.jsxs(e.Fragment,{children:[c&&e.jsx(P,{p:2,children:e.jsx(H,{onClick:()=>{o(!0),x()},"data-cy":"button-open-biometrics-results","data-perm":R.GRIEVANCES_VIEW_BIOMETRIC_RESULTS,children:r("View Biometrics Results")})}),e.jsxs(Ks,{open:l,onClose:()=>o(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md","data-cy":"dialog-biometrics-results",children:[e.jsx(Ye,{children:e.jsx(Le,{"data-cy":"dialog-title",children:r("Biometrics Results")})}),e.jsx(Be,{"data-cy":"dialog-content",children:e.jsxs(zs,{children:[e.jsxs(P,{display:"flex",justifyContent:"space-between",p:5,children:[a?.unicefId&&e.jsxs(P,{display:"flex",flexDirection:"column",children:[a?.photo?e.jsx("img",{src:a?.photo,alt:"Image 1",style:{maxWidth:"100%",maxHeight:"300px",objectFit:"cover"},"data-cy":"image1"}):e.jsx(Yo,{}),e.jsxs(ee,{variant:"subtitle2",children:[h?.memberLabel," ",a?.unicefId,":"," ",a?.fullName]})]}),n?.unicefId&&e.jsxs(P,{display:"flex",flexDirection:"column",children:[n?.photo?e.jsx("img",{src:n?.photo,alt:"Image 2",style:{maxWidth:"100%",maxHeight:"300px",objectFit:"cover"},"data-cy":"image2"}):e.jsx(Yo,{}),e.jsxs(ee,{variant:"subtitle2",children:[h?.memberLabel," ",n?.unicefId,":"," ",n?.fullName]})]})]}),e.jsxs(P,{p:5,"data-cy":"results-info",children:[e.jsx("div",{children:e.jsxs("strong",{children:[r("Algorithm similarity score:")," ",t]})}),Number(t)>0?e.jsx("div",{children:r("Face images matching suggests: Duplicates")}):i]})]})}),e.jsx(ss,{children:e.jsx(Gs,{children:e.jsx(H,{onClick:()=>o(!1),"data-cy":"button-close",children:r("CLOSE")})})})]})]})},Xb=({ticket:s,isEditable:t,canApprove:a,isTicketForApproval:n,selectedIndividualIds:i,setIsEditMode:r,setSelectedIndividualIds:l})=>{const{showMessage:o}=Ae(),{t:d}=M(),{baseUrl:c,businessArea:u}=U(),h=ge(),m=Nt(),{isActiveProgram:g}=Z(),x=!n||!g||!i.length,{dedupEngineSimilarityPair:f}=s.ticketDetails.extraData,{mutateAsync:j,isPending:y}=xe({mutationFn:async b=>N.restBusinessAreasGrievanceTicketsApproveNeedsAdjudicationCreate({businessAreaSlug:u,id:s.id,formData:b}),onSuccess:()=>{o(d("Action successful")),l([])},onError:b=>{fe(b,o)}});return e.jsxs(P,{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,children:[e.jsxs(P,{display:"flex",gap:2,children:[e.jsx(H,{onClick:()=>h(`/${c}/grievance/new-ticket`,{state:{linkedTicketId:s.id}}),variant:"outlined",color:"primary","data-cy":"button-create-linked-ticket","data-perm":R.GRIEVANCES_CREATE,disabled:!g,children:d("Create Linked Ticket")}),!t&&e.jsx(H,{variant:"outlined","data-perm":R.GRIEVANCES_UPDATE,color:"primary","data-cy":"button-edit",disabled:s.status!==ze.FOR_APPROVAL,onClick:()=>r(!0),children:d("Edit")}),f&&e.jsx(Qb,{ticketId:s.id,similarityScore:f.similarityScore,individual1:f.individual1,individual2:f.individual2,statusCode:f.statusCode}),t&&a&&e.jsxs(e.Fragment,{children:[e.jsx(H,{disabled:x||y,"data-cy":"button-mark-distinct","data-perm":R.GRIEVANCES_APPROVE_DATA_CHANGE,onClick:()=>m({content:"Are you sure you want to mark this record as distinct?"}).then(async()=>{try{await j({distinctIndividualIds:i})}catch(b){fe(b,o)}r(!1)}),variant:"contained",color:"primary",children:d("Mark as Distinct")}),e.jsx(H,{disabled:x||y,"data-cy":"button-mark-duplicate","data-perm":R.GRIEVANCES_APPROVE_DATA_CHANGE,onClick:()=>m({content:d("Are you sure you want to mark this record as a duplicate?")}).then(async()=>{try{await j({duplicateIndividualIds:i})}catch(b){fe(b,o)}r(!1)}),variant:"contained",color:"primary",children:d("Mark as Duplicate")})]})]}),e.jsx(H,{variant:"outlined",color:"error","data-cy":"button-clear",disabled:x||y,onClick:()=>m({content:d("Are you sure you want to clear the selected ids? They won't be marked as a duplicate or distinct anymore.")}).then(async()=>{try{await j({clearIndividualIds:i})}catch(b){o(b?.body?.errors||b?.message||"An error occurred")}r(!1)}),endIcon:e.jsx(Wh,{}),children:d("Clear")})]})},Jb=({ticket:s,isEditable:t,selectedIndividualIds:a,setSelectedIndividualIds:n,getGoldenRecordSimilarity:i,getPossibleDuplicateSimilarity:r,markedDistinctInPossibleDuplicates:l,markedDuplicateInPossibleDuplicates:o})=>{const{t:d}=M(),{baseUrl:c,isAllPrograms:u}=U(),{isActiveProgram:h,isSocialDctType:m}=Z(),{selectedProgram:g}=Z(),x=g?.beneficiaryGroup,f=s?.ticketDetails,j=D=>{n(F=>F.includes(D)?F.filter(w=>w!==D):[...F,D])},y=()=>{const D=[...f.possibleDuplicates.map(F=>F.id)];return f.goldenRecordsIndividual&&D.push(f.goldenRecordsIndividual.id),D},b=D=>{D.target.checked?n(y()):n([])},C=()=>y().every(F=>a.includes(F)),v=e.jsx(Ms,{"data-cy":"people-icon-tooltip",title:"Marked as Duplicate",children:e.jsx(Kh,{"data-cy":"people-icon",color:"primary"})}),S=e.jsx(Ms,{"data-cy":"person-icon-tooltip",title:"Marked as Distinct",children:e.jsx(Wa,{"data-cy":"person-icon",color:"primary"})}),I=!t||s.status!==ze.FOR_APPROVAL||!h,E=D=>e.jsxs(be,{"data-cy":`possible-duplicate-row-${D?.unicefId}`,children:[e.jsx(_,{align:"left","data-cy":"checkbox-cell",children:e.jsx(ns,{color:"primary",disabled:I,checked:a.includes(D.id),onChange:()=>j(D.id),"data-cy":"select-checkbox"})}),e.jsx(_,{align:"left","data-cy":"distinct-duplicate-cell",children:(()=>{const{id:F}=D;return l.includes(F)?S:o.includes(F)?v:"-"})()}),e.jsx(_,{align:"left","data-cy":"individual-id-cell",children:u?e.jsx("span",{"data-cy":"individual-id",children:D?.unicefId}):e.jsx(me,{to:`/${c}/population/individuals/${D?.id}`,"data-cy":"individual-link",children:D?.unicefId})}),!m&&e.jsx(_,{align:"left","data-cy":"household-id-cell",children:u?e.jsx("span",{"data-cy":"household-id",children:D?.household?.unicefId||"-"}):e.jsx(me,{to:`/${c}/population/household/${D?.household?.id}`,"data-cy":"household-link",children:D?.household?.unicefId||"-"})}),e.jsx(_,{align:"left","data-cy":"full-name-cell",children:D?.fullName}),e.jsx(_,{align:"left","data-cy":"sex-cell",children:D?.sex}),e.jsx(_,{align:"left","data-cy":"birth-date-cell",children:e.jsx(pe,{children:D?.birthDate})}),e.jsx(_,{align:"left","data-cy":"similarity-cell",children:r(D)}),e.jsx(_,{align:"left","data-cy":"last-registration-date-cell",children:e.jsx(pe,{children:D?.lastRegistrationDate})}),e.jsx(_,{align:"left","data-cy":"document-type-cell",children:D?.documents?.[0]?.type.label}),e.jsx(_,{align:"left","data-cy":"document-number-cell",children:D?.documents?.[0]?.documentNumber}),e.jsx(_,{align:"left","data-cy":"admin2-name-cell",children:D?.household?.admin2?.name}),e.jsx(_,{align:"left","data-cy":"village-cell",children:D?.household?.village})]},D.id);return e.jsxs(Bl,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left",children:e.jsx(ns,{indeterminate:a.length>0&&!C,checked:C(),onChange:b,disabled:I,"data-cy":"select-all-checkbox"})}),e.jsx(_,{"data-cy":"table-cell-uniqueness",align:"left",children:d("Uniqueness")}),e.jsxs(_,{"data-cy":"table-cell-individual-id",align:"left",children:[x?.memberLabel," ID"]}),!m&&e.jsxs(_,{"data-cy":"table-cell-household-id",align:"left",children:[x?.groupLabel," ID"]}),e.jsx(_,{"data-cy":"table-cell-full-name",align:"left",children:d("Full Name")}),e.jsx(_,{"data-cy":"table-cell-gender",align:"left",children:d("Gender")}),e.jsx(_,{"data-cy":"table-cell-date-of-birth",align:"left",children:d("Date of Birth")}),e.jsx(_,{"data-cy":"table-cell-similarity-score",align:"left",children:d("Similarity Score")}),e.jsx(_,{"data-cy":"table-cell-last-registration-date",align:"left",children:d("Last Registration Date")}),e.jsx(_,{"data-cy":"table-cell-doc-type",align:"left",children:d("Doc Type")}),e.jsx(_,{"data-cy":"table-cell-doc-number",align:"left",children:d("Doc #")}),e.jsx(_,{"data-cy":"table-cell-admin-level2",align:"left",children:d("Admin Level 2")}),e.jsx(_,{"data-cy":"table-cell-village",align:"left",children:d("Village")})]})}),e.jsxs(cs,{children:[e.jsxs(be,{"data-cy":`possible-duplicate-row-${f.goldenRecordsIndividual?.unicefId}`,children:[e.jsx(_,{align:"left",children:e.jsx(ns,{color:"primary","data-cy":"checkbox-individual",disabled:I,checked:a.includes(f.goldenRecordsIndividual?.id),onChange:()=>j(f.goldenRecordsIndividual?.id)})}),e.jsx(_,{align:"left","data-cy":"distinct-duplicate-golden-cell",children:f.goldenRecordsIndividual?(()=>{const D=f.goldenRecordsIndividual.id;return l.includes(D)?S:o.includes(D)?v:"-"})():"-"}),e.jsx(_,{align:"left","data-cy":"individual-id-cell",children:u?e.jsx("span",{"data-cy":"individual-id",children:f.goldenRecordsIndividual?.unicefId}):e.jsx(me,{to:`/${c}/population/individuals/${f.goldenRecordsIndividual?.id}`,"data-cy":"individual-link",children:f.goldenRecordsIndividual?.unicefId})}),!m&&e.jsx(_,{align:"left","data-cy":"household-id-cell",children:u?e.jsx("span",{"data-cy":"household-id",children:f.goldenRecordsIndividual?.household?.unicefId||"-"}):e.jsx(me,{to:`/${c}/population/household/${f.goldenRecordsIndividual?.household?.id}`,"data-cy":"household-link",children:f.goldenRecordsIndividual?.household?.unicefId||"-"})}),e.jsx(_,{align:"left","data-cy":"full-name-cell",children:f.goldenRecordsIndividual?.fullName}),e.jsx(_,{align:"left","data-cy":"gender-cell",children:f.goldenRecordsIndividual?.sex}),e.jsx(_,{align:"left","data-cy":"birth-date-cell",children:e.jsx(pe,{children:f.goldenRecordsIndividual?.birthDate})}),e.jsx(_,{align:"left","data-cy":"similarity-score-cell",children:i()}),e.jsx(_,{align:"left","data-cy":"last-registration-date-cell",children:e.jsx(pe,{children:f.goldenRecordsIndividual?.lastRegistrationDate})}),e.jsx(_,{align:"left","data-cy":"doc-type-cell",children:f.goldenRecordsIndividual?.documents?.[0]?.type.label}),e.jsx(_,{align:"left","data-cy":"doc-number-cell",children:f.goldenRecordsIndividual?.documents?.[0]?.documentNumber}),e.jsx(_,{align:"left","data-cy":"admin-level2-cell",children:f.goldenRecordsIndividual?.household?.admin2?.name}),e.jsx(_,{align:"left","data-cy":"village-cell",children:f.goldenRecordsIndividual?.household?.village})]}),f.possibleDuplicates.map(D=>E(D))]})]})},Zb=({ticket:s,canApprove:t})=>{const{t:a}=M(),n=s.ticketDetails,{extraData:i,goldenRecordsIndividual:r,possibleDuplicate:l,possibleDuplicates:o}=n,[d,c]=A.useState([]),[u,h]=A.useState(!1),m=E=>D=>D.hitId===E,g=(E,D)=>E?.find(m(D))?.score,x=()=>{const E=l?.id,D=i?.goldenRecords,F=r?.deduplicationGoldenRecordResults;return g(D,E)||g(F,E)||"-"},f=()=>{const E=r?.id,D=i?.possibleDuplicate,F=l?.deduplicationGoldenRecordResults;return g(D,E)||g(F,E)||"-"},j=!!n.selectedIndividual,y=u||!j,b=s.status===ze.FOR_APPROVAL,{selectedDuplicates:C,selectedDistinct:v}=s.ticketDetails,S=[...C.map(E=>E.id).filter(E=>[...o,r].map(D=>D.id).includes(E))],I=[...v.map(E=>E.id).filter(E=>[...o,r].map(D=>D.id).includes(E))];return e.jsxs(aa,{children:[e.jsx(Ie,{children:e.jsx(P,{display:"flex",justifyContent:"space-between",children:e.jsx(ee,{"data-cy":"approve-box-needs-adjudication-title",variant:"h6",children:a("Needs Adjudication Details")})})}),e.jsx(Xb,{ticket:s,isEditable:y,canApprove:t,isTicketForApproval:b,selectedIndividualIds:d,setIsEditMode:h,setSelectedIndividualIds:c}),e.jsx(Jb,{ticket:s,selectedIndividualIds:d,setSelectedIndividualIds:c,isEditable:y,markedDuplicateInPossibleDuplicates:S,markedDistinctInPossibleDuplicates:I,getGoldenRecordSimilarity:x,getPossibleDuplicateSimilarity:f})]})},ej=({ticket:s,canApprove:t})=>{const{t:a}=M(),{businessAreaSlug:n,baseUrl:i,isAllPrograms:r}=U(),l=ge(),o=Nt(),{isActiveProgram:d}=Z(),{selectedProgram:c}=Z(),u=c?.beneficiaryGroup,{businessArea:h}=U(),m=Fe(),g=xe({mutationFn:({grievanceTicketId:O,approveStatus:k})=>N.restBusinessAreasGrievanceTicketsApproveStatusUpdateCreate({businessAreaSlug:h,id:O,formData:{approveStatus:k}}),onSuccess:()=>{m.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",n,s.id]})}}),x=s.ticketDetails,[f,j]=A.useState(x?.selectedIndividual?.id),[y,b]=A.useState(!1),C=a("Are you sure you want to mark this record as duplicate? It will be removed from Golden Records upon ticket closure."),v=!!x.selectedIndividual,S=y||!v,I=()=>s.status!==ze.FOR_APPROVAL||!f,E=O=>k=>k.hitId===O,D=(O,k)=>O?.find(E(k))?.score,F=()=>{const{extraData:O,goldenRecordsIndividual:k,possibleDuplicate:$}=x,G=$?.id,W=O?.goldenRecords,Y=k?.deduplicationGoldenRecordResults;return D(W,G)||D(Y,G)||"-"},w=()=>{const{extraData:O,goldenRecordsIndividual:k,possibleDuplicate:$}=x,G=k?.id,W=O?.possibleDuplicate,Y=$?.deduplicationGoldenRecordResults;return D(W,G)||D(Y,G)||"-"};return e.jsxs(aa,{children:[e.jsx(Ie,{children:e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(ee,{variant:"h6",children:a("Needs Adjudication Details")}),e.jsxs(P,{gap:24,display:"flex",children:[e.jsx(H,{onClick:()=>l(`/${i}/grievance/new-ticket`,{state:{linkedTicketId:s.id}}),variant:"outlined",color:"primary","data-cy":"button-create-linked-ticket","data-perm":R.GRIEVANCES_CREATE,children:a("Create Linked Ticket")}),!S&&e.jsx(H,{variant:"outlined",color:"primary","data-cy":"button-edit",disabled:s.status!==ze.FOR_APPROVAL,onClick:()=>b(!0),children:a("Edit")}),S&&t&&e.jsx(H,{disabled:I()||!d||f===x?.selectedIndividual?.id,"data-cy":"button-mark-duplicate",onClick:()=>o({content:C}).then(()=>{g.mutateAsync({grievanceTicketId:s.id,approveStatus:!0}),b(!1)}),variant:"outlined",color:"primary",children:a("Mark as Duplicate")})]})]})}),e.jsxs(Bl,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{"data-cy":"table-cell-individual-id",align:"left",children:`${u?.memberLabel} ID`}),e.jsx(_,{"data-cy":"table-cell-household-id",align:"left",children:`${u?.groupLabel} ID`}),e.jsx(_,{"data-cy":"table-cell-full-name",align:"left",children:a("Full Name")}),e.jsx(_,{"data-cy":"table-cell-gender",align:"left",children:a("Gender")}),e.jsx(_,{"data-cy":"table-cell-date-of-birth",align:"left",children:a("Date of Birth")}),e.jsx(_,{"data-cy":"table-cell-similarity-score",align:"left",children:a("Similarity Score")}),e.jsx(_,{"data-cy":"table-cell-last-registration-date",align:"left",children:a("Last Registration Date")}),e.jsx(_,{"data-cy":"table-cell-doc-type",align:"left",children:a("Doc Type")}),e.jsx(_,{"data-cy":"table-cell-doc-number",align:"left",children:a("Doc #")}),e.jsx(_,{"data-cy":"table-cell-admin-level2",align:"left",children:a("Admin Level 2")}),e.jsx(_,{"data-cy":"table-cell-village",align:"left",children:a("Village")})]})}),e.jsxs(cs,{children:[e.jsxs(be,{children:[e.jsx(_,{align:"left",children:e.jsx(ns,{color:"primary","data-cy":"checkbox-individual",disabled:!S||s.status!==ze.FOR_APPROVAL||!d,checked:f===x.goldenRecordsIndividual?.id,onChange:(O,k)=>j(k?x.goldenRecordsIndividual?.id:null)})}),e.jsx(_,{align:"left",children:r?e.jsx("span",{children:x.goldenRecordsIndividual?.unicefId}):e.jsx(me,{to:`/${i}/population/individuals/${x.goldenRecordsIndividual?.id}`,children:x.goldenRecordsIndividual?.unicefId})}),e.jsx(_,{align:"left",children:r?e.jsx("span",{children:x.goldenRecordsIndividual?.household?.unicefId||"-"}):e.jsx(me,{to:`/${i}/population/household/${x.goldenRecordsIndividual?.household?.id}`,children:x.goldenRecordsIndividual?.household?.unicefId||"-"})}),e.jsx(_,{align:"left",children:x.goldenRecordsIndividual?.fullName}),e.jsx(_,{align:"left",children:x.goldenRecordsIndividual?.sex}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:x.goldenRecordsIndividual?.birthDate})}),e.jsx(_,{align:"left",children:F()}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:x.goldenRecordsIndividual?.lastRegistrationDate})}),e.jsx(_,{align:"left",children:x.goldenRecordsIndividual?.documents[0]?.type.label}),e.jsx(_,{align:"left",children:x.goldenRecordsIndividual?.documents[0].documentNumber}),e.jsx(_,{align:"left",children:x.goldenRecordsIndividual?.household?.admin2?.name}),e.jsx(_,{align:"left",children:x.goldenRecordsIndividual?.household?.village})]}),e.jsxs(be,{children:[e.jsx(_,{align:"left",children:e.jsx(ns,{color:"primary",disabled:!S||s.status!==ze.FOR_APPROVAL||!d,checked:f===x.possibleDuplicate?.id,onChange:(O,k)=>j(k?x.possibleDuplicate?.id:null)})}),e.jsx(_,{align:"left",children:r?e.jsx("span",{children:x.possibleDuplicate?.unicefId}):e.jsx(me,{to:`/${i}/population/individuals/${x.possibleDuplicate?.id}`,children:x.possibleDuplicate?.unicefId})}),e.jsx(_,{align:"left",children:r?e.jsx("span",{children:x.possibleDuplicate?.household?.unicefId||"-"}):e.jsx(me,{to:`/${i}/population/household/${x.possibleDuplicate?.household?.id}`,children:x.possibleDuplicate?.household?.unicefId||"-"})}),e.jsx(_,{align:"left",children:x.possibleDuplicate?.fullName}),e.jsx(_,{align:"left",children:x.possibleDuplicate?.sex}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:x.possibleDuplicate?.birthDate})}),e.jsx(_,{align:"left",children:w()}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:x.possibleDuplicate?.lastRegistrationDate})}),e.jsx(_,{align:"left",children:x.possibleDuplicate?.documents[0]?.type.label}),e.jsx(_,{align:"left",children:x.possibleDuplicate?.documents?.documentNumber}),e.jsx(_,{align:"left",children:x.possibleDuplicate?.household?.admin2?.name}),e.jsx(_,{align:"left",children:x.possibleDuplicate?.household?.village})]})]})]})]})};function sj({ticket:s}){const{t}=M(),[a,n]=A.useState(!1),{showMessage:i}=Ae(),r=Fe(),{businessArea:l}=U(),{mutateAsync:o}=xe({mutationFn:u=>{const h={extras:{ticketPaymentVerificationDetailsExtras:{newReceivedAmount:u.newReceivedAmount,newStatus:u.newStatus}}};return N.restBusinessAreasGrievanceTicketsPartialUpdate({businessAreaSlug:l,id:s.id,formData:h})},onSuccess:()=>{n(!1),i(t("Payment has been verified.")),r.invalidateQueries({queryKey:["GrievanceTicketDetail",s.id]})},onError:u=>{fe(u,i)}}),d=async u=>{try{await o(u)}catch{}},c={ticketId:s.id,newReceivedAmount:0,newStatus:"RECEIVED"};return e.jsx(B.Formik,{initialValues:c,onSubmit:d,children:({values:u})=>e.jsxs(B.Form,{children:[a&&e.jsx(Bs,{}),e.jsx(P,{p:2,children:e.jsx(H,{color:"primary",variant:"contained","data-cy":"grievance-verify",onClick:()=>n(!0),children:t("Verify")})}),e.jsxs(Ks,{open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Verify Payment")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"newStatus",label:"Status",style:{flexDirection:"row"},choices:[{value:"RECEIVED",name:t("Received")},{value:"NOT_RECEIVED",name:t("Not Received")}],component:ea})}),e.jsx(p,{size:{xs:6},children:u.newStatus==="RECEIVED"&&e.jsx(B.Field,{name:"newReceivedAmount",type:"number",label:t("Amount Received"),color:"primary",component:Se})})]})})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>n(!1),children:t("CANCEL")}),e.jsx(H,{type:"submit",color:"primary",variant:"contained",onClick:()=>d(u),"data-cy":"button-submit",children:t("Verify")})]})})]})]})})}const tj=T(us)`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 26px 22px;
`,aj=T(gs)`
  min-width: 100px;
`,nj=T.div`
  color: #28cb15;
`;function ij({ticket:s,canApprovePaymentVerification:t}){const{t:a}=M(),{showMessage:n}=Ae(),i=Fe(),{businessArea:r}=U(),l=Nt(),{mutateAsync:o}=xe({mutationFn:({grievanceTicketId:f,approveStatus:j})=>{const y={approveStatus:j};return N.restBusinessAreasGrievanceTicketsApprovePaymentDetailsCreate({businessAreaSlug:r,id:f,formData:y})},onSuccess:()=>{i.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",r,s.id]})},onError:f=>{fe(f,n)}}),d=s.ticketDetails?.approveStatus,c=s.ticketDetails?.oldReceivedAmount,u=s.ticketDetails?.newReceivedAmount,h=s.ticketDetails?.paymentVerification?.receivedAmount,m=s.paymentRecord?.deliveredQuantity,g=s.paymentRecord?.entitlementQuantity;let x=a("Are you sure you want to disapprove this payment?");return d||(x=a("Are you sure you want to approve this payment?")),e.jsxs(tj,{children:[e.jsx(Ie,{children:e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(ee,{variant:"h6",children:a("Payment Details")}),s.status===ze.IN_PROGRESS?e.jsx(sj,{ticket:s}):null,t&&s.status===ze.FOR_APPROVAL?e.jsx(H,{"data-cy":"grievance-approve",onClick:()=>l({title:a("Approve"),content:x}).then(async()=>{try{await o({grievanceTicketId:s.id,approveStatus:!d}),d&&n(a("Changes Disapproved")),d||n(a("Changes Approved"))}catch{}}),variant:d?"outlined":"contained",color:"primary",disabled:s.status!==ze.FOR_APPROVAL,children:a(d?"Disapprove":"Approve")}):null]})}),e.jsxs(aj,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"right"}),e.jsxs(_,{align:"right",children:[a("Entitlement Value")," ($)"]}),e.jsxs(_,{align:"right",children:[a("Delivered Value")," ($)"]}),e.jsxs(_,{align:"right",children:[a("Received Value")," ($)"]}),e.jsxs(_,{align:"right",children:[a("New Verified Value")," ($)"]})]})}),e.jsx(cs,{children:e.jsxs(be,{children:[e.jsx(_,{children:d?e.jsx(nj,{children:e.jsx(Xt,{})}):null}),e.jsx(_,{align:"right",children:Qe(g)}),e.jsx(_,{align:"right",children:Qe(m)}),e.jsx(_,{align:"right",children:c==null?Qe(h):Qe(c)}),e.jsx(_,{align:"right",children:Qe(u??0)})]})})]})]})}function rj({field:s,value:t}){let a;if(s?.name==="country"||s?.name==="country_origin"||s?.name==="admin_area_title")a=t||"-";else switch(s?.type){case"SELECT_ONE":a=s.choices.find(n=>n.value===t)?.labelEn||"-";break;case"SELECT_MANY":t instanceof Array?a=t.map(n=>s.choices.find(i=>i.value===n)?.labelEn||"-").join(", "):a="-";break;case"BOOL":a=t===null?"-":t?"Yes":"No";break;case"IMAGE":a=e.jsx(hn,{field:s,isCurrent:!0});break;default:a=typeof t=="object"&&t!==null&&"value"in t?t.value:t}return e.jsx(e.Fragment,{children:a===null||a==="null"||a===void 0||a===""?"-":a})}function lj({field:s,value:t}){let a;switch(s?.type){case"SELECT_ONE":a=s.choices.find(n=>n.value===t)?.labelEn||t||"-";break;case"SELECT_MANY":a=s.choices.find(n=>n.value===t)?.labelEn||"-",t instanceof Array&&(a=t.map(n=>s.choices.find(i=>i.value===n)?.labelEn||"-").join(", "));break;case"BOOL":a=t===null?"-":t?"Yes":"No";break;case"IMAGE":a=e.jsx(hn,{field:s});break;default:a=t}return e.jsx(e.Fragment,{children:a||"-"})}const oj=T.div`
  color: #28cb15;
`,dj=T.span`
  text-transform: capitalize;
`,Qo=(s,t,a,n,i,r,l,o,d)=>{const c=mt.snakeCase(s[0]),u=t[c],h=a(c),m=`enhanced-table-checkbox-${n}`,g=yi(s[1],(y,b)=>mt.camelCase(b)),x=c==="country"||c==="country_origin"||c==="countryOrigin"?i[g.previousValue]:g.previousValue,f=u?.isFlexField?d.flexFields[c]:d[mt.camelCase(c)],j=r.status===ze.CLOSED?x:f;return e.jsxs(be,{role:"checkbox","aria-checked":h,children:[e.jsx(_,{children:l?e.jsx(ns,{"data-cy":"checkbox-household-data",onChange:y=>o(c,y.target.checked),color:"primary",disabled:r.status!==ze.FOR_APPROVAL,checked:h,inputProps:{"aria-labelledby":m}}):h&&e.jsx(oj,{"data-cy":"green-tick",children:e.jsx(Xt,{})})}),e.jsx(_,{id:m,scope:"row",align:"left",children:e.jsx(dj,{children:mt.snakeCase(s[0]).replaceAll("_h_f","").replaceAll("_"," ")})}),e.jsx(_,{align:"left",children:e.jsx(rj,{field:u,value:j})}),e.jsx(_,{align:"left",children:e.jsx(lj,{field:u,value:g.value})})]},c)},cj=T.div`
  color: #28cb15;
`,uj=T(gs)`
  min-width: 100px;
`;function hj(s){const{t}=M(),{businessArea:a}=U(),{setFieldValue:n,ticket:i,isEdit:r,values:l}=s,o=i.household?.id,{data:d,isLoading:c,error:u}=V({queryKey:["household",a,o,i.household.programSlug],queryFn:()=>N.restBusinessAreasProgramsHouseholdsRetrieve({businessAreaSlug:a,id:o,programSlug:i.household.programSlug}),enabled:!!(o&&a)}),h=l.selected,{selectedFlexFields:m}=l,g={...i.ticketDetails.householdData},x=k=>h.includes(k),f=k=>m.includes(k),j=l.selectedRoles||[],y=k=>{zt(k,"selectedRoles",j,n)},b=g.flex_fields||{};delete g.flex_fields;const C=Object.entries(g).filter(([k])=>k!=="roles"),v=Object.entries(b).filter(([k])=>k!=="approveStatus"),{data:S}=V({queryKey:["allEditHouseholdFieldsAttributes",a],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllEditHouseholdFieldsAttributesList({businessAreaSlug:a}),enabled:!!a}),I=Hs(S??[],"name","*"),{data:E}=V({queryKey:["restChoicesCountriesList"],queryFn:()=>N.restChoicesCountriesList(),enabled:!0}),D=Hs(E,"value","name"),F=k=>{zt(k,"selectedFlexFields",m,n)},w=k=>{zt(mt.snakeCase(k),"selected",h,n)},O=i.ticketDetails.householdData.roles||[];return c?e.jsx("div",{children:t("Loading household details...")}):u?e.jsx("div",{children:t("Error loading household details")}):e.jsxs(uj,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{"data-cy":"table-cell-type-of-data",align:"left",children:t("Type of Data")}),e.jsxs(_,{"data-cy":"table-cell-previous-current-value",align:"left",children:[i.status===ze.CLOSED?t("Previous"):t("Current")," ",t("Value")]}),e.jsx(_,{"data-cy":"table-cell-new-value",align:"left",children:t("New Value")})]})}),e.jsxs(cs,{children:[C.length>0&&C.map((k,$)=>Qo(k,I,x,$,D,i,r,w,d)),O.length>0&&O.map((k,$)=>{const G=`enhanced-table-checkbox-role-${$}`,W=j.includes(k.individual_id);return e.jsxs(be,{role:"checkbox","aria-checked":W,children:[e.jsx(_,{children:r?e.jsx(ns,{"data-cy":"checkbox-household-role",onChange:()=>y(k.individual_id),color:"primary",disabled:i.status!==ze.FOR_APPROVAL,checked:W,inputProps:{"aria-labelledby":G}}):W&&e.jsx(cj,{"data-cy":"green-tick-role",children:e.jsx(Xt,{})})}),e.jsx(_,{id:G,scope:"row",align:"left",children:`Roles (${k.full_name})`}),e.jsx(_,{align:"left",children:k.previous_value===null?"No role":sl[k.previous_value]||k.previous_value}),e.jsx(_,{align:"left",children:k.value===null?"No role":sl[k.value]||k.value})]},`role-row-${k.individual_id}`)}),v.length>0&&v.map((k,$)=>Qo(k,I,f,$,D,i,r,F,d))]})]})}const mj=oe(hj,"RequestedHouseholdDataChangeTable");function pj({ticket:s,canApproveDataChange:t}){const{t:a}=M(),{showMessage:n}=Ae(),i=Nt(),{isActiveProgram:r}=Z(),l=Fe(),{businessArea:o}=U(),d=I=>{const E=I.selectedRoles.length+I.selected.length+I.selectedFlexFields.length||0;return`You approved ${E} change${E===1?"":"s"}, remaining proposed changes will be automatically rejected upon ticket closure.`},{mutateAsync:c}=xe({mutationFn:({householdApproveData:I,flexFieldsApproveData:E})=>{const D={householdApproveData:I,flexFieldsApproveData:E};return N.restBusinessAreasGrievanceTicketsApproveHouseholdDataChangeCreate({businessAreaSlug:o,id:s.id,formData:D})},onSuccess:()=>{n("Changes Approved"),l.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",o,s.id]})},onError:I=>{fe(I,n)}}),u=Js.useMemo(()=>({...s.ticketDetails.householdData}),[s.ticketDetails.householdData]),h=Js.useMemo(()=>u.roles||[],[u.roles]);let m=0;const g=u?.flexFields||{};delete u.flexFields;const x=Object.entries(g),f=Object.entries(u);m+=f.filter(([,I])=>I.approve_status).length,m+=x.filter(([,I])=>I.approve_status).length,m+=h.filter(I=>I&&typeof I=="object"&&"approve_status"in I&&I.approve_status===!0).length;const[j,y]=A.useState(m===0),b=I=>(I.selected.length||I.selectedFlexFields.length||I.selectedRoles.length)&&!j&&s.status===ze.FOR_APPROVAL,C=I=>{const E=I.selected.length+I.selectedFlexFields.length+I.selectedRoles.length,D=f.length+x.length;return E===D},v=(I,E)=>C(I)?e.jsx(H,{onClick:E,variant:"contained",color:"primary","data-cy":"button-approve","data-perm":R.GRIEVANCES_APPROVE_DATA_CHANGE,disabled:s.status!==ze.FOR_APPROVAL||!r,children:a("Approve")}):e.jsx(H,{onClick:()=>i({title:a("Warning"),content:d(I)}).then(()=>{E()}),variant:"contained",color:"primary","data-cy":"button-approve","data-perm":R.GRIEVANCES_APPROVE_DATA_CHANGE,title:a("Program has to be active to create a Linked Ticket to Feedback"),disabled:s.status!==ze.FOR_APPROVAL||!r,children:a("Approve")}),S=Js.useMemo(()=>{const I=Object.entries(u).filter(([w,O])=>w!=="roles"&&w!=="flex_fields"&&O&&typeof O=="object"&&"approve_status"in O&&O.approve_status===!0).map(([w])=>w),E=u.flex_fields||{},D=Object.entries(E).filter(([,w])=>w&&typeof w=="object"&&"approve_status"in w&&w.approve_status===!0).map(([w])=>w),F=h.filter(w=>w&&typeof w=="object"&&"approve_status"in w&&w.approve_status===!0).map(w=>w.individual_id);return{selected:I,selectedFlexFields:D,selectedRoles:F}},[u,h]);return e.jsx(B.Formik,{initialValues:S,enableReinitialize:!0,onSubmit:async I=>{const E={};I.selected.forEach(w=>{E[w]=!0});const D={};x.forEach(([w])=>{typeof g[w]=="object"&&g[w]!==null&&(D[w]=I.selectedFlexFields.includes(w))}),Object.keys(D).length>0?E.flex_fields=D:"flex_fields"in E&&delete E.flex_fields,E.roles=I.selectedRoles.map(w=>({individual_id:w,approve_status:!0}));const F={householdApproveData:E};try{await c(F);const w=Object.values(I).flat().length;y(w===0)}catch{}},children:({submitForm:I,setFieldValue:E,values:D})=>e.jsxs(aa,{children:[e.jsx(Ie,{children:e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(ee,{variant:"h6",children:"Requested Data Change"}),b(D)?e.jsx(H,{onClick:()=>y(!0),variant:"outlined",color:"primary","data-cy":"button-edit",disabled:s.status===ze.CLOSED,children:a("EDIT")}):t&&v(D,I)]})}),e.jsx(mj,{ticket:s,setFieldValue:E,isEdit:j,values:D})]})})}const Oa=T.div`
  padding-top: ${({theme:s})=>s.spacing(4)};
  padding-bottom: ${({theme:s})=>s.spacing(2)};
`,gj=T(gs)`
  color: #9e9e9e;
`,xj=T.div`
  color: #28cb15;
`;function fj({values:s,isEdit:t,ticket:a,setFieldValue:n,documents:i,documentTypeDict:r,countriesDict:l}){const{t:o}=M(),{selectedDocuments:d}=s,c=h=>{zt(h,"selectedDocuments",d,n)},u=e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{"data-cy":"table-cell-id-type",align:"left",children:o("ID Type")}),e.jsx(_,{"data-cy":"table-cell-country",align:"left",children:o("Country")}),e.jsx(_,{"data-cy":"table-cell-number",align:"left",children:o("Number")}),e.jsx(_,{"data-cy":"table-cell-photo",align:"left",children:o("Photo")})]})});return e.jsxs(e.Fragment,{children:[e.jsx(Oa,{children:e.jsx(P,{display:"flex",justifyContent:"space-between",children:e.jsx(ee,{variant:"h6",children:o("Documents to be added")})})}),e.jsxs(gj,{children:[u,e.jsx(cs,{children:i?.map((h,m)=>e.jsxs(be,{children:[e.jsx(_,{align:"left",children:t?e.jsx(ns,{color:"primary","data-cy":"checkbox-document",onChange:()=>{c(m)},disabled:a.status!==ze.FOR_APPROVAL,checked:d.includes(m),inputProps:{"aria-labelledby":"selected"}}):d.includes(m)&&e.jsx(xj,{"data-cy":"green-check-icon",children:e.jsx(Xt,{})})}),e.jsx(_,{align:"left",children:r[h.value.key]}),e.jsx(_,{align:"left",children:l[h.value.country]}),e.jsx(_,{align:"left",children:h.value.number}),e.jsx(_,{align:"left",children:h.value.photo?e.jsx(nt,{src:h.value.photo}):"-"})]},`${h.value.type}-${h.value.country}`))})]})]})}const yj=T.div`
  color: #28cb15;
`,Xo=T.div`
  color: #9e9e9e;
`,bj=T(gs)`
  min-width: 100px;
`;function jj({values:s,isEdit:t,ticket:a,setFieldValue:n,documentTypeDict:i,countriesDict:r,index:l,document:o}){const{t:d}=M(),c=(g,x)=>g===x?e.jsx(Xo,{children:d("Not updated")}):e.jsx("span",{children:x}),{selectedDocumentsToEdit:u}=s,h=g=>g.value?.photo===g.previousValue?.photo?e.jsx(Xo,{children:d("Not updated")}):o.value?.photo?e.jsx(nt,{src:o.value.photo}):e.jsx("span",{children:"-"}),m=g=>{zt(g,"selectedDocumentsToEdit",u,n)};return e.jsxs("div",{children:[e.jsx(Oa,{children:e.jsx(P,{display:"flex",justifyContent:"space-between",children:e.jsx(ee,{variant:"h6",children:d("Document to be edited")})})}),e.jsxs(bj,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left",children:t?e.jsx(ns,{color:"primary","data-cy":"checkbox-document-to-edit",onChange:()=>{m(l)},disabled:a.status!==ze.FOR_APPROVAL,checked:u.includes(l),inputProps:{"aria-labelledby":"selected"}}):u.includes(l)&&e.jsx(yj,{"data-cy":"green-check",children:e.jsx(Xt,{})})}),e.jsx(_,{"data-cy":"table-cell-field",align:"left",children:d("Field")}),e.jsx(_,{"data-cy":"table-cell-current-value",align:"left",children:d("Current Value")}),e.jsx(_,{"data-cy":"table-cell-new-value",align:"left",children:d("New Value")})]})}),e.jsxs(cs,{children:[e.jsxs(be,{children:[e.jsx(_,{}),e.jsx(_,{align:"left",children:d("Country")}),e.jsx(_,{align:"left",children:r[o.previousValue.country]}),e.jsx(_,{align:"left",children:c(r[o.previousValue.country],r[o.value?.country])})]}),e.jsxs(be,{children:[e.jsx(_,{}),e.jsx(_,{align:"left",children:d("Document Type")}),e.jsx(_,{align:"left",children:i[o.previousValue.key]}),e.jsx(_,{align:"left",children:c(i[o.previousValue.key],i[o.value.key])})]}),e.jsxs(be,{children:[e.jsx(_,{}),e.jsx(_,{align:"left",children:d("Document Number")}),e.jsx(_,{align:"left",children:o.previousValue.number}),e.jsx(_,{align:"left",children:c(o.previousValue.number,o.value.number)})]}),e.jsxs(be,{children:[e.jsx(_,{}),e.jsx(_,{align:"left",children:d("Photo")}),e.jsx(_,{align:"left",children:o.previousValue?.photo?e.jsx(nt,{src:o.previousValue.photo}):"-"}),e.jsx(_,{align:"left",children:h(o)})]})]})]})]},o.previousValue.number)}const Aj=T.div`
  color: #28cb15;
`,_j=T(gs)`
  min-width: 100px;
`;function Pj({values:s,isEdit:t,ticket:a,setFieldValue:n,countriesDict:i,documentsToRemove:r,previousDocuments:l}){const{t:o}=M(),d=e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{"data-cy":"table-cell-id-type",align:"left",children:o("ID Type")}),e.jsx(_,{"data-cy":"table-cell-id-country",align:"left",children:o("Country")}),e.jsx(_,{"data-cy":"table-cell-id-type",align:"left",children:o("Number")})]})}),{selectedDocumentsToRemove:c}=s,u=h=>{zt(h,"selectedDocumentsToRemove",c,n)};return e.jsxs(e.Fragment,{children:[e.jsx(Oa,{children:e.jsx(P,{display:"flex",justifyContent:"space-between",children:e.jsx(ee,{variant:"h6",children:o("Documents to be removed")})})}),e.jsxs(_j,{children:[d,e.jsx(cs,{children:r?.map((h,m)=>{const g=Object.values(l||{}).find(x=>x.id===h.value);return e.jsxs(be,{children:[e.jsx(_,{align:"left",children:t?e.jsx(ns,{"data-cy":"checkbox-remove-document",onChange:()=>{u(m)},color:"primary",disabled:a.status!==ze.FOR_APPROVAL,checked:c.includes(m),inputProps:{"aria-labelledby":"xd"}}):c.includes(m)&&e.jsx(Aj,{"data-cy":"green-check",children:e.jsx(Xt,{})})}),e.jsx(_,{align:"left",children:g?.key||"-"}),e.jsx(_,{align:"left",children:i[g?.country]||"-"}),e.jsx(_,{align:"left",children:g?.documentNumber||"-"})]},`${g?.key||"doc"}-${g?.country||m}`)})})]})]})}function Cj({field:s,value:t,individualId:a,fieldName:n}){const{t:i}=M();if((s?.name==="photo"||n==="photo"&&!s?.isFlexField)&&(s?.type==="IMAGE"||!s))return e.jsx(e.Fragment,{children:a?e.jsx(On,{isCurrent:!0,individualId:a}):"-"});let l;switch(s?.type){case"SELECT_ONE":l=s.choices.find(o=>o.value===t)?.labelEn||"-";break;case"SELECT_MANY":l=s.choices.find(o=>o.value===t)?.labelEn||"-",t instanceof Array&&(l=t.map(o=>s.choices.find(d=>d.value===o)?.labelEn||"-").join(", "));break;case"BOOL":l=t===null?"-":i(t?"Yes":"No");break;case"IMAGE":s?.isFlexField?l=e.jsx(hn,{field:s,isCurrent:!0,isIndividual:!0}):s?.name==="photo"?l=e.jsx(On,{isCurrent:!0,individualId:a}):l=t?e.jsx(nt,{src:t}):"-";break;default:l=typeof t=="object"&&t!==null&&"value"in t?t.value:t}return e.jsx(e.Fragment,{children:l===null||l==="null"||l===void 0||l===""?"-":l})}function Ej({field:s,value:t,fieldName:a}){const{t:n}=M();if((s?.name==="photo"||a==="photo"&&!s?.isFlexField)&&(s?.type==="IMAGE"||!s))return e.jsx(e.Fragment,{children:t?e.jsx(On,{photoPath:t}):"-"});let r;switch(s?.type){case"SELECT_ONE":r=s.choices.find(l=>l.value===t)?.labelEn||"-";break;case"SELECT_MANY":r=s.choices.find(l=>l.value===t)?.labelEn||"-",t instanceof Array&&(r=t.map(l=>s.choices.find(o=>o.value===l)?.labelEn||"-").join(", "));break;case"BOOL":r=t===null?"-":n(t?"Yes":"No");break;case"IMAGE":s?.isFlexField?r=e.jsx(hn,{field:s,isIndividual:!0}):s?.name==="photo"?r=e.jsx(On,{photoPath:t}):r=t?e.jsx(nt,{src:t}):"-";break;default:r=t}return e.jsx(e.Fragment,{children:r==null||r===""?"-":r})}const vj=T.div`
  color: #28cb15;
`,Sj=T.span`
  text-transform: capitalize;
`,Jo=(s,t,a,n,i,r,l,o,d)=>{const c=Zs(s[0]),u=t(s[0]),h=`enhanced-table-checkbox-${a}`,m=yi(s[1],(C,v)=>Zs(v)),g=i[mt.snakeCase(s[0])],x=c==="country"||c==="country_origin"||c==="countryOrigin",f=x?r[m.previousValue]:m.previousValue,j=g?.isFlexField?d?.flexFields[s[0]]:x?r[d?.[Zs(c)]]:d?.[Zs(c)],y=n.status===ze.CLOSED?f:j,b=x?r[m.value]:m.value;return e.jsxs(be,{role:"checkbox","aria-checked":u,children:[e.jsx(_,{children:l?e.jsx(ns,{onChange:C=>o(s[0],C.target.checked),color:"primary",disabled:n.status!==ze.FOR_APPROVAL,checked:u,inputProps:{"aria-labelledby":h},"data-cy":"checkbox-requested-data-change"}):u&&e.jsx(vj,{"data-cy":"green-tick",children:e.jsx(Xt,{})})}),e.jsx(_,{id:h,scope:"row",align:"left",children:e.jsx(Sj,{children:s[0]==="sex"?"gender":mt.snakeCase(s[0]).replaceAll("_i_f","").replaceAll("_"," ")})}),e.jsx(_,{align:"left","data-cy":"current-value",children:e.jsx(Cj,{field:g,value:y,individualId:d?.id,fieldName:s[0]})}),e.jsx(_,{align:"left","data-cy":"new-value",children:e.jsx(Ej,{field:g,value:b,fieldName:s[0]})})]},c)},Ij=T(gs)`
  min-width: 100px;
  width: 100%;
`;function Dj({values:s,isEdit:t,fieldsDict:a,countriesDict:n,ticket:i,entries:r,entriesFlexFields:l,setFieldValue:o,individual:d}){const{t:c}=M(),{selectedFlexFields:u}=s,h=s.selected,m=b=>h.includes(Zs(b)),g=b=>u.includes(b),x=b=>{zt(Zs(b),"selected",h,o)},f=b=>{zt(b,"selectedFlexFields",u,o)},j=["documentsToEdit","accountsToEdit","identitiesToEdit","previousDocuments","documentsToRemove","previousIdentities","identitiesToRemove","flexFields"],y=r.filter(b=>!j.includes(b[0]));return e.jsxs(Ij,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{"data-cy":"table-cell-type-of-data",align:"left",children:c("Type of Data")}),e.jsxs(_,{"data-cy":"table-cell-previous-current-value",align:"left",children:[i.status===ze.CLOSED?c("Previous"):c("Current")," ",c("Value")]}),e.jsx(_,{"data-cy":"table-cell-new-value",align:"left",children:c("New Value")})]})}),e.jsxs(cs,{children:[y?.map((b,C)=>Jo(b,m,C,i,a,n,t,x,d)),l?.map((b,C)=>Jo(b,g,C,i,a,n,t,f,d))]})]})}const Tj=T.div`
  color: #28cb15;
`,Rj=T(gs)`
  min-width: 100px;
`;function Fj({values:s,isEdit:t,ticket:a,setFieldValue:n,countriesDict:i,identityTypeDict:r,identities:l}){const{t:o}=M(),{selectedIdentities:d}=s,c=h=>{zt(h,"selectedIdentities",d,n)},u=e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{"data-cy":"table-cell-partner",align:"left",children:o("Partner")}),e.jsx(_,{"data-cy":"table-cell-country",align:"left",children:o("Country")}),e.jsx(_,{"data-cy":"table-cell-number",align:"left",children:o("Number")})]})});return e.jsxs(e.Fragment,{children:[e.jsx(Oa,{children:e.jsx(P,{display:"flex",justifyContent:"space-between",children:e.jsx(ee,{variant:"h6",children:o("Identities to be added")})})}),e.jsxs(Rj,{children:[u,e.jsx(cs,{children:l?.map((h,m)=>e.jsxs(be,{children:[e.jsx(_,{align:"left",children:t?e.jsx(ns,{color:"primary",onChange:()=>{c(m)},disabled:a.status!==ze.FOR_APPROVAL,checked:d.includes(m),inputProps:{"aria-labelledby":"selected"},"data-cy":"checkbox-identity"}):d.includes(m)&&e.jsx(Tj,{"data-cy":"green-check",children:e.jsx(Xt,{})})}),e.jsx(_,{align:"left",children:r[h.value.partner]}),e.jsx(_,{align:"left",children:i[h.value.country]}),e.jsx(_,{align:"left",children:h.value.number})]},`${h.value.partner}-${h.value.partner}`))})]})]})}const Nj=T.div`
  color: #28cb15;
`,Zo=T.div`
  color: #9e9e9e;
`,Lj=T(gs)`
  min-width: 100px;
`;function Oj({values:s,isEdit:t,ticket:a,setFieldValue:n,countriesDict:i,index:r,identity:l}){const{t:o}=M(),{selectedIdentitiesToEdit:d}=s,c=(m,g)=>m===g?e.jsx(Zo,{children:o("Not updated")}):e.jsx("span",{children:g}),u=m=>{zt(m,"selectedIdentitiesToEdit",d,n)},h=m=>m.partner||m.agency;return e.jsxs(e.Fragment,{children:[e.jsx(Oa,{children:e.jsx(P,{display:"flex",justifyContent:"space-between",children:e.jsx(ee,{variant:"h6",children:o("Identity to be edited")})})}),e.jsxs(Lj,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left",children:t?e.jsx(ns,{color:"primary",onChange:()=>{u(r)},disabled:a.status!==ze.FOR_APPROVAL,checked:d.includes(r),inputProps:{"aria-labelledby":"selected"}}):d.includes(r)&&e.jsx(Nj,{"data-cy":"green-check",children:e.jsx(Xt,{})})}),e.jsx(_,{align:"left",children:o("Field")}),e.jsx(_,{align:"left",children:o("Current Value")}),e.jsx(_,{align:"left",children:o("New Value")})]})}),e.jsxs(cs,{children:[e.jsxs(be,{children:[e.jsx(_,{}),e.jsx(_,{align:"left",children:o("Partner")}),e.jsx(_,{align:"left",children:h(l.previousValue)}),e.jsx(_,{align:"left",children:l.value?.partner??e.jsx(Zo,{children:o("Not updated")})})]}),e.jsxs(be,{children:[e.jsx(_,{}),e.jsx(_,{align:"left",children:o("Country")}),e.jsx(_,{align:"left",children:i[l.previousValue.country]}),e.jsx(_,{align:"left",children:c(i[l.previousValue.country],i[l.value?.country])})]}),e.jsxs(be,{children:[e.jsx(_,{}),e.jsx(_,{align:"left",children:o("Identity Number")}),e.jsx(_,{align:"left",children:l.previousValue.number}),e.jsx(_,{align:"left",children:c(l.previousValue.number,l.value?.number)})]})]})]})]})}const kj=T.div`
  color: #28cb15;
`,wj=T(gs)`
  min-width: 100px;
`;function Mj({values:s,isEdit:t,ticket:a,countriesDict:n,identitiesToRemove:i,previousIdentities:r,setFieldValue:l}){const{t:o}=M(),{selectedIdentitiesToRemove:d}=s,c=e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{"data-cy":"table-cell-partner",align:"left",children:o("Partner")}),e.jsx(_,{"data-cy":"table-cell-country",align:"left",children:o("Country")}),e.jsx(_,{"data-cy":"table-cell-number",align:"left",children:o("Number")})]})}),u=h=>{zt(h,"selectedIdentitiesToRemove",d,l)};return e.jsxs(e.Fragment,{children:[e.jsx(Oa,{children:e.jsx(P,{display:"flex",justifyContent:"space-between",children:e.jsx(ee,{variant:"h6",children:o("Identities to be removed")})})}),e.jsxs(wj,{children:[c,e.jsx(cs,{children:i?.map((h,m)=>{const g=r[h.value];return e.jsxs(be,{children:[e.jsx(_,{align:"left",children:t?e.jsx(ns,{"data-cy":"checkbox-identity-to-remove",onChange:()=>{u(m)},color:"primary",disabled:a.status!==ze.FOR_APPROVAL,checked:d.includes(m),inputProps:{"aria-labelledby":"xd"}}):d.includes(m)&&e.jsx(kj,{"data-cy":"green-check",children:e.jsx(Xt,{})})}),e.jsx(_,{align:"left",children:g?.partner||"-"}),e.jsx(_,{align:"left",children:n[g?.country]||"-"}),e.jsx(_,{align:"left",children:g?.number||"-"})]},`${g.number}-${g.country}`)})})]})]})}const $j=T.div`
  color: #28cb15;
`,Uj=T.div`
  color: #9e9e9e;
`,Vj=T(gs)`
  min-width: 100px;
`;function Bj({values:s,isEdit:t,ticket:a,setFieldValue:n,index:i,account:r,accountFinancialInstitutionsDict:l}){const{t:o}=M(),{selectedAccountsToEdit:d}=s,c=h=>{zt(h,"selectedAccountsToEdit",d,n)},u=(h,m)=>h===m?e.jsx(Uj,{children:o("Not updated")}):e.jsx("span",{children:m});return e.jsxs(e.Fragment,{children:[e.jsx(Oa,{children:e.jsx(P,{display:"flex",justifyContent:"space-between",children:e.jsxs(ee,{variant:"h6",children:[o("Account to be edited")," - ",r.accountType]})})}),e.jsxs(Vj,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left",children:t?e.jsx(ns,{color:"primary","data-cy":"checkbox-edit-account",onChange:()=>{c(i)},disabled:a.status!==ze.FOR_APPROVAL,checked:d.includes(i),inputProps:{"aria-labelledby":"selected"}}):d.includes(i)&&e.jsx($j,{"data-cy":"green-check",children:e.jsx(Xt,{})})}),e.jsx(_,{align:"left",children:o("Field")}),e.jsx(_,{align:"left",children:o("Current Value")}),e.jsx(_,{align:"left",children:o("New Value")})]})}),e.jsxs(cs,{children:[e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{align:"left",children:"Number"}),e.jsx(_,{align:"left",children:r.numberPreviousValue||"-"}),e.jsx(_,{align:"left",children:u(r.numberPreviousValue,r.number)})]},"number"),e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{align:"left",children:"Financial Institution"}),e.jsx(_,{align:"left",children:l[r.financialInstitutionPreviousValue]||"-"}),e.jsx(_,{align:"left",children:u(l[r.financialInstitutionPreviousValue],l[r.financialInstitution])})]},"financial_institution"),r.dataFields.map((h,m)=>e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{align:"left",children:h.name}),e.jsx(_,{align:"left",children:h.previousValue||"-"}),e.jsx(_,{align:"left",children:u(h.previousValue,h.value)})]},m))]})]})]})}const Gj=T.div`
  color: #28cb15;
`,zj=T(gs)`
  min-width: 100px;
`;function qj({values:s,isEdit:t,ticket:a,setFieldValue:n,index:i,account:r,accountFinancialInstitutionsDict:l}){const{t:o}=M(),{selectedAccounts:d}=s,c=m=>{zt(m,"selectedAccounts",d,n)},u=r.value.dataFields||[],h={accountType:r.value.accountType,number:r.value.number,financialInstitution:r.value.financialInstitution};for(const m of u)h[m.key]=m.value;return e.jsxs(e.Fragment,{children:[e.jsx(Oa,{children:e.jsx(P,{display:"flex",justifyContent:"space-between",children:e.jsxs(ee,{variant:"h6",children:[o("Account to be created")," - ",r.value.accountType]})})}),e.jsxs(zj,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left",children:t?e.jsx(ns,{color:"primary","data-cy":"checkbox-create-account",onChange:()=>{c(i)},disabled:a.status!==ze.FOR_APPROVAL,checked:d.includes(i),inputProps:{"aria-labelledby":"selected"}}):d.includes(i)&&e.jsx(Gj,{"data-cy":"green-check",children:e.jsx(Xt,{})})}),e.jsx(_,{align:"left",children:o("Field")}),e.jsx(_,{align:"left",children:o("Value")})]})}),e.jsx(cs,{children:Object.entries(h||{}).filter(([m,g])=>m!=="accountType").map(([m,g])=>(m==="financialInstitution"&&(g=l[g]),e.jsxs(be,{children:[e.jsx(_,{align:"left"}),e.jsx(_,{align:"left",children:m}),e.jsx(_,{align:"left",children:Al(g)}),e.jsx(_,{align:"left"})]},m)))})]})]})}function Hj({setFieldValue:s,ticket:t,values:a,isEdit:n}){const{businessAreaSlug:i}=U(),{data:r,isLoading:l}=V({queryKey:["addIndividualFieldsAttributes",i],queryFn:()=>N.restBusinessAreasGrievanceTicketsAllAddIndividualsFieldsAttributesList({businessAreaSlug:i})}),{data:o,isLoading:d}=V({queryKey:["individualChoices",i],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:i})}),{data:c,isLoading:u}=V({queryKey:["countriesList"],queryFn:()=>N.restChoicesCountriesList()}),{data:h,isLoading:m}=V({queryKey:["individualChoices",i,t.individual.id,t.individual.programSlug],queryFn:()=>t.individual.id?N.restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:i,programSlug:t.individual.programSlug,id:t.individual.id}):null}),g={...t.ticketDetails.individualData},{documents:x,identities:f,previousDocuments:j,documentsToRemove:y,documentsToEdit:b,previousIdentities:C,identitiesToRemove:v,identitiesToEdit:S,accounts:I,accountsToEdit:E,flexFields:D,...F}=g,w=F&&Object.entries(F),O=D&&Object.entries(D),k=Hs(r,"name","*"),$=Hs(c,"value","name"),G=Hs(o?.documentTypeChoices,"value","name"),W=Hs(o?.identityTypeChoices,"value","name"),Y=Hs(o?.accountFinancialInstitutionChoices,"value","name");return l||d||u||!k||!$||!G||!W||!Y||m?e.jsx(Ne,{}):e.jsxs("div",{children:[w?.length||O?.length?e.jsx(Dj,{values:a,isEdit:n,fieldsDict:k,countriesDict:$,ticket:t,entries:w,entriesFlexFields:O,setFieldValue:s,individual:h}):null,x?.length?e.jsx(fj,{values:a,isEdit:n,ticket:t,documents:x,setFieldValue:s,documentTypeDict:G,countriesDict:$}):null,b?.length?b.map((X,J)=>e.jsx(jj,{values:a,isEdit:n,ticket:t,setFieldValue:s,documentTypeDict:G,countriesDict:$,index:J,document:X},X.previousValue.number)):null,f?.length?e.jsx(Fj,{values:a,isEdit:n,ticket:t,setFieldValue:s,documentTypeDict:G,countriesDict:$,identityTypeDict:W,document,identities:f}):null,S?.length?S.map((X,J)=>e.jsx(Oj,{values:a,isEdit:n,ticket:t,setFieldValue:s,countriesDict:$,index:J,identity:X},X.previousValue.number)):null,I?.length?I.map((X,J)=>e.jsx(qj,{values:a,isEdit:n,ticket:t,setFieldValue:s,index:J,account:X,accountFinancialInstitutionsDict:Y},X.id)):null,E?.length?E.map((X,J)=>e.jsx(Bj,{values:a,isEdit:n,ticket:t,setFieldValue:s,index:J,account:X,accountFinancialInstitutionsDict:Y},X.id)):null,y?.length?e.jsx(Pj,{values:a,isEdit:n,ticket:t,setFieldValue:s,countriesDict:$,documentsToRemove:y,previousDocuments:j}):null,v?.length?e.jsx(Mj,{values:a,isEdit:n,ticket:t,setFieldValue:s,countriesDict:$,identitiesToRemove:v,previousIdentities:C}):null]})}function Wj({ticket:s,canApproveDataChange:t}){const{t:a}=M(),{businessAreaSlug:n}=U(),{showMessage:i}=Ae(),r=Nt(),l=Fe(),{businessArea:o}=U(),d={...s.ticketDetails.individualData};let c=0;const u=s.status===ze.FOR_APPROVAL,h=d?.documents||[],m=d.documentsToRemove||[],g=d.documentsToEdit||[],x=d?.identities||[],f=d.identities_to_remove||[],j=d.identities_to_edit||[],y=d.accounts||[],b=d.accounts_to_edit||[],C=d.flexFields||{};delete d.flexFields,delete d.documents,delete d.documents_to_edit,delete d.documents_to_remove,delete d.previous_documents,delete d.identities,delete d.identities_to_edit,delete d.identities_to_remove,delete d.previous_identities,delete d.accounts,delete d.accounts_to_edit;const v=Object.entries(d),S=Object.entries(C);c+=h.filter(ne=>ne.approveStatus).length,c+=m.filter(ne=>ne.approveStatus).length,c+=g.filter(ne=>ne.approveStatus).length,c+=x.filter(ne=>ne.approveStatus).length,c+=f.filter(ne=>ne.approveStatus).length,c+=j.filter(ne=>ne.approve_status).length,c+=v.filter(([,ne])=>ne.approve_status).length,c+=y.filter(ne=>ne.approve_status).length,c+=b.filter(ne=>ne.approve_status).length,c+=S.filter(([,ne])=>ne.approveStatus).length;const[I,E]=A.useState(c===0),D=ne=>`You approved ${ne||0} change${ne===1?"":"s"}, remaining proposed changes will be automatically rejected upon ticket closure.`,{mutateAsync:F}=xe({mutationFn:({individualApproveData:ne,approvedDocumentsToCreate:Ue,approvedDocumentsToRemove:Te,approvedDocumentsToEdit:ie,approvedIdentitiesToCreate:Pe,approvedIdentitiesToRemove:ue,approvedIdentitiesToEdit:Ge,approvedAccountsToCreate:ls,approvedAccountsToEdit:qe,flexFieldsApproveData:xs})=>{const Oe={individualApproveData:ne,approvedDocumentsToCreate:Ue,approvedDocumentsToRemove:Te,approvedDocumentsToEdit:ie,approvedIdentitiesToCreate:Pe,approvedIdentitiesToRemove:ue,approvedIdentitiesToEdit:Ge,flexFieldsApproveData:xs,approvedAccountsToCreate:ls,approvedAccountsToEdit:qe};return N.restBusinessAreasGrievanceTicketsApproveIndividualDataChangeCreate({businessAreaSlug:o,id:s.id,formData:Oe})},onSuccess:()=>{i("Changes Approved"),l.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",n,s.id]})},onError:ne=>{fe(ne,i)}}),w=[],O=[],k=[];for(let ne=0;ne<h?.length;ne++)h[ne]?.approveStatus&&w.push(ne);for(let ne=0;ne<m?.length;ne++)m[ne]?.approveStatus&&O.push(ne);for(let ne=0;ne<g?.length;ne++)g[ne]?.approveStatus&&k.push(ne);const $=[],G=[],W=[];for(let ne=0;ne<x?.length;ne++)x[ne]?.approveStatus&&$.push(ne);for(let ne=0;ne<f?.length;ne++)f[ne]?.approveStatus&&G.push(ne);for(let ne=0;ne<j?.length;ne++)j[ne]?.approveStatus&&W.push(ne);const Y=[];for(let ne=0;ne<y?.length;ne++)y[ne]?.approve_status&&Y.push(ne);const X=[];for(let ne=0;ne<b?.length;ne++)b[ne]?.approve_status&&X.push(ne);const J=s.individual?.id===s.household?.headOfHousehold?.id,ae=s?.individual?.rolesInHouseholds.filter(ne=>ne.role==="PRIMARY").length+(J?1:0),re=Object.values(s.ticketDetails.roleReassignData)?.filter(ne=>ne.role==="PRIMARY"||ne.role==="HEAD").length;let se=!1;s.issueType.toString()===$e.DELETE_INDIVIDUAL?se=u&&ae===re:se=u;const le=ne=>ne&&!I&&u,ce=ne=>{const Ue=v.length+S.length+h.length+m.length+g.length+x.length+f.length+y.length+b.length+j.length;return ne===Ue},_e=(ne,Ue)=>ce(ne)?e.jsx(H,{onClick:Ue,variant:"contained",color:"primary",disabled:!se,"data-cy":"button-approve","data-perm":R.GRIEVANCES_APPROVE_DATA_CHANGE,children:a("Approve")}):e.jsx(H,{onClick:()=>r({title:a("Warning"),content:D(ne)}).then(()=>{Ue()}),variant:"contained",color:"primary",disabled:!se,"data-cy":"button-approve","data-perm":R.GRIEVANCES_APPROVE_DATA_CHANGE,children:a("Approve")});return e.jsx(B.Formik,{initialValues:{selected:v.filter(ne=>yi(ne[1],(Te,ie)=>Zs(ie)).approveStatus).map(ne=>Zs(ne[0])),selectedFlexFields:S.filter(ne=>yi(ne[1],(Te,ie)=>Zs(ie)).approveStatus).map(ne=>ne[0]),selectedDocuments:w,selectedDocumentsToRemove:O,selectedDocumentsToEdit:k,selectedIdentities:$,selectedIdentitiesToEdit:W,selectedIdentitiesToRemove:G,selectedAccounts:Y,selectedAccountsToEdit:X},onSubmit:async ne=>{const Ue=ne.selected.reduce((es,ye)=>(es[ye]=!0,es),{}),Te=ne.selectedDocuments,ie=ne.selectedDocumentsToRemove,Pe=ne.selectedDocumentsToEdit,ue=ne.selectedIdentities,Ge=ne.selectedIdentitiesToRemove,ls=ne.selectedIdentitiesToEdit,qe=ne.selectedAccounts,xs=ne.selectedAccountsToEdit,Oe=ne.selectedFlexFields.reduce((es,ye)=>(es[ye]=!0,es),{});try{await F({individualApproveData:Ue,approvedDocumentsToCreate:Te,approvedDocumentsToRemove:ie,approvedDocumentsToEdit:Pe,approvedIdentitiesToCreate:ue,approvedIdentitiesToRemove:Ge,approvedIdentitiesToEdit:ls,approvedAccountsToCreate:qe,approvedAccountsToEdit:xs,flexFieldsApproveData:Oe});const es=Object.values(ne).flat().length;E(es===0)}catch{}},children:({submitForm:ne,setFieldValue:Ue,values:Te})=>{const ie=Object.values(Te).flat().length;return e.jsxs(aa,{children:[e.jsx(Ie,{children:e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(ee,{variant:"h6",children:"Requested Data Change"}),le(ie)?e.jsx(H,{onClick:()=>E(!0),variant:"outlined",color:"primary",disabled:s.status===ze.CLOSED,children:a("EDIT")}):t&&_e(ie,ne)]})}),e.jsx(Hj,{values:Te,ticket:s,setFieldValue:Ue,isEdit:I})]})}})}function Kj({ticket:s,canApproveFlagAndAdjudication:t,canApproveDataChange:a,canApprovePaymentVerification:n}){const i=()=>s?.category?.toString()===De.SYSTEM_FLAGGING?e.jsx(Yb,{ticket:s,canApproveFlag:t}):s?.category?.toString()===De.NEEDS_ADJUDICATION?s.ticketDetails.isMultipleDuplicatesVersion?e.jsx(Zb,{ticket:s,canApprove:t}):e.jsx(ej,{ticket:s,canApprove:t}):s?.issueType?.toString()===$e.ADD_INDIVIDUAL?e.jsx(kb,{ticket:s,canApproveDataChange:a}):s?.issueType?.toString()===$e.DELETE_INDIVIDUAL?e.jsx(Bb,{ticket:s,canApproveDataChange:a}):s?.issueType?.toString()===$e.DELETE_HOUSEHOLD?e.jsx(Vb,{ticket:s,canApproveDataChange:a}):s?.issueType?.toString()===$e.EDIT_INDIVIDUAL?e.jsx(Wj,{ticket:s,canApproveDataChange:a}):s?.issueType?.toString()===$e.EDIT_HOUSEHOLD?e.jsx(pj,{ticket:s,canApproveDataChange:a}):s?.category?.toString()===De.PAYMENT_VERIFICATION&&s.ticketDetails.hasMultiplePaymentVerifications===!1?e.jsx(ij,{ticket:s,canApprovePaymentVerification:n}):null;return e.jsx(p,{container:!0,size:12,children:e.jsx(P,{sx:{width:"100%"},p:3,children:i()})})}const Yj=oe(Kj,"GrievancesApproveSection");function Qj({ticket:s,choicesData:t,baseUrl:a,canViewHouseholdDetails:n,canViewIndividualDetails:i}){const{t:r}=M(),{isAllPrograms:l,businessArea:o}=U(),{selectedProgram:d,isSocialDctType:c}=Z(),u=d?.beneficiaryGroup,h=_s(t.grievanceTicketStatusChoices),m=t.grievanceTicketPriorityChoices,g=t.grievanceTicketUrgencyChoices,x=_s(t.grievanceTicketCategoryChoices),f=Zc(s.category),j=eu(s.issueType),y=s.issueType===22,b=()=>e.jsx(P,{display:"flex",flexDirection:"column",children:s.documentation?.length?s.documentation.map(E=>E.contentType.includes("image")?e.jsx(nt,{src:E.filePath,variant:"link",linkText:E.name},E.id):e.jsx(Us,{download:!0,href:E.filePath,children:E.name},E.id)):"-"}),C=()=>{const E=s?.paymentRecord;return E?e.jsx(Us,{href:`/${o}/programs/${s.programs?.[0]?.slug}/payment-module/payments/${E.id}`,children:E.unicefId}):e.jsx(e.Fragment,{children:"-"})},v=()=>{const E=s?.paymentRecord?.parent;return E?e.jsx(Us,{href:`/${o}/programs/${s.programs?.[0]?.slug}/payment-module/payment-plans/${E.id}`,children:E.unicefId}):e.jsx(e.Fragment,{children:"-"})},S=()=>{const E=s?.paymentRecord?.parent;if(E){const D=`/${o}/programs/${s.programs?.[0]?.slug}/payment-verification/payment-plan/${E.id}`;return e.jsx(Us,{href:D,children:E.unicefId})}return e.jsx(e.Fragment,{children:"-"})},I=()=>s.programs?.length?e.jsx(P,{display:"flex",flexDirection:"column",children:s.programs.map(E=>e.jsx(Us,{href:`/${a}/details/${E.slug}`,children:E.name},E.id))}):e.jsx(e.Fragment,{children:"-"});return e.jsx(p,{size:{xs:12},children:e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:r("Details")})}),e.jsx(vt,{children:e.jsx(p,{container:!0,spacing:6,children:[{label:r("Status"),value:e.jsx(we,{status:h[s.status],statusToColor:Vn}),size:3},{label:r("Priority"),value:e.jsx(we,{status:m[m.findIndex(E=>E.value===s.priority)]?.name||"-",statusToColor:ji}),size:3},{label:r("Urgency"),value:e.jsx(we,{status:g[g.findIndex(E=>E.value===s.urgency)]?.name||"-",statusToColor:ji}),size:3},{label:r("Assigned to"),value:va(s.assignedTo),size:3},{label:r("Category"),value:e.jsx("span",{children:x[s.category]}),size:3},f&&{label:r("Issue Type"),value:e.jsx("span",{children:Jc(j,u)}),size:3},!c&&{label:`${u?.groupLabel} ID`,value:e.jsx("span",{children:s.household?.id&&n&&!l?e.jsx(me,{to:`/${a}/population/household/${s.household.id}`,children:s.household.unicefId}):e.jsx("div",{children:s.household?.id?s.household.unicefId:"-"})}),size:3},{label:l||c?r("Target ID"):`${u?.memberLabel} ID`,value:l||c?e.jsx("div",{children:s?.targetId||"-"}):e.jsx("span",{children:s.individual?.id&&i?e.jsx(me,{to:`/${a}/population/individuals/${s.individual.id}`,children:s.individual.unicefId}):e.jsx("div",{children:s.individual?.id?s.individual.unicefId:"-"})}),size:3},{label:r("Payment ID"),value:e.jsx("span",{children:C()}),size:3},{label:r("Payment Plan"),value:e.jsx("span",{children:v()}),size:3},{label:r("Payment Plan Verification"),value:e.jsx("span",{children:S()}),size:3},{label:r("Programme"),value:I(),size:3},y&&{label:r("Partner"),value:s.partner?.name,size:3},{label:r("Created By"),value:va(s.createdBy),size:3},{label:r("Date Created"),value:e.jsx(pe,{children:s.createdAt}),size:3},{label:r("Last Modified Date"),value:e.jsx(pe,{children:s.updatedAt}),size:3},{label:r("Administrative Level 2"),value:s.admin,size:3},{label:r("Area / Village / Pay point"),value:s.area,size:3},{label:r("Languages Spoken"),value:s.language,size:3},{label:r("Grievance Supporting Documents"),value:b(),size:3},{label:r("Description"),value:s.description,size:12},{label:r("Comments"),value:s.comments,size:12}].filter(E=>c?E.label!==`${u?.groupLabel} ID`:E).map(E=>E.label&&E.value&&E.size&&e.jsx(p,{size:{xs:E.size},children:e.jsx(L,{label:E.label,children:E.value})},E.label))})})]})})}const Xj=oe(Qj,"GrievancesDetails");function ed({ticket:s}){const{t}=M(),{baseUrl:a}=U(),{id:n}=ts(),{selectedProgram:i}=Z(),r=i?.beneficiaryGroup,[l,o]=A.useState(!1),{existingTickets:d,linkedTickets:c}=s,u=f=>f.length?f.map(j=>{const y=$t(j.id,j.category,a);return e.jsx(P,{mb:1,children:e.jsx(Us,{href:y,children:j.unicefId})},j.id)}):e.jsx(e.Fragment,{children:"-"}),h=s.household?.id&&d.length?d.filter(f=>f.status!==ze.CLOSED&&f.id!==n):[],m=s.household?.id&&d.length?d.filter(f=>f.status===ze.CLOSED&&f.id!==n):[],g=c.length?c.filter(f=>f.status!==ze.CLOSED&&f.id!==n):[],x=c.length?c.filter(f=>f.status===ze.CLOSED&&f.id!==n):[];return c.length>0||d.length>0?e.jsxs(aa,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:t("Other Related Tickets")})}),e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(L,{label:`For ${r?.groupLabel} ${s.household?.unicefId||"-"}`,children:e.jsx(e.Fragment,{children:u(h)})}),e.jsx(L,{label:t("Tickets"),children:e.jsx(e.Fragment,{children:u(g)})}),!l&&(x.length>0||m.length>0)?e.jsx(P,{mt:3,children:e.jsxs(_i,{onClick:()=>o(!0),children:[t("SHOW CLOSED TICKETS")," (",x.length+m.length,")"]})}):null,l&&e.jsxs(P,{mb:3,mt:3,children:[e.jsx(ee,{children:t("Closed Tickets")}),e.jsx(L,{label:`${t(`For ${r?.groupLabel}`)} ${s.household?.unicefId||"-"}`,children:e.jsx(e.Fragment,{children:u(m)})}),e.jsx(L,{label:t("Tickets"),children:e.jsx(e.Fragment,{children:u(x)})})]}),l&&(x.length>0||m.length>0)?e.jsxs(_i,{onClick:()=>o(!1),children:[t("HIDE CLOSED TICKETS")," (",x.length+m.length,")"]}):null]})]}):null}function Jj({verifications:s}){const{t}=M(),{baseUrl:a}=U(),n=s.map(i=>e.jsx(P,{mb:1,children:e.jsx(Us,{href:`/${a}/verification-records/${i.id}`,children:i.paymentId})},i.id));return e.jsxs(aa,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:t("Payment Ids")})}),e.jsx(P,{display:"flex",flexDirection:"column",children:n})]})}function Zj({selectedHousehold:s,selectedIndividual:t,setLookUpDialogOpen:a,disabled:n}){const{baseUrl:i}=U(),{selectedProgram:r}=Z(),l=r?.beneficiaryGroup;return e.jsx(Fn,{children:e.jsxs(p,{container:!0,children:[e.jsx(p,{children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsxs("span",{children:[`${l?.groupLabel} ID: `,s?.unicefId?e.jsx(Us,{href:`/${i}/population/household/${s.id}`,children:e.jsxs(ot,{children:[" ",s.unicefId]})}):e.jsx(ot,{children:" -"})]}),e.jsxs("span",{children:[`${l?.memberLabel} ID: `,t?.unicefId?e.jsx(Us,{href:`/${i}/population/individuals/${t.id}`,children:e.jsx(ot,{children:t.unicefId})}):e.jsx(ot,{children:"-"})]})]})}),e.jsx(p,{children:e.jsx(P,{p:2,children:e.jsx(p,{container:!0,justifyContent:"center",alignItems:"center",children:e.jsx(p,{children:n?null:e.jsx(kl,{children:e.jsx(ma,{color:"inherit",fontSize:"small",onClick:()=>a(!0)})})})})})})]})})}function eA({onValueChange:s,initialValues:t,lookUpDialogOpen:a,setLookUpDialogOpen:n,ticket:i,selectedIndividual:r,selectedHousehold:l,setSelectedIndividual:o,setSelectedHousehold:d,shouldUseMultiple:c,individual:u,household:h}){const{t:m}=M(),g=je(),{businessArea:x}=U(),{id:f}=ts(),{showMessage:j}=Ae(),y=Fe(),{mutateAsync:b}=xe({mutationFn:O=>N.restBusinessAreasGrievanceTicketsReassignRoleCreate({businessAreaSlug:x,id:f,formData:O}),onSuccess:()=>{y.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",x,f]}),j(m("Role Reassigned"))},onError:O=>{fe(O,j)}}),{data:C,isLoading:v}=V({queryKey:["individualChoices",x],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:x})}),S={search:"",documentType:C?.documentTypeChoices?.[0]?.value,documentNumber:"",admin2:"",sex:"",ageMin:"",ageMax:"",flags:[],orderBy:"unicef_id",status:"",household:""};h&&(S.household=h?.id);const[I,E]=A.useState(Ke(g,S)),[D,F]=A.useState(Ke(g,S));if(v)return e.jsx(Ne,{});if(!C)return null;const w=()=>{n(!1)};return e.jsx(B.Formik,{initialValues:t,onSubmit:async O=>{s("selectedHousehold",O.selectedHousehold),s("selectedIndividual",O.selectedIndividual),n(!1);const k={householdId:h.id,individualId:c?u.id:O.selectedIndividual?.id,newIndividualId:c?O.selectedIndividual?.id:void 0,role:O.role};try{await b(k)}catch{}},children:({submitForm:O,setFieldValue:k,values:$})=>e.jsxs(is,{maxWidth:"lg",fullWidth:!0,open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[a&&e.jsx(Bs,{}),e.jsx(Ye,{children:e.jsx(Le,{children:m("Reassign Role")})}),e.jsxs(Be,{children:[e.jsx(Vl,{filter:I,choicesData:C,setFilter:E,initialFilter:S,appliedFilter:D,setAppliedFilter:F,isOnPaper:!1}),e.jsx(ju,{filter:D,setFieldValue:k,valuesInner:$,selectedHousehold:l,setSelectedHousehold:d,selectedIndividual:r,setSelectedIndividual:o,ticket:i,excludedId:u.id,noTableStyling:!0})]}),e.jsx(ss,{children:e.jsx(os,{children:e.jsxs(P,{display:"flex",children:[e.jsx(P,{mr:1,children:e.jsx(B.Field,{name:"identityVerified",label:"Identity Verified*",component:ws})}),e.jsx(H,{onClick:()=>w(),children:m("CANCEL")}),e.jsx(H,{type:"submit",color:"primary",variant:"contained",onClick:O,disabled:$.identityVerified===!1,"data-cy":"button-submit",children:m("SAVE")})]})})})]})})}function Ci({household:s,ticket:t,individualRole:a,shouldDisableButton:n,individualToReassign:i,initialSelectedIndividualId:r}){const{t:l}=M(),[o,d]=A.useState(r),{businessArea:c,programId:u}=U(),{data:h,isLoading:m}=V({queryKey:["businessAreaProgramIndividual",c,u,o],queryFn:()=>N.restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:c,programSlug:u,id:o}),enabled:!!o}),[g,x]=A.useState(!1),[f,j]=A.useState(null),[y,b]=A.useState(null),[C,v]=A.useState({household:null,individual:null,role:null,newIndividual:null}),[S,I]=A.useState(!1);return A.useEffect(()=>{j(s)},[s]),A.useEffect(()=>{y?.household&&j(y.household)},[y]),A.useEffect(()=>{h&&b(h)},[h]),A.useEffect(()=>{const E=t.category?.toString(),D=t.issueType?.toString();let F=null;switch(E){case De.DATA_CHANGE:(D===$e.DELETE_INDIVIDUAL||D===$e.EDIT_INDIVIDUAL)&&(F=t?.ticketDetails?.roleReassignData);break;case De.SYSTEM_FLAGGING:F=t?.ticketDetails?.roleReassignData;break;case De.NEEDS_ADJUDICATION:F=t?.ticketDetails?.roleReassignData,I(t?.ticketDetails?.selectedDuplicates?.length>0);break}let w=null;if(F)if(a.id==="HEAD")w=F.head||F.HEAD;else{const O=a.id.replace(/-/g,"");if(F[O])w=F[O];else{const $=Object.keys(F).find(G=>G.toLowerCase()===O.toLowerCase());$&&(w=F[$])}}w&&v(w)},[t,a,r]),A.useEffect(()=>{if(C?.individual){const E=C.newIndividual||C.individual;d(E)}},[C]),m?e.jsx(Ne,{}):e.jsx(B.Formik,{initialValues:{selectedIndividual:h,selectedHousehold:f,role:a.role},onSubmit:null,children:({setFieldValue:E,values:D})=>e.jsxs(e.Fragment,{children:[y?e.jsx(Zj,{setLookUpDialogOpen:x,selectedHousehold:f,selectedIndividual:y,disabled:n}):e.jsx(Ol,{title:l("Reassign Role"),handleClick:()=>x(!0)}),e.jsx(eA,{lookUpDialogOpen:g,setLookUpDialogOpen:x,initialValues:D,onValueChange:E,ticket:t,individual:i,selectedIndividual:y,selectedHousehold:f,setSelectedHousehold:j,setSelectedIndividual:b,shouldUseMultiple:S,household:s})]})})}const sA=T(us)`
  border: 1px solid ${({theme:s})=>s.hctPalette.orange};
  border-radius: 3px;
  background-color: #fff;
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 26px 22px;
`,tA=T.div`
  color: ${({theme:s})=>s.hctPalette.orange};
`,aA=T(Ii)`
  position: relative;
  top: 5px;
  margin-right: 10px;
`;function nA({ticket:s}){const{t}=M(),{baseUrl:a}=U(),{selectedProgram:n}=Z(),i=n?.beneficiaryGroup,r=s.ticketDetails.roleReassignData,l={};for(const c of Object.keys(r))l[r[c].individual]=r[c];const o=s.ticketDetails.selectedDuplicates?.filter(c=>c.role==="PRIMARY"||c.role==="HEAD"),d=()=>e.jsx(e.Fragment,{children:o.map(c=>{const{household:u}=c,h=c?.rolesInHouseholds||[],m=c?.id===u?.headOfHousehold?.id,g=h.filter(x=>x.role!==null).map(x=>e.jsxs(P,{mb:2,mt:2,children:[e.jsxs(P,{mb:2,children:[e.jsx(L,{label:t("ROLE"),children:e.jsxs(e.Fragment,{children:[cl(x.role)," Collector"]})}),e.jsxs(L,{label:t(`${i?.memberLabel.toUpperCase()} ID`),children:[e.jsx(Us,{href:`/${a}/population/individuals/${x.individual.id}`,children:x.individual.unicefId})," ",x.individual.fullName]}),e.jsx(L,{label:t(`${i?.groupLabel.toUpperCase()} ID`),children:e.jsx(Us,{href:`/${a}/population/household/${x.household.id}`,children:x.household.unicefId})})]}),e.jsx(Ci,{shouldDisableButton:!1,individualRole:{role:x.role,id:x.id},ticket:s,household:x.household,individualToReassign:c,initialSelectedIndividualId:l[c.id]?.new_individual})]},x.id));return e.jsxs(P,{mt:3,display:"flex",flexDirection:"column",children:[m&&e.jsxs(P,{mb:2,mt:2,children:[e.jsxs(P,{mb:2,children:[e.jsx(L,{label:t("ROLE"),children:e.jsx(e.Fragment,{children:t(`Head of ${i?.groupLabel}`)})}),e.jsxs(L,{label:t(`${i?.memberLabel.toUpperCase()} ID`),children:[e.jsx(Us,{href:`/${a}/population/individuals/${s.individual.id}`,children:s.individual.unicefId})," ",s.individual.fullName]}),e.jsx(L,{label:t(`${i?.groupLabel.toUpperCase()} ID`),children:e.jsx(Us,{href:`/${a}/population/household/${s?.household.id}`,children:u.unicefId})})]}),e.jsx(Ci,{shouldDisableButton:!1,individualRole:{role:"HEAD",id:"HEAD"},ticket:s,household:u,individualToReassign:c,initialSelectedIndividualId:l[c.id]?.new_individual})]}),g]},u.unicefId)})});return o.length?e.jsxs(sA,{children:[e.jsx(tA,{children:e.jsxs(ee,{variant:"h6",children:[e.jsx(aA,{}),t(`${i?.memberLabel} is the Head of ${i?.groupLabel} or the collector for the ${i?.groupLabel}`)]})}),e.jsx(ee,{variant:"body2",children:t(`Upon changing you will need to select new ${i?.memberLabelPlural} for this role.`)}),e.jsx(ee,{variant:"body2",children:t(`Upon removing you will need to select new ${i?.memberLabelPlural} for this role.`)}),e.jsx(P,{mt:3,display:"flex",flexDirection:"column",children:d()})]}):null}const iA=T(H)`
  padding: 25px;
  margin-top: 25px;
  width: 100%;
  border: 1.5px solid #043e91;
  border-radius: 5px;
  color: #033f91;
  font-size: 16px;
  text-align: center;
  padding: 25px;
  font-weight: 700;
  cursor: pointer;
  background: #fff;
`;function rA({individualRole:s,household:t,individual:a}){const{t:n}=M(),{id:i}=ts(),{showMessage:r}=Ae(),{selectedProgram:l}=Z(),o=l?.beneficiaryGroup,{businessArea:d}=U(),c=Fe(),{mutateAsync:u,isPending:h}=xe({mutationFn:m=>N.restBusinessAreasGrievanceTicketsReassignRoleCreate({businessAreaSlug:d,id:i,formData:m}),onSuccess:()=>{c.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",d,i]}),r(n("Role Reassigned"))},onError:m=>{fe(m,r)}});return e.jsx(B.Formik,{initialValues:{},onSubmit:async()=>{const m={householdId:t.id,individualId:a.id,role:s.role};try{await u(m)}catch(g){fe(g,r)}},children:({submitForm:m})=>e.jsx(iA,{type:"submit",color:"primary",onClick:m,"data-cy":"button-submit",variant:"contained",disabled:h,children:n(h?"Reassigning...":`Reassign To Unique ${o?.memberLabel}`)})})}const lA=T(us)`
  border: 1px solid ${({theme:s})=>s.hctPalette.orange};
  border-radius: 3px;
  background-color: #fff;
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 26px 22px;
`,oA=T.div`
  color: ${({theme:s})=>s.hctPalette.orange};
`,dA=T(Ii)`
  position: relative;
  top: 5px;
  margin-right: 10px;
`,cA=({ticket:s,shouldDisplayButton:t,shouldDisableButton:a})=>{const{t:n}=M(),{baseUrl:i}=U(),{selectedProgram:r}=Z(),l=r?.beneficiaryGroup,o=s.category.toString(),d=s.issueType?.toString();let c=s.individual,u=s.household,h,m;o===De.NEEDS_ADJUDICATION?(c=s.ticketDetails.selectedIndividual,u=s.ticketDetails.selectedIndividual?.household,h=s.ticketDetails.roleReassignData,m=s.ticketDetails.possibleDuplicate.id===c.id?s.ticketDetails.goldenRecordsIndividual:s.ticketDetails.possibleDuplicate):(o===De.SYSTEM_FLAGGING||!h&&s.ticketDetails?.roleReassignData)&&(h=s.ticketDetails.roleReassignData);let g=c?.rolesInHouseholds||[],x=c?.id===u?.headOfHousehold?.id;if(o===De.DATA_CHANGE&&d===$e.EDIT_INDIVIDUAL){const v=s.ticketDetails.individualData;Ao(v.role)&&(g=[]),Ao(v.relationship)&&(x=!1)}const j={},y={};h&&typeof h=="object"&&Object.entries(h).forEach(([v,S])=>{S&&typeof S=="object"&&"individual"in S&&typeof S.individual=="string"&&(j[S.individual]=S),S&&typeof S=="object"&&"role"in S&&(y[v]=S,y[v.toLowerCase()]=S)});const b=g.filter(v=>v.role!==null).map(v=>{const S=v.id.replace(/-/g,""),I=s.ticketDetails.roleReassignData;let E=null,D=null;if(I)if(I[S])E=S,D=I[S].individual;else{const w=Object.keys(I).find(O=>O.toLowerCase()===S.toLowerCase());w&&(E=w,D=I[w].individual)}return e.jsxs(P,{mb:2,mt:2,children:[e.jsxs(P,{mb:2,children:[e.jsx(L,{label:n("ROLE"),children:e.jsxs(e.Fragment,{children:[cl(v.role)," Collector"]})}),e.jsx(L,{label:n(`${l?.groupLabel} ID`),children:e.jsx(Us,{href:`/${i}/population/household/${v.household.id}`,children:v.household.unicefId})})]}),t?e.jsx(Ci,{shouldDisableButton:a,individualRole:{role:v.role,id:v.id},ticket:s,household:v.household,individualToReassign:c,initialSelectedIndividualId:D}):null,t&&s.category.toString()===De.NEEDS_ADJUDICATION&&s.ticketDetails.roleReassignData?.[E]?.individual!==m.id?e.jsx(rA,{individualRole:{role:v.role,id:v.id},household:v.household,individual:m}):null]},v.id)}),C=()=>s.issueType.toString()===$e.DELETE_INDIVIDUAL&&(s.individual?.role==="PRIMARY"||s.individual?.relationship==="HEAD")?e.jsx(ee,{variant:"body2",children:n(`Upon removing you will need to select new ${l?.memberLabelPlural} for this role.`)}):null;return e.jsxs(lA,{children:[e.jsx(oA,{children:e.jsxs(ee,{variant:"h6",children:[e.jsx(dA,{}),n(`${l?.memberLabel} is the Head of Household or the collector for the ${l?.groupLabel}`)," "]})}),C(),e.jsxs(P,{mt:3,display:"flex",flexDirection:"column",children:[x&&e.jsxs(P,{mb:2,mt:2,children:[e.jsxs(P,{mb:2,children:[e.jsx(L,{label:n("ROLE"),children:e.jsx(e.Fragment,{children:n(`Head of ${l?.groupLabel}`)})}),e.jsx(L,{label:n(`${l?.groupLabel} ID`),children:e.jsx(Us,{href:`/${i}/population/household/${s?.household.id}`,children:u.unicefId})})]}),t?e.jsx(Ci,{shouldDisableButton:a,individualRole:{role:"HEAD",id:"HEAD"},ticket:s,household:u,individualToReassign:c,initialSelectedIndividualId:s.ticketDetails.roleReassignData?.head?.individual||s.ticketDetails.roleReassignData?.HEAD?.individual}):null]}),b]})]})};function uA({ticket:s}){const{isSocialDctType:t}=Z(),a=()=>{let{individual:r,household:l}=s;const{category:o,issueType:d,status:c}=s;if(o.toString()===De.NEEDS_ADJUDICATION&&(r=s.ticketDetails.selectedIndividual,l=s.ticketDetails.selectedIndividual?.household),l?.activeIndividualsCount===1||![{category:De.DATA_CHANGE,issueType:$e.DELETE_INDIVIDUAL},{category:De.DATA_CHANGE,issueType:$e.EDIT_INDIVIDUAL},{category:De.SYSTEM_FLAGGING,issueType:void 0,approveStatus:s?.ticketDetails?.approveStatus},{category:De.NEEDS_ADJUDICATION,selectedIndividual:s?.ticketDetails?.selectedIndividual}].some(y=>o.toString()===y.category&&(d?.toString()===y.issueType||y.approveStatus||y.selectedIndividual))||!(c===ze.FOR_APPROVAL))return!1;const g=r?.rolesInHouseholds||[],x=r?.id===l?.headOfHousehold?.id,f=g.some(y=>y.role!==null);let j=!0;if(o.toString()===De.DATA_CHANGE&&d.toString()===$e.EDIT_INDIVIDUAL){const{role:y,relationship:b}=s.ticketDetails.individualData;mt.isEmpty(y)&&mt.isEmpty(b)&&(j=!1)}return(x||f)&&j&&!t},n=()=>s.category.toString()===De.NEEDS_ADJUDICATION&&s.ticketDetails.isMultipleDuplicatesVersion&&!t,i=()=>s.category.toString()===De.PAYMENT_VERIFICATION?e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(P,{mt:3,children:s.ticketDetails?.hasMultiplePaymentVerifications?e.jsx(Jj,{verifications:s.ticketDetails?.paymentVerifications.map(r=>({id:r.id,paymentId:s.paymentRecord.unicefId}))||[]}):null}),e.jsx(P,{mt:3,children:e.jsx(ed,{ticket:s})})]}):a()?e.jsx(P,{p:3,children:e.jsx(P,{display:"flex",flexDirection:"column",children:e.jsx(cA,{shouldDisplayButton:!0,shouldDisableButton:s.ticketDetails?.approveStatus,ticket:s})})}):n()?e.jsx(P,{p:3,children:e.jsx(P,{display:"flex",flexDirection:"column",children:e.jsx(nA,{ticket:s})})}):e.jsx(P,{p:3,children:e.jsx(P,{display:"flex",flexDirection:"column",children:e.jsx(ed,{ticket:s})})});return e.jsx(p,{sx:{width:"100%"},children:i()})}const sd=T.span`
  font-size: 16px;
`,hA=T.span`
  font-size: 12px;
  color: #848484;
`,td=T.div`
  margin-bottom: 35px;
`,mA=T(us)`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 26px 22px;
`;function pA({notes:s,canAddNote:t}){const{t:a}=M(),{businessAreaSlug:n,programSlug:i}=U(),{showMessage:r}=Ae(),{data:l,isLoading:o}=V({queryKey:["profile",n,i],queryFn:()=>N.restBusinessAreasUsersProfileRetrieve({businessAreaSlug:n,program:i==="all"?void 0:i}),staleTime:300*1e3,gcTime:1800*1e3,refetchOnWindowFocus:!1}),{id:d}=ts(),{isActiveProgram:c}=Z(),u=Fe(),{mutate:h,isPending:m}=xe({mutationFn:b=>N.restBusinessAreasGrievanceTicketsCreateNoteCreate({businessAreaSlug:n,id:d,formData:b}),onSuccess:()=>{u.invalidateQueries({queryKey:["businessAreasGrievanceTicketsRetrieve",n,d]})},onError:b=>{fe(b,r)}});if(o)return null;const g=(b,C,v,S)=>e.jsxs(p,{container:!0,"data-cy":"note-row",children:[e.jsx(p,{size:{xs:2},children:e.jsx(Hr,{alt:`${b} picture`,src:"/static/images/avatar/1.jpg"})}),e.jsxs(p,{size:{xs:10},children:[e.jsx(p,{size:{xs:12},children:e.jsxs(P,{display:"flex",justifyContent:"space-between","data-cy":"note-name",children:[e.jsx(sd,{children:b}),e.jsx(hA,{children:e.jsx(pe,{withTime:!0,children:C})})]})}),e.jsx(p,{size:{xs:12},children:e.jsx(td,{children:e.jsx("p",{children:v})})})]})]},S),x=s?.map(b=>g(va(b.createdBy),b.createdAt,b.description,b.id)),f={newNote:""},j=Q.object().shape({newNote:Q.string().required(a("Note cannot be empty"))}),y=`${l.firstName||l.email}`;return e.jsx(p,{size:{xs:8},children:e.jsx(P,{p:3,children:e.jsx(B.Formik,{initialValues:f,onSubmit:(b,{resetForm:C})=>{h({description:b.newNote}),C({})},validationSchema:j,children:({submitForm:b})=>e.jsxs(mA,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:"Notes"})}),x,t&&e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:2},children:e.jsx(Hr,{src:y,alt:y})}),e.jsxs(p,{size:{xs:10},children:[e.jsx(p,{size:{xs:12},children:e.jsx(P,{display:"flex",justifyContent:"space-between",children:e.jsx(sd,{children:va(l)})})}),e.jsx(p,{size:{xs:12},children:e.jsx(td,{children:e.jsxs(B.Form,{children:[e.jsx(B.Field,{name:"newNote",multiline:!0,fullWidth:!0,variant:"filled",label:"Add a note ...",component:Se}),e.jsx(P,{mt:2,display:"flex",justifyContent:"flex-end",children:e.jsx(ke,{"data-cy":"button-add-note",loading:m,color:"primary",variant:"contained",onClick:b,disabled:!c,children:a("Add New Note")})})]})})})]})]})]})})})})}const Dt=[{disablePadding:!1,label:"Date",id:"timestamp",numeric:!1,weight:.4},{disablePadding:!1,label:"User",id:"actor",numeric:!1,weight:.6},{disablePadding:!1,label:"Action",id:"action",numeric:!1,weight:.4},{disablePadding:!1,label:"Change from",id:"change_from",numeric:!1},{disablePadding:!1,label:"Change to",id:"change_to",numeric:!1}],gA=T.div`
  border-bottom: 1px solid rgba(224, 224, 224, 1);
`,xA=T(yt)`
  background-color: #fafafa;
`,fA=T(Ve)`
  transform: rotate(0deg);
  transition: ${({theme:s})=>s.transitions.create("transform",{duration:400})};
  ${({expanded:s})=>s&&on.css`
      transform: rotate(180deg);
    `}
`,ti=s=>{const t=/(\d{2}:\d{2}:\d{2})([+-])(\d{2}):(\d{2})$/;return t.test(s)?s.replace(t,""):s},yA=({logEntry:s})=>{const{changes:t}=s,[a,n]=A.useState(!1);if(!t)return null;const i=Object.keys(t),{length:r}=i;return r===1?e.jsxs(_a,{role:"checkbox","data-cy":"log-row",children:[e.jsx(As,{weight:Dt[0].weight,"data-cy":"timestamp-cell",children:fs(s.timestamp).format("DD MMM YYYY HH:mm")}),e.jsx(As,{weight:Dt[1].weight,"data-cy":"user-cell",children:s.userDisplayName||s.user||null}),e.jsx(As,{weight:Dt[2].weight,"data-cy":"change-key-cell",children:i[0]}),e.jsx(As,{weight:Dt[3].weight,"data-cy":"from-value-cell",children:ti(t[i[0]].from)}),e.jsx(As,{weight:Dt[4].weight,"data-cy":"to-value-cell",children:ti(t[i[0]].to)}),e.jsx(ln,{})]}):e.jsxs(e.Fragment,{children:[e.jsxs(_a,{onClick:()=>n(!a),hover:!0,"data-cy":`log-row-${s.id}`,children:[e.jsx(As,{weight:Dt[0].weight,"data-cy":"timestamp-cell",children:fs(s.timestamp).format("DD MMM YYYY HH:mm")}),e.jsx(As,{weight:Dt[1].weight,"data-cy":"user-cell",children:s.userDisplayName||s.user||null}),e.jsx(As,{weight:Dt[2].weight,"data-cy":"change-type-cell",children:"Multiple"}),e.jsx(As,{weight:Dt[3].weight}),e.jsx(As,{weight:Dt[4].weight}),e.jsx(gA,{children:e.jsx(fA,{expanded:a,onClick:()=>n(!a),"data-cy":"expand-collapse-button",children:e.jsx(za,{})})})]}),e.jsx(xA,{in:a,"data-cy":"collapse-container",children:i.map(l=>e.jsxs(_a,{"data-cy":`detail-row-${l}`,children:[e.jsx(As,{weight:Dt[0].weight}),e.jsx(As,{weight:Dt[1].weight}),e.jsx(As,{weight:Dt[2].weight,"data-cy":"detail-key-cell",children:l}),e.jsx(As,{weight:Dt[3].weight,"data-cy":"detail-from-value-cell",children:ti(t[l].from)}),e.jsx(As,{weight:Dt[4].weight,"data-cy":"detail-to-value-cell",children:ti(t[l].to)}),e.jsx(ln,{})]},`${s.id}${l}`))})]})},bA=Ft("div")`
  display: flex;
  flex-direction: column;
`,jA=Ft("div")`
  display: flex;
  flex: ${({weight:s})=>s||1};
  padding: 16px;
  font-size: 12px;
  text-align: left;
  font-weight: 500;
  line-height: 1.43rem;
  border-bottom: 1px solid rgba(224, 224, 224, 1);
  letter-spacing: 0.01071em;
  vertical-align: inherit;
`,AA=Ft(us)(()=>({width:"100%",padding:"20px 0",marginBottom:"20px"})),_A=Ft("div")(()=>({margin:"0 24px",display:"flex",flexDirection:"row",justifyContent:"space-between"}));function PA({logEntries:s,totalCount:t,rowsPerPage:a,page:n,onChangePage:i,onChangeRowsPerPage:r}){const[l,o]=A.useState(!1),{t:d}=M();return e.jsxs(AA,{"data-cy":"activity-log-container",children:[e.jsxs(_A,{children:[e.jsx(ee,{variant:"h6","data-cy":"activity-log-title",children:d("Activity Log")}),e.jsx(H,{variant:"outlined",color:"primary",endIcon:l?e.jsx(Di,{}):e.jsx(za,{}),onClick:()=>o(!l),"data-cy":"expand-collapse-button",children:l?"HIDE":"SHOW"})]}),e.jsxs(yt,{in:l,children:[e.jsxs(bA,{"data-cy":"activity-log-table",children:[e.jsxs(_a,{children:[Dt.map(c=>e.jsx(jA,{"data-cy":`heading-cell-${c.id}`,style:{flex:c.weight||1},children:c.label},c.id)),e.jsx(ln,{})]}),s.map(c=>e.jsx(yA,{"data-cy":"log-row",logEntry:c},c.id))]}),e.jsx(Ua,{rowsPerPageOptions:[5,10,15],component:"div","data-cy":"pagination",count:t,rowsPerPage:a,page:n,onPageChange:i,onRowsPerPageChange:r})]})]})}const CA=T.div`
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  padding: 20px;
  padding-bottom: 0;
`;function Lt({objectId:s}){const[t,a]=A.useState(0),{businessAreaSlug:n}=U(),[i,r]=A.useState(5),{data:l}=V({queryKey:["activityLogs",n,s,t,i],queryFn:()=>N.restBusinessAreasActivityLogsList({businessAreaSlug:n,objectId:s,limit:i,offset:t*i}),enabled:!!(n&&s)}),{data:o}=V({queryKey:["activityLogsCount",n],queryFn:()=>N.restBusinessAreasActivityLogsCountRetrieve({businessAreaSlug:n}),enabled:!!n});if(!l)return null;const d=l.results.map((u,h)=>({...u,id:`${u.objectId}-${u.timestamp}-${h}`,userDisplayName:u.user||""})),c=o?.count??0;return e.jsx(CA,{children:e.jsx(PA,{totalCount:c,rowsPerPage:i,logEntries:d,page:t,onChangePage:(u,h)=>{a(h)},onChangeRowsPerPage:u=>{const h=parseInt(u.target.value,10);r(h),a(0)}})})}const EA=()=>{const{id:s}=ts(),{businessAreaSlug:t,programSlug:a}=U(),n=ve(),{data:i,isLoading:r}=V({queryKey:["profile",t,a],queryFn:()=>N.restBusinessAreasUsersProfileRetrieve({businessAreaSlug:t,program:a==="all"?void 0:a}),staleTime:300*1e3,gcTime:1800*1e3,refetchOnWindowFocus:!1}),{data:l,isLoading:o,error:d}=V({queryKey:["businessAreasGrievanceTicketsRetrieve",t,s],queryFn:()=>N.restBusinessAreasGrievanceTicketsRetrieve({businessAreaSlug:t,id:s})}),{baseUrl:c}=U(),{data:u,isLoading:h}=V({queryKey:["businessAreasGrievanceTicketsChoices",t],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:t})});if(h||o||r)return e.jsx(Ne,{});if(rt(d))return e.jsx(Xe,{permission:R.GRIEVANCES_VIEW_DETAILS});if(!l||!u||!i||n===null)return null;const m=l,g=i?.id,x=g===m?.createdBy?.id,f=g===m?.assignedTo?.id,{canViewHouseholdDetails:j,canViewIndividualDetails:y,canEdit:b,canAddNote:C,canSetInProgress:v,canSetOnHold:S,canSendForApproval:I,canSendBack:E,canClose:D,canApproveDataChange:F,canApproveFlagAndAdjudication:w,canApprovePaymentVerification:O,canAssign:k}=Cu(x,f,m,n);return e.jsxs(e.Fragment,{children:[e.jsx(Lb,{ticket:m,canEdit:b,canSetInProgress:v,canSetOnHold:S,canSendForApproval:I,canSendBack:E,canClose:D,canAssign:k}),e.jsxs(p,{container:!0,children:[e.jsx(Xj,{ticket:m,choicesData:u,baseUrl:c,canViewHouseholdDetails:j,canViewIndividualDetails:y}),e.jsx(Yj,{ticket:m,baseUrl:c,canApproveFlagAndAdjudication:w,canApproveDataChange:F,canApprovePaymentVerification:O}),e.jsx(pA,{notes:m.ticketNotes,canAddNote:C}),e.jsx(uA,{ticket:m})]}),K(R.ACTIVITY_LOG_VIEW,n)&&e.jsx(Lt,{objectId:m.id})]})},ad=oe(EA,"GrievancesDetailsPage"),Yi=({disabled:s,name:t,filter:a,value:n,label:i,initialFilter:r,appliedFilter:l,setAppliedFilter:o,setFilter:d,additionalVariables:c})=>{const{t:u}=M(),h=ge(),m=je(),[g,x]=A.useState(!1),[f,j]=A.useState(""),y=qt(f,800),b=Bi(),[C,v]=A.useState({limit:100,businessAreaSlug:b,search:y||void 0,ordering:"first_name,last_name,email",...c}),{data:S,isLoading:I,refetch:E}=V({queryKey:["businessAreasUsersList",C,b],queryFn:()=>N.restBusinessAreasUsersList(C)});A.useEffect(()=>{v(W=>({...W,search:y||void 0}))},[y]);const D=A.useCallback(()=>{b&&E()},[b,E]),{handleFilterChange:F}=Ss(r,h,m,a,d,l,o),w=S?.results||[],O=w.map(W=>({id:W.id,name:`${W.firstName} ${W.lastName}`.trim()||W.email})),k=(W,Y)=>typeof Y=="string"?W?.id===Y:W?.id===Y?.id,$=W=>{if(typeof W=="string"){const Y=w.find(X=>X.id===W);return Y?`${Y.firstName||""} ${Y.lastName||""}`.trim()||Y.email:W}return W?.name||""},G=W=>{j(W)};return e.jsx(un,{value:n,disabled:s,label:i||u("Created By"),dataCy:"filters-created-by-autocomplete",loadData:D,loading:I,options:O,handleChange:(W,Y)=>{Y||G(""),Qa(t,Y?.id,F)},handleOpen:()=>x(!0),open:g,handleClose:(W,Y)=>{x(!1),Y!=="select-option"&&G("")},handleOptionSelected:k,handleOptionLabel:$,data:S,inputValue:f,onInputTextChange:G,debouncedInputText:y})};function vA({disabled:s,name:t,filter:a,value:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,setFilter:o,dataCy:d}){const{t:c}=M(),[u,h]=A.useState(!1),m=ge(),g=je(),[x,f]=A.useState(""),j=qt(x,800),{data:y,isLoading:b,refetch:C}=V({queryKey:["languagesList"],queryFn:()=>N.restChoicesLanguagesList()}),v=A.useCallback(()=>{C()},[C]),{handleFilterChange:S}=Ss(i,m,g,a,o,r,l),D=(y||[]).filter(O=>O.name.toLowerCase().includes(j.toLowerCase())).map(O=>({id:O.value,code:O.value,name:O.name})),F=(O,k)=>typeof k=="string"?O?.code===k:O?.code===k?.code,w=O=>{if(typeof O=="string"){const k=D.find($=>$.code===O);return k?k.name:O}return O?.name||""};return e.jsx(un,{value:n||"",disabled:s,label:c("Preferred language"),dataCy:d,loadData:v,loading:b,options:D,handleChange:(O,k)=>{k||f(""),Qa(t,k?.code,S)},handleOpen:()=>h(!0),open:u,handleClose:(O,k)=>{h(!1),k!=="select-option"&&f("")},handleOptionSelected:F,handleOptionLabel:w,data:y,inputValue:x,onInputTextChange:f,debouncedInputText:j})}function Iu({disabled:s,name:t,filter:a,value:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,setFilter:o,dataCy:d="program-autocomplete"}){const{businessArea:c}=U(),{t:u}=M(),[h,m]=A.useState(!1),g=ge(),x=je(),[f,j]=A.useState(""),y=qt(f,800),[b,C]=A.useState({limit:20,businessAreaSlug:c,search:y||void 0}),{data:v,isLoading:S,refetch:I}=V({queryKey:["businessAreasProgramsList",b,c],queryFn:()=>N.restBusinessAreasProgramsList(b)});A.useEffect(()=>{C(G=>({...G,search:y||void 0}))},[y]);const E=A.useCallback(()=>{c&&I()},[c,I]),{handleFilterChange:D}=Ss(i,g,x,a,o,r,l),F=v?.results||[],w=F.map(G=>({id:G.id,name:G.name})),O=(G,W)=>typeof W=="string"?G?.id===W:G?.id===W?.id,k=G=>typeof G=="string"?F.find(Y=>Y.id===G)?.name||G:G?.name||"",$=G=>{j(G)};return e.jsx(un,{value:n,disabled:s,label:u("Programme"),dataCy:d,loadData:E,loading:S,options:w,handleChange:(G,W)=>{W||$(""),Qa(t,W?.id,D)},handleOpen:()=>m(!0),open:h,handleClose:(G,W)=>{m(!1),W!=="select-option"&&$("")},handleOptionSelected:O,handleOptionLabel:k,data:v,inputValue:f,onInputTextChange:$,debouncedInputText:y,startAdornment:e.jsx(dt,{position:"start",children:e.jsx(Si,{})})})}function Gl({disabled:s,name:t,filter:a,value:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,setFilter:o,onChange:d}){const{t:c}=M(),[u,h]=A.useState(!1),m=ge(),g=je(),[x,f]=A.useState(""),j=qt(x,800),{businessArea:y,programId:b}=U(),[C,v]=A.useState({limit:20,businessAreaSlug:y,programSlug:b||"",search:j||void 0,ordering:"name"}),{data:S,isLoading:I,refetch:E}=V({queryKey:["businessAreasProgramsRegistrationDataImportsList",C,y,b],queryFn:()=>N.restBusinessAreasProgramsRegistrationDataImportsList(C),enabled:!!b&&!!y});A.useEffect(()=>{v(W=>({...W,search:j||void 0}))},[j]),A.useEffect(()=>{v(W=>({...W,programSlug:b||""}))},[b]);const D=A.useCallback(()=>{y&&b&&E()},[y,b,E]),F=i&&o&&r&&l?Ss(i,m,g,a,o,r,l).handleFilterChange:void 0,w=S?.results||[],O=w.map(W=>({id:W.id,name:W.name})),k=(W,Y)=>typeof Y=="string"?W?.id===Y:W?.id===Y?.id,$=W=>{if(typeof W=="string"){const Y=w.find(X=>X.id===W);return Y?Y.name:W}return W?.name||""},G=W=>{f(W)};return e.jsx(un,{value:n,disabled:s,label:c("Registration Data Import"),dataCy:"filters-registration-data-import",loadData:D,loading:I,options:O,handleChange:(W,Y)=>{Y||G(""),d?d(Y?.id||null):F&&t&&Qa(t,Y?.id,F)},handleOpen:()=>h(!0),open:u,handleClose:(W,Y)=>{h(!1),Y!=="select-option"&&G("")},handleOptionSelected:k,handleOptionLabel:$,data:S,inputValue:x,onInputTextChange:G,debouncedInputText:j})}const SA=({filter:s,choicesData:t,selectedTab:a,setFilter:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l})=>{const{t:o}=M(),{isAllPrograms:d}=U(),c=ge(),u=je(),{handleFilterChange:h,applyFilterChanges:m,clearFilter:g}=Ss(i,c,u,s,n,r,l),x=()=>{m()},f=()=>{g()},j=Hs(t?.grievanceTicketIssueTypeChoices,"category","*"),y=A.useMemo(()=>s.grievanceType===Qr[sn.userGenerated]?t.grievanceTicketManualCategoryChoices:t.grievanceTicketSystemCategoryChoices,[t,s.grievanceType]),b=Zc(s.category),C=A.useMemo(()=>t.grievanceTicketPriorityChoices.map(D=>D.value===0?{...D,value:"Not Set"}:D),[t.grievanceTicketPriorityChoices]),v=A.useMemo(()=>t.grievanceTicketUrgencyChoices.map(D=>D.value===0?{...D,value:"Not Set"}:D).reverse(),[t.grievanceTicketUrgencyChoices]),S=j[s.category]?.subCategories||[],I=Object.entries(S).map(([E,D])=>({name:D,value:E}));return e.jsx(Ns,{clearHandler:f,applyHandler:x,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{value:s.search,label:"Search",onChange:E=>h("search",E.target.value),"data-cy":"filters-search",borderRadius:"4px 0px 0px 4px"})}),e.jsx(Ul,{onChange:h,type:s.documentType,number:s.documentNumber,choices:t?.documentTypeChoices}),d&&e.jsx(p,{size:{xs:3},children:e.jsx(Iu,{filter:s,name:"program",value:s.program,setFilter:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:E=>h("status",E.target.value),label:o("Status"),value:s.status,fullWidth:!0,"data-cy":"filters-status",children:t.grievanceTicketStatusChoices.map(E=>e.jsx(de,{value:E.value,children:E.name},E.value))})}),e.jsx(p,{size:{xs:2},children:e.jsx(Cs,{value:s.fsp,label:"FSP",icon:e.jsx(Yh,{style:{color:"#5f6368"}}),fullWidth:!0,onChange:E=>h("fsp",E.target.value),"data-cy":"filters-fsp"})}),e.jsx(p,{size:{xs:2},children:e.jsx(ms,{topLabel:o("Creation Date"),placeholder:"From",onChange:E=>h("createdAtBefore",E),value:s.createdAtBefore,fullWidth:!0,dataCy:"filters-creation-date-from"})}),e.jsx(p,{size:{xs:2},children:e.jsx(ms,{placeholder:"To",onChange:E=>h("createdAtAfter",E),value:s.createdAtAfter,fullWidth:!0,dataCy:"filters-creation-date-to"})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:E=>h("category",E.target.value),label:o("Category"),value:s.category,fullWidth:!0,"data-cy":"filters-category",children:y.map(E=>e.jsx(de,{value:E.value,children:E.name},E.value))})}),b&&e.jsx(p,{size:{xs:2},children:e.jsx(He,{onChange:E=>h("issueType",E.target.value),label:"Issue Type",value:s.issueType,fullWidth:!0,children:I.map(E=>e.jsx(de,{value:E.value,children:E.name},E.value))})}),e.jsx(p,{size:{xs:3},children:e.jsx(Bn,{filter:s,label:o("Assigned To"),name:"assignedTo",value:s.assignedTo,setFilter:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,dataCy:"filters-assignee"})}),a===sn.userGenerated&&e.jsx(p,{size:{xs:3},children:e.jsx(Yi,{filter:s,name:"createdBy",value:s.createdBy,setFilter:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,additionalVariables:{isTicketCreator:!0}})}),a===sn.systemGenerated&&e.jsxs(p,{container:!0,spacing:3,alignItems:"flex-end",children:[e.jsx(p,{size:{xs:6},children:e.jsx(js,{topLabel:o("Similarity Score"),value:s.scoreMin,placeholder:"From",onChange:E=>h("scoreMin",E.target.value),"data-cy":"filters-similarity-score-from",fullWidth:!0})}),e.jsx(p,{size:{xs:6},children:e.jsx(js,{value:s.scoreMax,placeholder:"To",onChange:E=>h("scoreMax",E.target.value),"data-cy":"filters-similarity-score-to",fullWidth:!0})})]}),!d&&e.jsx(p,{size:{xs:3},children:e.jsx(Gl,{filter:s,name:"registrationDataImport",value:s.registrationDataImport,initialFilter:i,appliedFilter:r,setAppliedFilter:l,setFilter:n})}),e.jsx(p,{size:{xs:3},children:e.jsx(vA,{filter:s,name:"preferredLanguage",value:s.preferredLanguage,initialFilter:i,appliedFilter:r,setAppliedFilter:l,setFilter:n,dataCy:"filters-preferred-language"})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:E=>h("priority",E.target.value),label:o("Priority"),value:s.priority,"data-cy":"filters-priority",fullWidth:!0,children:C?.map(E=>e.jsx(de,{value:E.value,children:E.name},E.value))})}),e.jsx(p,{size:{xs:2},children:e.jsx(He,{onChange:E=>h("urgency",E.target.value),label:o("Urgency"),value:s.urgency,"data-cy":"filters-urgency",fullWidth:!0,children:v?.map(E=>e.jsx(de,{value:E.value,children:E.name},E.value))})}),e.jsx(p,{size:{xs:2},children:e.jsxs(He,{onChange:E=>h("grievanceStatus",E.target.value),label:void 0,value:s.grievanceStatus,fullWidth:!0,disableClearable:!0,"data-cy":"filters-active-tickets",children:[e.jsx(de,{value:Xr.Active,children:o("Active Tickets")}),e.jsx(de,{value:Xr.All,children:o("All Tickets")})]})}),d&&e.jsx(p,{size:{xs:2},children:e.jsxs(He,{onChange:E=>h("programState",E.target.value),label:o("Programme State"),value:s.programState,fullWidth:!0,disableClearable:!0,"data-cy":"filters-program-state",children:[e.jsx(de,{value:"active",children:o("Active Programmes")}),e.jsx(de,{value:"all",children:o("All Programmes")})]})}),a===sn.systemGenerated&&e.jsx(p,{size:{xs:2},children:e.jsxs(He,{onChange:E=>h("areaScope",E.target.value),label:o("Ticket Type"),value:s.areaScope,fullWidth:!0,disableClearable:!0,"data-cy":"filters-area-scope",children:[e.jsx(de,{value:"cross-area",children:o("Cross-Area Tickets")}),e.jsx(de,{value:"all",children:o("All Tickets")})]})}),e.jsx(p,{size:{xs:3},children:e.jsx(ua,{level:1,filter:s,name:"admin1",value:s.admin1,disabled:s.admin2,setFilter:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,dataCy:"filters-admin-level-1"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ua,{level:2,filter:s,name:"admin2",value:s.admin2,disabled:s.admin1,setFilter:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,dataCy:"filters-admin-level-2"})})]})})},IA=[{disablePadding:!1,label:"Ticket ID",id:"unicef_id",numeric:!1,dataCy:"ticket-id"},{disablePadding:!1,label:"Status",id:"status",numeric:!1,dataCy:"status"},{disablePadding:!1,label:"Assigned to",id:"assigned_to__last_name",numeric:!1,dataCy:"assignedTo"},{disablePadding:!1,label:"Category",id:"category",numeric:!1,dataCy:"category"},{disablePadding:!1,label:"Issue Type",id:"issueType",numeric:!1,dataCy:"issueType"},{disablePadding:!1,label:"Household ID",id:"household_unicef_id",numeric:!1,dataCy:"householdId"},{disablePadding:!1,label:"Priority",id:"priority",numeric:!1,dataCy:"priority"},{disablePadding:!1,label:"Urgency",id:"urgency",numeric:!1,dataCy:"urgency"},{disablePadding:!1,label:"Linked Tickets",id:"linked_tickets",numeric:!1,dataCy:"linkedTickets"},{disablePadding:!1,label:"Creation Date",id:"created_at",numeric:!1,dataCy:"createdAt"},{disablePadding:!1,label:"Last Modified Date",id:"user_modified",numeric:!1,dataCy:"userModified"},{disablePadding:!1,label:"Total Days",id:"total_days",numeric:!1,dataCy:"totalDays"}],DA=[{disablePadding:!1,label:"Ticket ID",id:"unicef_id",numeric:!1,dataCy:"ticket-id"},{disablePadding:!1,label:"Status",id:"status",numeric:!1,dataCy:"status"},{disablePadding:!1,label:"Assigned to",id:"assigned_to__last_name",numeric:!1,dataCy:"assignedTo"},{disablePadding:!1,label:"Category",id:"category",numeric:!1,dataCy:"category"},{disablePadding:!1,label:"Issue Type",id:"issueType",numeric:!1,dataCy:"issueType"},{disablePadding:!1,label:"Target ID",id:"target_unicef_id",numeric:!1,dataCy:"targetId",disableSort:!0},{disablePadding:!1,label:"Priority",id:"priority",numeric:!1,dataCy:"priority"},{disablePadding:!1,label:"Urgency",id:"urgency",numeric:!1,dataCy:"urgency"},{disablePadding:!1,label:"Linked Tickets",id:"linked_tickets",numeric:!1,dataCy:"linkedTickets"},{disablePadding:!1,label:"Creation Date",id:"created_at",numeric:!1,dataCy:"createdAt"},{disablePadding:!1,label:"Last Modified Date",id:"user_modified",numeric:!1,dataCy:"userModified"},{disablePadding:!1,label:"Total Days",id:"total_days",numeric:!1,dataCy:"totalDays"}],zn=T.span`
  font-weight: bold;
`,TA=T.div`
  color: #000;
  text-decoration: underline;
  cursor: pointer;
  display: flex;
  align-content: center;
`,RA=T(gs)`
  min-width: 100px;
`,FA=T(Ks)`
  max-height: 800px;
`;function NA({ticket:s,categoryChoices:t,statusChoices:a,canViewDetails:n,baseUrl:i,issueTypeChoicesData:r}){const[l,o]=A.useState(!1),d=ge(),{t:c}=M(),u=x=>x.issueType?r.find(f=>f.category===x.category.toString())?.subCategories.find(f=>f.value===x.issueType.toString()).name:"-",h=x=>{const f=u(x),j=$t(x.id,x.category,i);return e.jsxs(rs,{hover:!0,onClick:n?()=>d(j):void 0,children:[e.jsx(_,{align:"left",children:n?e.jsx(me,{to:j,children:x.unicefId}):x.unicefId}),e.jsx(_,{align:"left",children:t[x.category]}),e.jsx(_,{align:"left",children:f||"-"}),e.jsx(_,{align:"left",children:e.jsx(we,{status:a[x.status],statusToColor:Vn})})]},x.id)},m=()=>{const x=s.relatedTickets.length;return x===0?e.jsx("span",{children:"-"}):e.jsxs(TA,{onClick:f=>{f.stopPropagation(),o(!0)},children:[x," linked ticket",x===1?"":"s"]})},g=()=>{const{relatedTickets:x}=s||{};return e.jsx(e.Fragment,{children:x.map(f=>h(f))})};return e.jsxs(e.Fragment,{children:[m(),e.jsxs(FA,{open:l,onClose:()=>o(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"lg",children:[e.jsx(Ye,{children:e.jsx(Le,{children:c("Related Tickets")})}),e.jsxs(Be,{children:[e.jsx(P,{mt:2,mb:6,children:e.jsxs(ee,{children:[e.jsxs(zn,{children:["Ticket ID",s.unicefId]})," ","is related to the following tickets."]})}),e.jsxs(RA,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left",children:c("Ticket Id")}),e.jsx(_,{align:"left",children:c("Category")}),e.jsx(_,{align:"left",children:c("Issue Type")}),e.jsx(_,{align:"left",children:c("Status")})]})}),e.jsx(cs,{children:g()})]})]}),e.jsx(ss,{children:e.jsx(os,{children:e.jsx(H,{onClick:x=>{x.stopPropagation(),o(!1)},children:c("CANCEL")})})})]})]})}const LA=oe(NA,"LinkedTicketsModal"),OA=T(ha)`
  width: ${s=>s.fullWidth?"100%":"180px"}
    .MuiFormControl-marginDense {
    margin-top: 4px;
  }
  .MuiInput-underline:hover:not(.Mui-disabled):before,
  .MuiInput-underline:before,
  .MuiInput-underline:after {
    border: 0px;
  }
  .MuiFormControl-root {
    width: 260px;
  }
`,Du=({fullWidth:s,onFilterChange:t,value:a,optionsData:n,setInputValue:i,ids:r,label:l,disableClearable:o})=>{const[d,c]=A.useState(!1),[u,h]=A.useState(""),m=qt(u,800),{isActiveProgram:g}=Z();A.useEffect(()=>{i(m)},[m,i]);const x=Array.isArray(n)?[...n].sort((C,v)=>{const S=C?.email?.toLowerCase(),I=v?.email?.toLowerCase();return S.localeCompare(I)}):[],f=C=>{C.stopPropagation(),c(!0)},j=(C,v)=>{C.preventDefault(),C.stopPropagation(),c(!1),v!=="select-option"&&h("")},y=(C,v)=>{C.preventDefault(),C.stopPropagation(),r?t?.(v,r):t?.(v)},b=C=>{C.preventDefault(),C.stopPropagation(),h(C.target.value)};return e.jsx(OA,{fullWidth:s,open:d,disableClearable:o,filterOptions:C=>C,onChange:y,onOpen:f,onClose:j,isOptionEqualToValue:(C,v)=>C.id===v.id,getOptionLabel:C=>C?`${C.email}`:`${a?.email||""}`,value:a,options:x,disabled:!g,renderInput:C=>e.jsx(ks,{...C,value:u,variant:l?"outlined":"standard",label:l,onClick:v=>v.stopPropagation(),onChange:b,InputProps:{...C.InputProps,endAdornment:e.jsx(e.Fragment,{children:C.InputProps.endAdornment})}})})};function kA({ticket:s,statusChoices:t,categoryChoices:a,canViewDetails:n,issueTypeChoicesData:i,priorityChoicesData:r,urgencyChoicesData:l,checkboxClickHandler:o,isSelected:d,optionsData:c,setInputValue:u}){const{baseUrl:h,businessArea:m,isAllPrograms:g,programId:x}=U(),{isSocialDctType:f}=Z(),j=ge(),{showMessage:y}=Ae(),b=$t(s.id,s.category,h),C=eu(s.issueType),v=Fe(),{mutateAsync:S}=xe({mutationFn:k=>N.restBusinessAreasGrievanceTicketsBulkUpdateAssigneeCreate({businessAreaSlug:m,formData:k}),onSuccess:()=>{v.invalidateQueries({queryKey:["businessAreasProgramsGrievanceTickets"]}),v.invalidateQueries({queryKey:["businessAreasProgramsGrievanceTickets",{program:x}]})},onError:k=>{fe(k,y)}}),I=async(k,$)=>{k&&await S({assignedTo:k.id,grievanceTicketIds:$})},E=()=>(n&&j(b),null),F=s.programs?.length?e.jsx("div",{children:s.programs.map(k=>e.jsx(me,{to:`/${m}/programs/${k.slug}/details/${k.slug}`,children:k.name},k.id))}):e.jsx("div",{children:"-"}),O=(k=>f||g?k?.targetId:k?.householdUnicefId)(s);return e.jsxs(rs,{onClick:E,hover:!0,role:"checkbox",children:[e.jsx(_,{align:"left",padding:"checkbox",children:e.jsx(ns,{color:"primary",onClick:k=>{k.stopPropagation(),o(s)},checked:d,disabled:s.status===ze.CLOSED,inputProps:{"aria-labelledby":s.unicefId}})}),e.jsx(_,{align:"left",children:n?e.jsx(me,{to:b,children:s.unicefId}):s.unicefId}),e.jsx(_,{align:"left",children:e.jsx(we,{status:t[s.status],statusToColor:Vn})}),e.jsx(_,{align:"left",children:s.status===ze.CLOSED?va(s.assignedTo):e.jsx(Du,{optionsData:c,onFilterChange:I,value:s.assignedTo,ids:[s.id],setInputValue:u,disableClearable:!0})}),e.jsx(_,{align:"left",children:a[s.category]}),e.jsx(_,{align:"left",children:C}),e.jsx(_,{align:"left",children:O||"-"}),e.jsx(_,{align:"left",children:e.jsx(we,{status:r[r.findIndex(k=>k.value===s.priority)]?.name||"-",statusToColor:ji})}),e.jsx(_,{align:"left",children:e.jsx(we,{status:l[l.findIndex(k=>k.value===s.urgency)]?.name||"-",statusToColor:ji})}),e.jsx(_,{align:"left",children:e.jsx(LA,{ticket:s,categoryChoices:a,statusChoices:t,issueTypeChoicesData:i,canViewDetails:n,baseUrl:h})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.createdAt})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.userModified})}),e.jsx(_,{align:"left",children:s.totalDays}),g&&e.jsx(_,{align:"left",children:F})]},s.id)}T.div`
  color: #000;
  text-decoration: underline;
  cursor: pointer;
  display: flex;
  align-content: center;
`;const nd=T(gs)`
  min-width: 400px;
  max-width: 800px;
`,wA=T(Ks)`
  max-height: 800px;
`;function Qi({selectedTickets:s,icon:t,buttonTitle:a,title:n,children:i,onSave:r,disabledSave:l}){const[o,d]=A.useState(!1),{t:c}=M(),{isActiveProgram:u}=Z(),h=()=>e.jsx(H,{variant:"outlined",color:"primary",startIcon:t,disabled:!s.length||!u,onClick:()=>d(!0),"data-cy":`button-${a}`,children:a}),m=async()=>{try{await r(s),d(!1)}catch{}};return e.jsxs(e.Fragment,{children:[h(),e.jsxs(wA,{open:o,onClose:()=>d(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{id:"scroll-dialog-title",children:n})}),e.jsxs(Be,{children:[e.jsx(P,{mt:2,mb:6,children:e.jsx(nd,{children:e.jsxs(ee,{children:[c("Tickets ID"),":"," ",e.jsx(zn,{"data-cy":"selected-tickets",children:s.map(g=>g.unicefId).join(", ")})]})})}),e.jsx(nd,{children:e.jsx(cs,{"data-cy":"dropdown",children:i})})]}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{"data-cy":"button-cancel",onClick:()=>{d(!1)},children:c("CANCEL")}),e.jsx(H,{"data-cy":"button-save",variant:"contained",color:"primary",onClick:m,disabled:l,children:c("SAVE")})]})})]})]})}T.div`
  color: #000;
  text-decoration: underline;
  cursor: pointer;
  display: flex;
  align-content: center;
`;function MA({selectedTickets:s,setSelected:t}){const{t:a}=M(),{showMessage:n}=Ae(),[i,r]=A.useState(""),{businessAreaSlug:l,isAllPrograms:o,programId:d}=U(),c=Fe(),{mutateAsync:u}=xe({mutationFn:m=>N.restBusinessAreasGrievanceTicketsBulkAddNoteCreate({businessAreaSlug:l,formData:m}),onSuccess:()=>{o?c.invalidateQueries({queryKey:["businessAreasGrievanceTickets"]}):c.invalidateQueries({queryKey:["businessAreasProgramsGrievanceTickets",{program:d}]}),t([])},onError:m=>{fe(m,n)}}),h=async()=>{await u({grievanceTicketIds:s.map(m=>m.id),note:i})};return e.jsx(Qi,{selectedTickets:s,title:a("Add Note"),buttonTitle:a("add note"),onSave:h,icon:e.jsx(xc,{}),disabledSave:!i,children:e.jsx(ks,{variant:"outlined",label:a("Note"),fullWidth:!0,value:i,onChange:m=>r(m.target.value)})})}T.div`
  color: #000;
  text-decoration: underline;
  cursor: pointer;
  display: flex;
  align-content: center;
`;function $A({selectedTickets:s,setSelected:t}){const{t:a}=M(),{showMessage:n}=Ae(),{businessAreaSlug:i,isAllPrograms:r,programId:l}=U(),[o,d]=A.useState(null),[c,u]=A.useState(""),h=Fe(),{mutateAsync:m}=xe({mutationFn:y=>N.restBusinessAreasGrievanceTicketsBulkUpdateAssigneeCreate({businessAreaSlug:i,formData:y}),onSuccess:()=>{r?h.invalidateQueries({queryKey:["businessAreasGrievanceTickets"]}):h.invalidateQueries({queryKey:["businessAreasProgramsGrievanceTickets",{program:l}]}),t([])},onError:y=>{fe(y,n)}}),{data:g}=V({queryKey:["users",i,c],queryFn:()=>N.restBusinessAreasUsersList({businessAreaSlug:i,limit:20,orderBy:["first_name","last_name","email"],search:c})}),x=g?.results||[],f=y=>{d(y)},j=async()=>{await m({assignedTo:o?.id||"",grievanceTicketIds:s.map(y=>y.id)})};return e.jsx(Qi,{selectedTickets:s,title:a("Assign"),buttonTitle:a("Assign"),onSave:j,icon:e.jsx(Qh,{}),children:e.jsx(Du,{optionsData:x,onFilterChange:f,setInputValue:u,label:a("Assignee"),fullWidth:!0})})}T.div`
  color: #000;
  text-decoration: underline;
  cursor: pointer;
  display: flex;
  align-content: center;
`;const UA=({selectedTickets:s,setSelected:t})=>{const{t:a}=M(),{showMessage:n}=Ae(),{businessAreaSlug:i,isAllPrograms:r,programId:l}=U(),[o,d]=A.useState(0),c=Fe(),{data:u}=V({queryKey:["businessAreasGrievanceTicketsChoices",i],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:i})}),{mutateAsync:h}=xe({mutationFn:x=>N.restBusinessAreasGrievanceTicketsBulkUpdatePriorityCreate({businessAreaSlug:i,formData:x}),onSuccess:()=>{r?c.invalidateQueries({queryKey:["businessAreasGrievanceTickets"]}):c.invalidateQueries({queryKey:["businessAreasProgramsGrievanceTickets",{program:l}]}),t([])},onError:x=>{fe(x,n)}}),m=u?.grievanceTicketPriorityChoices,g=async()=>{await h({grievanceTicketIds:s.map(x=>x.id),priority:o})};return e.jsx(Qi,{selectedTickets:s,title:a("Set priority"),buttonTitle:a("Set priority"),onSave:g,icon:e.jsx(Xh,{}),children:e.jsxs(tt,{variant:"outlined",style:{width:"100%"},children:[e.jsx(Rt,{children:a("Priority")}),e.jsx(at,{value:o,onChange:x=>d(x.target.value),label:a("Priority"),children:m?.map(x=>e.jsx(de,{value:x.value,children:x.name},x.value))})]})})};T.div`
  color: #000;
  text-decoration: underline;
  cursor: pointer;
  display: flex;
  align-content: center;
`;function VA({selectedTickets:s,setSelected:t}){const{t:a}=M(),{showMessage:n}=Ae(),{businessAreaSlug:i,isAllPrograms:r,programId:l}=U(),[o,d]=A.useState(0),c=Fe(),{mutateAsync:u}=xe({mutationFn:x=>N.restBusinessAreasGrievanceTicketsBulkUpdateUrgencyCreate({businessAreaSlug:i,formData:x}),onSuccess:()=>{r?c.invalidateQueries({queryKey:["businessAreasGrievanceTickets"]}):c.invalidateQueries({queryKey:["businessAreasProgramsGrievanceTickets",{program:l}]}),t([])},onError:x=>{fe(x,n)}}),{data:h}=V({queryKey:["businessAreasGrievanceTicketsChoices",i],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:i})}),m=h.grievanceTicketUrgencyChoices,g=async()=>{await u({urgency:o,grievanceTicketIds:s.map(x=>x.id)})};return e.jsx(Qi,{selectedTickets:s,title:a("Set Urgency"),buttonTitle:a("Set Urgency"),onSave:g,icon:e.jsx(Jh,{}),children:e.jsxs(tt,{variant:"outlined",style:{width:"100%"},children:[e.jsx(Rt,{id:"urgency-label",children:a("Urgency")}),e.jsx(at,{value:o,onChange:x=>d(x.target.value),label:a("Urgency"),children:m.map(x=>e.jsx(de,{value:x.value,children:x.name},x.value))})]})})}const BA=({filter:s})=>{const{businessArea:t,businessAreaSlug:a,programSlug:n,isAllPrograms:i}=U(),{isSocialDctType:r,selectedProgram:l}=Z(),o=l?.beneficiaryGroup,{programId:d}=U(),{t:c}=M(),h=$s(IA,o,{household_unicef_id:he=>`${he?.groupLabel} ID`}),m=A.useMemo(()=>({businessArea:t,search:s.search.trim(),documentType:s.documentType,documentNumber:s.documentNumber.trim(),status:[s.status],fsp:s.fsp,createdAtBefore:s.createdAtBefore,createdAtAfter:s.createdAtAfter,category:s.category,issueType:s.issueType,assignedTo:s.assignedTo,createdBy:s.createdBy,admin1:s.admin1,admin2:s.admin2,registrationDataImport:s.registrationDataImport,cashPlan:s.cashPlan,scoreMin:s.scoreMin,scoreMax:s.scoreMax,grievanceType:s.grievanceType,grievanceStatus:s.grievanceStatus,priority:s.priority==="Not Set"?0:s.priority,urgency:s.urgency==="Not Set"?0:s.urgency,preferredLanguage:s.preferredLanguage,programSlug:i?s.program:n,isActiveProgram:s.programState==="active"?!0:null,isCrossArea:s.areaScope==="cross-area"?!0:null}),[t,s.search,s.documentType,s.documentNumber,s.status,s.fsp,s.createdAtBefore,s.createdAtAfter,s.category,s.issueType,s.assignedTo,s.createdBy,s.admin1,s.admin2,s.registrationDataImport,s.cashPlan,s.scoreMin,s.scoreMax,s.grievanceType,s.grievanceStatus,s.priority,s.urgency,s.preferredLanguage,s.program,s.programState,s.areaScope,i,n]),[g,x]=A.useState(m);A.useEffect(()=>{x(m)},[m]);const[f,j]=A.useState(""),y=qt(f,800),[b,C]=A.useState(0),{data:v}=V({queryKey:["businessAreasUsersList",{businessAreaSlug:t,limit:20,ordering:"first_name,last_name,email",search:y||void 0}],queryFn:({queryKey:he})=>{const[,Re]=he;return N.restBusinessAreasUsersList(Re)}}),S=A.useMemo(()=>v?.results?v.results.map(he=>({id:he.id,firstName:he.firstName,lastName:he.lastName,email:he.email})):[],[v]),{data:I,isLoading:E,error:D}=V({queryKey:["businessAreasGrievanceTickets",g,t,s.grievanceType,d],queryFn:()=>N.restBusinessAreasGrievanceTicketsList(Ce({businessAreaSlug:t,program:d==="all"?void 0:d},g,{withPagination:!0})),enabled:i}),{data:F}=V({queryKey:["businessAreasGrievanceTicketsCount",t,g],queryFn:()=>N.restBusinessAreasGrievanceTicketsCountRetrieve(Ce({businessAreaSlug:t},g)),enabled:i&&b===0}),{data:w,isLoading:O,error:k}=V({queryKey:["businessAreasProgramsGrievanceTickets",g,d,t,s.grievanceType],queryFn:()=>N.restBusinessAreasProgramsGrievanceTicketsList(Ce({businessAreaSlug:t,programSlug:d},g,{withPagination:!0})),enabled:!i}),{data:$}=V({queryKey:["businessAreasProgramsGrievanceTicketsCount",t,d,g],queryFn:()=>N.restBusinessAreasProgramsGrievanceTicketsCountRetrieve(Ce({businessAreaSlug:t,programSlug:d},g)),enabled:!i&&b===0}),G=vs(b,F),W=vs(b,$),Y=i?G:W,X=S,[J,ae]=A.useState({0:[]}),re=[],se=J[b];for(const he of Object.keys(J))re.push(...J[he]);const le=he=>{const Re={...J};Re[b]=he,ae(Re)},{data:ce,isLoading:_e}=V({queryKey:["businessAreasGrievanceTicketsChoices",a],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:a})}),{data:ne,isLoading:Ue}=V({queryKey:["profile",a,n],queryFn:()=>N.restBusinessAreasUsersProfileRetrieve({businessAreaSlug:a,program:n==="all"?void 0:n}),staleTime:300*1e3,gcTime:1800*1e3,refetchOnWindowFocus:!1}),Te=ve();if(_e||Ue)return e.jsx(Ne,{});if(!ce||!ne||Te===null)return null;const ie=_s(ce.grievanceTicketStatusChoices),Pe=_s(ce.grievanceTicketCategoryChoices),ue=ce.grievanceTicketIssueTypeChoices,Ge=ce.grievanceTicketPriorityChoices,ls=ce.grievanceTicketUrgencyChoices,qe=ne.id,xs=he=>{const Re=qe===he.createdBy?.id,Me=qe===he.assignedTo?.id;return he.category.toString()===De.SENSITIVE_GRIEVANCE?Pt(R.GRIEVANCES_VIEW_DETAILS_SENSITIVE,Re,R.GRIEVANCES_VIEW_DETAILS_SENSITIVE_AS_CREATOR,Me,R.GRIEVANCES_VIEW_DETAILS_SENSITIVE_AS_OWNER,Te):Pt(R.GRIEVANCES_VIEW_DETAILS_EXCLUDING_SENSITIVE,Re,R.GRIEVANCES_VIEW_DETAILS_EXCLUDING_SENSITIVE_AS_CREATOR,Me,R.GRIEVANCES_VIEW_DETAILS_EXCLUDING_SENSITIVE_AS_OWNER,Te)},Oe=he=>{const Re=se?.findIndex(ps=>ps.id===he.id)??-1,Me=[...se||[]];Re===-1?Me.push(he):Re===0?Me.shift():Me.splice(Re,1),le(Me)},es=(he,Re)=>{if(!se?.length){const Me=Re.filter(ps=>ps.status!==ze.CLOSED).map(ps=>ps);le(Me);return}le([])},as=(()=>{const he=r||i?DA:h;return i?[...he,{disablePadding:!1,label:"Programmes",id:"programs",numeric:!1,dataCy:"programs"}]:he})();return e.jsx(Es,{children:e.jsxs(us,{children:[e.jsx(Ml,{title:c("Grievance Tickets List")}),e.jsxs(P,{display:"flex",flexDirection:"row",marginX:6,gap:4,component:"div",children:[e.jsx($A,{selectedTickets:re,setSelected:le}),e.jsx(UA,{selectedTickets:re,setSelected:le}),e.jsx(VA,{selectedTickets:re,setSelected:le}),e.jsx(MA,{selectedTickets:re,setSelected:le})]}),e.jsx(ds,{isOnPaper:!1,headCells:as,rowsPerPageOptions:[10,15,20,40],onSelectAllClick:es,numSelected:se?.length||0,data:i?I:w,error:i?D:k,isLoading:i?E:O,queryVariables:g,setQueryVariables:x,defaultOrderBy:"created_at",defaultOrderDirection:"desc",itemsCount:Y,renderRow:he=>e.jsx(kA,{ticket:he,statusChoices:ie,categoryChoices:Pe,issueTypeChoicesData:ue,priorityChoicesData:Ge,urgencyChoicesData:ls,canViewDetails:xs(he),checkboxClickHandler:Oe,isSelected:!!re.find(Re=>Re.id===he.id),optionsData:X,setInputValue:j},he.id),page:b,setPage:C})]})})},Vs=({children:s,onClick:t=()=>null,title:a="Permission denied",disabled:n,dataCy:i,dataPerm:r,...l})=>n?e.jsx(Ms,{title:a,children:e.jsx("span",{children:e.jsx(H,{disabled:n,onClick:t,"data-cy":i,"data-perm":r,...l,children:s})})}):e.jsx(H,{disabled:n,onClick:t,"data-cy":i,"data-perm":r,...l,children:s}),GA=()=>{const[s,t]=A.useState(!1),{businessArea:a,baseUrl:n}=U(),{isActiveProgram:i}=Z(),r=ve(),{id:l,cashPlanId:o}=ts(),d=je(),c=ge(),{data:u,isLoading:h}=V({queryKey:["businessAreasGrievanceTicketsChoices",a],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:a})}),m=d.pathname.indexOf("user-generated")!==-1,g={search:"",documentType:u?.documentTypeChoices?.[0]?.value,documentNumber:"",status:"",fsp:"",createdAtBefore:"",createdAtAfter:"",category:"",issueType:"",assignedTo:"",createdBy:"",admin1:"",admin2:"",registrationDataImport:l||"",cashPlan:o,scoreMin:"",scoreMax:"",grievanceType:m?"user":"system",grievanceStatus:Xr.Active,priority:"",urgency:"",preferredLanguage:"",program:"",programState:"all",areaScope:"all"},[x,f]=A.useState(m?sn.userGenerated:sn.systemGenerated),[j,y]=A.useState(Ke(d,g)),[b,C]=A.useState(Ke(d,g)),v=A.useRef(null);et(v,s,b,()=>t(!1));const S=["USER-GENERATED","SYSTEM-GENERATED"],I=`/${n}/grievance/tickets/user-generated`,E=`/${n}/grievance/tickets/system-generated`,D=S.map(O=>e.jsx(Tt,{"data-cy":`tab-${O}`,label:O},O)),F=e.jsx(La,{value:x,onChange:(O,k)=>{f(k),y({...j,grievanceType:Qr[k],category:"",program:""}),C({...b,grievanceType:Qr[k],category:"",program:""}),c(k===0?I:E)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto","aria-label":"tabs",children:D});return h?e.jsx(Ne,{}):r===null||r.length===0?e.jsx(Ne,{}):r.some(O=>O.includes("GRIEVANCES_VIEW_LIST")||O.includes("GRIEVANCES_VIEW_DETAILS"))?u?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{tabs:F,title:"Grievance Tickets",children:K(R.GRIEVANCES_CREATE,r)&&e.jsx(Vs,{variant:"contained",color:"primary",component:ys,title:Ee("Programme has to be active to create a new Grievance Ticket"),to:`/${n}/grievance/new-ticket`,dataCy:"button-new-ticket",dataPerm:`${R.GRIEVANCES_CREATE}, ${R.POPULATION_VIEW_HOUSEHOLDS_LIST} ${R.POPULATION_VIEW_INDIVIDUALS_LIST}, ${R.PROGRAMME_VIEW_LIST_AND_DETAILS}`,disabled:!i,children:Ee("NEW TICKET")})}),e.jsx(SA,{choicesData:u,filter:j,setFilter:y,initialFilter:g,appliedFilter:b,setAppliedFilter:O=>{C(O),t(!0)},selectedTab:x}),e.jsx("div",{ref:v,children:e.jsx(BA,{filter:b,selectedTab:x})})]}):null:e.jsx(Xe,{permission:[R.GRIEVANCES_VIEW_LIST,R.GRIEVANCES_VIEW_DETAILS]})},ai=oe(GA,"GrievancesTablePage");function id({selectedHousehold:s,admin2:t,setFieldValue:a}){return A.useEffect(()=>{s?.admin2&&t!==s.admin2&&a("admin2",s.admin2)},[s?.admin2,t,a]),null}function zA(){const{values:s,setFieldValue:t}=B.useFormikContext();return Js.useEffect(()=>{s.selectedHousehold?.program?.id&&s.programId!==s.selectedHousehold.program.id?t("programId",s.selectedHousehold.program.id):s.selectedIndividual?.program?.id&&s.programId!==s.selectedIndividual.program.id&&t("programId",s.selectedIndividual.program.id)},[s.selectedHousehold?.program?.id,s.selectedIndividual?.program?.id,s.programId,t]),null}const qA={POSITIVE_FEEDBACK:"POSITIVE_FEEDBACK"},rd=T.div`
  padding: 15px 0;
`,HA=T.div`
  .MuiStepper-root {
    padding: 0 !important;
  }
`,WA=T.div`
  .MuiPaper-root {
    padding: 32px 20px;
  }
`,KA=T.div`
  padding: 20px;
`,ld=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  padding: 15px 0;
`,od=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  border-top: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  padding: 15px 0;
`,YA=s=>{const t={category:Q.string().required("Category is required"),issueType:Q.string().required("Issue Type is required"),admin:Q.string().nullable(),description:Q.string().nullable(),consent:Q.bool().nullable(),area:Q.string().nullable(),language:Q.string().nullable(),programId:Q.string().nullable()};return s===tn.Description&&(t.description=Q.string().required("Description is required")),s>=tn.Verification&&(t.consent=Q.bool().oneOf([!0],"Consent is required")),Q.object().shape(t)};function QA(){const s=ge(),{t}=M(),{baseUrl:a,businessArea:n,isAllPrograms:i}=U(),r=ve(),{showMessage:l}=Ae(),{selectedProgram:o,isSocialDctType:d}=Z(),c=o?.beneficiaryGroup,u=["Category Selection",`${c?.groupLabel}/${c?.memberLabel} Look up`,"Identity Verification","Description"],[h,m]=A.useState(tn.Selection),g={category:"Feedback",issueType:null,selectedHousehold:null,selectedIndividual:null,description:"",comments:null,admin2:null,area:null,language:null,consent:!1,verificationRequired:!1,programId:i?null:o?.id},{data:x,isLoading:f}=V({queryKey:["choicesFeedbackIssueTypeList",n],queryFn:()=>N.restChoicesFeedbackIssueTypeList()}),{data:j,isLoading:y}=V({queryKey:["businessAreasProgramsList",{limit:100},n],queryFn:()=>N.restBusinessAreasProgramsList(Ce({businessAreaSlug:n,limit:100},{withPagination:!1}))}),{mutateAsync:b,isPending:C}=xe({mutationFn:({businessAreaSlug:F,requestBody:w})=>N.restBusinessAreasFeedbacksCreate({businessAreaSlug:F,requestBody:w})});if(f||y)return e.jsx(Ne,{});if(r===null)return null;if(!K(R.GRIEVANCES_FEEDBACK_VIEW_CREATE,r))return e.jsx(Xe,{permission:R.GRIEVANCES_FEEDBACK_VIEW_CREATE});if(!x||!j)return null;const v=[{title:t("Feedback"),to:`/${a}/grievance/feedback/`}],S=()=>{m(F=>F+1)},I=()=>{m(F=>F-1)},E=F=>({area:F.area,comments:F.comments,consent:F.consent,description:F.description,householdLookup:F.selectedHousehold?.id,individualLookup:F.selectedIndividual?.id,issueType:F.issueType,admin2:typeof F.admin2=="object"&&F.admin2!==null?F.admin2.id:F.admin2,language:F.language||"",programId:F.programId||null}),D=j?.results?.map(F=>({name:F.name,value:F.id}));return e.jsx(B.Formik,{initialValues:g,onSubmit:async F=>{if(h===u.length-1)try{const w=await b({businessAreaSlug:n,requestBody:E(F)});l(t("Feedback created")),s(`/${a}/grievance/feedback/${w.id}`)}catch(w){fe(w,l,"Error creating feedback")}else S()},validateOnChange:!0,validateOnBlur:!0,validationSchema:YA(h),children:({submitForm:F,values:w,setFieldValue:O,errors:k,touched:$})=>{w.selectedHousehold,w.admin2;const G=!w.selectedHousehold?.id&&!w.selectedIndividual?.id;return e.jsxs(e.Fragment,{children:[e.jsx(zA,{}),e.jsx(id,{selectedHousehold:w.selectedHousehold,admin2:w.admin2,setFieldValue:O}),e.jsx(Ze,{title:"New Feedback",breadCrumbs:K(R.GRIEVANCES_FEEDBACK_VIEW_LIST,r)?v:null}),e.jsx(At,{container:!0,spacing:3,children:e.jsx(At,{size:{xs:12},children:e.jsx(KA,{children:e.jsx(WA,{children:e.jsxs(Fs,{children:[e.jsx(HA,{children:e.jsx(Ta,{activeStep:h,children:u.map(W=>{const Y={},X={};return e.jsx(Ra,{...Y,children:e.jsx(qa,{...X,children:W})},W)})})}),h===tn.Selection&&e.jsxs(At,{container:!0,spacing:3,children:[e.jsx(At,{size:{xs:6},children:e.jsx(L,{label:t("Category"),children:t("Feedback")})}),e.jsx(At,{size:{xs:6},children:e.jsx(B.Field,{name:"issueType",label:"Issue Type",variant:"outlined",required:!0,choices:x,component:We,"data-cy":"input-issue-type"})})]}),h===tn.Lookup&&e.jsx(od,{children:e.jsx(Ot,{display:"flex",flexDirection:"column",children:e.jsx(Au,{values:w,onValueChange:O,errors:k,touched:$})})}),h===tn.Verification&&e.jsxs(od,{children:[w.selectedHousehold&&e.jsxs(e.Fragment,{children:[!d&&e.jsxs(Ot,{py:4,children:[e.jsx(ee,{variant:"subtitle2",children:t(`${c?.groupLabel} Questionnaire`)}),e.jsx(Ot,{py:4,children:e.jsx(ou,{values:w,programSlug:w.selectedHousehold?.programSlug||w.selectedHousehold?.program?.slug||w.selectedIndividual?.program?.slug||w.selectedIndividual?.programSlug})})]}),e.jsx(ee,{variant:"subtitle2",children:t(`${c?.memberLabel} Questionnaire`)}),e.jsx(Ot,{py:4,children:e.jsx(du,{values:w})}),e.jsx(ld,{})]}),e.jsx(lu,{}),e.jsx(B.Field,{name:"consent",label:t("Received Consent"),color:"primary",fullWidth:!0,required:!0,container:!1,component:ws,"data-cy":"input-consent"})]}),h===u.length-1&&e.jsxs(rd,{children:[e.jsx(vt,{children:e.jsx(Ot,{p:6,children:e.jsxs(At,{container:!0,spacing:6,children:[e.jsx(At,{size:{xs:6},children:e.jsx(L,{label:t("Category"),children:t("Feedback")})}),e.jsx(At,{size:{xs:6},children:e.jsx(L,{label:t("Issue Type"),children:w.issueType===qA.POSITIVE_FEEDBACK?"Positive Feedback":"Negative Feedback"})}),!d&&e.jsx(At,{size:{xs:6},children:e.jsx(L,{label:t(`${c?.groupLabel}`),children:w.selectedHousehold?.unicefId})}),e.jsx(At,{size:{xs:6},children:e.jsx(L,{label:t(`${c?.memberLabel}`),children:w.selectedIndividual?.unicefId})})]})})}),e.jsx(ld,{}),e.jsx(rd,{}),e.jsxs(At,{container:!0,spacing:3,children:[e.jsx(At,{size:{xs:12},children:e.jsx(B.Field,{name:"description",multiline:!0,fullWidth:!0,variant:"outlined",label:t("Description"),required:!0,component:Se,"data-cy":"input-description"})}),e.jsx(At,{size:{xs:12},children:e.jsx(B.Field,{name:"comments",multiline:!0,fullWidth:!0,variant:"outlined",label:t("Comments"),component:Se,"data-cy":"input-comments"})}),e.jsxs(At,{size:{xs:6},children:[e.jsx(B.Field,{name:"admin2",variant:"outlined",component:Hi,dataCy:"input-admin2"}),$.admin2&&typeof k.admin2=="string"&&e.jsx(Ls,{error:!0,children:k.admin2})]}),e.jsxs(At,{size:{xs:6},children:[e.jsx(B.Field,{name:"area",fullWidth:!0,variant:"outlined",label:t("Area / Village / Pay point"),component:Se,"data-cy":"input-area"}),$.area&&typeof k.area=="string"&&e.jsx(Ls,{error:!0,children:k.area})]}),e.jsxs(At,{size:{xs:6},children:[e.jsx(B.Field,{name:"language",multiline:!0,fullWidth:!0,variant:"outlined",label:t("Languages Spoken"),component:Se,"data-cy":"input-languages"}),$.language&&typeof k.language=="string"&&e.jsx(Ls,{error:!0,children:k.language})]}),e.jsxs(At,{size:{xs:3},children:[e.jsx(B.Field,{name:"programId",label:t("Programme Name"),fullWidth:!0,variant:"outlined",choices:D,component:We,disabled:!i||!G}),$.programId&&typeof k.programId=="string"&&e.jsx(Ls,{error:!0,children:k.programId})]})]})]}),k.verificationRequired?e.jsx(Ls,{error:!0,children:k.verificationRequired}):null,e.jsxs(Ot,{pt:3,display:"flex",flexDirection:"row",children:[e.jsx(Ot,{mr:3,children:e.jsx(H,{component:ys,to:`/${a}/grievance/feedback`,"data-cy":"button-cancel",children:t("Cancel")})}),e.jsxs(Ot,{display:"flex",ml:"auto",children:[e.jsx(H,{disabled:h===0,onClick:I,"data-cy":"button-back",children:t("Back")}),e.jsx(ke,{loading:C,color:"primary",variant:"contained",onClick:F,"data-cy":"button-submit",children:h===u.length-1?t("Save"):t("Next")})]})]})]})})})})})]})}})}const XA=oe(QA,"CreateFeedbackPage");function JA({feedback:s,canViewHouseholdDetails:t,canViewIndividualDetails:a}){const{t:n}=M(),{baseUrl:i,isAllPrograms:r}=U(),{selectedProgram:l,isSocialDctType:o}=Z(),d=l?.beneficiaryGroup;return e.jsx(p,{size:{xs:12},children:e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Details")})}),e.jsx(vt,{children:e.jsx(p,{container:!0,spacing:6,children:[{label:n("Category"),value:e.jsx("span",{children:n("Feedback")}),size:3},{label:n("Issue Type"),value:e.jsx("span",{children:s.issueType==="POSITIVE_FEEDBACK"?"Positive Feedback":"Negative Feedback"}),size:3},{label:`${d?.groupLabel} ID`,value:e.jsx("span",{children:s.householdId&&t&&!r?e.jsx(me,{to:`/${i}/population/household/${s.householdId}`,children:s.householdUnicefId}):e.jsx("div",{children:s.householdId?s.householdUnicefId:"-"})}),size:3},{label:r||o?n("Target ID"):`${d?.memberLabel} ID`,value:e.jsx("span",{children:s.individualId&&a&&!r?e.jsx(me,{to:`/${i}/population/individuals/${s.individualId}`,children:s.individualUnicefId}):e.jsx("div",{children:s.individualId?s.individualUnicefId:"-"})}),size:3},{label:n("Programme"),value:e.jsx("span",{children:s.programId?e.jsx(me,{to:`/${i}/details/${s.programId}`,children:s.programName}):"-"}),size:3},{label:n("Created By"),value:s.createdBy,size:3},{label:n("Date Created"),value:e.jsx(pe,{children:s.createdAt}),size:3},{label:n("Last Modified Date"),value:e.jsx(pe,{children:s.updatedAt}),size:3},{label:n("Administrative Level 2"),value:s.admin2?.name,size:3},{label:n("Area / Village / Pay point"),value:s.area,size:3},{label:n("Languages Spoken"),value:s.language,size:3},{label:n("Description"),value:s.description,size:12},{label:n("Comments"),value:s.comments,size:12}].filter(c=>o?c.label!==`${d?.groupLabel} ID`:c).map(c=>e.jsx(p,{size:{xs:c.size},children:e.jsx(L,{label:c.label,children:c.value})},c.label))})})]})})}const ZA=oe(JA,"FeedbackDetails");function e_({feedback:s,canEdit:t}){const{t:a}=M(),{id:n}=ts(),{baseUrl:i}=U(),r=ge(),{isActiveProgram:l}=Z(),o=[{title:a("Feedback"),to:`/${i}/grievance/feedback`}],d=!!s.linkedGrievanceId,c=!!(s.householdId&&!s.individualId);return e.jsx(Ze,{title:`Feedback ID: ${s.unicefId}`,breadCrumbs:o,flags:e.jsx(gt,{adminUrl:s.adminUrl}),children:e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(P,{mr:3,children:e.jsx(Vs,{color:"primary",variant:"outlined",component:ys,to:`/${i}/grievance/feedback/edit-ticket/${n}`,startIcon:e.jsx(Ha,{}),"data-cy":"button-edit",title:a("Programme has to be active to edit a Feedback"),disabled:!l,dataPerm:R.GRIEVANCES_FEEDBACK_VIEW_CREATE,children:a("Edit")})}),!d&&e.jsx(P,{mr:3,children:e.jsx(Vs,{onClick:()=>r(`/${i}/grievance/new-ticket`,{state:{selectedHousehold:s?.householdId,selectedIndividual:s?.individualId,linkedFeedbackId:n,isFeedbackWithHouseholdOnly:c,feedbackProgramId:s?.programId}}),variant:"contained",color:"primary","data-cy":"button-create-linked-ticket",title:a("Programme has to be active to create a Linked Ticket to Feedback"),disabled:!l,dataPerm:R.GRIEVANCES_CREATE,children:a("Create Linked Ticket")})})]})})}const s_=oe(e_,"FeedbackDetailsToolbar");function t_({feedback:s}){const{t}=M(),{baseUrl:a}=U(),n=$t(s.linkedGrievanceId,Number(s.linkedGrievanceCategory),a);return e.jsx(p,{size:{xs:4},children:s.linkedGrievanceId?e.jsx(P,{p:3,children:e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:t("Linked Grievance")})}),e.jsx(vt,{children:e.jsx(L,{label:t("Ticket Id"),children:e.jsx(me,{to:n,children:s.linkedGrievanceUnicefId})})})]})}):null})}const a_=oe(t_,"LinkedGrievance"),mn=(s,t,a)=>{const{businessAreaSlug:n,programSlug:i}=U();return V({queryKey:[t.name,{id:s,programSlug:i,businessAreaSlug:n}],queryFn:()=>t({id:s,businessAreaSlug:n,programSlug:i}),enabled:!!n&&!!i,...a})};function n_(){const{id:s}=ts(),t=ve(),{data:a,isLoading:n,error:i}=mn(s,N.restBusinessAreasFeedbacksRetrieve,{});if(n)return e.jsx(Ne,{});if(rt(i))return e.jsx(Xe,{permission:R.GRIEVANCES_FEEDBACK_VIEW_DETAILS});if(!a||t===null)return null;const r=K(R.GRIEVANCES_FEEDBACK_VIEW_UPDATE,t),l=K(R.POPULATION_VIEW_HOUSEHOLDS_DETAILS,t),o=K(R.POPULATION_VIEW_INDIVIDUALS_DETAILS,t);return e.jsxs(e.Fragment,{children:[e.jsx(s_,{canEdit:r,feedback:a}),e.jsxs(p,{container:!0,children:[e.jsx(ZA,{feedback:a,canViewHouseholdDetails:l,canViewIndividualDetails:o}),e.jsx(a_,{feedback:a})]}),K(R.ACTIVITY_LOG_VIEW,t)&&e.jsx(P,{sx:{mt:2},children:e.jsx(Lt,{objectId:a.id})})]})}const i_=oe(n_,"FeedbackDetailsPage"),r_=({setFilter:s,initialFilter:t,appliedFilter:a,setAppliedFilter:n,filter:i})=>{const{t:r}=M(),l=ge(),o=je(),{businessArea:d}=U(),{isAllPrograms:c}=U(),{data:u,isLoading:h}=V({queryKey:["businessAreasGrievanceTicketsChoices",d],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:d})}),{handleFilterChange:m,applyFilterChanges:g,clearFilter:x}=Ss(t,l,o,i,s,a,n),f=()=>{g()},j=()=>{x()};return h?e.jsx(Ne,{}):e.jsx(Ns,{clearHandler:j,applyHandler:f,children:e.jsxs(p,{container:!0,spacing:3,sx:{alignItems:"flex-end"},children:[e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{value:i.feedbackId,label:"Search",onChange:y=>m("feedbackId",y.target.value),"data-cy":"filters-search"})}),c&&e.jsx(p,{size:{xs:3},children:e.jsx(Iu,{filter:i,name:"program",value:i.program,setFilter:s,initialFilter:t,appliedFilter:a,setAppliedFilter:n})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:y=>m("issueType",y.target.value),label:r("Issue Type"),value:i.issueType,"data-cy":"filters-issue-type",children:u?.feedbackIssueTypeChoices?.map(y=>e.jsx(de,{value:y.value,children:y.name},y.name))})}),e.jsx(p,{size:{xs:3},children:e.jsx(Yi,{name:"createdBy",filter:i,value:i.createdBy,label:r("Created by"),setFilter:s,initialFilter:t,appliedFilter:a,setAppliedFilter:n,additionalVariables:{isFeedbackCreator:!0}})}),!c&&e.jsx(p,{size:{xs:3}}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{topLabel:r("Creation Date"),label:"From",onChange:y=>m("createdAtBefore",y),value:i.createdAtBefore,dataCy:"filters-creation-date-from"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{label:r("To"),onChange:y=>m("createdAtAfter",y),value:i.createdAtAfter,dataCy:"filters-creation-date-to"})}),c&&e.jsx(p,{size:{xs:3},children:e.jsxs(He,{onChange:y=>m("programState",y.target.value),label:r("Programme State"),value:i.programState,fullWidth:!0,disableClearable:!0,"data-cy":"filters-program-state",children:[e.jsx(de,{value:"active",children:r("Active Programmes")}),e.jsx(de,{value:"all",children:r("All Programmes")})]})})]})})},l_=oe(r_,"FeedbackFilters"),o_=[{disablePadding:!1,label:"Feedback ID",id:"unicef_id",numeric:!1},{disablePadding:!1,label:"Issue Type",id:"issue_type",numeric:!1},{disablePadding:!1,label:"Household ID",id:"household_lookup",numeric:!1},{disablePadding:!1,label:"Linked Grievance",id:"linked_grievance",numeric:!1},{disablePadding:!1,label:"Created by",id:"created_by",numeric:!1},{disablePadding:!1,label:"Creation Date",id:"created_at",numeric:!1}];function d_({feedback:s,canViewDetails:t}){const a=ge(),{baseUrl:n,isAllPrograms:i}=U(),r=`/${n}/grievance/feedback/${s.id}`,l=s.householdId?`/${n}/population/household/${s.householdId}`:null,o=s.linkedGrievanceId?$t(s.linkedGrievanceId,1,n):null,d=()=>{a(r)};return e.jsxs(rs,{hover:!0,onClick:t?d:void 0,role:"checkbox",children:[e.jsx(_,{align:"left",children:t?e.jsx(me,{to:r,children:s.unicefId}):s.unicefId}),e.jsx(_,{align:"left",children:s.issueType==="POSITIVE_FEEDBACK"?"Positive Feedback":"Negative Feedback"}),e.jsx(_,{align:"left",children:s.householdId&&!i?e.jsx(me,{to:l,children:s.householdUnicefId}):Aa(s.householdUnicefId)}),e.jsx(_,{align:"left",children:s.linkedGrievanceId?e.jsx(me,{to:o,children:s.linkedGrievanceUnicefId}):Aa(s.linkedGrievanceUnicefId)}),e.jsx(_,{align:"left",children:s.createdBy}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.createdAt})}),i&&e.jsx(_,{align:"left",children:s.programId?e.jsx(me,{to:`/${n}/details/${s.programId}`,children:s.programName},s.programId):"-"})]},s.unicefId)}function c_({filter:s,canViewDetails:t}){const{t:a}=M(),{selectedProgram:n}=Z(),i=n?.beneficiaryGroup,{isAllPrograms:r,programId:l,businessArea:o}=U(),d=A.useMemo(()=>({feedbackId:s.feedbackId,issueType:s.issueType||null,createdBy:Ea(s.createdBy)||null,createdAtBefore:Yt(s.createdAtBefore,"startOfDay"),createdAtAfter:Yt(s.createdAtAfter,"endOfDay"),program:r?s.program:null,isActiveProgram:s.programState==="active"?!0:null,businessAreaSlug:o,programSlug:r?null:l}),[s.feedbackId,s.issueType,s.createdBy,s.createdAtBefore,s.createdAtAfter,s.program,s.programState,o,l,r]),[c,u]=A.useState(d);A.useMemo(()=>{u(d)},[d]);const[h,m]=A.useState(0),{data:g,error:x,isLoading:f}=V({queryKey:["businessAreasProgramsFeedbacksList",c,l,o],queryFn:()=>N.restBusinessAreasProgramsFeedbacksList(Ce({businessAreaSlug:o,programSlug:l},c,{withPagination:!0})),enabled:!r}),{data:j}=V({queryKey:["businessAreasProgramsFeedbacksCountRetrieve",o,l,c],queryFn:()=>N.restBusinessAreasProgramsFeedbacksCountRetrieve(Ce({businessAreaSlug:o,programSlug:l},c)),enabled:!r&&h===0}),{data:y,error:b,isLoading:C}=V({queryKey:["businessAreasFeedbacksList",c,o],queryFn:()=>N.restBusinessAreasFeedbacksList(Ce({businessAreaSlug:o},c,{withPagination:!0})),enabled:r}),{data:v}=V({queryKey:["businessAreasFeedbacksCountRetrieve",o,c],queryFn:()=>N.restBusinessAreasFeedbacksCountRetrieve(Ce({businessAreaSlug:o},c)),enabled:r&&h===0}),I=$s(o_,i,{household_lookup:F=>`${F?.groupLabel} ID`}),E=[...I,{disablePadding:!1,label:"Programme",id:"programs",numeric:!1,dataCy:"programs"}],D=vs(h,r?v:j);return e.jsx(Es,{children:e.jsx(ds,{headCells:r?E:I,title:a("Feedbacks List"),rowsPerPageOptions:[10,15,20],defaultOrderBy:"createdAt",defaultOrderDirection:"desc",queryVariables:c,setQueryVariables:u,data:r?y:g,error:r?b:x,isLoading:r?C:f,itemsCount:D,page:h,setPage:m,renderRow:F=>e.jsx(d_,{feedback:F,canViewDetails:t},F.id)})})}const u_=oe(c_,"FeedbackTable");function h_(){const{baseUrl:s,isAllPrograms:t}=U(),a=ve(),{t:n}=M(),i=je(),{isActiveProgram:r}=Z(),l={feedbackId:"",issueType:"",createdBy:"",createdAtBefore:"",createdAtAfter:"",program:"",programState:t?"all":""},[o,d]=A.useState(Ke(i,l)),[c,u]=A.useState(Ke(i,l)),[h,m]=A.useState(!1),g=A.useRef(null);if(et(g,h,c,()=>m(!1)),a===null)return null;if(!K(R.GRIEVANCES_FEEDBACK_VIEW_LIST,a))return e.jsx(Xe,{permission:R.GRIEVANCES_FEEDBACK_VIEW_LIST});const x=K(R.GRIEVANCES_FEEDBACK_VIEW_DETAILS,a);return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:n("Feedback"),children:e.jsx(Vs,{variant:"contained",color:"primary",component:ys,to:`/${s}/grievance/feedback/create`,dataCy:"button-submit-new-feedback",dataPerm:`${R.GRIEVANCES_CREATE}, ${R.POPULATION_VIEW_HOUSEHOLDS_LIST} ${R.POPULATION_VIEW_INDIVIDUALS_LIST}, ${R.PROGRAMME_VIEW_LIST_AND_DETAILS}`,title:n("Programme has to be active to create a new Feedback"),disabled:!r,children:n("Submit New Feedback")})}),e.jsx(l_,{filter:o,setFilter:d,initialFilter:l,appliedFilter:c,setAppliedFilter:f=>{u(f),m(!0)}}),e.jsx("div",{ref:g,children:e.jsx(u_,{filter:c,canViewDetails:x})})]})}const m_=oe(h_,"FeedbackPage"),p_=T.div`
  color: #6f6f6f;
  font-weight: 500;
  font-size: 12px;
  letter-spacing: 1.75px;
  padding-bottom: 5px;
`,g_=T.div`
  color: rgba(0, 0, 0, 0.87);
  font-weight: 600;
  font-size: 20px;
`,x_=T(us)`
  border-left: 4px solid ${({color:s})=>s};
  padding: 20px 24px;
`;function f_({color:s,children:t}){return e.jsx(x_,{color:s,children:t})}function _r({topLabel:s,topNumber:t,systemGenerated:a,userGenerated:n,dataCy:i}){const{t:r}=M();return e.jsxs(f_,{color:"#FFF",children:[e.jsx(p_,{children:s}),e.jsx(p,{container:!0,alignItems:"center",children:e.jsx(p,{children:e.jsx(g_,{"data-cy":`${i}-top-number`,children:t})})}),e.jsxs(p,{container:!0,alignItems:"center",children:[e.jsx(p,{size:6,children:e.jsx(L,{dataCy:`${i}-system-generated`,label:r("SYSTEM-GENERATED"),children:a})}),e.jsx(p,{size:6,children:e.jsx(L,{dataCy:`${i}-user-generated`,label:r("USER-GENERATED"),children:n})})]})]})}const y_=({data:s})=>{if(!s)return null;const t={labels:s.labels,datasets:[{categoryPercentage:.5,maxBarThickness:20,backgroundColor:"#00867B",data:[...s.datasets[0]?.data||[]],stack:2}]},a={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},tooltips:{mode:"point"},scales:{x:{position:"top",ticks:{beginAtZero:!0,stepSize:1,callback:Uc,suggestedMax:Math.max(...s.datasets[0].data)+1}},y:{position:"left",grid:{display:!1}}},indexAxis:"y"};return e.jsx("div",{style:{height:"400px",width:"100%"},children:e.jsx(fc,{data:t,options:a})})},b_=T(({...s})=>e.jsx(us,{...s}))`
  padding: 18px 24px;
  padding-left: ${s=>s.extraPaddingLeft?"46px":"24px"}
  margin-top: ${s=>s.noMarginTop?"0":"20px"};
  font-size: 18px;
  font-weight: normal;
  && > p {
    color: ${s=>s.color||"inherit"}
  }
`;function zl({title:s,children:t,noMarginTop:a,extraPaddingLeft:n,extraPaddingTitle:i=!0,color:r}){return e.jsxs(b_,{noMarginTop:a,extraPaddingLeft:n,color:r,children:[s&&e.jsx(P,{mb:i?6:2,children:s}),t]})}function j_({data:s}){const{t}=M();return e.jsx(zl,{noMarginTop:!0,title:t("Tickets by Category"),children:e.jsx(y_,{data:s})})}const A_=({data:s})=>{const[a,n]=A.useState(!1),{t:i}=M();if(!s)return null;const r=c=>a?c:c.slice(0,5),l=s.datasets.map(c=>{const u=yf.find(h=>h.category.toLowerCase()===c.label.toLowerCase())?.color;return{...c,categoryPercentage:.5,backgroundColor:u||"#000",data:r(c.data).map(h=>h||""),stack:2,maxBarThickness:15}}),o={labels:r(s.labels),datasets:l},d={indexAxis:"y",legend:{labels:{padding:40}},scales:{x:{display:!0,position:"top",beginAtZero:!0,ticks:{callback:Uc}},y:{position:"left",grid:{display:!1}}}};return e.jsxs(P,{flexDirection:"column",children:[e.jsx("div",{style:{height:"400px"},children:e.jsx(fc,{data:o,options:d,plugins:[Zh]})}),s.labels.length>5?e.jsx(P,{textAlign:"center",mt:4,ml:2,mr:2,letterSpacing:1.75,children:e.jsx(H,{variant:"outlined",color:"primary",onClick:()=>n(!a),fullWidth:!0,children:i(a?"HIDE":"SHOW MORE LOCATIONS")})}):null]})};function __({data:s}){const{t}=M();return e.jsx(zl,{noMarginTop:!0,title:t("Tickets by Category and Location"),children:e.jsx(A_,{data:s})})}const P_=({data:s})=>{if(!s)return null;const t={labels:s.labels,datasets:[{backgroundColor:["#F5801A","#023E90","#13CB17","#FF0200","#6D4C41","#4F616B"],data:[...s.datasets[0]?.data||[]]}]},a={cutoutPercentage:80,responsive:!0,maintainAspectRatio:!1,legend:{position:"bottom",align:"center",labels:{usePointStyle:!0}}};return e.jsx(P,{mt:6,height:"300px",children:e.jsx(ul,{data:t,options:a})})};function C_({data:s}){const{t}=M();return e.jsx(zl,{noMarginTop:!0,title:t("Tickets by Status"),children:e.jsx(P_,{data:s})})}function E_(){const{t:s}=M(),{businessAreaSlug:t,programSlug:a,isAllPrograms:n}=U(),i=ve(),{data:r,isLoading:l}=V({queryKey:["grievanceDashboard",t,a,n],queryFn:()=>n?N.restBusinessAreasGrievanceTicketsDashboardRetrieve({businessAreaSlug:t}):N.restBusinessAreasProgramsGrievanceTicketsDashboardRetrieve({businessAreaSlug:t,programSlug:a}),refetchOnMount:"always"});if(!r||i===null)return null;if(l)return e.jsx(Ne,{});if(!i.some(v=>v.includes("GRIEVANCES_VIEW_LIST")||v.includes("GRIEVANCES_VIEW_DETAILS")))return e.jsx(Xe,{permission:[R.GRIEVANCES_VIEW_LIST,R.GRIEVANCES_VIEW_DETAILS]});const{ticketsByCategory:d,ticketsByLocationAndCategory:c,ticketsByStatus:u,ticketsByType:{userGeneratedCount:h,systemGeneratedCount:m,closedUserGeneratedCount:g,closedSystemGeneratedCount:x,userGeneratedAvgResolution:f,systemGeneratedAvgResolution:j}}=r,y=f*g,b=j*x,C=g+x;return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:s("Grievance Dashboard")}),e.jsx(Es,{children:e.jsxs(p,{container:!0,spacing:2,children:[e.jsxs(p,{size:{xs:4},children:[e.jsx(P,{children:e.jsx(_r,{topLabel:s("TOTAL NUMBER OF TICKETS"),topNumber:Qe(m+h),systemGenerated:Qe(m),userGenerated:Qe(h),dataCy:"total-number-of-tickets"})}),e.jsx(P,{sx:{mt:5},children:e.jsx(_r,{topLabel:s("TOTAL NUMBER OF CLOSED TICKETS"),topNumber:Qe(C),systemGenerated:Qe(x),userGenerated:Qe(g),dataCy:"total-number-of-closed-tickets"})}),e.jsx(P,{sx:{mt:5},children:e.jsx(_r,{topLabel:s("TICKETS AVERAGE RESOLUTION"),topNumber:`${C>0?((y+b)/C).toFixed(2):0} days`,systemGenerated:`${j} days`,userGenerated:`${f} days`,dataCy:"tickets-average-resolution"})}),e.jsx(P,{sx:{mt:5},children:e.jsx(C_,{data:u})})]}),e.jsxs(p,{size:{xs:8},children:[e.jsx(P,{sx:{ml:3},children:e.jsx(j_,{data:d})}),e.jsx(P,{sx:{ml:3,mt:5},children:e.jsx(__,{data:c})})]})]})})]})}const v_=oe(E_,"GrievancesDashboardPage"),Tu=()=>oa([{path:"grievance/new-ticket",element:e.jsx(ib,{})},{path:"grievance/edit-ticket/user-generated/:id",element:e.jsx(Wo,{})},{path:"grievance/edit-ticket/system-generated/:id",element:e.jsx(Wo,{})},{path:"grievance/tickets/user-generated/:id",element:e.jsx(ad,{})},{path:"grievance/tickets/system-generated/:id",element:e.jsx(ad,{})},{path:"grievance/rdi/:id",element:e.jsx(ai,{})},{path:"grievance/payment-verification/:cashPlanId",element:e.jsx(ai,{})},{path:"grievance/tickets/user-generated",element:e.jsx(ai,{})},{path:"grievance/tickets/system-generated",element:e.jsx(ai,{})},{path:"grievance/dashboard",element:e.jsx(v_,{})},{path:"grievance/feedback/create",element:e.jsx(XA,{})},{path:"grievance/feedback/edit-ticket/:id",element:e.jsx(tf,{})},{path:"grievance/feedback/:id",element:e.jsx(i_,{})},{path:"grievance/feedback",element:e.jsx(m_,{})}]),it=T.div`
  color: #9e9e9e;
`,S_=T(P)`
  display: flex;
  flex-direction: column;
  background-color: #fff;
  border-bottom: 1px solid rgba(224, 224, 224, 1);
  width: 100%;
`,I_=T(P)`
  display: flex;
  flex-direction: column;
  width: 100%;
`,st=({children:s=e.jsx(e.Fragment,{}),buttons:t,title:a="",description:n,p:i=3,containerPadding:r,noPaper:l=!1,tabs:o=null,stepper:d=null})=>{const{t:c}=M(),u=l?I_:S_,h={py:3,px:4};let m;return r!==void 0?typeof r=="object"?m=r:m={p:r}:m=h,e.jsx(u,{sx:m,children:e.jsxs(P,{p:i,children:[d&&e.jsx(P,{mb:2,children:d}),e.jsxs(P,{p:i,display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(P,{children:typeof a=="string"?e.jsx(ee,{"data-cy":"title",variant:"h6",children:c(a)}):a}),t]}),o&&e.jsx(P,{mb:2,children:o}),n&&e.jsx(P,{pl:i,mb:2,children:e.jsx(it,{"data-cy":"description",children:n})}),e.jsx(P,{children:s})]})})},D_=({values:s,programHasRdi:t})=>{const{t:a}=M(),n=je(),{businessArea:i}=U(),{data:r}=V({queryKey:["programChoices",i],queryFn:()=>N.restBusinessAreasProgramsChoicesRetrieve({businessAreaSlug:i}),staleTime:1e3*60*10,gcTime:1e3*60*30}),{data:l}=V({queryKey:["beneficiaryGroups"],queryFn:()=>N.restBeneficiaryGroupsList({})}),{setFieldValue:o}=B.useFormikContext(),d=n.pathname.includes("duplicate"),c=A.useMemo(()=>{const h=r?.dataCollectingTypeChoices.filter(g=>g.name!=="");if(!d||!s.beneficiaryGroup||!l?.results)return h;const m=l.results.find(g=>String(g.id)===String(s.beneficiaryGroup));return m?h?.filter(g=>m.masterDetail===!0?g.type==="STANDARD":m.masterDetail===!1?g.type==="SOCIAL":!0):h},[r?.dataCollectingTypeChoices,d,s.beneficiaryGroup,l]),u=A.useMemo(()=>{function h(x){if(!c)return;const f=c.find(j=>j.value===x);return f?f.type:void 0}if(!l?.results)return[];if(d)return l.results.map(x=>({name:x.name,value:x.id}));const m=h(s.dataCollectingTypeCode);let g=[];return m==="SOCIAL"?g=l.results.filter(x=>x.masterDetail===!1):m==="STANDARD"?g=l.results.filter(x=>x.masterDetail===!0):g=l.results,g.map(x=>({name:x.name,value:x.id}))},[s.dataCollectingTypeCode,l,c,d]);return!r||!l?null:e.jsx(B.Form,{children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"name",label:a("Programme Name"),type:"text",fullWidth:!0,required:!0,variant:"outlined",component:Se,"data-cy":"input-programme-name"})}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"programmeCode",label:a("Programme Code"),type:"text",fullWidth:!0,variant:"outlined",component:Se,maxLength:4,required:!0,"data-cy":"input-programme-code"})}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"startDate",label:a("Start Date"),component:jt,required:!0,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"}),"data-cy":"input-start-date"})}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"endDate",label:a("End Date"),component:jt,disabled:!s.startDate,initialFocusedDate:s.startDate,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"}),minDate:s.startDate,"data-cy":"input-end-date"})}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"sector",label:a("Sector"),fullWidth:!0,required:!0,variant:"outlined",choices:r.sectorChoices,component:We,"data-cy":"input-sector"})}),e.jsx(p,{size:6,children:e.jsx(Ms,{title:s.isActive?"Cannot update Data Collecting Type when program is Active":t?"Field disabled because Programme has RDI":d?"Field disabled on Copy Programme page":"",placement:"top",children:e.jsx("span",{children:e.jsx(B.Field,{name:"dataCollectingTypeCode",label:a("Data Collecting Type"),fullWidth:!0,variant:"outlined",required:!0,disabled:t||d||s.isActive,onChange:h=>{d||o("beneficiaryGroup",""),o("dataCollectingTypeCode",h.target.value)},choices:c||[],component:We,"data-cy":"input-data-collecting-type"})})})}),e.jsx(p,{size:6,children:e.jsx(Ms,{title:d?"Beneficiary Group is fixed when copying programs":s.dataCollectingTypeCode?t?"Field disabled because program has RDI":"":"Select Data Collecting Type first",placement:"top",children:e.jsx("span",{children:e.jsx(B.Field,{name:"beneficiaryGroup",label:a("Beneficiary Group"),fullWidth:!0,variant:"outlined",required:!!s.dataCollectingTypeCode&&!t&&!d,choices:u,component:We,"data-cy":"input-beneficiary-group",disabled:d&&!!s.beneficiaryGroup||!s.dataCollectingTypeCode&&!d||t})})})}),e.jsx(p,{size:12,children:e.jsx(B.Field,{name:"description",label:a("Description"),type:"text",fullWidth:!0,multiline:!0,variant:"outlined",component:Se,"data-cy":"input-description"})}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"budget",label:a("Budget (USD)"),type:"number",fullWidth:!0,precision:2,variant:"outlined",component:Se,"data-cy":"input-budget"})}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"administrativeAreasOfImplementation",label:a("Administrative Areas of Implementation"),type:"text",fullWidth:!0,variant:"outlined",component:Se,"data-cy":"input-admin-area"})}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"populationGoal",label:a("Population Goal (# of Individuals)"),type:"number",fullWidth:!0,variant:"outlined",component:Se,"data-cy":"input-population-goal"})}),e.jsx(p,{size:6}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"cashPlus",label:a("Cash+"),color:"primary",component:ws,"data-cy":"input-cash-plus"})}),e.jsx(p,{size:6}),e.jsx(p,{size:12,children:e.jsx(B.Field,{name:"frequencyOfPayments",label:a("Frequency of Payment"),choices:r.frequencyOfPaymentsChoices,component:ea,"data-cy":"input-frequency-of-payment",alignItems:"center"})}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"reconciliationWindowInDays",label:a("Reconciliation window (in days)"),type:"number",fullWidth:!0,integer:!0,variant:"outlined",component:Se,"data-cy":"input-reconciliation-window"})}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"sendReconciliationWindowExpiryNotifications",label:a("Send reconciliation window expiry notifications"),color:"primary",component:ws,"data-cy":"input-reconciliation-window-notifications"})})]})})},Ru=oe(D_,"ProgramForm"),Fu=({values:s,handleNext:t,errors:a,programId:n,programHasRdi:i})=>{const{t:r}=M(),{businessArea:l,programId:o,baseUrl:d}=U(),c=async()=>{t&&await t()};return e.jsxs(e.Fragment,{children:[e.jsx(Ru,{values:s,programHasRdi:i,errors:a}),a?.documentationToUpdate&&e.jsx(Ls,{error:!0,children:a.documentationToUpdate}),e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(H,{"data-cy":"button-cancel",component:ys,to:n?`/${l}/programs/${o}/details/${n}`:`/${d}/list`,children:r("Cancel")}),e.jsx(H,{variant:"contained",color:"primary","data-cy":"button-next",onClick:c,disabled:!!a&&(Array.isArray(a)?a.length>0:Object.keys(a).length>0),children:r("Next")})]})]})},Nu={NONE_PARTNERS_ACCESS:"None of the Partners should have access",SELECTED_PARTNERS_ACCESS:"Only Selected Partners within the business area",ALL_PARTNERS_ACCESS:"All Current Partners within the business area"},Lu=Object.entries(Nu).map(([s,t])=>({value:s,label:t})),pt=T.div`
  margin: 20px 0;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.54);
`,T_=ut(H)`
  color: #c21313;
`;function Xi({children:s,...t}){return e.jsx(T_,{...t,children:s})}const R_=T(Rs)`
  color: #fff;
`;function F_({canDeleteProgramPartner:s,handleDeleteProgramPartner:t}){const{t:a}=M(),[n,i]=A.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Xi,{"data-cy":"button-delete",onClick:()=>i(!0),disabled:!s,children:e.jsx(Rs,{})}),e.jsxs(is,{open:n,onClose:()=>i(!1),scroll:"paper",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Are you sure you want to remove the partner from this programme?")})}),e.jsx(Be,{children:e.jsx(pt,{children:e.jsx(it,{children:a("This action cannot be undone.")})})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>i(!1),children:a("CANCEL")}),e.jsx(ke,{loading:!1,type:"submit",variant:"contained",onClick:()=>t(),"data-cy":"button-delete",endIcon:e.jsx(R_,{}),children:a("Delete")})]})})]})]})}class Sn{id;checked;name;parent;children;constructor(t,a){this.id=t,this.name=a,this.children=[],this.checked=!1}addChild(t){this.children.push(t),t.parent=this}updateCheckStatus(){if(this.children.length===0)return;const t=this.children.every(n=>n.checked===!0),a=this.children.some(n=>n.checked===!0||n.checked==="indeterminate");t?this.checked=!0:a?this.checked="indeterminate":this.checked=!1,this.parent&&this.parent.updateCheckStatus()}updateCheckStatusFromRoot(){this.updateCheckStatus(),this.parent&&this.parent.updateCheckStatusFromRoot()}toggleCheck(){if(this.checked==="indeterminate")this.setChecked(!0);else{const t=!this.checked;this.setChecked(t)}}setChecked(t){this.checked=t,this.children.forEach(a=>a.setChecked(t)),this.updateCheckStatusFromRoot()}getSelectedIds(){const t=[];return this.traverse(a=>{a.checked===!0&&t.push(a.id)}),t}static getAllSelectedIds(t){const a=[];return t.forEach(n=>{a.push(...n.getSelectedIds())}),a}clearChecks(){this.checked=!1,this.children.forEach(t=>t.clearChecks())}traverse(t){t(this),this.children.forEach(a=>a.traverse(t))}static buildTree(t,a=[]){if(!Array.isArray(t)||t.length===0)return[];const n=r=>Array.isArray(r)?r:typeof r=="object"&&r!==null?Object.values(r):[],i=(r,l)=>{const o=new Sn(r.id,r.name);return a.includes(r.id)&&(o.checked=!0),o.parent=l,n(r.areas).forEach(c=>{const u=i(c,o);o.addChild(u)}),l||o.updateCheckStatusFromRoot(),o};return t.map(r=>i(r,null))}}const N_=T(P)`
  font-size: 18px;
  font-weight: 400;
`,dd=T(P)`
  font-size: 16px;
  font-weight: 400;
`,cd=T(P)`
  font-size: 14px;
  font-weight: 400;
  color: #49454f;
`,Ou=({values:s,partner:t,index:a,arrayHelpers:n,allAreasTreeData:i,partnerChoices:r,setFieldValue:l,canDeleteProgramPartner:o})=>{const{t:d}=M(),[c,u]=A.useState(!1),[h,m]=A.useState(()=>Sn.buildTree(i,s.partners[a]?.areas));if(A.useEffect(()=>{m(Sn.buildTree(i,s.partners[a]?.areas))},[i]),!i)return e.jsx(Ne,{});const g=d("Provide info about Programme Partner and set Area Access"),x=e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(dd,{children:d("Business Area")}),e.jsx(cd,{children:d("The partner has access to the entire business area")})]}),f=(D,F)=>{D.stopPropagation(),F.toggleCheck(),l(`partners[${a}].areas`,Sn.getAllSelectedIds(h)),l(`partners[${a}].areaAccess`,"ADMIN_AREA"),m([...h])},j=D=>e.jsx(am,{itemId:D.id,label:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(ns,{id:D.id,color:"primary",checked:!!D.checked,indeterminate:D.checked==="indeterminate",onChange:F=>f(F,D),onClick:F=>F.stopPropagation()}),D.name]}),children:D.children.length>0&&D.children.map(j)},D.id);function y(D,F,w=1){const O={[w]:0};return D.forEach(k=>{if(F.includes(k.id)&&O[w]++,k.areas&&k.areas.length>0){const $=y(k.areas,F,w+1);Object.keys($).forEach(G=>{O[G]?O[G]+=$[G]:O[G]=$[G]})}}),O}const b=s.partners[a]?.areas||[],C=y(i,b),v=s.partners[a]?.areaAccess==="ADMIN_AREA",S=e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsxs(P,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(P,{children:[e.jsx(dd,{children:d("Admin Area")}),e.jsx(cd,{children:d("The partner will have access to the program's selected admin area(s):")}),!c&&v&&Object.values(C).some(D=>D>0)&&e.jsx(p,{container:!0,children:Object.keys(C).map(D=>e.jsx(p,{size:4,children:e.jsx(L,{dataCy:`Admin-Areas-${D}-field`,label:`Admin Areas ${D}`,children:C[D]},D)},D))})]}),e.jsx(Ve,{onClick:()=>{u(!c)},children:c?e.jsx(yc,{}):e.jsx(em,{})})]}),e.jsx(yt,{in:c,children:e.jsx(P,{style:{maxHeight:"30vh",overflow:"auto",width:"50%"},children:e.jsx(sm,{multiSelect:!0,slots:{expandIcon:tm,collapseIcon:Ti},defaultExpandedItems:(s.partners[a]?.areas||[]).map(String),defaultSelectedItems:(s.partners[a]?.areas||[]).map(String),children:h.length>0&&h.map(j)})})})]}),I=()=>{const D=s.partners.findIndex(F=>F.id===t.id);D!==-1&&n.remove(D)},E=()=>{h.forEach(D=>D.clearChecks()),m([...h])};return e.jsxs(p,{container:!0,direction:"column",children:[e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(p,{size:6,children:e.jsx(B.Field,{name:`partners[${a}].id`,label:d("Partner"),color:"primary",choices:r,component:We,required:!0})}),e.jsx(F_,{canDeleteProgramPartner:o,handleDeleteProgramPartner:I})]}),e.jsx(P,{mt:2,children:e.jsx(it,{children:g})}),e.jsx(P,{mt:2,children:e.jsx(N_,{children:d("Area Access")})}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:`partners[${a}].areaAccess`,required:s.partners[a]?.id!=="",choices:[{value:"BUSINESS_AREA",name:d("Business Area"),optionLabel:x},{value:"ADMIN_AREA",name:d("Admin Area"),optionLabel:S}],component:ea,withGreyBox:!0,onChange:D=>{u(D.target.value==="ADMIN_AREA"),D.target.value==="BUSINESS_AREA"&&(l(`partners[${a}].areas`,[]),E())}})}),a+1<s.partners.length&&e.jsx(St,{})]})},ku=({values:s,allAreasTreeData:t,partnerChoices:a,step:n,setStep:i,submitForm:r,setFieldValue:l,programId:o,loading:d})=>{const{t:c}=M(),{baseUrl:u,programId:h,businessArea:m}=U();A.useEffect(()=>{s.partnerAccess==="SELECTED_PARTNERS_ACCESS"&&s.partners.length===0&&l("partners",[{id:"",areaAccess:"BUSINESS_AREA"}]),s.partnerAccess!=="SELECTED_PARTNERS_ACCESS"&&s.partners.length>0&&l("partners",[])},[s,l]);const g=a.every(f=>f.disabled)||s.partners.some(f=>!f.id);let x="";return g&&(s.partners.some(f=>!f.id)?x=c("Select partner first"):x=c("All partners have been added")),e.jsxs(e.Fragment,{children:[e.jsx(P,{display:"flex",justifyContent:"space-between",mt:2,children:e.jsx(p,{container:!0,spacing:2,children:e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"partnerAccess",label:c("Who should have access to the program?"),color:"primary",choices:Lu,component:We,required:!0,disableClearable:!0})})})}),s.partnerAccess==="SELECTED_PARTNERS_ACCESS"&&e.jsxs(e.Fragment,{children:[e.jsx(St,{}),e.jsx(B.FieldArray,{name:"partners",render:f=>{const{form:{setFieldValue:j}}=f;return e.jsxs(e.Fragment,{children:[s.partners.map((y,b)=>e.jsx(Ou,{partner:y,index:b,values:s,arrayHelpers:f,allAreasTreeData:t,partnerChoices:a,setFieldValue:j,canDeleteProgramPartner:s.partners.length>1},y.id)),e.jsx(P,{display:"flex",children:e.jsx(Vs,{disabled:g,"data-cy":"button-add-partner",title:x,onClick:()=>f.push({id:"",areaAccess:"BUSINESS_AREA"}),variant:"outlined",color:"primary",endIcon:e.jsx(pa,{}),children:c("Add Partner")})})]})}})]}),e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(P,{mr:2,children:e.jsx(H,{"data-cy":"button-cancel",component:ys,to:o?`/${m}/programs/${h}/details/${o}`:`/${u}/list`,children:c("Cancel")})}),e.jsxs(P,{display:"flex",children:[e.jsx(P,{mr:2,children:e.jsx(H,{"data-cy":"button-back",variant:"outlined",onClick:()=>i(n-1),children:c("Back")})}),e.jsx(ke,{"data-cy":"button-save",variant:"contained",color:"primary",onClick:r,loading:d,children:c("Save")})]})]})]})},wu=({values:s,handleNext:t,setStep:a,step:n,programHasRdi:i,programHasTp:r,pdusubtypeChoicesData:l,errors:o,programId:d,setFieldValue:c,program:u})=>{const{t:h}=M(),{businessArea:m,programId:g,baseUrl:x}=U(),f=Nt(),j=l?.map(v=>({value:v.value,name:v.name})),y=h("Deleting Time Series Field"),b=h("Are you sure you want to delete this field? This action cannot be reversed."),C=i||r;return e.jsxs(e.Fragment,{children:[e.jsx(B.FieldArray,{name:"pduFields",render:v=>e.jsxs("div",{children:[s.pduFields&&s.pduFields.length>0?s.pduFields.map((S,I)=>e.jsxs(P,{pt:3,pb:3,children:[e.jsxs(p,{container:!0,spacing:3,alignItems:"flex-start",children:[e.jsx(p,{size:3,children:e.jsx(B.Field,{name:`pduFields.${I}.label`,required:!0,fullWidth:!0,variant:"outlined",label:h("Time Series Field Name"),component:Se,disabled:C})}),e.jsx(p,{size:3,children:e.jsx(B.Field,{name:`pduFields.${I}.pduData.subtype`,required:!0,fullWidth:!0,variant:"outlined",label:h("Data Type"),component:We,choices:j,disabled:C})}),e.jsx(p,{size:3,children:e.jsx(B.Field,{name:`pduFields.${I}.pduData.numberOfRounds`,fullWidth:!0,required:!0,variant:"outlined",label:h("Number of Expected Rounds"),onChange:E=>{const D=parseInt(E.target.value,10),F=[...s.pduFields[I].pduData.roundsNames];if(F.length<D)for(let w=F.length;w<D;w++)F.push("");else F.length>D&&(F.length=D);c(`pduFields.${I}.pduData.numberOfRounds`,D),c(`pduFields.${I}.pduData.roundsNames`,F)},component:We,choices:[...Array(100).keys()].map(E=>{const D=s.editMode&&C&&E+2<=(u?.pduFields[I]?.pduData?.numberOfRounds||0);return{value:E+1,label:`${E+1}`,disabled:D}})},s.pduFields[I].pduData.numberOfRounds)}),e.jsx(p,{size:1,children:e.jsx(Ve,{onClick:()=>f({title:y,content:b,type:"error"}).then(()=>v.remove(I)),disabled:C,children:e.jsx(Rs,{})})}),S.pduData.numberOfRounds&&[...Array(Number(S.pduData.numberOfRounds)).keys()].map(E=>{const D=u?.pduFields?.[I]?.pduData?.numberOfRounds||0,F=C&&s.editMode&&E+1<=D;return e.jsx(p,{size:12,children:e.jsx(tt,{fullWidth:!0,variant:"outlined",children:e.jsx(B.Field,{name:`pduFields.${I}.pduData.roundsNames.${E}`,fullWidth:!0,variant:"outlined",label:`${h("Round")} ${E+1} ${h("Name")}`,component:Se,type:"text",disabled:F})})},E)})]}),s.pduFields.length>1&&I<s.pduFields.length-1&&e.jsx(St,{})]},I)):null,e.jsx(P,{mt:6,children:e.jsx(H,{variant:"outlined",color:"primary",onClick:()=>v.push({label:"",pduData:{subtype:"",numberOfRounds:null,roundsNames:[]}}),endIcon:e.jsx(pa,{}),disabled:C,"data-cy":"button-add-time-series-field",children:h("Add Time Series Fields")})})]})}),e.jsxs(P,{mt:3,display:"flex",justifyContent:"space-between",children:[e.jsx(H,{"data-cy":"button-cancel",component:ys,to:d?`/${m}/programs/${g}/details/${d}`:`/${x}/list`,children:h("Cancel")}),e.jsxs(P,{display:"flex",children:[e.jsx(P,{mr:2,children:e.jsx(H,{"data-cy":"button-back",variant:"outlined",onClick:()=>a(n-1),children:h("Back")})}),e.jsx(H,{variant:"contained",color:"primary","data-cy":"button-next",onClick:t,disabled:o.pduFields&&o.pduFields.length>0,children:h("Next")})]})]})]})},ql=async({validateForm:s,stepFields:t,step:a,setStep:n,setFieldTouched:i})=>{const r=await s();t[a].some(o=>r[o])?t[a].forEach(o=>i(o,!0,!1)):a<t.length&&n(a+1)},Hl=({step:s,setStep:t,stepsData:a})=>e.jsx(Ta,{activeStep:s,children:a.map((n,i)=>e.jsx(Ra,{children:e.jsx(nm,{"data-cy":n.dataCy,onClick:()=>t(i),children:n.title})},n.title))}),L_=s=>Q.object().shape({editMode:Q.boolean(),name:Q.string().required(s("Programme Name is required")).min(3,s("Too short")).max(150,s("Too long")),programmeCode:Q.string().min(4,s("Programme code has to be 4 characters")).max(4,s("Programme code has to be 4 characters")).matches(/^[A-Za-z0-9\-/.]{4}$/,s("Programme code may only contain letters, digits and '-', '/', '.'.")).nullable(),startDate:Q.date().required(s("Start Date is required")).transform(t=>t instanceof Date&&!isNaN(t.getTime())?t:null),endDate:Q.date().transform((t,a)=>a===""?null:t).nullable().when("startDate",(t,a)=>t instanceof Date&&!isNaN(t.getTime())?a.min(t,`${s("End date have to be greater than")} ${fs(t).format("YYYY-MM-DD")}`):a).when("editMode",(t,a)=>t?a:a.min(ta,s("End Date cannot be in the past"))),sector:Q.string().required(s("Sector is required")),dataCollectingTypeCode:Q.string().required(s("Data Collecting Type is required")),beneficiaryGroup:Q.string().nullable().test({name:"conditional-required",message:s("Beneficiary Group is required"),test:function(t){const{dataCollectingTypeCode:a}=this.parent;return!a||this.options?.context?.programHasRdi||this.options?.context?.isCopy?!0:!!t}}),description:Q.string().min(3,s("Too short")).max(255,s("Too long")).nullable(),budget:Q.number().min(0).max(99999999,s("Number is too big")),administrativeAreasOfImplementation:Q.string().min(2,s("Too short")).max(255,s("Too long")).nullable(),populationGoal:Q.number().min(0).max(99999999,s("Number is too big")),partnerAccess:Q.string().required(),partners:Q.array().of(Q.object().shape({id:Q.string().required(s("Partner ID is required")),areaAccess:Q.string().required(s("Area Access is required"))})),pduFields:Q.array().of(Q.object().shape({label:Q.string().nullable().min(3,s("Too short")).max(150,s("Too long")).required(s("Label is required")),pduData:Q.object().shape({subtype:Q.string().nullable().required(s("Subtype is required")),numberOfRounds:Q.number().nullable().required(s("Number of rounds is required")),roundsNames:Q.array().of(Q.string().min(3,s("Too short")).max(150,s("Too long")))})}))}),O_=()=>{const s=ge(),{t}=M(),a=ve(),[n,i]=A.useState(0),{showMessage:r}=Ae(),{baseUrl:l,businessArea:o}=U(),{selectedProgram:d}=Z(),c=d?.beneficiaryGroup,{data:u}=V({queryKey:["allAreasTree",o],queryFn:()=>N.restBusinessAreasGeoAreasAllAreasTreeList({businessAreaSlug:o})}),{data:h,isLoading:m}=V({queryKey:["userChoices",o],queryFn:()=>N.restBusinessAreasUsersChoicesRetrieve({businessAreaSlug:o})}),{data:g,isLoading:x}=V({queryKey:["programChoices",o],queryFn:()=>N.restBusinessAreasProgramsChoicesRetrieve({businessAreaSlug:o}),staleTime:1e3*60*10,gcTime:1e3*60*30}),f=Fe(),{mutateAsync:j,isPending:y}=xe({mutationFn:E=>N.restBusinessAreasProgramsCreate({businessAreaSlug:o,requestBody:E}),onSuccess:async()=>{await f.invalidateQueries({queryKey:["programs",o]}),await f.invalidateQueries({queryKey:["programChoices",o]})}}),b=async E=>{const D=parseFloat(E.budget)??0,F=Number.isNaN(D)?0:D.toFixed(2),w=parseInt(E.populationGoal,10)??0,O=Number.isNaN(w)?0:w,k=E.partnerAccess==="SELECTED_PARTNERS_ACCESS"?E.partners.map(({id:re,areas:se,areaAccess:le})=>({partner:re,areas:le==="ADMIN_AREA"?se:[]})):[],$=mt.omit(E,["editMode","isActive"]),G={label:"",pduData:{subtype:"",numberOfRounds:null,roundsNames:[]}},W=re=>{const se=G.pduData.roundsNames.map(ce=>ce||""),le=re.pduData.roundsNames.map(ce=>ce??"");return re.label===G.label&&re.pduData.subtype===G.pduData.subtype&&re.pduData.numberOfRounds===G.pduData.numberOfRounds&&le.length===se.length&&le.every((ce,_e)=>ce===se[_e])},Y=re=>{const se=re.pduData.roundsNames.map(ce=>ce??"");for(;se.length<re.pduData.numberOfRounds;)se.push("");const le=se.slice(0,re.pduData.numberOfRounds);return{...re,pduData:{...re.pduData,roundsNames:le}}},X=E.pduFields.map(Y),J=X.every(W)?null:X.length>0?X:null,ae=J?$a(J):null;try{const re={id:"",slug:"",version:0,status:"",name:$.name,programmeCode:$.programmeCode||null,sector:$.sector,description:$.description||"",budget:F.toString(),administrativeAreasOfImplementation:$.administrativeAreasOfImplementation||"",populationGoal:O,cashPlus:$.cashPlus,frequencyOfPayments:$.frequencyOfPayments,dataCollectingType:$.dataCollectingTypeCode,beneficiaryGroup:$.beneficiaryGroup||"",startDate:$.startDate,endDate:$.endDate===""||$.endDate===void 0?null:$.endDate,pduFields:ae||[],partners:k,partnerAccess:E.partnerAccess,reconciliationWindowInDays:E.reconciliationWindowInDays,sendReconciliationWindowExpiryNotifications:E.sendReconciliationWindowExpiryNotifications},se=await j(re);r("Programme created."),s(`/${l}/details/${se.slug}`)}catch(re){fe(re,r)}},C={isActive:!1,editMode:!1,name:"",programmeCode:"",startDate:"",endDate:void 0,sector:"",dataCollectingTypeCode:"",beneficiaryGroup:"",description:"",budget:"",administrativeAreasOfImplementation:"",populationGoal:"",cashPlus:!1,frequencyOfPayments:"REGULAR",partners:[],reconciliationWindowInDays:0,sendReconciliationWindowExpiryNotifications:!1,partnerAccess:"ALL_PARTNERS_ACCESS",pduFields:[]},v=[["name","programmeCode","startDate","endDate","sector","dataCollectingTypeCode","description","budget","administrativeAreasOfImplementation","populationGoal","cashPlus","frequencyOfPayments","reconciliationWindowInDays","sendReconciliationWindowExpiryNotifications"],["pduField"],["partnerAccess"]];if(m||x)return e.jsx(Ne,{});if(!h||!g)return null;const{partnerChoicesTemp:S}=h,I=[{title:t("Programme Management"),to:`/${l}/list/`}];return e.jsx(B.Formik,{initialValues:C,onSubmit:E=>{b(E)},initialTouched:{programmeCode:!0},validationSchema:L_(t),validationContext:{programHasRdi:!1,isCopy:!1},validateOnChange:!0,children:({submitForm:E,values:D,validateForm:F,setFieldTouched:w,setFieldValue:O,errors:k,setErrors:$})=>{const G=_l(S,D.partners),W=async()=>{await ql({validateForm:F,stepFields:v,step:n,setStep:i,setFieldTouched:w})},Y=[{title:t("Details"),description:t("To create a new Programme, please complete all required fields on the form below and save."),dataCy:"step-button-details"},{title:t("Programme Time Series Fields"),description:t(`The Time Series Fields feature allows serial updating of ${c?.memberLabel} data through an XLSX file.`),dataCy:"step-button-time-series-fields"},{title:t("Programme Partners"),description:"",dataCy:"step-button-partners"}],X=Y[n].title,J=Y[n].description?Y[n].description:void 0;return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:t("New Programme"),breadCrumbs:K(R.PROGRAMME_VIEW_LIST_AND_DETAILS,a)?I:null}),e.jsx(st,{title:X,description:J,stepper:e.jsx(Hl,{step:n,setStep:i,stepsData:Y}),children:e.jsxs(P,{p:3,children:[e.jsx(Wt,{in:n===0,timeout:600,children:e.jsx("div",{children:n===0&&e.jsx(Fu,{values:D,handleNext:W,errors:k})})}),e.jsx(Wt,{in:n===1,timeout:600,children:e.jsx("div",{children:n===1&&e.jsx(wu,{values:D,handleNext:W,step:n,setStep:i,pdusubtypeChoicesData:g.pduSubtypeChoices,errors:k,setFieldValue:O})})}),e.jsx(Wt,{in:n===2,timeout:600,children:e.jsx("div",{children:n===2&&e.jsx(ku,{values:D,allAreasTreeData:u||[],partnerChoices:G,step:n,setStep:i,submitForm:E,setFieldValue:O,loading:y})})})]})})]})}})},k_=oe(O_,"CreateProgramPage"),Mu=s=>{const t=Q.date().transform((a,n)=>n===""?null:a).when("startDate",(a,n)=>a instanceof Date&&!isNaN(a.getTime())?n.min(a,`${s("End date have to be greater than")} ${fs(a).format("YYYY-MM-DD")}`):n).min(ta,s("End Date cannot be in the past")).nullable();return Q.object().shape({editMode:Q.boolean(),name:Q.string().required(s("Programme Name is required")).min(3,s("Too short")).max(150,s("Too long")),programmeCode:Q.string().min(4,s("Programme code has to be 4 characters")).max(4,s("Programme code has to be 4 characters")).matches(/^[A-Za-z0-9\-/.]{4}$/,s("Programme code may only contain letters, digits and '-', '/', '.'.")).nullable(),startDate:Q.date().required(s("Start Date is required")).transform(a=>a instanceof Date&&!isNaN(a.getTime())?a:null),endDate:t,sector:Q.string().required(s("Sector is required")),dataCollectingTypeCode:Q.string().required(s("Data Collecting Type is required")),beneficiaryGroup:Q.string().nullable().test({name:"conditional-required",message:s("Beneficiary Group is required"),test:function(a){const{dataCollectingTypeCode:n}=this.parent;return!n||this.options?.context?.isEdit||this.options?.context?.isCopy?!0:!!a}}),description:Q.string().min(3,s("Too short")).max(255,s("Too long")).nullable(),budget:Q.number().min(0).max(99999999,s("Number is too big")),administrativeAreasOfImplementation:Q.string().min(2,s("Too short")).max(255,s("Too long")).nullable(),populationGoal:Q.number().min(0).max(99999999,s("Number is too big"))})},w_=s=>Q.object().shape({partnerAccess:Q.string().required(),partners:Q.array().of(Q.object().shape({id:Q.string().required(s("Partner ID is required")),areaAccess:Q.string().required(s("Area Access is required"))}))}),M_=()=>{const s=ge(),{t}=M(),{id:a}=ts(),n=ve(),[i,r]=A.useState(0),{showMessage:l}=Ae(),{baseUrl:o,businessArea:d}=U(),c=Fe(),{mutateAsync:u,isPending:h}=xe({mutationFn:Ue=>N.restBusinessAreasProgramsCopyCreate({businessAreaSlug:d,slug:a,requestBody:Ue}),onSuccess:async()=>{await c.invalidateQueries({queryKey:["businessAreaPrograms",d]})}}),{data:m,isLoading:g}=V({queryKey:["allAreasTree",d],queryFn:()=>N.restBusinessAreasGeoAreasAllAreasTreeList({businessAreaSlug:d})}),{data:x,isLoading:f}=V({queryKey:["businessAreaProgram",d,a],queryFn:()=>N.restBusinessAreasProgramsRetrieve({businessAreaSlug:d,slug:a})}),{data:j,isLoading:y}=V({queryKey:["userChoices",d],queryFn:()=>N.restBusinessAreasUsersChoicesRetrieve({businessAreaSlug:d})}),{data:b,isLoading:C}=V({queryKey:["programChoices",d],queryFn:()=>N.restBusinessAreasProgramsChoicesRetrieve({businessAreaSlug:d}),staleTime:1e3*60*10,gcTime:1e3*60*30}),v=async Ue=>{const Te=parseFloat(Ue.budget)??0,ie=Number.isNaN(Te)?0:Te.toFixed(2),Pe=Ue.partnerAccess==="SELECTED_PARTNERS_ACCESS"?Ue.partners.map(({id:ye,areas:as,areaAccess:he})=>({partner:ye,areas:he==="ADMIN_AREA"?as:[],areaAccess:he})):[],ue=mt.omit(Ue,["editMode","beneficiaryGroup","isActive"]),Ge={label:"",pduData:{subtype:"",numberOfRounds:null,roundsNames:[]}},ls=ye=>{const as=Ge.pduData.roundsNames.map(Re=>Re||""),he=ye.pduData.roundsNames.map(Re=>Re??"");return ye.label===Ge.label&&ye.pduData.subtype===Ge.pduData.subtype&&ye.pduData.numberOfRounds===Ge.pduData.numberOfRounds&&he.length===as.length&&he.every((Re,Me)=>Re===as[Me])},qe=ye=>{const as=ye.pduData.roundsNames.map(Re=>Re??"");for(;as.length<ye.pduData.numberOfRounds;)as.push("");const he=as.slice(0,ye.pduData.numberOfRounds);return{...ye,pduData:{...ye.pduData,roundsNames:he}}},xs=Ue.pduFields.map(qe),Oe=xs.every(ls)?null:xs.length>0?xs:null,es=Oe?$a(Oe):null;try{const ye={programmeCode:ue.programmeCode,name:ue.name,sector:ue.sector,description:ue.description,budget:ie.toString(),administrativeAreasOfImplementation:ue.administrativeAreasOfImplementation,populationGoal:parseInt(ue.populationGoal,10)||0,cashPlus:ue.cashPlus,frequencyOfPayments:ue.frequencyOfPayments,dataCollectingType:ue.dataCollectingTypeCode,beneficiaryGroup:ue.beneficiaryGroup,startDate:ue.startDate,endDate:ue.endDate===""||ue.endDate===void 0?null:ue.endDate,pduFields:es,partners:Pe.map(({partner:Me,areas:ps})=>({partner:Me,areas:ps})),partnerAccess:Ue.partnerAccess},as=await u(ye);l("Programme created.");const he=as.message.match(/New Program slug: ([^\s]+)/),Re=he?he[1]:null;Re&&s(`/${o}/details/${Re}`)}catch(ye){fe(ye,l,t("Programme create action failed."))}};if(f||g||y||C)return e.jsx(Ne,{});if(!x||!m||!j||!b)return null;const{name:S,startDate:I,endDate:E,sector:D,dataCollectingType:F,beneficiaryGroup:w,description:O,budget:k="",administrativeAreasOfImplementation:$,populationGoal:G=0,cashPlus:W=!1,frequencyOfPayments:Y="REGULAR",partners:X,partnerAccess:J="ALL_PARTNERS_ACCESS"}=x,ae={editMode:!1,isActive:!1,name:`Copy of Programme: (${S})`,programmeCode:null,startDate:I,endDate:E,sector:D,dataCollectingTypeCode:F?.code,beneficiaryGroup:w?.id,description:O,budget:k,administrativeAreasOfImplementation:$,populationGoal:G,cashPlus:W,frequencyOfPayments:Y,partners:X.filter(Ue=>Mn(Ue.name)).map(Ue=>({id:Ue.id,areas:Ue?.areas?.map(Te=>Te?.id)||[],areaAccess:Ue.areaAccess})),partnerAccess:J,pduFields:[]};ae.budget=x.budget==="0.00"?"":x.budget;const re=[["name","programmeCode","startDate","endDate","sector","dataCollectingTypeCode","beneficiaryGroup","description","budget","administrativeAreasOfImplementation","populationGoal","cashPlus","frequencyOfPayments"],["partnerAccess"]],{partnerChoicesTemp:se}=j,le=[{title:t("Programme"),to:`/${o}/details/${a}`}],ce=[{title:t("Details"),description:t("To create a new Programme, please complete all required fields on the form below and save."),dataCy:"step-button-details"},{title:t("Programme Time Series Fields"),description:t("The Time Series Fields feature allows serial updating of individual data through an XLSX file."),dataCy:"step-button-time-series-fields"},{title:t("Programme Partners"),description:"",dataCy:"step-button-partners"}],_e=ce[i].title,ne=ce[i].description?ce[i].description:void 0;return e.jsx(B.Formik,{initialValues:ae,onSubmit:Ue=>{v(Ue)},validationSchema:Mu(t),validateOnChange:!0,children:({submitForm:Ue,values:Te,validateForm:ie,setFieldTouched:Pe,setFieldValue:ue,errors:Ge,setErrors:ls})=>{const qe=_l(se,Te.partners),xs=async()=>{await ql({validateForm:ie,stepFields:re,step:i,setStep:r,setFieldTouched:Pe})};return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`${t("Copy of Programme")}: (${S})`,breadCrumbs:K(R.PROGRAMME_VIEW_LIST_AND_DETAILS,n)?le:null}),e.jsx(st,{title:_e,description:ne,stepper:e.jsx(Hl,{step:i,setStep:r,stepsData:ce}),children:e.jsxs(P,{p:3,children:[e.jsx(Wt,{in:i===0,timeout:600,children:e.jsx("div",{children:i===0&&e.jsx(Fu,{values:Te,handleNext:xs,programId:a,errors:Ge})})}),e.jsx(Wt,{in:i===1,timeout:600,children:e.jsx("div",{children:i===1&&e.jsx(wu,{values:Te,handleNext:xs,step:i,setStep:r,pdusubtypeChoicesData:b.pduSubtypeChoices,errors:Ge,programId:a,setFieldValue:ue})})}),e.jsx(Wt,{in:i===2,timeout:600,children:e.jsx("div",{children:i===2&&e.jsx(ku,{values:Te,allAreasTreeData:m||[],partnerChoices:qe,step:i,setStep:r,submitForm:Ue,setFieldValue:ue,programId:a,loading:h})})})]})})]})}})},$_=oe(M_,"DuplicateProgramPage"),U_=({values:s,handleNext:t,errors:a,programId:n,programHasRdi:i})=>{const{t:r}=M(),{businessArea:l,programId:o,baseUrl:d}=U(),c=async()=>{t&&await t()};return e.jsxs(e.Fragment,{children:[e.jsx(Ru,{values:s,programHasRdi:i}),e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(H,{"data-cy":"button-cancel",component:ys,to:n?`/${l}/programs/${o}/details/${n}`:`/${d}/list`,children:r("Cancel")}),e.jsx(H,{variant:"contained",color:"primary","data-cy":"button-next",onClick:c,disabled:!!a&&(Array.isArray(a)?a.length>0:Object.keys(a).length>0),children:r("Next")})]})]})},V_=({values:s,allAreasTreeData:t,partnerChoices:a,submitForm:n,setFieldValue:i,programId:r,loading:l})=>{const{t:o}=M(),{baseUrl:d,programId:c,businessArea:u}=U();A.useEffect(()=>{s.partnerAccess==="SELECTED_PARTNERS_ACCESS"&&s.partners.length===0&&i("partners",[{id:"",areaAccess:"BUSINESS_AREA"}]),s.partnerAccess!=="SELECTED_PARTNERS_ACCESS"&&s.partners.length>0&&i("partners",[])},[s,i]);const h=a.every(g=>g.disabled)||s.partners.some(g=>!g.id);let m="";return h&&(s.partners.some(g=>!g.id)?m=o("Select partner first"):m=o("All partners have been added")),e.jsxs(e.Fragment,{children:[e.jsx(P,{display:"flex",justifyContent:"space-between",mt:2,children:e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"partnerAccess",label:o("Who should have access to the program?"),color:"primary",choices:Lu,component:We,required:!0,disableClearable:!0})})}),e.jsxs(e.Fragment,{children:[e.jsx(St,{}),e.jsx(B.FieldArray,{name:"partners",render:g=>{const{form:{setFieldValue:x}}=g;return e.jsxs(e.Fragment,{children:[s.partners.map((f,j)=>e.jsx(Ou,{partner:f,index:j,values:s,arrayHelpers:g,allAreasTreeData:t,partnerChoices:a,setFieldValue:x,canDeleteProgramPartner:s.partners.length>1},f.id)),e.jsx(P,{display:"flex",children:s.partnerAccess==="SELECTED_PARTNERS_ACCESS"&&e.jsx(Vs,{disabled:h,"data-cy":"button-add-partner",title:m,onClick:()=>g.push({id:"",areaAccess:"BUSINESS_AREA"}),variant:"outlined",color:"primary",endIcon:e.jsx(pa,{}),children:o("Add Partner")})})]})}})]}),e.jsxs(P,{mt:1,display:"flex",justifyContent:"space-between",children:[e.jsx(P,{mr:2,children:e.jsx(H,{"data-cy":"button-cancel",component:ys,to:r?`/${u}/programs/${c}/details/${r}`:`/${d}/list`,children:o("Cancel")})}),e.jsx(P,{display:"flex",children:e.jsx(ke,{"data-cy":"button-save",variant:"contained",color:"primary",onClick:n,loading:l,children:o("Save")})})]})]})},B_=({values:s,submitForm:t,programHasRdi:a,programHasTp:n,pdusubtypeChoicesData:i,programId:r,setFieldValue:l,program:o,setStep:d,step:c,loading:u})=>{const{t:h}=M(),{businessArea:m,programId:g,baseUrl:x}=U(),f=Nt(),j=i?.map(v=>({value:v.value,name:v.name})),y=h("Deleting Time Series Field"),b=h("Are you sure you want to delete this field? This action cannot be reversed."),C=a||n;return e.jsxs(e.Fragment,{children:[e.jsx(B.FieldArray,{name:"pduFields",render:v=>e.jsxs("div",{children:[s.pduFields&&s.pduFields.length>0?s.pduFields.map((S,I)=>e.jsxs(P,{pt:3,pb:3,children:[e.jsxs(p,{container:!0,spacing:3,alignItems:"flex-start",children:[e.jsx(p,{size:3,children:e.jsx(B.Field,{name:`pduFields.${I}.label`,required:!0,fullWidth:!0,variant:"outlined",label:h("Time Series Field Name"),component:Se,disabled:C})}),e.jsx(p,{size:3,children:e.jsx(B.Field,{name:`pduFields.${I}.pdu_data.subtype`,required:!0,fullWidth:!0,variant:"outlined",label:h("Data Type"),component:We,choices:j,disabled:C})}),e.jsx(p,{size:3,children:e.jsx(B.Field,{name:`pduFields.${I}.pdu_data.number_of_rounds`,fullWidth:!0,required:!0,variant:"outlined",label:h("Number of Expected Rounds"),onChange:E=>{const D=parseInt(E.target.value,10),F=[...s.pduFields[I]?.pdu_data?.rounds_names||[]];if(F.length<D)for(let w=F.length;w<D;w++)F.push("");else F.length>D&&(F.length=D);s.pduFields[I].pdu_data||l(`pduFields.${I}.pdu_data`,{subtype:"",rounds_names:F}),l(`pduFields.${I}.pdu_data.number_of_rounds`,D),l(`pduFields.${I}.pdu_data.rounds_names`,F)},component:We,choices:[...Array(100).keys()].map(E=>{const D=s.editMode&&C&&E+2<=(o?.pduFields[I]?.pdu_data?.number_of_rounds||0);return{value:E+1,label:`${E+1}`,disabled:D}})},s.pduFields[I]?.pdu_data?.number_of_rounds||0)}),e.jsx(p,{size:1,children:e.jsx(Ve,{onClick:()=>f({title:y,content:b,type:"error"}).then(()=>v.remove(I)),disabled:C,children:e.jsx(Rs,{})})}),S?.pdu_data?.number_of_rounds&&[...Array(Number(S?.pdu_data?.number_of_rounds)).keys()].map(E=>{const D=o?.pduFields?.[I]?.pdu_data?.number_of_rounds||0,F=C&&s.editMode&&E+1<=D;return e.jsx(p,{size:12,children:e.jsx(tt,{fullWidth:!0,variant:"outlined",children:e.jsx(B.Field,{name:`pduFields.${I}.pdu_data.rounds_names.${E}`,fullWidth:!0,variant:"outlined",label:`${h("Round")} ${E+1} ${h("Name")}`,component:Se,type:"text",disabled:F})})},E)})]}),s.pduFields.length>1&&I<s.pduFields.length-1&&e.jsx(St,{})]},I)):null,e.jsx(P,{mt:6,children:e.jsx(H,{variant:"outlined",color:"primary",onClick:()=>v.push({label:"",pdu_data:{subtype:"",number_of_rounds:1,rounds_names:[""]}}),endIcon:e.jsx(pa,{}),disabled:C,"data-cy":"button-add-time-series-field",children:h("Add Time Series Fields")})})]})}),e.jsxs(P,{mt:3,display:"flex",justifyContent:"space-between",children:[e.jsx(H,{"data-cy":"button-cancel",component:ys,to:r?`/${m}/programs/${g}/details/${r}`:`/${x}/list`,children:h("Cancel")}),e.jsxs(P,{display:"flex",children:[e.jsx(P,{mr:2,children:e.jsx(H,{"data-cy":"button-back",variant:"outlined",onClick:()=>d(c-1),children:h("Back")})}),e.jsx(ke,{"data-cy":"button-save",variant:"contained",color:"primary",onClick:t,loading:u,children:h("Save")})]})]})]})},G_=()=>{const s=ge(),{t}=M(),{id:a}=ts(),n=ve(),r=je().state?.option,[l,o]=A.useState(0),{showMessage:d}=Ae(),{baseUrl:c,businessArea:u}=U(),{data:h}=V({queryKey:["allAreasTree",u],queryFn:()=>N.restBusinessAreasGeoAreasAllAreasTreeList({businessAreaSlug:u})}),{data:m,isLoading:g}=V({queryKey:["businessAreaProgram",u,a],queryFn:()=>N.restBusinessAreasProgramsRetrieve({businessAreaSlug:u,slug:a})}),{data:x,isLoading:f}=V({queryKey:["programChoices",u],queryFn:()=>N.restBusinessAreasProgramsChoicesRetrieve({businessAreaSlug:u}),staleTime:1e3*60*10,gcTime:1e3*60*30}),{data:j,isLoading:y}=V({queryKey:["userChoices",u],queryFn:()=>N.restBusinessAreasUsersChoicesRetrieve({businessAreaSlug:u})}),b=Fe(),{mutateAsync:C,isPending:v}=xe({mutationFn:ye=>N.restBusinessAreasProgramsUpdate({businessAreaSlug:u,slug:a,requestBody:ye}),onSuccess:async()=>{await b.invalidateQueries({queryKey:["businessAreaProgram",u,a]}),await b.invalidateQueries({queryKey:["businessAreaPrograms",u]})}}),{mutateAsync:S,isPending:I}=xe({mutationFn:ye=>N.restBusinessAreasProgramsUpdatePartnerAccessCreate({businessAreaSlug:u,slug:a,requestBody:ye}),onSuccess:async()=>{await b.invalidateQueries({queryKey:["businessAreaProgram",u,a]}),await b.invalidateQueries({queryKey:["businessAreaPrograms",u]}),await b.invalidateQueries({queryKey:["activityLogs",u,Ea(a)]})}});if(g||f||y)return e.jsx(Ne,{});if(!m||!x||!j)return null;const{name:E,programmeCode:D,startDate:F,endDate:w,sector:O,dataCollectingType:k,beneficiaryGroup:$,description:G,budget:W="",administrativeAreasOfImplementation:Y,populationGoal:X="",cashPlus:J=!1,frequencyOfPayments:ae="REGULAR",version:re,partners:se,partnerAccess:le="ALL_PARTNERS_ACCESS",registrationImportsTotalCount:ce,pduFields:_e,targetPopulationsCount:ne,reconciliationWindowInDays:Ue,sendReconciliationWindowExpiryNotifications:Te}=m,ie=ce>0,Pe=ne>0,ue=async ye=>{const as=parseFloat(ye.budget)??0,he=Number.isNaN(as)?"0.00":as.toFixed(2),Re=parseInt(ye.populationGoal,10)??0,Me=Number.isNaN(Re)?0:Re,ps=ye.pduFields.filter(Je=>Je.label!=="").map(({pdu_data:Je,...Ts})=>{let It=Je;if(Je){const xa=Object.fromEntries(Object.entries(Je).filter(([gn])=>gn!=="id"));xa.rounds_names=(Je.rounds_names||(Je.rounds_names=[]),Je.number_of_rounds===1&&Je.rounds_names.length===0?[""]:Je.rounds_names.map(gn=>gn||"")),It=xa}return{...Ts,pduData:It}});try{const Je=mt.omit(ye,["editMode","partners","partnerAccess","pduFields","isActive"]),Ts={programmeCode:Je.programmeCode,name:Je.name,slug:"",sector:Je.sector,description:Je.description,budget:he,administrativeAreasOfImplementation:Je.administrativeAreasOfImplementation,populationGoal:Me,cashPlus:Je.cashPlus,frequencyOfPayments:Je.frequencyOfPayments,dataCollectingType:m.status==="DRAFT"?Je.dataCollectingTypeCode:m.dataCollectingType.code,beneficiaryGroup:Je.beneficiaryGroup,startDate:Je.startDate,endDate:Je.endDate===""||Je.endDate===void 0?null:Je.endDate,pduFields:$a(ps),version:re,status:"",partnerAccess:"",reconciliationWindowInDays:Je.reconciliationWindowInDays,sendReconciliationWindowExpiryNotifications:Je.sendReconciliationWindowExpiryNotifications},It=await C(Ts);d(t("Programme edited.")),s(`/${c}/details/${It.slug}`)}catch(Je){fe(Je,d)}},Ge=async ye=>{const as=ye.partnerAccess==="SELECTED_PARTNERS_ACCESS"?ye.partners.map(({id:he,areas:Re,areaAccess:Me})=>({partner:he,areas:Me==="ADMIN_AREA"?Re:[]})):[];try{const he={partners:as,partnerAccess:ye.partnerAccess,version:re};await S(he),d(t("Programme Partners updated.")),s(`/${c}/details/${a}`)}catch(he){fe(he,d)}},ls={isActive:m.status==="ACTIVE",editMode:!0,name:E,programmeCode:D,startDate:F,endDate:w,sector:O,dataCollectingTypeCode:k.code,beneficiaryGroup:$.id,description:G,budget:W,administrativeAreasOfImplementation:Y,populationGoal:X,cashPlus:J,frequencyOfPayments:ae,pduFields:_e,reconciliationWindowInDays:Ue,sendReconciliationWindowExpiryNotifications:Te};ls.budget=m.budget==="0.00"?"":m.budget,ls.populationGoal=m.populationGoal===0?"":m.populationGoal;const qe={partners:se.length>0?se.filter(ye=>Mn(ye.name)).map(ye=>({id:ye.id,areaAccess:ye.areaAccess,areas:Array.isArray(ye.areas)?ye.areas.map(as=>as.id):[]})):[],partnerAccess:le},xs=[["name","programmeCode","startDate","endDate","sector","dataCollectingTypeCode","beneficiaryGroup","description","budget","administrativeAreasOfImplementation","populationGoal","cashPlus","frequencyOfPayments","reconciliationWindowInDays","sendReconciliationWindowExpiryNotifications"],["partnerAccess"]],Oe=[{title:t("Programme"),to:`/${c}/details/${a}`}],es=[{title:t("Details"),description:t("To create a new Programme, please complete all required fields on the form below and save."),dataCy:"step-button-details"},{title:t("Programme Time Series Fields"),description:t("The Time Series Fields feature allows serial updating of individual data through an XLSX file."),dataCy:"step-button-time-series-fields"}];return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`${t("Edit Programme")}: (${E})`,breadCrumbs:K(R.PROGRAMME_VIEW_LIST_AND_DETAILS,n)?Oe:null}),r==="details"&&e.jsx(B.Formik,{initialValues:ls,onSubmit:ye=>{ue(ye)},validationSchema:Mu(t),validationContext:{isEdit:!0},validateOnChange:!0,children:({submitForm:ye,values:as,validateForm:he,setFieldTouched:Re,setFieldValue:Me,errors:ps,setErrors:Je})=>{const Ts=async()=>{await ql({validateForm:he,stepFields:xs,step:l,setStep:o,setFieldTouched:Re})};return e.jsx(st,{title:es[l].title,description:es[l].description,stepper:e.jsx(Hl,{step:l,setStep:o,stepsData:es}),children:e.jsx(P,{p:3,children:e.jsxs(e.Fragment,{children:[e.jsx(Wt,{in:l===0,timeout:600,children:e.jsx("div",{children:l===0&&e.jsx(U_,{values:as,handleNext:Ts,programId:a,errors:ps,programHasRdi:ie})})}),e.jsx(Wt,{in:l===1,timeout:600,children:e.jsx("div",{children:l===1&&e.jsx(B_,{values:as,step:l,setStep:o,pdusubtypeChoicesData:x?.pduSubtypeChoices,programHasRdi:ie,programHasTp:Pe,programId:a,program:m,setFieldValue:Me,submitForm:ye,loading:v})})})]})})})}}),r==="partners"&&e.jsx(B.Formik,{initialValues:qe,onSubmit:ye=>{Ge(ye)},validationSchema:w_(t),children:({submitForm:ye,values:as,setFieldValue:he})=>{const Re=Cp(m.partners,as.partners),Me=_l(j.partnerChoices,as.partners),ps=new Set,Je=[...Re,...Me].filter(Ts=>{const It=`${Ts.value}|${Ts.label}`;return ps.has(It)?!1:(ps.add(It),!0)});return e.jsx(st,{title:t("Programme Partners"),children:e.jsx(Wt,{in:r==="partners",timeout:600,children:e.jsx("div",{children:e.jsx(V_,{values:as,allAreasTreeData:h||[],partnerChoices:Je,submitForm:ye,setFieldValue:he,programId:a,loading:I})})})})}})]})},z_=oe(G_,"EditProgramPage"),q_=T.div`
  padding: ${({theme:s})=>s.spacing(8)};
  border-color: #b1b1b5;
  border-left-width: 1px;
  border-left-style: solid;
`,H_=T.div`
  font-family: ${({theme:s})=>s.hctTypography.fontFamily};
  color: #253b46;
  font-size: 36px;
  line-height: 32px;
  margin-top: ${({theme:s})=>s.spacing(2)};
`,W_=T(P)`
  border: 1px solid #e3e3e3;
`,K_=({program:s,choices:t})=>{const{t:a}=M(),{frequencyOfPaymentsChoices:n,sectorChoices:i}=t,r=_s(n),l=_s(i),o=u=>{const h={1:0,2:0,3:0,4:0};return u.areas?.forEach(({level:m})=>{const g=h[m+1]||0;h[m+1]=g+1}),e.jsx(p,{container:!0,spacing:6,children:Object.keys(h).map(m=>e.jsx(p,{size:3,children:e.jsx(L,{dataCy:`admin-area-${m}-total-count`,label:a(`Admin Area ${m}`),children:h[m]})},m))})};let d=[];d=s.partners.filter(u=>Mn(u.name));const c=d.length>0;return e.jsxs(Fs,{"data-cy":"program-details-container",children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Programme Details")})}),e.jsxs(vt,{children:[e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:4,children:e.jsx(L,{label:a("status"),children:e.jsx(we,{status:s.status,statusToColor:Pl})})}),e.jsx(p,{size:4,children:e.jsx(L,{label:a("START DATE"),value:e.jsx(pe,{children:s.startDate})})}),e.jsx(p,{size:4,children:e.jsx(L,{label:a("END DATE"),value:e.jsx(pe,{children:s.endDate})})}),e.jsx(p,{size:4,children:e.jsx(L,{label:a("Programme Code"),value:s.programmeCode})}),e.jsx(p,{size:4,children:e.jsx(L,{label:a("Sector"),value:l[s.sector]})}),e.jsx(p,{size:4,children:e.jsx(L,{label:a("Data Collecting Type"),value:s?.dataCollectingType?.label})}),e.jsx(p,{size:4,children:e.jsx(L,{label:a("Beneficiary Group"),value:s?.beneficiaryGroup?.name})}),e.jsx(p,{size:4,children:e.jsx(L,{label:a("Frequency of Payment"),value:r[s.frequencyOfPayments]})}),e.jsx(p,{size:4,children:e.jsx(L,{label:a("Administrative Areas of implementation"),value:s.administrativeAreasOfImplementation})}),e.jsx(p,{size:4,children:e.jsx(L,{label:a("Description"),value:s.description})}),e.jsx(p,{size:4,children:e.jsx(L,{label:a("CASH+"),value:s.cashPlus?a("Yes"):a("No")})}),e.jsx(p,{size:4,children:e.jsx(L,{label:a("Partner Access"),value:Nu[s.partnerAccess]})}),e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:a("Reconciliation Window (in days)"),value:s.reconciliationWindowInDays})}),e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:a("Send reconciliation window expiry notifications"),value:s.sendReconciliationWindowExpiryNotifications?a("Yes"):a("No")})})]}),e.jsx(q_,{children:e.jsx(L,{label:a("Programme size"),children:e.jsx(H_,{children:s.householdCount})})})]}),c&&e.jsxs(e.Fragment,{children:[e.jsx(St,{}),e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Programme Partners")})}),e.jsx(vt,{children:e.jsx(p,{container:!0,spacing:6,children:d.map(u=>e.jsx(p,{size:12,children:e.jsxs(W_,{p:6,flexDirection:"column",children:[e.jsx(ee,{"data-cy":"label-partner-name",variant:"h6",children:u.name}),u.areaAccess==="BUSINESS_AREA"?e.jsx(L,{dataCy:"area-access-field",label:a("Area Access"),children:a("Business Area")}):o(u)]})},u.id))})})]})]})},Y_=T(Rs)`
  color: #fff;
`,Q_=({program:s,programCycle:t})=>{const{t:a}=M(),[n,i]=A.useState(!1),{businessArea:r}=U(),{showMessage:l}=Ae(),o=Fe(),{mutateAsync:d,isPending:c}=xe({mutationFn:()=>N.restBusinessAreasProgramsCyclesDestroy({businessAreaSlug:r,programSlug:s.slug,id:t.id})}),u=async()=>{try{await d(),l(a("Programme Cycle Deleted"))}catch(h){h.message&&h.message.includes("Unexpected end of JSON input")?l(a("Programme Cycle Deleted")):fe(h,l)}await o.invalidateQueries({queryKey:["programCycles",r,s.slug],exact:!1}),i(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{color:"primary","data-cy":"delete-programme-cycle",onClick:()=>i(!0),children:e.jsx(Rs,{})}),e.jsxs(is,{open:n,onClose:()=>i(!1),scroll:"paper",children:[e.jsx(Ye,{children:e.jsx(Le,{children:"Are you sure you want to delete the Program Cycle from the system?"})}),e.jsx(Be,{children:e.jsx(pt,{children:e.jsx(it,{children:a("This action cannot be undone.")})})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>i(!1),children:a("CANCEL")}),e.jsx(ke,{loading:c,color:"error",variant:"contained",onClick:u,"data-cy":"button-delete",endIcon:e.jsx(Y_,{}),children:a("Delete")})]})})]})]})},X_=oe(Q_,"DeleteProgramCycle"),J_=({programCycle:s,program:t})=>{const{t:a}=M(),[n,i]=A.useState(!1),{businessArea:r}=U(),{showMessage:l}=Ae(),o=Fe(),{mutateAsync:d,isPending:c}=xe({mutationFn:async f=>N.restBusinessAreasProgramsCyclesPartialUpdate({businessAreaSlug:r,id:s.id,programSlug:t.slug??t.id,requestBody:f}),onSuccess:async()=>{await o.invalidateQueries({queryKey:["programCycles",r,t.slug]}),i(!1)}}),u=!!s.endDate,h=async f=>{try{await d({title:f.title,startDate:f.startDate,endDate:f.endDate}),l(a("Programme Cycle Updated"))}catch(j){fe(j,l,a("Error updating Programme Cycle"))}},m={title:s.title,startDate:s.startDate,endDate:s.endDate??void 0},g=()=>{let f=Q.date().min(ta,a("End Date cannot be in the past")).when("startDate",([j],y)=>j?y.min(new Date(j),`${a("End date have to be greater than")} ${fs(j).format("YYYY-MM-DD")}`):y);return t.endDate&&(f=f.max(new Date(t.endDate),a("End Date cannot be after Programme End Date"))),u&&(f=f.required(a("End Date is required"))),f},x=Q.object().shape({title:Q.string().required(a("Programme Cycle title is required")).min(2,a("Too short")).max(150,a("Too long")),startDate:Q.date().required(a("Start Date is required")).min(t.startDate,a("Start Date cannot be before Programme Start Date")),endDate:g()});return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{onClick:()=>{i(!0)},color:"primary","data-cy":"button-edit-program-cycle",children:e.jsx(Ha,{})}),e.jsx(is,{open:n,onClose:()=>i(!1),scroll:"paper",children:e.jsx(B.Formik,{initialValues:m,onSubmit:h,validationSchema:x,children:({submitForm:f})=>e.jsxs(e.Fragment,{children:[n&&e.jsx(Bs,{}),e.jsx(Ye,{children:e.jsx(Le,{children:a("Edit Programme Cycle")})}),e.jsxs(Be,{children:[e.jsx(pt,{children:e.jsx(it,{children:a("Change details of the Programme Cycle")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"title",fullWidth:!0,variant:"outlined",label:a("Programme Cycle Title"),component:Se,required:!0})}),e.jsx(p,{size:{xs:6},"data-cy":"start-date-cycle",children:e.jsx(B.Field,{name:"startDate",label:a("Start Date"),component:jt,required:!0,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"})})}),e.jsx(p,{size:{xs:6},"data-cy":"end-date-cycle",children:e.jsx(B.Field,{name:"endDate",label:a("End Date"),component:jt,required:u,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"})})})]})]}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>{i(!1)},"data-cy":"button-cancel",children:a("CANCEL")}),e.jsx(ke,{loading:c,color:"primary",variant:"contained",onClick:f,"data-cy":"button-save",children:a("Save")})]})})]})})})]})},Z_=oe(J_,"EditProgramCycle"),eP=[{id:"title",numeric:!1,disablePadding:!1,label:"Programme Cycle Title",dataCy:"head-cell-programme-cycle-title"},{id:"status",numeric:!1,disablePadding:!1,label:"Status",dataCy:"head-cell-status"},{id:"total_entitled_quantity_usd",numeric:!0,disablePadding:!1,label:"Total Entitled Quantity (USD)",disableSort:!0,dataCy:"head-cell-total-entitled-quantity_usd"},{id:"total_undelivered_quantity_usd",numeric:!0,disablePadding:!1,label:"Total Undelivered Quantity (USD)",disableSort:!0,dataCy:"head-cell-total-undelivered-quantity_usd"},{id:"total_delivered_quantity_usd",numeric:!0,disablePadding:!1,label:"Total Delivered Quantity (USD)",disableSort:!0,dataCy:"head-cell-total-delivered-quantity_usd"},{id:"startDate",numeric:!1,disablePadding:!1,label:"Start Date",dataCy:"head-cell-start-date"},{id:"end_date",numeric:!1,disablePadding:!1,label:"End Date",dataCy:"head-cell-end-date"},{id:"empty",numeric:!1,disablePadding:!1,label:"",disableSort:!0,dataCy:"head-cell-empty"}],sP=({program:s,onClose:t,onSubmit:a,step:n})=>{const{t:i}=M(),{businessArea:r}=U(),l=Fe(),{showMessage:o}=Ae();let d=Q.date().min(ta,i("End Date cannot be in the past")).when("startDate",([f],j)=>f?j.min(new Date(f),`${i("End date have to be greater than")} ${fs(f).format("YYYY-MM-DD")}`):j);s.endDate&&(d=d.max(new Date(s.endDate),i("End Date cannot be after Programme End Date")));const c=Q.object().shape({title:Q.string().required(i("Programme Cycle Title is required")).min(2,i("Too short")).max(150,i("Too long")),startDate:Q.date().required(i("Start Date is required")).min(s.startDate,i("Start Date cannot be before Programme Start Date")),endDate:d}),u={title:"",startDate:void 0,endDate:void 0},{mutateAsync:h,isPending:m,error:g}=xe({mutationFn:async f=>N.restBusinessAreasProgramsCyclesCreate({businessAreaSlug:r,programSlug:s.slug,requestBody:f}),onSuccess:async()=>{await l.invalidateQueries({queryKey:["programCycles"],exact:!1}),a()}}),x=async f=>{try{await h({title:f.title,startDate:f.startDate,endDate:f.endDate}),o(i("Programme Cycle Created"))}catch(j){fe(j,o)}};return e.jsx(B.Formik,{initialValues:u,validationSchema:c,onSubmit:x,children:({submitForm:f})=>e.jsx(B.Form,{children:e.jsxs(e.Fragment,{children:[e.jsx(Ye,{children:e.jsx(Le,{children:e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(P,{children:i("Add New Programme Cycle")}),n&&e.jsx(P,{children:n})]})})}),e.jsxs(Be,{children:[e.jsx(pt,{children:e.jsx(it,{children:i("Enter data for the new Programme Cycle")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsxs(p,{size:12,children:[e.jsx(B.Field,{name:"title",fullWidth:!0,variant:"outlined",label:i("Programme Cycle Title"),component:Se,required:!0}),g?.data?.title&&e.jsx(Ls,{error:!0,children:g.data.title})]}),e.jsxs(p,{size:6,"data-cy":"start-date-cycle",children:[e.jsx(B.Field,{name:"startDate",label:i("Start Date"),component:jt,required:!0,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"})}),g?.data?.startDate&&e.jsx(Ls,{error:!0,children:g.data.startDate})]}),e.jsxs(p,{size:6,"data-cy":"end-date-cycle",children:[e.jsx(B.Field,{name:"endDate",label:i("End Date"),component:jt,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"})}),g?.data?.endDate&&e.jsx(Ls,{error:!0,children:g.data.endDate})]})]})]}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{"data-cy":"button-cancel",onClick:t,children:i("CANCEL")}),e.jsx(ke,{loading:m,color:"primary",variant:"contained",onClick:f,"data-cy":"button-create-program-cycle",children:i("CREATE")})]})})]})})})},ud=oe(sP,"CreateProgramCycle"),tP=({program:s,programCycle:t,onClose:a,onSubmit:n,step:i})=>{const{t:r}=M(),{businessArea:l}=U(),{showMessage:o}=Ae();let d=Q.date().required(r("End Date is required")).min(ta,r("End Date cannot be in the past")).when("startDate",([x],f)=>x?f.min(new Date(x),`${r("End date have to be greater than")} ${fs(x).format("YYYY-MM-DD")}`):f);s.endDate&&(d=d.max(new Date(s.endDate),r("End Date cannot be after Programme End Date")));const c=Q.object().shape({endDate:d}),u={id:t.id,title:t.title,startDate:t.startDate,endDate:t.endDate},{mutateAsync:h,isPending:m}=xe({mutationFn:({businessAreaSlug:x,id:f,programSlug:j,requestBody:y})=>N.restBusinessAreasProgramsCyclesUpdate({businessAreaSlug:x,id:f,programSlug:j,requestBody:y}),onSuccess:()=>{n()}}),g=async x=>{try{await h({businessAreaSlug:l,id:t.id,programSlug:s.slug??s.id,requestBody:{title:x.title,startDate:x.startDate,endDate:x.endDate}}),o(r("Programme Cycle Updated"))}catch(f){fe(f,o)}};return e.jsx(B.Formik,{initialValues:u,validationSchema:c,onSubmit:g,children:({submitForm:x,values:f})=>e.jsxs(B.Form,{children:[e.jsx(Ye,{children:e.jsx(Le,{children:e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(P,{children:r("Add New Programme Cycle")}),i&&e.jsx(P,{children:i})]})})}),e.jsxs(Be,{children:[e.jsx(pt,{children:e.jsx(it,{children:r("Before you create a new Cycle, it is necessary to specify the end date of the existing Cycle")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:6,children:e.jsx(L,{"data-cy":"previous-program-cycle-title",label:r("Programme Cycle Title"),children:f.title})}),e.jsx(p,{size:6,children:e.jsx(L,{"data-cy":"previous-program-cycle-start-date",label:r("Start Date"),children:f.startDate})}),e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"endDate",label:r("End Date"),component:jt,required:!0,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"}),"data-cy":"input-previous-program-cycle-end-date"})})]})]}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{"data-cy":"button-cancel",onClick:a,children:r("CANCEL")}),e.jsx(ke,{loading:m,color:"primary",variant:"contained",onClick:x,"data-cy":"button-update-program-cycle-modal",children:r("NEXT")})]})})]})})},aP=oe(tP,"UpdateProgramCycle"),nP=({lastProgramCycle:s})=>{const{t}=M(),[a,n]=A.useState(!1),[i,r]=A.useState(0),l=Fe(),{businessArea:o}=U(),d=ve(),{selectedProgram:c}=Z(),{data:u}=V({queryKey:["program",o,c.slug],queryFn:()=>N.restBusinessAreasProgramsRetrieve({businessAreaSlug:o,slug:c.slug})});if(!u)return null;const h=c.status===ht.ACTIVE&&K(R.PM_PROGRAMME_CYCLE_CREATE,d),m=async()=>{await l.invalidateQueries({queryKey:["programCycles"],exact:!1}),n(!1),r(0)},g=()=>{r(i+1)},x=()=>{n(!1),r(0)},f=[];return s?.endDate?f.push(e.jsx(ud,{program:u,onClose:m,onSubmit:x},"createProgramCycle")):(f.push(e.jsx(aP,{program:u,programCycle:s,onClose:m,onSubmit:g,step:"1/2"},"updateProgramCycle")),f.push(e.jsx(ud,{program:u,onClose:m,onSubmit:x,step:"2/2"},"createProgramCycle"))),e.jsxs(e.Fragment,{children:[e.jsx(Vs,{variant:"outlined",color:"primary",startIcon:e.jsx(pa,{}),onClick:()=>n(!0),"data-cy":"button-add-new-programme-cycle",disabled:!h,title:"Require active programme and all cycles need to have an end date",children:t("ADD NEW PROGRAMME CYCLE")}),e.jsx(is,{open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:f.map((j,y)=>{if(y===i)return j})})]})},$u=oe(nP,"AddNewProgramCycle"),iP=({program:s})=>{const[t,a]=A.useState(0),[n,i]=A.useState({offset:0,limit:5,ordering:"created_at",page:t});Js.useEffect(()=>{i(y=>({...y,page:t}))},[t]);const{businessAreaSlug:r,baseUrl:l,programId:o}=U(),d=ve(),{data:c,error:u,isLoading:h}=V({queryKey:["programCycles",r,s.slug,n],queryFn:()=>N.restBusinessAreasProgramsCyclesList(Ce({businessAreaSlug:r,programSlug:s.slug},n,{withPagination:!0}))}),{data:m}=V({queryKey:["businessAreasProgramsCyclesCountRetrieve",s.slug,r,n],queryFn:()=>N.restBusinessAreasProgramsCyclesCountRetrieve(Ce({businessAreaSlug:r,programSlug:s.slug},n)),enabled:t===0}),g=vs(t,m),x=o!=="all",f=y=>{const b=`/${l}/payment-module/program-cycles/${y.id}`,C=(y.status==="Draft"||y.status==="Active")&&K(R.PM_PROGRAMME_CYCLE_UPDATE,d),v=K(R.PM_PROGRAMME_CYCLE_DELETE,d);return e.jsxs(rs,{"data-cy":"program-cycle-row",children:[e.jsx(_,{"data-cy":"program-cycle-title",children:x?e.jsx(me,{to:b,children:y.title}):y.title}),e.jsx(_,{"data-cy":"program-cycle-status",children:e.jsx(we,{status:y.status,statusToColor:vl})}),e.jsx(_,{align:"right","data-cy":"program-cycle-total-entitled-quantity-usd",children:y.totalEntitledQuantityUsd?Qe(y.totalEntitledQuantityUsd):"-"}),e.jsx(_,{align:"right","data-cy":"program-cycle-total-undelivered-quantity-usd",children:y.totalUndeliveredQuantityUsd?Qe(y.totalUndeliveredQuantityUsd):"-"}),e.jsx(_,{align:"right","data-cy":"program-cycle-total-delivered-quantity-usd",children:y.totalDeliveredQuantityUsd?Qe(y.totalDeliveredQuantityUsd):"-"}),e.jsx(_,{"data-cy":"program-cycle-start-date",children:e.jsx(pe,{children:y.startDate})}),e.jsx(_,{"data-cy":"program-cycle-end-date",children:e.jsx(pe,{children:y.endDate})}),e.jsx(_,{"data-cy":"program-cycle-details-btn",children:s.status==="ACTIVE"&&e.jsxs(e.Fragment,{children:[C&&e.jsx(Z_,{program:s,programCycle:y}),y.canRemoveCycle&&v&&e.jsx(X_,{program:s,programCycle:y})]})})]},y.id)};if(h)return null;const j=[e.jsx($u,{lastProgramCycle:(c?.results||[])[(c?.results||[]).length-1]},"add-new")];return e.jsx(ds,{title:"Programme Cycles",renderRow:f,headCells:eP,data:c,error:u,isLoading:h,queryVariables:n,setQueryVariables:i,actions:j,itemsCount:g,page:t,setPage:a})},rP=oe(iP,"ProgramCyclesTableProgramDetails"),lP=ut(bc)(()=>({".MuiPaper-root":{border:"1px solid #d3d4d5"}})),hd=ut(de)(({theme:s})=>({"&:focus":{backgroundColor:s.palette.primary.main,"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:s.palette.common.white}}})),Uu=({program:s})=>{const{t}=M(),a=ge(),{baseUrl:n}=U(),[i,r]=A.useState(null),l=c=>{r(c.currentTarget)},o=()=>{r(null)},d=c=>{a(`/${n}/edit/${s.slug}`,{state:{option:c}})};return e.jsxs(e.Fragment,{children:[e.jsx(H,{"aria-controls":"customized-menu","aria-haspopup":"true",variant:"outlined",color:"primary",onClick:l,startIcon:e.jsx(Ha,{}),endIcon:i?e.jsx(Dn,{}):e.jsx(Tn,{}),"data-cy":"button-edit-program",children:t("Edit Programme")}),e.jsxs(lP,{id:"customized-menu",anchorEl:i,keepMounted:!0,open:!!i,onClose:o,children:[e.jsx(hd,{"data-cy":"menu-item-edit-details",children:e.jsx(ia,{"data-cy":"menu-item-edit-details-text",onClick:()=>d("details"),primary:t("Edit Programme Details")})}),e.jsx(hd,{"data-cy":"menu-item-edit-partners",children:e.jsx(ia,{"data-cy":"menu-item-edit-partners-text",onClick:()=>d("partners"),primary:t("Edit Programme Partners")})})]})]})};function Wl({program:s}){const{baseUrl:t}=U();return e.jsx(Ve,{component:ys,to:`/${t}/duplicate/${s.slug}`,"data-cy":"button-copy-program",children:e.jsx(Ri,{})})}function oP({program:s}){const t=ge(),{t:a}=M(),n=Fe(),[i,r]=A.useState(!1),{showMessage:l}=Ae(),{baseUrl:o,businessArea:d}=U(),{selectedProgram:c,setSelectedProgram:u}=Z(),{mutateAsync:h,isPending:m}=xe({mutationFn:()=>N.restBusinessAreasProgramsFinishCreate({businessAreaSlug:d,slug:s.slug}),onSuccess:()=>{n.invalidateQueries({queryKey:["program",d,s.slug]})}}),g=async()=>{try{await h(),u({...c,status:ht.FINISHED}),l(a("Programme finished.")),t(`/${o}/details/${s.slug}`),r(!1)}catch(x){fe(x,l,a("Failed to finish programme."))}};return e.jsxs("span",{children:[e.jsx(H,{color:"primary",onClick:()=>r(!0),"data-cy":"button-finish-program",children:a("Finish Programme")}),e.jsxs(is,{open:i,onClose:()=>r(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Finish Programme")})}),e.jsx(Be,{children:e.jsx(pt,{children:a("Are you sure you want to finish this Programme?")})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>r(!1),children:a("CANCEL")}),e.jsx(ke,{loading:m,type:"submit",color:"primary",variant:"contained",onClick:g,"data-cy":"button-finish-program",children:a("FINISH")})]})})]})]})}function dP({program:s,canFinish:t,canEdit:a,canDuplicate:n}){return e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(P,{m:2,children:e.jsx(oP,{program:s})}),a&&e.jsx(P,{m:2,children:e.jsx(Uu,{program:s})}),n&&e.jsx(P,{m:2,children:e.jsx(Wl,{program:s})})]})}const cP=({program:s})=>{const{t}=M(),[a,n]=A.useState(!1),{showMessage:i}=Ae(),{businessArea:r}=U(),{selectedProgram:l,setSelectedProgram:o}=Z(),d=Fe(),{mutateAsync:c,isPending:u}=xe({mutationFn:()=>N.restBusinessAreasProgramsActivateCreate({businessAreaSlug:r,slug:s.slug}),onSuccess:()=>{o({...l,status:ht.ACTIVE}),i(t("Programme activated.")),d.invalidateQueries({queryKey:["program",r,s.slug]}),n(!1)},onError:m=>{fe(m,i,t("Programme activate action failed."))}}),h=async()=>{await c()};return e.jsxs("span",{children:[e.jsx(H,{variant:"contained",color:"primary",onClick:()=>n(!0),"data-cy":"button-activate-program","data-perm":R.PROGRAMME_ACTIVATE,children:"Activate"}),e.jsxs(is,{open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Activate Programme")})}),e.jsx(Be,{children:e.jsxs(pt,{children:[t("Are you sure you want to activate this Programme?"),e.jsx("br",{}),t("Upon activation of this Programme, default Programme Cycles will be created.")]})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{"data-cy":"button-cancel",onClick:()=>n(!1),children:t("CANCEL")}),e.jsx(ke,{loading:u,type:"submit",color:"primary",variant:"contained",onClick:h,"data-cy":"button-activate-program-modal","data-perm":R.PROGRAMME_ACTIVATE,children:t("ACTIVATE")})]})})]})]})},uP=T(H)`
  && {
    color: ${({theme:s})=>s.palette.error.main};
  }
`,hP=T(H)`
  && {
    background-color: ${({theme:s})=>s.palette.error.main};
  }
  &&:hover {
    background-color: ${({theme:s})=>s.palette.error.dark};
  }
`,mP=T(is)`
  .MuiDialog-paperWidthSm {
    min-width: ${({theme:s})=>s.spacing(120)};
  }
`,pP=({program:s})=>{const t=ge(),{t:a}=M(),[n,i]=A.useState(!1),{showMessage:r}=Ae(),{businessArea:l,programId:o}=U(),d=Fe(),{mutateAsync:c,isPending:u}=xe({mutationFn:()=>N.restBusinessAreasProgramsDestroy({businessAreaSlug:l,slug:s.slug}),onSuccess:async()=>{await d.invalidateQueries({queryKey:["businessAreasProgramsList",l,o]}),r(a("Programme removed")),t(`/${l}/programs/all/list`)},onError:h=>{h.message&&h.message.includes("Unexpected end of JSON input")?(r(a("Programme removed")),t(`/${l}/programs/all/list`)):fe(h,r)}});return e.jsxs("span",{children:[e.jsx(uP,{startIcon:e.jsx(im,{}),onClick:()=>i(!0),"data-cy":"button-remove-program",children:a("REMOVE")}),e.jsxs(mP,{open:n,onClose:()=>i(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Remove Programme")})}),e.jsx(Be,{children:e.jsx(pt,{children:a("Are you sure you want to remove this Programme?")})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{"data-cy":"button-cancel",onClick:()=>i(!1),children:a("CANCEL")}),e.jsx(hP,{type:"submit",color:"primary",variant:"contained",disabled:u,onClick:()=>c(),"data-cy":"button-remove-program","data-perm":R.PROGRAMME_REMOVE,children:a("REMOVE")})]})})]})]})};function gP({program:s,canRemove:t,canEdit:a,canActivate:n,canDuplicate:i}){return e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(P,{m:2,children:e.jsx(pP,{program:s})}),a&&e.jsx(P,{m:2,children:e.jsx(Uu,{program:s})}),n&&e.jsx(P,{m:2,children:e.jsx(cP,{program:s})}),i&&e.jsx(P,{m:2,children:e.jsx(Wl,{program:s})})]})}function xP({program:s}){const{t}=M(),[a,n]=A.useState(!1),{showMessage:i}=Ae(),{businessAreaSlug:r}=U(),{selectedProgram:l,setSelectedProgram:o}=Z(),d=Fe(),{mutate:c,isPending:u}=xe({mutationFn:async()=>N.restBusinessAreasProgramsActivateCreate({businessAreaSlug:r,slug:s.slug}),onSuccess:()=>{o({...l,status:ht.ACTIVE}),d.invalidateQueries({queryKey:["program",r,s.slug]}),i(t("Programme reactivated.")),n(!1)},onError:m=>{fe(m,i)}}),h=()=>{c()};return e.jsxs("span",{children:[e.jsx(H,{"data-cy":"button-reactivate-program",variant:"outlined",color:"primary",onClick:()=>n(!0),children:t("Reactivate")}),e.jsxs(is,{open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Reactivate Programme")})}),e.jsx(Be,{children:e.jsx(pt,{children:t("Are you sure you want to reactivate this Programme?")})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{"data-cy":"button-cancel",onClick:()=>n(!1),children:t("CANCEL")}),e.jsx(ke,{loading:u,type:"submit",color:"primary",variant:"contained",onClick:h,"data-cy":"button-reactivate-program-popup",children:t("REACTIVATE")})]})})]})]})}function fP({program:s,canActivate:t,canDuplicate:a}){return e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(P,{m:2,children:e.jsx(xP,{program:s})}),a&&e.jsx(P,{m:2,children:e.jsx(Wl,{program:s})})]})}function yP({program:s,canActivate:t,canEdit:a,canRemove:n,canFinish:i,canDuplicate:r}){let l;const{t:o}=M(),{baseUrl:d,isAllPrograms:c}=U();switch(s.status){case ht.ACTIVE:l=e.jsx(dP,{program:s,canFinish:i,canEdit:a,canDuplicate:r});break;case ht.DRAFT:l=e.jsx(gP,{program:s,canRemove:n,canEdit:a,canActivate:t,canDuplicate:r});break;default:l=e.jsx(fP,{program:s,canActivate:t,canDuplicate:r})}const u=[];return c&&u.unshift({title:o("Programme Management"),to:`/${d}/list/`}),e.jsx(Ze,{title:s.name,breadCrumbs:u,flags:e.jsx(gt,{adminUrl:s.adminUrl}),children:l})}const bP=T.div`
  && {
    display: flex;
    flex-direction: column;
    min-width: 100%;
  }
`,jP=T.div`
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  padding: 20px 20px 0;
`,AP=T.div`
  margin-top: 120px;
`,_P=T.div`
  color: rgba(0, 0, 0, 0.38);
  font-size: 24px;
  line-height: 28px;
  text-align: center;
`;function PP(){const{t:s}=M(),{id:t}=ts(),{businessArea:a}=U(),{data:n,isLoading:i,error:r}=V({queryKey:["program",a,t],queryFn:()=>N.restBusinessAreasProgramsRetrieve({businessAreaSlug:a,slug:t})}),{data:l,isLoading:o}=V({queryKey:["businessArea",a],queryFn:()=>N.restBusinessAreasRetrieve({slug:a})}),{data:d,isLoading:c}=V({queryKey:["programChoices",a],queryFn:()=>N.restBusinessAreasProgramsChoicesRetrieve({businessAreaSlug:a}),staleTime:1e3*60*10,gcTime:1e3*60*30}),u=ve();if(i||c||o)return e.jsx(Ne,{});if(rt(r))return e.jsx(Xe,{permission:R.PROGRAMME_VIEW_LIST_AND_DETAILS});if(!d||!l||u===null)return null;const h=K(R.PROGRAMME_FINISH,u);return r?.message.includes("Not Found")?e.jsx(Gi,{errorMessage:"You are not authorized to view this program or the program does not exist."}):e.jsxs(e.Fragment,{children:[e.jsx(yP,{program:n,canActivate:K(R.PROGRAMME_ACTIVATE,u),canEdit:K(R.PROGRAMME_UPDATE,u),canRemove:K(R.PROGRAMME_REMOVE,u),canFinish:h,canDuplicate:K(R.PROGRAMME_DUPLICATE,u)}),e.jsxs(bP,{children:[e.jsx(K_,{program:n,choices:d}),n?.status===ht.DRAFT?e.jsx(AP,{children:e.jsx(_P,{children:s("Activate the Programme to create a Cycle")})}):e.jsx(jP,{children:e.jsx(rP,{program:n})}),K(R.ACTIVITY_LOG_VIEW,u)&&e.jsx(Lt,{objectId:n.id})]})]})}const CP=[{disablePadding:!1,label:"Name",id:"name",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Timeframe",id:"startDate",numeric:!1},{disablePadding:!1,label:"Sector",id:"sector",numeric:!1},{disablePadding:!1,label:"Programme Size",id:"number_of_households",numeric:!0,disableSort:!0},{disablePadding:!1,label:"Budget (USD)",id:"budget",numeric:!0}];function EP({program:s,choicesData:t}){const a=ge(),{baseUrl:n}=U(),i=`/${n}/details/${s.slug}`,r=()=>{a(i)},l=_s(t?.sectorChoices);return e.jsx(e.Fragment,{children:e.jsxs(rs,{hover:!0,onClick:r,role:"checkbox","data-cy":`table-row-${s.name}`,children:[e.jsx(_,{align:"left",children:e.jsx(me,{to:i,children:s.name})}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Pl})}),e.jsxs(_,{align:"left",children:[e.jsx(pe,{children:s.startDate})," -"," ",e.jsx(pe,{children:s.endDate})]}),e.jsx(_,{align:"left",children:l[s.sector]}),e.jsx(_,{align:"right",children:s.householdCount}),e.jsx(_,{align:"right",children:$c(Number(s.budget))})]},s.id)})}const vP=oe(EP,"ProgrammesTableRow");function SP({businessArea:s,filter:t,choicesData:a}){const{t:n}=M(),{programId:i,isAllPrograms:r}=U(),l=A.useMemo(()=>({businessAreaSlug:s,beneficiaryGroupMatch:r?"":i,compatibleDct:r?"":i,search:t.search,startDate:t.startDate||null,endDate:t.endDate||null,status:t.status!==""?t.status:void 0,sector:t.sector,numberOfHouseholdsMax:t.numberOfHouseholdsMax,numberOfHouseholdsMin:t.numberOfHouseholdsMin,budgetMax:t.budgetMax,budgetMin:t.budgetMin,dataCollectingType:t.dataCollectingType}),[s,i,r,t.search,t.startDate,t.endDate,t.status,t.sector,t.numberOfHouseholdsMin,t.numberOfHouseholdsMax,t.budgetMin,t.budgetMax,t.dataCollectingType]),[o,d]=A.useState(l);A.useEffect(()=>{d(l)},[l]);const[c,u]=A.useState(0),{data:h,isLoading:m,error:g}=V({queryKey:["businessAreasProgramsList",o,s,i],queryFn:()=>N.restBusinessAreasProgramsList(Ce({businessAreaSlug:s},o,{withPagination:!0})),enabled:!!o.businessAreaSlug}),{data:x}=V({queryKey:["businessAreasProgramsCount",s,o],queryFn:()=>N.restBusinessAreasProgramsCountRetrieve(Ce({businessAreaSlug:s},o)),enabled:c===0}),f=vs(c,x);return e.jsx(e.Fragment,{children:e.jsx(Es,{children:e.jsx(ds,{title:n("Programmes"),headCells:CP,queryVariables:o,setQueryVariables:d,data:h,isLoading:m,error:g,itemsCount:f,renderRow:j=>e.jsx(vP,{program:j,choicesData:a},j.id),page:c,setPage:u})})})}const IP=oe(SP,"ProgrammesTable");function DP({filter:s,choicesData:t,setFilter:a,initialFilter:n,appliedFilter:i,setAppliedFilter:r}){const l=ge(),o=je(),{handleFilterChange:d,applyFilterChanges:c,clearFilter:u}=Ss(n,l,o,s,a,i,r),h=()=>{c()},m=()=>{u()};return e.jsx(Ns,{clearHandler:m,applyHandler:h,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:2,children:e.jsx(Cs,{label:"Search",value:s.search,onChange:g=>d("search",g.target.value),"data-cy":"filters-search"})}),e.jsx(p,{size:2,children:e.jsx(He,{onChange:g=>d("status",g.target.value),label:"Status",value:s.status,"data-cy":"filters-status",children:t.statusChoices.map(g=>e.jsx(de,{value:g.value,children:g.name},g.value))})}),e.jsx(p,{size:2,children:e.jsx(ms,{label:"Start Date",dataCy:"filters-start-date",onChange:g=>d("startDate",g?fs(g).format("YYYY-MM-DD"):""),value:s.startDate})}),e.jsx(p,{size:2,children:e.jsx(ms,{label:"End Date",dataCy:"filters-end-date",onChange:g=>d("endDate",g?fs(g).format("YYYY-MM-DD"):""),value:s.endDate})}),e.jsx(p,{size:4,children:e.jsx(He,{onChange:g=>d("sector",g.target.value),label:"Sector",dataCy:"filters-sector",value:s.sector,multiple:!0,children:t.sectorChoices.map(g=>e.jsx(de,{value:g.value,children:g.name},g.value))})}),e.jsx(p,{size:2,children:e.jsx(js,{"data-cy":"filters-number-of-households-min",topLabel:"Programme Size",placeholder:"From",value:s.numberOfHouseholdsMin,onChange:g=>d("numberOfHouseholdsMin",g.target.value),icon:e.jsx(ct,{})})}),e.jsx(p,{size:2,children:e.jsx(js,{"data-cy":"filters-number-of-households-max",value:s.numberOfHouseholdsMax,placeholder:"To",onChange:g=>d("numberOfHouseholdsMax",g.target.value),icon:e.jsx(ct,{})})}),e.jsx(p,{size:2,children:e.jsx(js,{"data-cy":"filters-budget-min",topLabel:"Budget (USD)",value:s.budgetMin,placeholder:"From",onChange:g=>d("budgetMin",g.target.value)})}),e.jsx(p,{size:2,children:e.jsx(js,{"data-cy":"filters-budget-max",value:s.budgetMax,placeholder:"To",onChange:g=>d("budgetMax",g.target.value)})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:g=>d("dataCollectingType",g.target.value),label:"Data Collecting Type",value:s.dataCollectingType,"data-cy":"filters-data-collecting-type",children:t.dataCollectingTypeChoices.map(g=>e.jsx(de,{value:g.value,children:g.name},g.value))})})]})})}const TP=oe(DP,"ProgrammesFilters"),Pr={search:"",startDate:"",endDate:"",status:"",sector:[],numberOfHouseholdsMin:"",numberOfHouseholdsMax:"",budgetMin:"",budgetMax:"",dataCollectingType:""};function RP(){const s=je(),[t,a]=A.useState(Ke(s,Pr)),[n,i]=A.useState(Ke(s,Pr)),[r,l]=A.useState(!1),o=A.useRef(null);et(o,r,n,()=>l(!1));const{baseUrl:d,businessArea:c}=U(),u=ve(),{data:h}=V({queryKey:["programChoices",c],queryFn:()=>N.restBusinessAreasProgramsChoicesRetrieve({businessAreaSlug:c}),staleTime:1e3*60*10,gcTime:1e3*60*30}),{t:m}=M();if(!u||!h)return null;if(!K([R.PROGRAMME_VIEW_LIST_AND_DETAILS,R.PROGRAMME_MANAGEMENT_VIEW],u))return e.jsx(Xe,{permission:[R.PROGRAMME_VIEW_LIST_AND_DETAILS,R.PROGRAMME_MANAGEMENT_VIEW]});const g=e.jsx(Ze,{title:m("Programme Management"),children:e.jsx(H,{variant:"contained",color:"primary",component:ys,to:`/${d}/create`,"data-cy":"button-new-program","data-perm":R.PROGRAMME_CREATE,children:m("Create Programme")})});return e.jsxs(e.Fragment,{children:[K(R.PROGRAMME_CREATE,u)&&g,e.jsx(TP,{filter:t,choicesData:h,setFilter:a,initialFilter:Pr,appliedFilter:n,setAppliedFilter:x=>{i(x),l(!0)}}),e.jsx("div",{ref:o,children:e.jsx(IP,{businessArea:c,choicesData:h,filter:n})})]})}const FP=oe(RP,"ProgramsPage"),Vu=()=>oa([{path:"list",element:e.jsx(FP,{})},{path:"create",element:e.jsx(k_,{})},{path:"edit/:id",element:e.jsx(z_,{})},{path:"duplicate/:id",element:e.jsx($_,{})},{path:"details/:id",element:e.jsx(PP,{})}]),qn={baseURL:"/api/rest/",headers:{Accept:"application/json"},cache:new Map,buildParams(s={}){const t=new URLSearchParams;return Object.entries(s).forEach(([a,n])=>{if(typeof a!="string"||!/^[a-zA-Z0-9_-]+$/.test(a))throw new Error("Invalid parameter key");if(Array.isArray(n))n.forEach(i=>{if(typeof i!="string"&&typeof i!="number")throw new Error("Invalid parameter value");t.append(a,encodeURIComponent(i.toString()))});else{if(typeof n!="string"&&typeof n!="number")throw new Error("Invalid parameter value");t.append(a,encodeURIComponent(n.toString()))}}),t.toString()},async get(s,t={},a){const n=this.buildParams(t),i=s+(n?`?${n}`:""),r=this.cache.get(i),l={...this.headers};r&&r.etag&&(l["If-None-Match"]=r.etag);const o=await fetch(`${this.baseURL}${i}`,{headers:l});if(o.status===304)return r.data;if(!o.ok)throw new Error(`Error fetching data from ${s}`);if(s.includes("download")){const u=await o.blob(),h=window.URL.createObjectURL(u),m=document.createElement("a");m.href=h,m.download=a||s.split("/").pop()||"download",document.body.appendChild(m),m.click(),m.remove(),window.URL.revokeObjectURL(h);return}const d=o.headers.get("ETag"),c=await o.json();return d&&c!==void 0&&c!==null&&this.cache.set(i,{etag:d,data:c}),c},async post(s,t){const a=t instanceof FormData,n={method:"POST",headers:{...a?{}:{"Content-Type":"application/json"}},body:a?t:JSON.stringify(t)},i=await fetch(`${this.baseURL}${s}`,n);if(!i.ok){const l=Error(`Error posting data to ${s}`);try{l.data=await i.json()}catch{l.data=null}throw l}const r=await i.text();return r?{data:JSON.parse(r)}:{data:null}},async put(s,t={}){const a=await fetch(`${this.baseURL}${s}`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){const i=Error(`Error puting data to ${s}`);try{i.data=await a.json()}catch{i.data=null}throw i}const n=await a.text();return n?{data:JSON.parse(n)}:{data:null}},async delete(s){if(!(await fetch(`${this.baseURL}${s}`,{method:"DELETE",headers:{...this.headers,"Content-Type":"application/json"}})).ok)throw new Error(`Error deleting data from ${s}`)}},NP=async s=>{try{return await s}catch(t){throw console.error("API call failed:",t.message||t),new Error(`API call failed: ${t.message||"Unknown error"}`)}},Ji=(s,t)=>{const a=s?.message||"An unknown error occurred";throw new Error(`Failed to ${t}: ${a}`)},LP=async({businessAreaSlug:s,ids:t,action:a,comment:n})=>{const i={ids:t,action:a};n&&(i.comment=n);try{return(await qn.post(`business-areas/${s}/payments/payment-plans-managerial/bulk-action/`,i)).data}catch(r){Ji(r,"perform bulk action on payment plans")}},OP=async(s,t,a,n)=>{try{return await qn.delete(`business-areas/${s}/programs/${t}/payment-plans/${a}/supporting-documents/${n}/`),{success:!0}}catch(i){Ji(i,"delete supporting document")}},kP=async(s,t,a,n,i)=>{const r=new FormData;r.append("file",n),r.append("title",i);try{return(await qn.post(`business-areas/${s}/programs/${t}/payment-plans/${a}/supporting-documents/`,r)).data}catch(l){Ji(l,"upload supporting document")}},wP=async(s,t,a,n,i)=>NP(qn.get(`business-areas/${s}/programs/${t}/payment-plans/${a}/supporting-documents/${n}/download/`,{},i)),MP=T(gs)`
  min-width: 400px;
  max-width: 800px;
`,$P=T(is)`
  max-height: 800px;
`,UP=T.span`
  font-weight: bold;
`,Kl=({selectedPlansIds:s,selectedPlansUnicefIds:t,buttonTitle:a,dialogTitle:n,title:i,children:r,onSave:l,disabledSave:o})=>{const[d,c]=A.useState(!1),[u,h]=A.useState(""),{t:m}=M(),{isActiveProgram:g}=Z(),x=()=>e.jsx(H,{variant:"outlined",color:"primary",disabled:!s.length||!g,onClick:()=>c(!0),"data-cy":`${a.toLowerCase()}-button`,children:a}),f=async()=>{try{await l(s,u)}catch{}finally{c(!1)}};return e.jsxs(e.Fragment,{children:[x(),e.jsxs($P,{open:d,onClose:()=>c(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{id:"dialog-title",children:n})}),e.jsxs(Be,{children:[e.jsxs(P,{mt:2,mb:6,children:[e.jsx(ee,{children:i}),e.jsxs(ee,{children:[m("Selected Plans IDs"),":"," ",e.jsx(UP,{"data-cy":"plans-ids",children:t?.join(", ")})]}),e.jsx(P,{mt:4,children:e.jsx(ks,{size:"small",label:m("Comment"),value:u,onChange:j=>h(j.target.value),multiline:!0,inputProps:{maxLength:500},fullWidth:!0,"data-cy":`comment-${a.toLowerCase()}`})})]}),e.jsx(MP,{children:e.jsx(cs,{children:r})})]}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>{c(!1)},"data-cy":"button-cancel",children:m("CANCEL")}),e.jsx(H,{variant:"contained",color:"primary",onClick:f,disabled:o,"data-cy":"button-save",children:m("SAVE")})]})})]})]})},VP=({selectedPlansIds:s,selectedPlansUnicefIds:t,onApprove:a})=>{const{t:n}=M();return e.jsx(Kl,{selectedPlansIds:s,selectedPlansUnicefIds:t,buttonTitle:n("Approve"),dialogTitle:n("Approve Payment Plans"),title:n("Are you sure you want to approve these Payment Plans?"),onSave:a})},Zi=({selectedProgram:s,setSelectedProgram:t,programs:a,dataCy:n})=>{const i=r=>{t(r.target.value)};return a.length===0?e.jsx("div",{children:"Programme"}):e.jsxs(at,{value:s,onChange:i,displayEmpty:!0,fullWidth:!0,"data-cy":n,size:"small",renderValue:r=>r||"Programme",endAdornment:s!==""&&e.jsx(dt,{position:"end",children:e.jsx(P,{mr:2,children:e.jsx(Ve,{size:"small",onClick:r=>{r.stopPropagation(),t("")},children:e.jsx(Ct,{})})})}),children:[e.jsx(de,{value:"",children:e.jsx("em",{children:"Programme"})}),a.map(r=>e.jsx(de,{value:r,children:r},r))]})},er=({initialSortField:s,initialSortDirection:t})=>{const[a,n]=A.useState(s),[i,r]=A.useState(t),[l,o]=A.useState("");return{sortField:a,sortDirection:i,selectedProgram:l,setSelectedProgram:o,handleSort:m=>{const g=a===m&&i==="asc"?"desc":"asc";n(m),r(g)},handleProgramChange:m=>{o(m.target.value)},sortRows:m=>[...m].sort((g,x)=>g[a]<x[a]?i==="asc"?-1:1:g[a]>x[a]?i==="asc"?1:-1:0),filterRows:(m,g,x,f)=>m.filter(j=>f.some(y=>l!==""&&j.program!==l?!1:y.field==="program"?j[y.field]===l||l==="":y.field===g?fs(j[y.field]).format("D MMMM YYYY").toLowerCase().includes(x.toLowerCase()):j[y.field]?.toString().toLowerCase().includes(x.toLowerCase())))}},BP=({selectedApproved:s,setSelectedApproved:t,handleSelect:a,handleSelectAll:n,inApprovalData:i,bulkAction:r,enableSearch:l=!1})=>{const{t:o}=M(),{businessArea:d}=U(),{showMessage:c}=Ae(),[u,h]=A.useState(""),{sortField:m,sortDirection:g,selectedProgram:x,setSelectedProgram:f,handleSort:j,sortRows:y,filterRows:b}=er({initialSortField:null,initialSortDirection:"asc"}),C=()=>{const k=i.results.map($=>$.id);n(k,s,t)},v=i?.results?.reduce((k,$)=>(k.includes($.program)||k.push($.program),k),[]),S=i?.results?.every(k=>s.includes(k.id)),I=i?.results.filter(k=>s.includes(k.id)).map(k=>k.unicefId),E=[{field:"unicefId",headerName:o("Payment Plan ID"),width:200,renderCell:k=>e.jsx(me,{to:`/${d}/programs/${k.row.programSlug}/payment-module/${k.row.isFollowUp?"followup-payment-plans":"payment-plans"}/${k.row.id}`,newTab:!0,children:k.value})},{field:"program",headerName:o("Programme Name"),width:200},{field:"lastApprovalProcessDate",headerName:o("Last Modified Date"),width:200,renderCell:k=>e.jsx(pe,{children:k.value})},{field:"lastApprovalProcessBy",headerName:o("Sent for Approval by"),width:200}],D=b(i?.results||[],"lastApprovalProcessDate",u,E),F=y(D),w=o("Payment Plans pending for Approval"),O=e.jsxs(e.Fragment,{children:[l&&e.jsx(ks,{label:"Search",value:u,"data-cy":"search-approval",size:"small",onChange:k=>h(k.target.value),slotProps:{input:{startAdornment:e.jsx(dt,{position:"start",children:e.jsx(Pa,{})})}}}),e.jsx(VP,{selectedPlansIds:s,selectedPlansUnicefIds:I,onApprove:async(k,$)=>{try{await r.mutateAsync({ids:s,action:"APPROVE",comment:$}),c(o("Payment Plan(s) Approved")),t([])}catch(G){fe(G,c)}}})]});return e.jsx(st,{title:w,buttons:O,children:e.jsxs(gs,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{padding:"checkbox",style:{width:"10%"},children:e.jsx(P,{sx:{flex:1},children:e.jsx(ns,{"data-cy":"select-all-approval",checked:S&&s.length>0,onClick:C})})}),E.map(k=>e.jsx(_,{children:k.field==="program"?e.jsx(Zi,{dataCy:"program-select-approval",selectedProgram:x,setSelectedProgram:f,programs:v}):e.jsx(kn,{active:m===k.field,direction:g,onClick:()=>j(k.field),children:k.headerName})},k.field))]})}),e.jsx(cs,{children:F.map(k=>e.jsxs(be,{children:[e.jsx(_,{padding:"checkbox",children:e.jsx(ns,{"data-cy":"select-approval",checked:s.includes(k.id),onChange:()=>a(s,t,k.id)})}),E.map($=>e.jsx(_,{"data-cy":"column-field",align:"left",children:$.renderCell?$.renderCell({value:k[$.field],row:k}):k[$.field]},$.field))]},k.id))})]})})},GP=({selectedPlansIds:s,selectedPlansUnicefIds:t,onAuthorize:a})=>{const{t:n}=M();return e.jsx(Kl,{selectedPlansIds:s,selectedPlansUnicefIds:t,buttonTitle:n("Authorize"),dialogTitle:n("Authorize Payment Plans"),title:n("Are you sure you want to authorize these Payment Plans?"),onSave:a})},zP=({selectedAuthorized:s,setSelectedAuthorized:t,handleSelect:a,handleSelectAll:n,inAuthorizationData:i,bulkAction:r,enableSearch:l=!1})=>{const{t:o}=M(),{businessArea:d}=U(),{showMessage:c}=Ae(),[u,h]=A.useState(""),{sortField:m,sortDirection:g,selectedProgram:x,setSelectedProgram:f,handleSort:j,sortRows:y,filterRows:b}=er({initialSortField:null,initialSortDirection:"asc"}),C=()=>{const k=i.results.map($=>$.id);n(k,s,t)},v=i?.results?.reduce((k,$)=>(k.includes($.program)||k.push($.program),k),[]),S=i?.results?.every(k=>s.includes(k.id)),I=i?.results.filter(k=>s.includes(k.id)).map(k=>k.unicefId),E=[{field:"unicefId",headerName:o("Payment Plan ID"),width:200,renderCell:k=>e.jsx(me,{to:`/${d}/programs/${k.row.programSlug}/payment-module/${k.row.isFollowUp?"followup-payment-plans":"payment-plans"}/${k.row.id}`,newTab:!0,children:k.value})},{field:"program",headerName:o("Programme Name"),width:200},{field:"lastApprovalProcessDate",headerName:o("Last Modified Date"),width:200,renderCell:k=>e.jsx(pe,{children:k.value})},{field:"lastApprovalProcessBy",headerName:o("Approved by"),width:200}],D=b(i?.results||[],"lastApprovalProcessDate",u,E),F=y(D),w=o("Payment Plans pending for Authorization"),O=e.jsxs(e.Fragment,{children:[l&&e.jsx(ks,{label:"Search",value:u,size:"small","data-cy":"search-authorization",onChange:k=>h(k.target.value),slotProps:{input:{startAdornment:e.jsx(dt,{position:"start",children:e.jsx(Pa,{})})}}}),e.jsx(GP,{selectedPlansIds:s,selectedPlansUnicefIds:I,onAuthorize:async(k,$)=>{try{await r.mutateAsync({ids:s,action:"AUTHORIZE",comment:$}),c(o("Payment Plan(s) Authorized")),t([])}catch(G){fe(G,c)}}})]});return e.jsx(st,{title:w,buttons:O,children:e.jsxs(gs,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{padding:"checkbox",style:{width:"10%"},children:e.jsx(P,{sx:{flex:1},children:e.jsx(ns,{checked:S&&s.length>0,onClick:C,"data-cy":"select-all-authorization"})})}),E.map(k=>e.jsx(_,{children:k.field==="program"?e.jsx(Zi,{selectedProgram:x,setSelectedProgram:f,programs:v,dataCy:"program-select-authorization"}):e.jsx(kn,{active:m===k.field,direction:g,onClick:()=>j(k.field),children:k.headerName})},k.field))]})}),e.jsx(cs,{children:F.map(k=>e.jsxs(be,{children:[e.jsx(_,{padding:"checkbox",children:e.jsx(ns,{checked:s.includes(k.id),onChange:()=>a(s,t,k.id),"data-cy":"select-authorization"})}),E.map($=>e.jsx(_,{align:"left","data-cy":"column-field-authorization",children:$.renderCell?$.renderCell({value:k[$.field],row:k}):k[$.field]},$.field))]},k.id))})]})})},qP=({selectedPlansIds:s,selectedPlansUnicefIds:t,onRelease:a})=>{const{t:n}=M();return e.jsx(Kl,{selectedPlansIds:s,selectedPlansUnicefIds:t,buttonTitle:n("Release"),dialogTitle:n("Release Payment Plans"),title:n("Are you sure you want to release these Payment Plans?"),onSave:a})},HP=({selectedInReview:s,setSelectedInReview:t,handleSelect:a,handleSelectAll:n,inReviewData:i,bulkAction:r,enableSearch:l=!1})=>{const{t:o}=M(),{businessArea:d}=U(),{showMessage:c}=Ae(),[u,h]=A.useState(""),{sortField:m,sortDirection:g,selectedProgram:x,setSelectedProgram:f,handleSort:j,sortRows:y,filterRows:b}=er({initialSortField:null,initialSortDirection:"asc"}),C=()=>{const k=i?.results?.map($=>$.id);n(k,s,t)},v=i?.results?.reduce((k,$)=>(k.includes($.program)||k.push($.program),k),[]),S=i?.results?.every(k=>s.includes(k.id)),I=i?.results.filter(k=>s.includes(k.id)).map(k=>k.unicefId),E=[{field:"unicefId",headerName:o("Payment Plan ID"),width:200,renderCell:k=>e.jsx(me,{to:`/${d}/programs/${k.row.programSlug}/payment-module/${k.row.isFollowUp?"followup-payment-plans":"payment-plans"}/${k.row.id}`,newTab:!0,children:k.value})},{field:"program",headerName:o("Programme Name"),width:200},{field:"lastApprovalProcessDate",headerName:o("Last Modified Date"),width:200,renderCell:k=>e.jsx(pe,{children:k.value})},{field:"lastApprovalProcessBy",headerName:o("Authorized by"),width:200}],D=b(i?.results||[],"lastApprovalProcessDate",u,E),F=y(D),w=o("Payment Plans pending for Release"),O=e.jsxs(e.Fragment,{children:[l&&e.jsx(ks,{label:"Search",value:u,size:"small",onChange:k=>h(k.target.value),"data-cy":"search-release",slotProps:{input:{startAdornment:e.jsx(dt,{position:"start",children:e.jsx(Pa,{})})}}}),e.jsx(qP,{selectedPlansIds:s,selectedPlansUnicefIds:I,onRelease:async(k,$)=>{try{await r.mutateAsync({ids:s,action:"REVIEW",comment:$}),c(o("Payment Plan(s) Released")),t([])}catch(G){fe(G,c)}}})]});return e.jsx(st,{title:w,buttons:O,children:e.jsxs(gs,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{padding:"checkbox",style:{width:"10%"},children:e.jsx(P,{sx:{flex:1},children:e.jsx(ns,{checked:S&&s.length>0,onClick:C,"data-cy":"select-all-release"})})}),E.map(k=>e.jsx(_,{children:k.field==="program"?e.jsx(Zi,{selectedProgram:x,setSelectedProgram:f,programs:v,dataCy:"program-select-release"}):e.jsx(kn,{active:m===k.field,direction:g,onClick:()=>j(k.field),children:k.headerName})},k.field))]})}),e.jsx(cs,{children:F.map(k=>e.jsxs(be,{children:[e.jsx(_,{padding:"checkbox",children:e.jsx(ns,{checked:s.includes(k.id),onChange:()=>a(s,t,k.id),"data-cy":"select-release"})}),E.map($=>e.jsx(_,{align:"left","data-cy":"column-field-release",children:$.renderCell?$.renderCell({value:k[$.field],row:k}):k[$.field]},$.field))]},k.id))})]})})},WP=({releasedData:s})=>{const{t}=M(),{businessArea:a}=U(),[n,i]=A.useState(""),{sortField:r,sortDirection:l,selectedProgram:o,setSelectedProgram:d,handleSort:c,sortRows:u,filterRows:h}=er({initialSortField:null,initialSortDirection:"asc"}),m=s?.results?.reduce((b,C)=>(b.includes(C.program)||b.push(C.program),b),[]),g=[{field:"unicefId",headerName:t("Payment Plan ID"),width:200,renderCell:b=>e.jsx(me,{to:`/${a}/programs/${b.row.programSlug}/payment-module/${b.row.isFollowUp?"followup-payment-plans":"payment-plans"}/${b.row.id}`,newTab:!0,children:b.value})},{field:"program",headerName:t("Programme Name"),width:200},{field:"totalEntitledQuantityUsd",headerName:t("Total Entitled Quantity (USD)"),width:200,renderCell:b=>e.jsx(e.Fragment,{children:b.value||"-"})},{field:"lastApprovalProcessDate",headerName:t("Released on"),width:200,renderCell:b=>e.jsx(pe,{children:b.value})},{field:"lastApprovalProcessBy",headerName:t("Released by"),width:200},{field:"hasPaymentsReconciliationOverdue",headerName:t("Payments Reconciliation Overdue"),width:100,renderCell:b=>e.jsx(e.Fragment,{children:b.value?e.jsx("span",{style:{color:"red",fontWeight:600},children:"YES"}):""})}],x=h(s?.results||[],"lastApprovalProcessDate",n,g),f=u(x),j=t("Released Payment Plans"),y=e.jsx(ks,{label:"Search",value:n,size:"small",onChange:b=>i(b.target.value),"data-cy":"search-released",slotProps:{input:{startAdornment:e.jsx(dt,{position:"start",children:e.jsx(Pa,{})})}}});return e.jsx(st,{title:j,buttons:y,children:e.jsx(e.Fragment,{children:e.jsx(Ut,{children:e.jsxs(gs,{children:[e.jsx(hs,{children:e.jsx(be,{children:g.map(b=>e.jsx(_,{children:b.field==="program"?e.jsx(Zi,{selectedProgram:o,setSelectedProgram:d,programs:m,dataCy:"program-select-released"}):e.jsx(kn,{active:r===b.field,direction:l,onClick:()=>c(b.field),children:b.headerName})},b.field))})}),e.jsx(cs,{children:f.map(b=>e.jsx(be,{children:g.map(C=>e.jsx(_,{"data-cy":"column-field-released",children:C.renderCell?C.renderCell({value:b[C.field],row:b}):b[C.field]},C.field))},b.id))})]})})})})},Bu=()=>{const{t:s}=M(),{businessAreaSlug:t}=U(),[a,n]=A.useState([]),[i,r]=A.useState([]),[l,o]=A.useState([]),{showMessage:d}=Ae(),c=(G,W,Y)=>{G.includes(Y)?W(G.filter(X=>X!==Y)):W([...G,Y])},u=(G,W,Y)=>{let X;G.every(J=>W.includes(J))?X=[]:X=G,Y(X)},h=ve(),m=G=>N.restBusinessAreasPaymentsPaymentPlansManagerialList({businessAreaSlug:t,limit:1e4,offset:0,status:G}),{data:g,isLoading:x,refetch:f}=V({queryKey:["paymentPlansInApproval",t],queryFn:()=>m("IN_APPROVAL")}),{data:j,isLoading:y,refetch:b}=V({queryKey:["paymentPlansInAuthorization",t],queryFn:()=>m("IN_AUTHORIZATION")}),{data:C,isLoading:v,refetch:S}=V({queryKey:["paymentPlansInReview",t],queryFn:()=>m("IN_REVIEW")}),{data:I,isLoading:E,refetch:D}=V({queryKey:["paymentPlansReleased",t],queryFn:()=>m("ACCEPTED")}),F=xe({mutationFn:G=>LP({businessAreaSlug:t,ids:G.ids,action:G.action,comment:G.comment}),onSuccess:()=>{f(),b(),S(),D(),d(s("Action completed successfully"))}});if(x||y||v||E||!h)return e.jsx(Ne,{});const w=K("PM_ACCEPTANCE_PROCESS_APPROVE",h),O=K("PM_ACCEPTANCE_PROCESS_AUTHORIZE",h),k=K("PM_ACCEPTANCE_PROCESS_FINANCIAL_REVIEW",h),$=K("PAYMENT_VIEW_LIST_MANAGERIAL_RELEASED",h);return K(R.PAYMENT_VIEW_LIST_MANAGERIAL,h)?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:s("Managerial Console")}),w&&e.jsx(P,{mb:6,children:w&&e.jsx(P,{mb:6,children:e.jsx(BP,{selectedApproved:a,setSelectedApproved:n,handleSelect:c,handleSelectAll:u,inApprovalData:g,bulkAction:F})})}),O&&e.jsx(P,{mb:6,children:e.jsx(zP,{selectedAuthorized:i,setSelectedAuthorized:r,handleSelect:c,handleSelectAll:u,inAuthorizationData:j,bulkAction:F})}),k&&e.jsx(P,{mb:6,children:e.jsx(HP,{selectedInReview:l,setSelectedInReview:o,handleSelect:c,handleSelectAll:u,inReviewData:C,bulkAction:F})}),$&&e.jsx(WP,{releasedData:I})]}):e.jsx(Xe,{permission:R.PAYMENT_VIEW_LIST_MANAGERIAL})};oe(Bu,"ManagerialConsolePage");const Gu=()=>{const{businessArea:s}=U(),t=encodeURIComponent(s),a=`${window.location.origin}/api/rest/dashboard/${t}/`;return e.jsx("div",{style:{height:"100vh",width:"100%"},children:e.jsx("iframe",{src:a,style:{width:"100%",height:"100vh",border:"none"},title:"Dashboard"})})},KP=({hhData:s})=>{const{businessArea:t,baseUrl:a}=U(),{t:n}=M();return e.jsx(Ut,{component:us,sx:{mt:2},children:e.jsxs(gs,{size:"small",children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{children:n("Household ID")}),e.jsx(_,{children:n("Programme Name")})]})}),e.jsx(cs,{children:s.results&&s.results.length>0?s.results.map(i=>{const r=`/${t}/programs/${i.programSlug}/population/household/${i.id}`,l=`/${a}/details/${i.programSlug}`;return e.jsxs(be,{hover:!0,children:[e.jsx(_,{children:e.jsx(me,{to:r,children:i.unicefId})}),e.jsx(_,{children:e.jsx(me,{to:l,children:i.programName})})]},i.id)}):e.jsx(be,{children:e.jsx(_,{colSpan:1,children:n("No results found")})})})]})})},YP=({indData:s})=>{const{baseUrl:t,businessArea:a}=U(),{t:n}=M();return e.jsx(Ut,{component:us,sx:{mt:2},children:e.jsxs(gs,{size:"small",children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{children:n("Individual ID")}),e.jsx(_,{children:n("Household ID")}),e.jsx(_,{children:n("Programme Name")}),e.jsx(_,{children:n("Full Name")})]})}),e.jsx(cs,{children:s.results&&s.results.length>0?s.results.map(i=>{const r=`/${a}/programs/${i.program.slug}/population/individuals/${i.id}`,l=`/${a}/programs/${i.program.slug}/population/household/${i.household.id}`,o=`/${t}/details/${i?.program?.slug}`;return e.jsxs(be,{hover:!0,children:[e.jsx(_,{children:e.jsx(me,{to:r,children:i.unicefId})}),e.jsx(_,{children:e.jsx(me,{to:l,children:i?.household?.unicefId})}),e.jsx(_,{children:e.jsx(me,{to:o,children:i?.program?.name})}),e.jsx(_,{children:i.fullName})]},i.id)}):e.jsx(be,{children:e.jsx(_,{colSpan:2,children:n("No results found")})})})]})})},QP=({grvData:s})=>{const{baseUrl:t,businessArea:a}=U(),{t:n}=M();return e.jsx(Ut,{component:us,sx:{mt:2},children:e.jsxs(gs,{size:"small",children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{children:n("Ticket ID")}),e.jsx(_,{children:n("Status")}),e.jsx(_,{children:n("Category")}),e.jsx(_,{children:n("Issue Type")}),e.jsx(_,{children:n("Programme Name")}),e.jsx(_,{children:n("Household ID")}),e.jsx(_,{children:n("Individual ID")})]})}),e.jsx(cs,{children:s.results&&s.results.length>0?s.results.map(i=>{const r=$t(i.id,i.category,t),l=`/${a}/programs/${i.programs?.[0]?.slug}/population/individuals/${i.individualId}`,o=`/${a}/programs/${i.programs?.[0]?.slug}/population/household/${i.householdId}`,d=`/${t}/details/${i.programs?.[0]?.slug}`;return e.jsxs(be,{hover:!0,children:[e.jsx(_,{children:e.jsx(me,{to:r,children:i.unicefId})}),e.jsx(_,{children:Pp[i.status]}),e.jsx(_,{children:jl[i.category]}),e.jsx(_,{children:Oi[i.issueType]}),e.jsx(_,{children:e.jsx(me,{to:d,children:i.programs?.[0]?.name})}),e.jsx(_,{children:i?.householdUnicefId?e.jsx(me,{to:o,children:i?.householdUnicefId}):"-"}),e.jsx(_,{children:i?.individualUnicefId?e.jsx(me,{to:l,children:i?.individualUnicefId}):"-"})]},i.id)}):e.jsx(be,{children:e.jsx(_,{colSpan:4,children:n("No results found")})})})]})})},XP=({ppData:s})=>{const{baseUrl:t,businessArea:a}=U(),{t:n}=M();return e.jsx(Ut,{component:us,sx:{mt:2},children:e.jsxs(gs,{size:"small",children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{children:n("Payment Plan ID")}),e.jsx(_,{children:n("Programme Name")})]})}),e.jsx(cs,{children:s.results&&s.results.length>0?s.results.map(i=>{const r=`/${a}/programs/${i.program.slug}/payment-module/payment-plans/${i.id}`,l=`/${t}/details/${i.program.slug}`;return e.jsxs(be,{hover:!0,children:[e.jsx(_,{children:e.jsx(me,{to:r,children:i.unicefId})}),e.jsx(_,{children:e.jsx(me,{to:l,children:i.program.name})})]},i.id)}):e.jsx(be,{children:e.jsx(_,{colSpan:7,children:n("No results found")})})})]})})},JP=({paymentsData:s})=>{const{baseUrl:t,businessArea:a}=U(),{t:n}=M();return e.jsx(Ut,{component:us,sx:{mt:2},children:e.jsxs(gs,{size:"small",children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{children:n("Payment ID")}),e.jsx(_,{children:n("Programme Name")}),e.jsx(_,{children:n("Payment Plan ID")}),e.jsx(_,{children:n("Household ID")}),e.jsx(_,{children:n("Individual ID")}),e.jsx(_,{children:n("Individual Full Name")})]})}),e.jsx(cs,{children:s.results&&s.results.length>0?s.results.map(i=>{const r=`/${a}/programs/${i.programSlug}/payment-module/payments/${i.id}`,l=`/${t}/details/${i.programSlug}`,o=`/${a}/programs/${i.programSlug}/payment-module/payment-plans/${i.parentId}`,d=`/${a}/programs/${i.programSlug}/population/household/${i.householdId}`,c=`/${a}/programs/${i.programSlug}/population/individuals/${i.hohId}`;return e.jsxs(be,{hover:!0,children:[e.jsx(_,{children:e.jsx(me,{to:r,children:i.unicefId||i.id})}),e.jsx(_,{children:e.jsx(me,{to:l,children:i.programName})}),e.jsx(_,{children:e.jsx(me,{to:o,children:i.parentUnicefId})}),e.jsx(_,{children:e.jsx(me,{to:d,children:i.householdUnicefId})}),e.jsx(_,{children:i.hohId?e.jsx(me,{to:c,children:i.hohUnicefId}):null}),e.jsx(_,{children:i.hohFullName})]},i.id)}):e.jsx(be,{children:e.jsx(_,{colSpan:6,children:n("No results found")})})})]})})},ZP=()=>{const s=e.jsx(P,{mt:4,textAlign:"center",children:e.jsx(ee,{variant:"h6",children:"No results found. Please adjust your search criteria and try again."})}),{t}=M(),a=je(),n=ge(),{businessArea:i}=U(),r=ve(),{selectedProgram:l}=Z(),o=l?.beneficiaryGroup,d=K(R.POPULATION_VIEW_HOUSEHOLDS_LIST,r),c=K(R.POPULATION_VIEW_INDIVIDUALS_LIST,r),u=K(R.GRIEVANCES_FEEDBACK_VIEW_LIST,r),h=K(R.PM_VIEW_LIST,r),m=K(R.PM_VIEW_PAYMENT_LIST,r),g={searchFor:"",basedOnId:"",officeSearch:"",activePrograms:!1},[x,f]=A.useState(Ke(a,g)),[j,y]=A.useState(Ke(a,g)),{handleFilterChange:b,applyFilterChanges:C,clearFilter:v}=Ss(g,n,a,x,f,j,y),S=()=>{C()},I=()=>{v()},E={businessAreaSlug:i,officeSearch:j.officeSearch,activeProgramsOnly:j.activePrograms?"true":void 0},D={businessAreaSlug:i,officeSearch:j.officeSearch,activeProgramsOnly:j.activePrograms?"true":void 0},F={businessAreaSlug:i,officeSearch:j.officeSearch,activeProgramsOnly:j.activePrograms?"true":void 0},w={businessAreaSlug:i,officeSearch:j.officeSearch,activeProgramsOnly:j.activePrograms?"true":void 0},O={businessAreaSlug:i,officeSearch:j.officeSearch,activeProgramsOnly:j.activePrograms?"true":void 0},{data:k,isLoading:$,error:G}=V({queryKey:["businessAreasHouseholdsList",E,i,j.officeSearch,j.activePrograms],queryFn:()=>N.restBusinessAreasHouseholdsList(Ce({businessAreaSlug:i},E,{withPagination:!1})),enabled:j.searchFor==="HH"&&!!j.officeSearch}),{data:W,isLoading:Y,error:X}=V({queryKey:["businessAreasIndividualsList",D,i,j.officeSearch,j.activePrograms],queryFn:()=>N.restBusinessAreasIndividualsList(Ce({businessAreaSlug:i},D,{withPagination:!1})),enabled:j.searchFor==="IND"&&!!j.officeSearch}),{data:J,isLoading:ae,error:re}=V({queryKey:["businessAreasGrievancesList",F,i,j.searchFor,j.officeSearch,j.activePrograms],queryFn:()=>N.restBusinessAreasGrievanceTicketsList(Ce({businessAreaSlug:i},F,{withPagination:!1})),enabled:j.searchFor==="GRV"&&!!j.officeSearch}),{data:se,isLoading:le,error:ce}=V({queryKey:["businessAreasPaymentPlansList",w,i,j.officeSearch,j.searchFor,j.activePrograms],queryFn:()=>N.restBusinessAreasPaymentPlansList(Ce({businessAreaSlug:i},w,{withPagination:!1})),enabled:j.searchFor==="PP"&&!!j.officeSearch}),{data:_e,isLoading:ne,error:Ue}=V({queryKey:["businessAreasPaymentsList",O,i,j.officeSearch,j.activePrograms],queryFn:()=>N.restBusinessAreasPaymentsList(Ce({businessAreaSlug:i},O,{withPagination:!1})),enabled:j.searchFor==="RCPT"&&!!j.officeSearch}),ie=(()=>{const ue=[d&&{value:"HH",label:`${o?.groupLabel||"Household"} (ID)`},c&&{value:"IND",label:`${o?.memberLabel||"Individual"} (ID, phone number, name)`},u&&{value:"GRV",label:"Grievance (ID)"},h&&{value:"PP",label:"Payment Plan (ID)"},m&&{value:"RCPT",label:"Payment (ID)"}].filter(Boolean);return x.searchFor==="GRV"?ue.filter(Ge=>Ge.value!=="PP"):x.searchFor==="PP"?ue.filter(Ge=>Ge.value!=="GRV"):ue})(),Pe=[d&&{value:"HH",label:o?.groupLabel||"Household"},c&&{value:"IND",label:o?.memberLabel||"Individual"},u&&{value:"GRV",label:"Grievance"},h&&{value:"PP",label:"Payment Plan"},m&&{value:"RCPT",label:"Payment"}].filter(Boolean);return K(R.SEARCH_BUSINESS_AREAS,r)?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:t("Country Search")}),e.jsxs(P,{display:"flex",flexDirection:"column","data-cy":"page-details-container",children:[e.jsx(Ns,{clearHandler:I,applyHandler:S,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:3,children:e.jsxs(tt,{fullWidth:!0,size:"small",children:[e.jsx(Rt,{id:"search-for-label",children:"Search For"}),e.jsx(at,{labelId:"search-for-label",id:"search-for",value:x.searchFor,label:"Search For",onChange:ue=>b("searchFor",ue.target.value),children:Pe.map(ue=>e.jsx(de,{value:ue.value,children:ue.label},ue.value))})]})}),e.jsx(p,{size:3,children:e.jsxs(tt,{fullWidth:!0,size:"small",children:[e.jsx(Rt,{id:"based-on-id-label",children:"Based on"}),e.jsx(at,{labelId:"based-on-id-label",id:"based-on-id",value:x.basedOnId,label:"Based on",onChange:ue=>b("basedOnId",ue.target.value),children:ie.map(ue=>e.jsx(de,{value:ue.value,children:ue.label},ue.value))})]})}),e.jsx(p,{size:3,children:e.jsx(Cs,{label:t("Search Value"),value:x.officeSearch,onChange:ue=>b("officeSearch",ue.target.value),"data-cy":"office-filters-search"})}),e.jsx(p,{size:3,children:e.jsx(sa,{control:e.jsx(ns,{checked:!!x.activePrograms,onChange:ue=>b("activePrograms",ue.target.checked),name:"active_programs","data-cy":"active-programs-checkbox"}),label:t("Only Active Programs")})})]})}),e.jsxs(st,{children:[j.searchFor==="HH"&&($?e.jsx("div",{children:t("Loading households...")}):G?e.jsx("div",{children:t("Error loading households")}):k?.results?.length?e.jsx(KP,{hhData:k}):s),j.searchFor==="IND"&&(Y?e.jsx("div",{children:t("Loading individuals...")}):X?e.jsx("div",{children:t("Error loading individuals")}):W?.results?.length?e.jsx(YP,{indData:W}):s),j.searchFor==="GRV"&&(ae?e.jsx("div",{children:t("Loading grievances...")}):re?e.jsx("div",{children:t("Error loading grievances")}):J?.results?.length?e.jsx(QP,{grvData:J}):s),j.searchFor==="PP"&&(le?e.jsx("div",{children:t("Loading payment plans...")}):ce?e.jsx("div",{children:t("Error loading payment plans")}):se?.results?.length?e.jsx(XP,{ppData:se}):s),j.searchFor==="RCPT"&&(ne?e.jsx("div",{children:t("Loading payments...")}):Ue?e.jsx("div",{children:t("Error loading payments")}):_e?.results?.length?e.jsx(JP,{paymentsData:_e}):s)]})]})]}):e.jsx(Xe,{permission:R.SEARCH_BUSINESS_AREAS})},eC=oe(ZP,"OfficeSearchPage"),sC=()=>{const t=oa([{path:"country-dashboard",element:e.jsx(Gu,{})},{path:"activity-log",element:e.jsx(Yc,{})},{path:"managerial-console",element:e.jsx(Bu,{})},{path:"country-search",element:e.jsx(eC,{})}]);return e.jsxs(e.Fragment,{children:[t,e.jsx(Tu,{}),e.jsx(Vu,{})]})},tC=T(at)`
  && {
    width: ${({theme:s})=>s.spacing(58)};
    background-color: rgba(104, 119, 127, 0.5);
    color: #e3e6e7;
    border-bottom-width: 0;
    border-radius: 4px;
    height: 40px;
  }
  .MuiFilledInput-input {
    padding: 0 10px;
    background-color: transparent;
  }
  .MuiSelect-select:focus {
    background-color: transparent;
  }
  .MuiSelect-icon {
    color: #e3e6e7;
  }
  &&:hover {
    border-bottom-width: 0;
    border-radius: 4px;
  }
  &&:hover::before {
    border-bottom-width: 0;
  }
  &&::before {
    border-bottom-width: 0;
  }
  &&::after {
    border-bottom-width: 0;
  }
  &&::after:hover {
    border-bottom-width: 0;
  }
`;function aC(){const{businessAreaSlug:s,programSlug:t}=U(),[a,n]=A.useState(s||""),i=A.useRef(!0);A.useEffect(()=>{if(i.current){i.current=!1;return}s&&s!==a&&n(s)},[s,a]);const{data:r}=V({queryKey:["businessAreasProfile",s,t],queryFn:()=>N.restBusinessAreasUsersProfileRetrieve({businessAreaSlug:s,program:t==="all"?void 0:t}),staleTime:900*1e3,gcTime:3600*1e3,refetchOnWindowFocus:!1}),l=ge(),o=Fe(),d=A.useCallback(u=>{const h=u.target.value;n(h),o.clear(),l(h==="global"?"/global/programs/all/country-dashboard":`/${h}/programs/all/list`)},[o,l]),c=A.useMemo(()=>r?.businessAreas?r.businessAreas.map(u=>e.jsx(de,{value:u.slug,children:u.name},u.slug)):[],[r?.businessAreas]);return e.jsx(tC,{variant:"filled",value:a,onChange:d,children:c})}const nC=Ft("div")`
  & .${or.paper} {
    box-shadow: none;
  }
  & .${or.listbox} {
    & .${or.option} {
      min-height: auto;
      align-items: flex-start;
      justify-content: space-between;
      padding: 10px;
      & .status-box-container {
        margin-right: 0;
      }
    }
  }
`,iC=s=>{const t=Object.fromEntries(Object.entries(s).filter(([a])=>!["disablePortal","anchorEl","open"].includes(a)));return e.jsx(nC,{...t})},rC=Ft(jc)`
  border-radius: 6px;
  width: 300px;
  z-index: ${({theme:s})=>s.zIndex.modal};
  background-color: #fff;
  box-shadow:
    0 5px 5px -3px rgba(0, 0, 0, 0.2),
    0 8px 10px 1px rgba(0, 0, 0, 0.14),
    0 3px 14px 2px rgba(0, 0, 0, 0.12);
`,lC=Ft(ks)`
  padding: 10px;
`,oC=Ft(rm)`
  && {
    width: ${({theme:s})=>s.spacing(58)};
    background-color: rgba(104, 119, 127, 0.5);
    color: #e3e6e7;
    border-bottom-width: 0;
    border-radius: 4px;
    height: 40px;
    display: flex;
    justify-content: space-between;
    font-family: Roboto, Helvetica, Arial, sans-serif;
    font-weight: 400;
    font-size: 1rem;
    padding: 0 10px;
  }
  &&:hover {
    background-color: rgba(0, 0, 0, 0.09);
  }
`,dC=Ft(P)`
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  margin-right: 10px;
`,cC=Ft("span")`
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  margin-right: 10px;
`,uC=()=>{const[s,t]=A.useState(null),{businessArea:a,programId:n}=U(),{selectedProgram:i,setSelectedProgram:r}=Z(),l=ge(),[o,d]=A.useState({}),{data:c,isLoading:u,refetch:h}=V({queryKey:["businessAreaProgram",a,o],queryFn:()=>N.restBusinessAreasProgramsList({businessAreaSlug:a,...o})}),m=A.useRef(!1),[g,x]=A.useState(""),{data:f,isLoading:j}=V({queryKey:["businessAreaProgram",a,n],queryFn:()=>N.restBusinessAreasProgramsRetrieve({businessAreaSlug:a,slug:n}),enabled:n!=="all"&&!!n}),[y,b]=A.useState([]);A.useEffect(()=>(m.current=!0,()=>{m.current=!1}),[]),A.useEffect(()=>{r({beneficiaryGroup:{id:"default-id",name:"Beneficiaries",groupLabel:"Group",groupLabelPlural:"Groups",memberLabel:"Member",memberLabelPlural:"Members",masterDetail:!1},id:"all",name:"All Programmes",status:ht.ACTIVE,dataCollectingType:null,pduFields:null,programmeCode:null,slug:null,canImportRdi:!0})},[]),A.useEffect(()=>{if(n!=="all"&&f&&m.current&&(!i||i?.slug!==n)){const{id:$,name:G,status:W,dataCollectingType:Y,pduFields:X,beneficiaryGroup:J,programmeCode:ae,slug:re,canImportRdi:se}=f;r({id:$,name:G,status:W,dataCollectingType:Y,pduFields:X,beneficiaryGroup:J,programmeCode:ae,slug:re,canImportRdi:se})}},[n,i,r,f]),A.useEffect(()=>{n&&n!=="all"&&!j&&f===null&&(r(null),l(`/access-denied/${a}`))},[n,l,a,j,f,r]),A.useEffect(()=>{if(c){const $=[];g===""&&$.push({id:"all",name:"All Programmes",status:null,slug:"all"}),$.push(...c.results.map(({id:G,name:W,slug:Y,status:X})=>({id:G,name:W,status:X,slug:Y}))),b($)}},[c,g]);const C=()=>{t(null)},v=($,G)=>{G&&(C(),G.id==="all"?(r({beneficiaryGroup:{id:"default-id",name:"Beneficiaries",groupLabel:"Group",groupLabelPlural:"Groups",memberLabel:"Member",memberLabelPlural:"Members",masterDetail:!1},id:"all",name:"All Programmes",status:ht.ACTIVE,dataCollectingType:null,pduFields:null,programmeCode:null,slug:null}),l(`/${a}/programs/all/list`)):l(`/${a}/programs/${G.slug}/details/${G.slug}`))},S=()=>{d(g?{limit:10,orderBy:"name",status:[ht.ACTIVE,ht.DRAFT,ht.FINISHED],name:g}:{}),h()},I=$=>{t($.currentTarget)},E=$=>{x($.target.value)},D=$=>{$.key==="Enter"&&S()},F=()=>{x("")},w=!!s,O=w?"global-program-filter":void 0,k=i?.name||"All Programmes";return j?null:e.jsxs(e.Fragment,{children:[e.jsx(P,{sx:{width:221,fontSize:13},children:e.jsxs(oC,{disableRipple:!0,"aria-describedby":O,onClick:I,title:k,"data-cy":"global-program-filter",children:[e.jsx(cC,{children:k}),e.jsx(yc,{})]})}),e.jsx(rC,{id:O,open:w,anchorEl:s,placement:"bottom-start",children:e.jsx(Ac,{onClickAway:C,children:e.jsx(ha,{open:!0,onClose:($,G)=>{G==="escape"&&C()},onChange:v,slots:{popper:iC},noOptionsText:"No results",renderOption:($,G)=>{const{key:W,...Y}=$;return e.jsxs("li",{...Y,children:[e.jsx(dC,{"data-cy":"select-option-name",title:G.name,children:G.name}),G.status&&e.jsx(we,{status:G.status,statusToColor:Pl})]},W)},filterOptions:$=>$,options:y,getOptionLabel:$=>$.name,forcePopupIcon:!1,loading:u,inputValue:g,renderInput:$=>e.jsx(lC,{...$,placeholder:"Search programmes",variant:"outlined",size:"small",ref:$.InputProps.ref,autoFocus:!0,onChange:E,onKeyDown:D,onFocus:()=>{h()},slotProps:{htmlInput:{...$.inputProps,"data-cy":"search-input-gpf"},input:{...$.InputProps,endAdornment:e.jsxs(e.Fragment,{children:[$.InputProps?.endAdornment,e.jsxs(dt,{position:"end",children:[u&&e.jsx(la,{}),g&&e.jsx(Ve,{"data-cy":"clear-icon",onClick:F,children:e.jsx(hl,{})}),e.jsx(Ve,{"data-cy":"search-icon",onClick:S,children:e.jsx(Pa,{})})]})]})}}})})})})]})},hC=T(H)`
  && {
    color: #e3e6e7;
  }
`,mC=T.span`
  margin-left: ${({theme:s})=>s.spacing(2)};
`;function pC({meData:s}){const[t,a]=A.useState(!1),n=A.useRef(null),i=A.useRef(t);A.useEffect(()=>{i.current===!0&&t===!1&&n.current?.focus(),i.current=t},[t]);const r=()=>{a(u=>!u)},l=u=>{n.current&&n.current.contains(u.target)||a(!1)},o=u=>{window.location.assign("/api/logout"),localStorage.removeItem("AUTHENTICATED"),l(u)},d=()=>{window.location.reload()};function c(u){u.key==="Tab"&&(u.preventDefault(),a(!1))}return s?e.jsxs(e.Fragment,{children:[e.jsxs(hC,{ref:n,onClick:r,"data-cy":"menu-user-profile",children:[e.jsx(Hr,{alt:s.email,src:"/static/images/avatar/1.jpg"}),e.jsxs(mC,{children:[" ",s.email]})]}),e.jsx(jc,{open:t,anchorEl:n.current,role:void 0,transition:!0,disablePortal:!0,children:({TransitionProps:u,placement:h})=>e.jsx(lm,{...u,style:{transformOrigin:h==="bottom"?"center top":"center bottom"},children:e.jsx(us,{children:e.jsx(Ac,{onClickAway:l,children:e.jsxs(om,{component:"ul",autoFocusItem:t,id:"menu-list-grow",onKeyDown:c,children:[e.jsx(de,{onClick:d,"data-cy":"menu-item-clear-cache",children:"Clear Cache"}),e.jsx(de,{href:"/api/logout",onClick:o,"data-cy":"menu-item-logout",children:"Logout"})]})})})})})]}):null}const gC="#003C8F",xC="#233944",md=dm({spacing:s=>s*4,palette:{primary:{main:gC},secondary:{main:xC},error:{main:cm[600]},background:{default:"#EEEEEE"}},typography:{h6:{fontSize:"20px",fontWeight:400}}}),vn="Roboto",wt=Object.assign({},md,{spacing:md.spacing,drawer:{width:270},hctPalette:{orange:"#FC942A",blue:"#D8E1EE",darkerBlue:"#033D90",green:"#10CB16",gray:"#4E606A",lightGray:"#d8d8d8",lighterGray:"#e4e4e4",lightestGray:"#fafafa",red:"#EF4343",brown:"#D9D1CE",darkBrown:"#715247",navyBlue:"#003C8F",lightBlue:"#00ADEF"},hctTypography:{fontFamily:vn,font:{fontFamily:vn},label:{color:"rgba(37,59,70,0.6)",fontFamily:vn,fontSize:"11px",fontWeight:500,letterSpacing:"0.39px",lineHeight:"16px",textTransform:"uppercase"}},styledMixins:{label:on.css`
      color: rgba(37, 59, 70, 0.6);
      font-family: ${vn};
      font-size: 11px;
      font-weight: 500;
      letter-spacing: 0.39px;
      line-height: 16px;
      text-transform: uppercase;
    `}}),fC=ut(hc)(()=>({display:"flex",justifyContent:"space-between"})),yC=ut("a")({textDecoration:"none",color:"#e3e6e7"}),bC=ut(um)(({open:s})=>({position:"fixed",top:0,zIndex:wt.zIndex.drawer+1,backgroundColor:wt.palette.secondary.main,transition:wt.transitions.create(["width","margin"],{easing:wt.transitions.easing.sharp,duration:wt.transitions.duration.leavingScreen}),...s&&{marginLeft:"270px",width:"calc(100% - 270px)",transition:wt.transitions.create(["width","margin"],{easing:wt.transitions.easing.sharp,duration:wt.transitions.duration.enteringScreen})},...!s&&{marginLeft:"0",width:"100%",transition:wt.transitions.create(["width","margin"],{easing:wt.transitions.easing.sharp,duration:wt.transitions.duration.leavingScreen})}})),jC=ut(Ve)(({open:s})=>({marginRight:36,...s&&{display:"none"}})),AC=({open:s,handleDrawerOpen:t})=>{const{businessArea:a,programSlug:n}=U(),{data:i}=V({queryKey:["profile",a,n],queryFn:()=>N.restBusinessAreasUsersProfileRetrieve({businessAreaSlug:a,program:n==="all"?void 0:n}),staleTime:300*1e3,gcTime:1800*1e3,refetchOnWindowFocus:!1}),r=`https://unicef.service-now.com/cc?id=sc_cat_item&sys_id=762ae3128747d91021cb670a0cbb35a7&HOPE - ${window.location.pathname.split("/")[2]}&Workspace: ${window.location.pathname.split("/")[1]} 
 Url: ${window.location.href}`;return e.jsx(bC,{open:s,children:e.jsxs(fC,{children:[e.jsxs(P,{display:"flex",alignItems:"center",justifyContent:"center",children:[e.jsx(P,{ml:1,children:e.jsx(jC,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:t,open:s,children:e.jsx(hm,{})})}),e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsx(P,{ml:6,"data-cy":"business-area-container",children:e.jsx(aC,{})}),a!=="global"&&e.jsx(P,{ml:6,"data-cy":"global-program-filter-container",children:e.jsx(uC,{})})]})]}),e.jsxs(P,{display:"flex",justifyContent:"flex-end",children:[e.jsx(H,{startIcon:e.jsx(mm,{style:{color:"#e3e6e7"}}),children:e.jsx(yC,{target:"_blank",href:r,children:"Support"})}),e.jsx(pC,{meData:i})]})]})})},_C=()=>Rc.version,Ys="SCOPE_PROGRAM",na="SCOPE_ALL_PROGRAMS",pd=[{name:"Country Dashboard",href:"/country-dashboard",selectedRegexp:/^\/$/,icon:e.jsx(ym,{}),permissions:[R.DASHBOARD_VIEW_COUNTRY],scopes:[na,Ys],dataPerm:R.DASHBOARD_VIEW_COUNTRY},{name:"Registration Data Import",href:"/registration-data-import",selectedRegexp:/^\/registration-data-import.*$/,icon:e.jsx(bm,{}),permissions:[R.RDI_VIEW_DETAILS,R.RDI_VIEW_LIST],scopes:[Ys],dataPerm:R.RDI_VIEW_LIST},{name:"Programme Population",href:"/population/household",selectedRegexp:/^\/population.*$/,icon:e.jsx(_o,{}),collapsable:!0,permissionModule:"POPULATION",scopes:[Ys],isSocialWorker:!1,secondaryActions:[{name:"Households",href:"/population/household",selectedRegexp:/^\/population\/household.*$/,icon:e.jsx(jm,{}),permissionModule:"HOUSEHOLDS",scopes:[Ys],dataPerm:R.POPULATION_VIEW_HOUSEHOLDS_LIST},{name:"Household Members",href:"/population/individuals",selectedRegexp:/^\/population\/individuals.*$/,icon:e.jsx(Am,{}),permissionModule:"INDIVIDUALS",scopes:[Ys],dataPerm:R.POPULATION_VIEW_INDIVIDUALS_LIST}]},{name:"People",href:"/population/people",selectedRegexp:/^\/population\/people.*$/,icon:e.jsx(_o,{}),permissionModule:"POPULATION",scopes:[Ys],isSocialWorker:!0,dataPerm:R.POPULATION_VIEW_INDIVIDUALS_LIST},{name:"Programmes",href:"/list",selectedRegexp:/^\/programs.*$/,icon:e.jsx(Po,{}),scopes:[na],permissions:[R.PROGRAMME_MANAGEMENT_VIEW,R.PROGRAMME_VIEW_LIST_AND_DETAILS,R.PROGRAMME_VIEW_PAYMENT_RECORD_DETAILS],dataPerm:R.PROGRAMME_VIEW_LIST_AND_DETAILS},{name:"Managerial Console",href:"/managerial-console",selectedRegexp:/^\/managerial-console.*$/,icon:e.jsx(_m,{}),scopes:[na],permissions:[R.PAYMENT_VIEW_LIST_MANAGERIAL],dataPerm:R.PAYMENT_VIEW_LIST_MANAGERIAL},{name:"Programme Details",href:"/programs",selectedRegexp:/^\/programs.*$/,icon:e.jsx(Po,{}),scopes:[Ys],permissions:[R.PROGRAMME_VIEW_LIST_AND_DETAILS,R.PROGRAMME_VIEW_PAYMENT_RECORD_DETAILS],dataPerm:R.PROGRAMME_VIEW_LIST_AND_DETAILS},{name:"Targeting",href:"/target-population",selectedRegexp:/^\/target-population.*$/,icon:e.jsx(Pm,{}),scopes:[Ys],permissions:[R.TARGETING_VIEW_LIST,R.TARGETING_VIEW_DETAILS],dataPerm:R.TARGETING_VIEW_LIST},{name:"Payment Module",href:"/payment-module/program-cycles",selectedRegexp:/^\/payment-module.*$/,icon:e.jsx(dr,{}),collapsable:!0,permissionModule:"PM",scopes:[Ys],secondaryActions:[{name:"Programme Cycles",href:"/payment-module/program-cycles",selectedRegexp:/^\/payment-module\/program-cycles.*$/,icon:e.jsx(dr,{}),permissions:[R.PM_PROGRAMME_CYCLE_VIEW_LIST,R.PM_PROGRAMME_CYCLE_VIEW_DETAILS],permissionModule:"PM",scopes:[Ys],dataPerm:R.PM_PROGRAMME_CYCLE_VIEW_LIST},{name:"Payment Plans",href:"/payment-module/payment-plans",selectedRegexp:/^\/payment-module\/payment-plans.*$/,icon:e.jsx(dr,{}),permissions:[R.PM_VIEW_LIST,R.PM_VIEW_DETAILS],permissionModule:"PM",scopes:[Ys],dataPerm:R.PM_VIEW_LIST}]},{name:"Payment Verification",href:"/payment-verification",selectedRegexp:/^\/payment-verification.*$/,icon:e.jsx(Cm,{}),scopes:[Ys],permissions:[R.PAYMENT_VERIFICATION_VIEW_LIST,R.PAYMENT_VERIFICATION_VIEW_DETAILS,R.PAYMENT_VERIFICATION_VIEW_PAYMENT_RECORD_DETAILS],dataPerm:R.PAYMENT_VERIFICATION_VIEW_LIST},{name:"Grievance",href:"/grievance/tickets",selectedRegexp:/^\/grievance\/tickets.*$/,icon:e.jsx(Im,{}),collapsable:!0,permissionModule:"GRIEVANCES",scopes:[Ys,na],secondaryActions:[{name:"Grievance Tickets",href:"/grievance/tickets/user-generated",selectedRegexp:/^\/grievance\/tickets.*$/,icon:e.jsx(Em,{}),permissionModule:"GRIEVANCES",scopes:[Ys,na],dataPerm:`${R.GRIEVANCES_VIEW_LIST}, ${R.PROGRAMME_VIEW_LIST_AND_DETAILS} ${R.USER_MANAGEMENT_VIEW_LIST}, ${R.RDI_VIEW_LIST}`},{name:"Grievance Dashboard",href:"/grievance/dashboard",selectedRegexp:/^\/grievance\/dashboard.*$/,icon:e.jsx(vm,{}),permissionModule:"GRIEVANCES",scopes:[Ys,na],dataPerm:R.GRIEVANCES_VIEW_LIST},{name:"Feedback",href:"/grievance/feedback",selectedRegexp:/^\/grievance\/feedback.*$/,icon:e.jsx(Sm,{}),permissionModule:"GRIEVANCES",scopes:[Ys,na],dataPerm:`${R.GRIEVANCES_VIEW_LIST}, ${R.PROGRAMME_VIEW_LIST_AND_DETAILS} ${R.USER_MANAGEMENT_VIEW_LIST}, ${R.RDI_VIEW_LIST}`}]},{name:"Accountability",href:"/accountability/communication",selectedRegexp:/^\/accountability\/communication.*$/,icon:e.jsx(Tm,{}),collapsable:!0,permissionModule:"ACCOUNTABILITY",flag:"isAccountabilityApplicable",scopes:[Ys],secondaryActions:[{name:"Communication",href:"/accountability/communication",selectedRegexp:/^\/accountability\/communication.*$/,icon:e.jsx(_c,{}),permissionModule:"COMMUNICATION_MESSAGE",scopes:[Ys],dataPerm:`${R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_LIST}, ${R.TARGETING_VIEW_LIST}, ${R.USER_MANAGEMENT_VIEW_LIST}`},{name:"Surveys",href:"/accountability/surveys",selectedRegexp:/^\/accountability\/surveys.*$/,icon:e.jsx(Dm,{}),permissionModule:"SURVEY",scopes:[Ys],dataPerm:R.ACCOUNTABILITY_SURVEY_VIEW_LIST}]},{name:"Programme Users",href:"/users-list",selectedRegexp:/^\/users-list.*$/,icon:e.jsx(Rm,{}),permissions:[R.USER_MANAGEMENT_VIEW_LIST],scopes:[Ys],dataPerm:R.USER_MANAGEMENT_VIEW_LIST},{name:"Activity Log",href:"/activity-log",selectedRegexp:/^\/activity-log.*$/,icon:e.jsx(Co,{}),permissions:[R.ACTIVITY_LOG_VIEW],scopes:[na],dataPerm:R.ACTIVITY_LOG_VIEW},{name:"Programme Log",href:"/activity-log",selectedRegexp:/^\/activity-log.*$/,icon:e.jsx(Co,{}),permissions:[R.ACTIVITY_LOG_VIEW],scopes:[Ys],dataPerm:R.ACTIVITY_LOG_VIEW},{name:"Country Search",href:"/country-search",selectedRegexp:/^\/country-search.*$/,icon:e.jsx(Fm,{}),permissions:[R.SEARCH_BUSINESS_AREAS],scopes:[na]}],PC=[{name:"Reporting",href:"https://reporting.hope.unicef.org/",icon:e.jsx(pm,{})},{name:"Knowledge Base",href:"https://unicef.service-now.com/cc?id=kb_search&kb_knowledge_base=be5501f9db003850d180f264f39619ee",icon:e.jsx(gm,{})},{name:"Conversations",href:"https://web.yammer.com/main/groups/eyJfdHlwZSI6Ikdyb3VwIiwiaWQiOiIxMzAzMTkwMDc3NDQifQ/all",icon:e.jsx(xm,{})},{name:"Tools and Materials",href:"https://unicef.sharepoint.com/sites/EMOPS-HOPE",icon:e.jsx(dn,{})},{name:"Release Note",href:"/api/changelog/",icon:e.jsx(fm,{})}],ni=T(ia)`
  .MuiTypography-body1 {
    color: #233944;
    font-size: 14px;
    font-weight: 500;
    line-height: 16px;
    margin-right: 100px;
  }
`,ii=T(Pc)`
  && {
    min-width: 40px;
  }
`,CC=T(Fi)`
  padding-left: ${({open:s})=>s?"32px !important":0};
`,gd=T.div`
  position: absolute;
  right: -2px;
  top: 8px;
`,EC=({currentLocation:s,open:t})=>{const{baseUrl:a,businessArea:n,programId:i,isAllPrograms:r}=U(),{isSocialDctType:l,selectedProgram:o}=Z(),d=ve(),{data:c}=V({queryKey:["businessArea",n],queryFn:()=>N.restBusinessAreasRetrieve({slug:n})}),u=s.replace(`/${a}`,""),h=ge(),m=pd.findIndex(S=>S.secondaryActions?S.secondaryActions.findIndex(I=>!!I.selectedRegexp.exec(u))!==-1:!1),[g,x]=A.useState(m!==-1?m:null);if(A.useEffect(()=>{x(null)},[a]),d===null||!c)return null;const y=((S,I)=>I?S.map((E,D)=>(D===2&&!r&&(E.name=I.name,E.secondaryActions&&(E.secondaryActions=E.secondaryActions.map((F,w)=>(w===0?F.name=I.groupLabelPlural:w===1&&(F.name=I.memberLabelPlural),F)))),E)):S)((S=>{let I=[...S];n==="global"&&(I=I.filter(F=>F.name==="Country Dashboard"));const D=(F=>I.findIndex(w=>w?.name===F))("Programme Details");return r||(I[D].href=`/details/${i}`),I=I.filter(F=>{let w=r?F.scopes.includes(na):F.scopes.includes(Ys);const O=l;return F.isSocialWorker===!1?w&&=!O:F.isSocialWorker===!0&&(w&&=O),w}),I})(pd),o?.beneficiaryGroup),{isAccountabilityApplicable:b}=c,C={isAccountabilityApplicable:b},v=S=>{let I="";for(const E of S)if(E.permissionModule&&hr(E.permissionModule,d)){I=E.href;break}return I};return e.jsx("div",{"data-cy":"drawer-items",children:y?.map((S,I)=>{if(S.permissionModule&&!hr(S.permissionModule,d)||S.permissions&&!K(S.permissions,d)||S.flag&&!C[S.flag])return null;if(S.collapsable){const E=v(S.secondaryActions);return e.jsxs("div",{children:[e.jsxs(Jn,{component:Zn,"data-cy":`nav-${S?.name}`,to:`/${a}${E}`,onClick:()=>{x(I===g?null:I),E&&h(`/${a}${E}`)},children:[e.jsx(ii,{children:S.icon}),e.jsx(ni,{primary:S?.name}),g!==null&&g===I?e.jsx(gd,{children:e.jsx(ml,{})}):e.jsx(gd,{children:e.jsx(Ti,{})})]}),e.jsx(yt,{in:g!==null&&g===I,children:e.jsx(CC,{open:t,component:"div",children:S.secondaryActions&&S.secondaryActions.map(D=>D.permissionModule&&hr(D.permissionModule,d)&&e.jsxs(Jn,{component:Zn,"data-perm":D.dataPerm,"data-cy":`nav-${D.name}`,to:`/${a}${D.href}`,selected:!!D.selectedRegexp.exec(u),children:[e.jsx(ii,{children:D.icon}),e.jsx(ni,{primary:D.name})]},D.name))})})]},S?.name+E)}return S.external?e.jsx(Jn,{"data-cy":`nav-${S?.name}`,component:Zn,to:S.href,target:"_blank",children:e.jsxs(P,{display:"flex",children:[e.jsx(ii,{children:S.icon}),e.jsx(ni,{primary:S?.name})]})},S?.name+S.href):e.jsxs(Jn,{"data-cy":`nav-${S?.name}`,"data-perm":S.dataPerm,component:Zn,to:`/${a}${S.href}`,onClick:()=>{x(null)},selected:!!S.selectedRegexp.exec(u),children:[e.jsx(ii,{children:S.icon}),e.jsx(ni,{primary:S?.name})]},S?.name+S.href)})})},zu=()=>{const s=window.location.href;return window.location.hostname==="localhost"?"#A1E4B6":s.includes("trn")?"#BF360C":s.includes("stg")?"#673AB7":s.includes("dev")?"#00796B":s.includes("eph")?"#CC00EF":s.includes("tst")?"#EF00A7":"#00ADEF"},vC=T("div")`
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding-left: 51px;
  background-color: ${zu()};
  color: white;
  box-shadow:
    0px 2px 4px 0px rgba(0, 0, 0, 0.2),
    0px 4px 5px 0px rgba(0, 0, 0, 0.14),
    0px 1px 10px 0px rgba(0, 0, 0, 0.12);
  min-height: 64px;
`,SC=T(Nm)`
  .MuiDrawer-paper {
    background-color: white;
    height: 100vh;
    position: relative;
    white-space: nowrap;
    width: ${s=>s.open?"270px":"55px"};
    transition:
      width 225ms cubic-bezier(0, 0, 0.2, 1) 0ms,
      width 195ms cubic-bezier(0, 0, 0.2, 1) 0ms;
    border-width: 0;
    overflow-x: hidden;
  }
`,IC=T(Ve)`
  color: #fff;
  opacity: 0.54;
`,DC=T.a`
  color: #233944;
  font-size: 14px;
  font-weight: 500;
  line-height: 16px;
  text-decoration: none;
`,TC=T("p")`
  text-align: left;
  font-size: 14px;
  color: #aaa;
  margin-left: 16px;
`,RC=T(P)`
  overflow-y: auto;
  max-height: calc(100vh - 64px);
  height: 100%;
`,FC=T("div")`
  color: #aaa;
  padding: 4px;
  text-align: center;
  font-size: 14px;
`,NC=T(ia)`
  .MuiTypography-body1 {
    color: #233944;
    font-size: 14px;
    font-weight: 500;
    line-height: 16px;
  }
`,LC=T.div`
  background-color: #ff80ff;
  color: #721c24;
  border-radius: 5px;
  text-align: center;
  font-weight: 600;
`,OC=T(Pc)`
  && {
    min-width: 40px;
  }
`,kC=({open:s,handleDrawerClose:t,currentLocation:a,dataCy:n})=>{const{t:i}=M(),{selectedProgram:r}=Z(),{isAllPrograms:l}=U(),o=_C();let d=null;const c=r?.status,u=c===ht.ACTIVE,h=c!=null;return!l&&!u&&h&&(d=e.jsx(LC,{"data-cy":"program-inactive-subheader",children:"Programme Inactive"})),e.jsxs(SC,{variant:"permanent",open:s,style:{height:"100vh"},"data-cy":n,children:[e.jsxs(vC,{children:[e.jsx(Hc,{transparent:zu()!=="#00ADEF",displayLogoWithoutSubtitle:!0}),e.jsx(IC,{onClick:t,children:e.jsx(Lm,{})})]}),d,e.jsx(In,{}),e.jsxs(RC,{children:[e.jsx(Fi,{children:e.jsx(EC,{open:s,currentLocation:a})}),e.jsx(P,{mb:2,children:e.jsx(In,{})}),s&&e.jsx(P,{mb:2,children:e.jsx(TC,{children:i("Resources")})}),PC.map(m=>e.jsx(pl,{children:e.jsx(DC,{"data-cy":`nav-resources-${m.name}`,target:"_blank",href:m.href,children:e.jsxs(P,{display:"flex",children:[e.jsx(OC,{children:m.icon}),e.jsx(NC,{primary:m.name})]})})},m.name+m.href)),s&&e.jsxs(FC,{children:["Version: ",o]})]})]})},wC=T.div`
  display: flex;
  width: 100vw;
`,MC=T.div`
  padding: 0px 1px;
  transition: margin-left 225ms cubic-bezier(0, 0, 0.2, 1) 0ms;
  width: 100%;
  flex-grow: 1;
  height: 100vh;
  overflow: auto;
`,$C=ut("div")(()=>({...wt.mixins.toolbar})),UC=()=>{const[s,t]=A.useState(!0),{businessArea:a,programSlug:n}=U(),i=je(),r=ge(),l=()=>{t(!0)},o=()=>{t(!1)},{data:d,isLoading:c}=V({queryKey:["businessAreasProfile",a,n],queryFn:()=>N.restBusinessAreasUsersProfileRetrieve({businessAreaSlug:a,program:n==="all"?void 0:n}),staleTime:900*1e3,gcTime:3600*1e3,refetchOnWindowFocus:!1});return!d||c?e.jsx(Ne,{}):d.businessAreas.map(m=>m.slug).includes(a)?e.jsxs(wC,{children:[e.jsx(Cc,{}),e.jsx(AC,{open:s,handleDrawerOpen:l}),e.jsx(kC,{open:s,handleDrawerClose:o,currentLocation:i.pathname,dataCy:"side-nav"}),e.jsxs(MC,{"data-cy":"main-content",children:[e.jsx($C,{}),e.jsx(Om,{})]})]}):(r("/"),null)},VC=({field:s,form:t,disabled:a,...n})=>{const{t:i}=M(),{data:r}=V({queryKey:["currencies"],queryFn:()=>N.restChoicesCurrenciesList()}),l=(d,c)=>{c?t.setFieldValue(s.name,c.value):t.setFieldValue(s.name,null)},o=Os(t.errors,s.name)&&(Os(t.touched,s.name)||t.submitCount>0);return r?e.jsx(ha,{options:r||[],defaultValue:s.value,getOptionLabel:d=>d.name,onChange:l,disabled:a,fullWidth:!0,renderInput:d=>e.jsx(ks,{...d,label:i("Currency"),variant:"outlined",size:"small",error:o,helperText:`${o?Os(t.errors,s.name):""}`,...n}),"data-cy":"input-currency"}):null},ft=T(us)`
  display: flex;
  padding: ${({theme:s})=>s.spacing(3)} ${({theme:s})=>s.spacing(4)};
  margin: ${({theme:s})=>s.spacing(5)};
  flex-direction: column;
  border-bottom: 1px solid rgba(224, 224, 224, 1);
`,Hn=({values:s,paymentPlan:t})=>{const{t:a}=M();return e.jsxs(ft,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Parameters")})}),e.jsxs(p,{spacing:3,container:!0,children:[e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:"dispersionStartDate",label:a("Dispersion Start Date"),component:jt,required:!0,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"}),dataCy:"input-dispersion-start-date",tooltip:a("The first day from which payments could be delivered.")})}),e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:"dispersionEndDate",label:a("Dispersion End Date"),component:jt,required:!0,minDate:Vc,disabled:!s.dispersionStartDate,initialFocusedDate:s.dispersionStartDate,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"}),dataCy:"input-dispersion-end-date",tooltip:a("The last day on which payments could be delivered.")})}),e.jsx(p,{size:{xs:3},children:e.jsx(B.Field,{name:"currency",component:VC,required:!0,disabled:!!t?.isFollowUp})})]})]})},BC=T(P)`
  width: 100%;
`;function Wn({allTargetPopulations:s,loading:t,disabled:a}){const{t:n}=M();if(t)return e.jsx(Ne,{});const i=s.results.map(r=>({name:r.name,value:r.id}));return e.jsxs(ft,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Target Population")})}),e.jsx(vt,{children:e.jsx(BC,{display:"flex",flexDirection:"column",children:e.jsx(p,{container:!0,children:e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"paymentPlanId",label:n("Target Population"),fullWidth:!0,variant:"outlined",required:!0,choices:i,component:We,disabled:a,"data-cy":"input-target-population"})})})})})]})}const xd=T.div`
  margin-left: 30px;
`;function sr({handleSubmit:s,baseUrl:t,permissions:a,paymentPlan:n,loadingUpdate:i}){const{t:r}=M(),{id:l,isFollowUp:o}=n,d=[{title:r("Payment Module"),to:`/${t}/payment-module/${o?"followup-payment-plans":"payment-plans"}/${l}`}];return e.jsx(Ze,{title:e.jsxs(P,{display:"flex",alignItems:"center",children:[r(o?"Follow-up Payment Plan":"Payment Plan")," ID"," ",n.unicefId,e.jsx(xd,{children:e.jsx(we,{status:n.status,statusToColor:Vt})}),n.backgroundActionStatus&&e.jsx(xd,{children:e.jsx(we,{status:n.backgroundActionStatus,statusToColor:wi})})]}),breadCrumbs:K(R.PM_VIEW_LIST,a)?d:null,children:e.jsxs(P,{display:"flex",mt:2,mb:2,children:[e.jsx(P,{mr:3,children:e.jsx(H,{component:ys,to:`/${t}/payment-module/payment-plans/${l}`,children:r("Cancel")})}),e.jsx(ke,{loading:i,variant:"contained",color:"primary",onClick:s,children:r("Save")})]})})}const GC=()=>{const s=ge(),{paymentPlanId:t}=ts(),{t:a}=M(),{mutateAsync:n,isPending:i}=xe({mutationFn:({businessAreaSlug:y,id:b,programSlug:C,requestBody:v})=>N.restBusinessAreasProgramsPaymentPlansPartialUpdate({businessAreaSlug:y,id:b,programSlug:C,requestBody:v})}),{showMessage:r}=Ae(),{baseUrl:l,businessArea:o,programId:d}=U(),c=ve(),{data:u,isLoading:h}=V({queryKey:["paymentPlan",o,t,d],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansRetrieve({businessAreaSlug:o,id:t,programSlug:d})}),{data:m,isLoading:g}=V({queryKey:["businessAreasProgramsTargetPopulationsList",o,d],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsList({businessAreaSlug:o,programSlug:d,status:"DRAFT"})});if(g||h)return e.jsx(Ne,{});if(!m||!u||c===null)return null;if(!K(R.PM_CREATE,c))return e.jsx(Xe,{permission:R.PM_CREATE});const x={paymentPlanId:u.id,currency:{name:u.currency,value:u.currency},dispersionStartDate:u.dispersionStartDate,dispersionEndDate:u.dispersionEndDate},f=Q.object().shape({paymentPlanId:Q.string().required(a("Target Population is required")),currency:Q.string().nullable().required(a("Currency is required")),dispersionStartDate:Q.date().required(a("Dispersion Start Date is required")),dispersionEndDate:Q.date().required(a("Dispersion End Date is required")).min(ta,a("Dispersion End Date cannot be in the past")).when("dispersionStartDate",(y,b)=>y?b.min(y,`${a("Dispersion End Date has to be greater than")} ${fs(y).format("YYYY-MM-DD")}`):b)}),j=async y=>{const b={dispersionStartDate:y.dispersionStartDate,dispersionEndDate:y.dispersionEndDate,currency:y.currency?.value?y.currency.value:y.currency};try{const C=await n({businessAreaSlug:o,id:t,programSlug:d,requestBody:b});r(a("Follow-up Payment Plan Edited")),s(`/${l}/payment-module/followup-payment-plans/${C.id}`)}catch(C){fe(C,r)}};return e.jsx(B.Formik,{initialValues:x,validationSchema:f,onSubmit:j,children:({submitForm:y,values:b})=>e.jsxs(B.Form,{children:[e.jsx(Bs,{}),e.jsx(sr,{paymentPlan:u,handleSubmit:y,baseUrl:l,permissions:c,loadingUpdate:i}),e.jsx(Wn,{allTargetPopulations:m,loading:g,disabled:!0}),e.jsx(Hn,{paymentPlan:u,values:b})]})})},zC=oe(GC,"EditFollowUpPaymentPlanPage"),qC=()=>{const s=ge(),{paymentPlanId:t}=ts(),{baseUrl:a,businessArea:n,programId:i}=U(),{t:r}=M(),{data:l,isLoading:o}=V({queryKey:["paymentPlan",n,t,i],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansRetrieve({businessAreaSlug:n,id:t,programSlug:i})}),{mutateAsync:d,isPending:c}=xe({mutationFn:({businessAreaSlug:y,id:b,programSlug:C,requestBody:v})=>N.restBusinessAreasProgramsPaymentPlansPartialUpdate({businessAreaSlug:y,id:b,programSlug:C,requestBody:v})}),{showMessage:u}=Ae(),h=ve(),{data:m,isLoading:g}=V({queryKey:["businessAreasProgramsTargetPopulationsList",n,i],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsList({businessAreaSlug:n,programSlug:i,status:"DRAFT"})});if(g||o)return e.jsx(Ne,{});if(!m||!l||h===null)return null;if(!K(R.PM_CREATE,h))return e.jsx(Xe,{permission:R.PM_CREATE});const x={paymentPlanId:l.id,currency:{name:l.currency,value:l.currency},dispersionStartDate:l.dispersionStartDate,dispersionEndDate:l.dispersionEndDate},f=Q.object().shape({paymentPlanId:Q.string().required(r("Target Population is required")),dispersionStartDate:Q.date().required(r("Dispersion Start Date is required")),dispersionEndDate:Q.date().required(r("Dispersion End Date is required")).min(ta,r("Dispersion End Date cannot be in the past")).when("dispersionStartDate",(y,b)=>y?b.min(y,`${r("Dispersion End Date has to be greater than")} ${fs(y).format("YYYY-MM-DD")}`):b)}),j=async y=>{const b={dispersionStartDate:y.dispersionStartDate,dispersionEndDate:y.dispersionEndDate,currency:y.currency?.value?y.currency.value:y.currency};try{const C=await d({businessAreaSlug:n,id:t,programSlug:i,requestBody:b});u(r("Payment Plan Edited")),s(`/${a}/payment-module/payment-plans/${C.id}`)}catch(C){fe(C,u)}};return e.jsx(B.Formik,{initialValues:x,validationSchema:f,onSubmit:j,children:({submitForm:y,values:b})=>e.jsxs(B.Form,{children:[e.jsx(Bs,{}),e.jsx(sr,{paymentPlan:l,handleSubmit:y,baseUrl:a,permissions:h,loadingUpdate:c}),e.jsx(Wn,{allTargetPopulations:m,loading:g,disabled:!0}),e.jsx(Hn,{paymentPlan:l,values:b})]})})},Cr=oe(qC,"EditPaymentPlanPage");function qu({baseUrl:s,paymentPlan:t}){const{t:a}=M(),{createdBy:n,program:i,currency:r,startDate:l,endDate:o,dispersionStartDate:d,dispersionEndDate:c,sourcePaymentPlan:{id:u,unicefId:h},exchangeRate:m}=t;return e.jsx(p,{size:{xs:12},children:e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Details")})}),e.jsx(vt,{children:e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Main Payment Plan"),children:e.jsx(me,{to:`/${s}/payment-module/payment-plans/${u}`,children:h})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Created By"),children:n})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Programme"),children:e.jsx(me,{to:`/${s}/details/${i.slug}`,children:i.name})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Target Population"),children:e.jsx(me,{to:`/${s}/target-population/${t.id}`,children:t.name})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Currency"),children:r})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Start Date"),children:e.jsx(pe,{children:l})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("End Date"),children:e.jsx(pe,{children:o})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Dispersion Start Date"),children:e.jsx(pe,{children:d})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Dispersion End Date"),children:e.jsx(pe,{children:c})})}),e.jsx(p,{size:{xs:3},children:e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsx(P,{mr:1,children:e.jsx(L,{label:a("FX Rate Applied"),children:m})}),e.jsx(Ms,{title:a("If displayed exchange rate differs from Vision, please contact your designated focal point for resolution"),children:e.jsx(Ve,{color:"primary","aria-label":"exchange-rate","data-cy":"info-exchange-rate",children:e.jsx(dn,{})})})]})})]})})]})})}const HC=T.div`
  padding: 0 ${({theme:s})=>s.spacing(2)};
  border-color: ${s=>s.color};
  border-left-width: 2px;
  border-left-style: solid;
`;function Ws({color:s,children:t}){return e.jsx(HC,{color:s,children:t})}function WC({paymentPlan:s}){const t=ge(),{t:a}=M(),[n,i]=A.useState(!1),{baseUrl:r,businessArea:l,programId:o}=U(),d=ve(),{isActiveProgram:c}=Z(),{showMessage:u}=Ae(),{selectedProgram:h}=Z(),m=h?.beneficiaryGroup,{id:g,totalWithdrawnHouseholdsCount:x,unsuccessfulPaymentsCount:f}=s,{mutateAsync:j,isPending:y}=xe({mutationFn:({businessAreaSlug:S,id:I,programSlug:E,requestBody:D})=>N.restBusinessAreasProgramsPaymentPlansCreateFollowUpCreate({businessAreaSlug:S,id:I,programSlug:E,requestBody:D})});if(d===null)return null;const b=Q.object().shape({dispersionStartDate:Q.date().required(a("Dispersion Start Date is required")),dispersionEndDate:Q.date().required(a("Dispersion End Date is required")).min(ta,a("Dispersion End Date cannot be in the past")).when("dispersionStartDate",(S,I)=>S?I.min(new Date(S),`${a("Dispersion End Date has to be greater than")} ${fs(S).format("YYYY-MM-DD")}`):I)}),C={dispersionStartDate:null,dispersionEndDate:null},v=async S=>{try{const I=S.dispersionStartDate?Gt.format(new Date(S.dispersionStartDate),"yyyy-MM-dd"):null,E=S.dispersionEndDate?Gt.format(new Date(S.dispersionEndDate),"yyyy-MM-dd"):null,F=await j({businessAreaSlug:l,programSlug:o,id:g,requestBody:{dispersionStartDate:I,dispersionEndDate:E}});i(!1),u(a("Payment Plan Created")),t(`/${r}/payment-module/followup-payment-plans/${F.id}`)}catch(I){fe(I,u)}};return e.jsx(B.Formik,{initialValues:C,validationSchema:b,onSubmit:v,validateOnChange:!0,validateOnBlur:!0,children:({submitForm:S,values:I})=>e.jsxs(B.Form,{children:[e.jsx(P,{p:2,children:e.jsx(H,{variant:"outlined",color:"primary",onClick:()=>i(!0),"data-perm":R.PM_CREATE,disabled:!K(R.PM_CREATE,d)||!c,children:a("Create Follow-up PP")})}),e.jsxs(is,{open:n,onClose:()=>i(!1),scroll:"paper",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Create Follow-up Payment Plan")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsxs(P,{p:5,children:[e.jsxs(P,{display:"flex",flexDirection:"column",children:[f===0&&e.jsx(P,{mb:2,children:e.jsx(Ws,{color:"#FF0200",children:e.jsx(it,{children:a("Follow-up Payment Plan might be started just for unsuccessful payments")})})}),x>0&&e.jsx(P,{mb:4,children:e.jsx(Ws,{color:"#FF0200",children:e.jsx(it,{children:a(`Withdrawn ${m?.groupLabel} cannot be added into follow-up payment plan`)})})})]}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:6},children:e.jsx(P,{mt:2,children:e.jsx(ee,{children:a("Main Payment Plan Details")})})}),e.jsx(p,{size:{xs:6}}),e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:a("Unsuccessful payments"),children:f})}),e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:a(`Withdrawn ${m?.groupLabelPlural}`),children:x})})]}),e.jsx(p,{size:{xs:12},children:e.jsx(St,{})}),e.jsx(P,{mb:3,children:e.jsx(ee,{children:a("Set the Dispersion Dates")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"dispersionStartDate",label:a("Dispersion Start Date"),component:jt,required:!0,disabled:y,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"}),"data-cy":"input-dispersion-start-date",tooltip:a("The first day from which payments could be delivered.")})}),e.jsx(p,{size:{xs:6},children:e.jsx(B.Field,{name:"dispersionEndDate",label:a("Dispersion End Date"),component:jt,required:!0,minDate:Vc,disabled:!I.dispersionStartDate,initialFocusedDate:I.dispersionStartDate,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"}),"data-cy":"input-dispersion-end-date",tooltip:a("The last day on which payments could be delivered.")})})]})]})})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>i(!1),children:a("Cancel")}),e.jsx(ke,{loading:y,type:"submit",color:"primary",variant:"contained",onClick:S,"data-cy":"button-submit",children:a("Save")})]})})]})]})})}const KC={splitType:"",paymentsNo:0},YC=({paymentPlan:s,canSplit:t})=>{const[a,n]=A.useState(!1),{showMessage:i}=Ae(),{businessArea:r,programId:l}=U(),{t:o}=M(),{mutateAsync:d,isPending:c}=xe({mutationFn:({businessAreaSlug:x,id:f,programSlug:j,requestBody:y})=>N.restBusinessAreasProgramsPaymentPlansSplitCreate({businessAreaSlug:x,id:f,programSlug:j,requestBody:y}),onSuccess:()=>{i(o("Payment Plan has been split successfully.")),n(!1)}});let u="Payments Number must be greater than 10",h=`Payments Number must be less than ${Qe(s.eligiblePaymentsCount)}`;if(s.eligiblePaymentsCount<=10){const x=`There are too few payments (${Qe(s.eligiblePaymentsCount)}) to split`;u=x,h=x}const m=Q.object().shape({splitType:Q.string().required("Split Type is required"),paymentsNo:Q.number().when("splitType",{is:"BY_RECORDS",then:x=>x.required("Payments Number is required").min(10,u).max(s.eligiblePaymentsCount,h)})}),g=async x=>{try{await d({businessAreaSlug:r,id:s.id,programSlug:l,requestBody:{splitType:x.splitType,paymentsNo:x.paymentsNo}}),n(!1),i(o("Split was successful!"))}catch(f){i(f)}};return e.jsx(B.Formik,{initialValues:KC,validationSchema:m,onSubmit:async x=>{await g(x)},children:({values:x,submitForm:f})=>e.jsxs(B.Form,{children:[e.jsx(H,{variant:"contained",color:"primary",onClick:()=>n(!0),endIcon:e.jsx(km,{}),disabled:!t,"data-perm":R.PM_SPLIT,children:o("Split")}),e.jsxs(is,{open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:o("Split into Payment Lists")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"splitType",label:"Split Type",choices:s.splitChoices,component:We})}),e.jsx(p,{size:{xs:12},children:x.splitType==="BY_RECORDS"&&e.jsx(B.Field,{name:"paymentsNo",label:"Payments Number",component:Se,type:"number",variant:"outlined"})})]})})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>n(!1),children:o("Cancel")}),e.jsx(ke,{loading:c,color:"primary",variant:"contained",onClick:f,"data-cy":"button-split",children:o("Split")})]})})]})]})})};function Yl({canSendToPaymentGateway:s,canSplit:t,paymentPlan:a,canClose:n}){const{t:i}=M(),r=Fe(),[l,o]=A.useState(!1),[d,c]=A.useState(""),{showMessage:u}=Ae(),{businessArea:h,programId:m}=U(),{mutateAsync:g,isPending:x}=xe({mutationFn:async()=>N.restBusinessAreasProgramsPaymentPlansCloseRetrieve({businessAreaSlug:h,programSlug:m,id:a.id}),onSuccess:()=>{u(i("Payment plan closed successfully"))},onError:G=>{fe(G,u)}}),{data:f,isLoading:j}=V({queryKey:["fspXlsxTemplates",h,m],queryFn:async()=>N.restBusinessAreasProgramsPaymentPlansFspXlsxTemplateListList({businessAreaSlug:h,programSlug:m}),enabled:l}),{mutateAsync:y,isPending:b}=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentPlansSendXlsxPasswordRetrieve({businessAreaSlug:h,programSlug:m,id:a.id}),onSuccess:()=>{u(i("Password has been sent."))},onError:G=>{fe(G,u)}}),{mutateAsync:C,isPending:v}=xe({mutationFn:async G=>{const W={fspXlsxTemplateId:G.fspXlsxTemplateId||""};return N.restBusinessAreasProgramsPaymentPlansGenerateXlsxWithAuthCodeCreate({businessAreaSlug:h,programSlug:m,id:a.id,requestBody:W})},onSuccess:()=>{u(i("Exporting XLSX started")),r.invalidateQueries({queryKey:["paymentPlan",h,a.id,m]})},onError:G=>{fe(G,u)}}),{mutateAsync:S,isPending:I}=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentPlansSendToPaymentGatewayRetrieve({businessAreaSlug:h,programSlug:m,id:a.id}),onSuccess:()=>{u(i("Sending to Payment Gateway started"))},onError:G=>{fe(G,u)}}),E=v||!a.canExportXlsx||a.backgroundActionStatus===bs.XLSX_EXPORTING,D=!a.canDownloadXlsx;if(j)return e.jsx(Ne,{});const F=()=>{o(!0)},w=()=>{o(!1)},O=G=>{c(G.target.value)},k=async()=>{try{await C({fspXlsxTemplateId:d}),w()}catch(G){fe(G,u)}},$=async()=>{try{await C({fspXlsxTemplateId:""}),w()}catch(G){u(G?.body?.errors||G?.message||"An error occurred while exporting")}};return e.jsx(P,{display:"flex",alignItems:"center",children:e.jsxs(e.Fragment,{children:[a.canCreateFollowUp&&e.jsx(P,{p:2,children:e.jsx(WC,{paymentPlan:a})}),e.jsx(P,{p:2,children:e.jsx(YC,{paymentPlan:a,canSplit:t})}),!a.hasPaymentListExportFile&&e.jsx(P,{m:2,children:e.jsx(ke,{loading:v,disabled:E,color:"primary",variant:"contained",startIcon:e.jsx(Ca,{}),"data-cy":"button-export-xlsx",onClick:a.fspCommunicationChannel==="API"?F:$,children:i("Export Xlsx")})}),n&&e.jsx(P,{m:2,children:e.jsx(ke,{color:"primary",variant:"contained","data-cy":"button-close",onClick:()=>g(),loading:x,children:i("Close")})}),e.jsxs(is,{open:l,onClose:w,children:[e.jsx(Le,{children:i("Select Template")}),e.jsx(Be,{children:e.jsx(at,{value:d,onChange:O,fullWidth:!0,variant:"outlined",size:"small","data-cy":"select-template",children:f?.results?.map(G=>e.jsx(de,{value:G.id,children:G.name},G.id))})}),e.jsxs(os,{children:[e.jsx(H,{"data-cy":"cancel-button",onClick:w,color:"primary",children:i("Cancel")}),e.jsx(H,{onClick:k,"data-cy":"export-button",color:"primary",disabled:!d,children:i("Export Xlsx")})]})]}),a.hasPaymentListExportFile&&e.jsxs(e.Fragment,{children:[e.jsx(P,{m:2,children:e.jsx(H,{color:"primary",component:"a",variant:"contained","data-cy":"button-download-xlsx",download:!0,href:`/api/download-payment-plan-payment-list/${a.id}`,disabled:D,"data-perm":R.PM_DOWNLOAD_XLSX_FOR_FSP,children:i("Download XLSX")})}),a.canSendXlsxPassword&&e.jsx(P,{m:2,children:e.jsx(ke,{loading:b,disabled:b,color:"primary",variant:"contained","data-cy":"button-send-xlsx-password",onClick:()=>y(),"data-perm":R.PM_SEND_XLSX_PASSWORD,children:i("Send Xlsx Password")})})]}),s&&e.jsx(P,{m:2,children:e.jsx(H,{type:"button",color:"primary",variant:"contained",onClick:()=>S(),"data-cy":"button-send-to-payment-gateway",disabled:I,"data-perm":R.PM_SEND_TO_PAYMENT_GATEWAY,children:i("Send to FSP")})})]})})}function QC({paymentPlan:s}){const{t}=M(),{isActiveProgram:a}=Z(),{businessArea:n,programId:i}=U(),[r,l]=A.useState(!1),{showMessage:o}=Ae(),d=Fe(),{mutateAsync:c,isPending:u}=xe({mutationFn:({businessAreaSlug:x,id:f,programSlug:j,requestBody:y})=>N.restBusinessAreasProgramsPaymentPlansApproveCreate({businessAreaSlug:x,id:f,programSlug:j,requestBody:y}),onSuccess:()=>{o(t("Payment Plan has been approved.")),l(!1),d.invalidateQueries({queryKey:["paymentPlan",n,s.id,i]})}}),h={comment:""},m=Q.object().shape({comment:Q.string().min(4,"Too short").max(255,"Too long")}),g=()=>{const x=s.approvalProcess?.[s.approvalProcess.length-1]?.approvalNumberRequired,f=s.approvalProcess?.[s.approvalProcess.length-1].actions?.approval?.length;return x-1===f};return e.jsx(B.Formik,{initialValues:h,onSubmit:(x,{resetForm:f})=>{c({businessAreaSlug:n,id:s.id,programSlug:i,requestBody:{comment:x.comment}}),f({})},validationSchema:m,children:({submitForm:x})=>e.jsxs(e.Fragment,{children:[r&&e.jsx(Bs,{}),e.jsx(P,{p:2,children:e.jsx(H,{color:"primary",variant:"contained",onClick:()=>l(!0),"data-cy":"button-approve","data-perm":R.PM_ACCEPTANCE_PROCESS_APPROVE,disabled:!a,children:t("Approve")})}),e.jsxs(is,{open:r,onClose:()=>l(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Approve Payment Plan")})}),e.jsx(Be,{children:e.jsxs(zs,{children:[e.jsx(P,{p:5,children:t("Are you sure you want to approve this Payment Plan?")}),g()&&e.jsx(P,{p:5,children:e.jsx(it,{children:t("Note: You are the last approver. Upon proceeding, this Payment Plan will be automatically moved to authorization stage.")})}),e.jsx(B.Form,{children:e.jsx(B.Field,{name:"comment",multiline:!0,fullWidth:!0,variant:"filled",label:"Comment (optional)",component:Se})})]})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>l(!1),children:"CANCEL"}),e.jsx(ke,{loading:u,type:"submit",color:"primary",variant:"contained",onClick:x,"data-cy":"button-submit",children:t("Approve")})]})})]})]})})}function Ql({paymentPlanId:s}){const{t}=M(),[a,n]=A.useState(!1),{showMessage:i}=Ae(),{isActiveProgram:r}=Z(),{businessArea:l,programId:o}=U(),d=Fe(),{mutateAsync:c,isPending:u}=xe({mutationFn:({businessAreaSlug:g,id:x,programSlug:f,requestBody:j})=>N.restBusinessAreasProgramsPaymentPlansRejectCreate({businessAreaSlug:g,id:x,programSlug:f,requestBody:j}),onSuccess:()=>{i(t("Payment Plan has been rejected.")),n(!1),d.invalidateQueries({queryKey:["paymentPlan",l,s,o]})}}),h={comment:""},m=Q.object().shape({comment:Q.string().min(4,"Too short").max(255,"Too long")});return e.jsx(B.Formik,{initialValues:h,onSubmit:(g,{resetForm:x})=>{c({businessAreaSlug:l,id:s,programSlug:o,requestBody:{comment:g.comment}}),n(!1),x({})},validationSchema:m,children:({submitForm:g})=>e.jsxs(e.Fragment,{children:[a&&e.jsx(Bs,{}),e.jsx(P,{p:2,children:e.jsx(Xi,{"data-cy":"button-reject",onClick:()=>n(!0),children:t("Reject")})}),e.jsxs(is,{open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Reject Payment Plan")})}),e.jsx(Be,{children:e.jsxs(zs,{children:[e.jsx(P,{p:5,children:t("Are you sure you want to reject this payment plan?")}),e.jsx(P,{p:5,children:e.jsx(it,{children:t("Note: Upon proceeding this payment plan will be automatically moved to locked status.")})}),e.jsx(B.Form,{children:e.jsx(B.Field,{name:"comment",multiline:!0,fullWidth:!0,variant:"filled",label:"Comment (optional)",component:Se})})]})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>n(!1),children:"CANCEL"}),e.jsx(ke,{loading:u,type:"submit",color:"primary",variant:"contained",onClick:g,dataCy:"button-submit",disabled:!r,"data-perm":R.PM_ACCEPTANCE_PROCESS_REJECT,children:t("Reject")})]})})]})]})})}function Kn({paymentPlan:s}){const{t}=M(),{isActiveProgram:a}=Z(),{businessArea:n,programId:i}=U(),[r,l]=A.useState(!1),{showMessage:o}=Ae(),d=Fe(),{mutateAsync:c,isPending:u}=xe({mutationFn:({businessAreaSlug:g,id:x,programSlug:f,requestBody:j})=>N.restBusinessAreasProgramsPaymentPlansAbortCreate({businessAreaSlug:g,id:x,programSlug:f,requestBody:j}),onSuccess:()=>{o(t("Payment Plan has been aborted.")),l(!1),d.invalidateQueries({queryKey:["paymentPlan",n,s.id,i]})}}),h={comment:""},m=Q.object().shape({comment:Q.string().min(4,"Too short").max(255,"Too long").required("Abort Reason is required")});return e.jsx(B.Formik,{initialValues:h,onSubmit:(g,{resetForm:x})=>{c({businessAreaSlug:n,id:s.id,programSlug:i,requestBody:{abortComment:g.comment}}),x({})},validationSchema:m,children:({submitForm:g})=>e.jsxs(e.Fragment,{children:[r&&e.jsx(Bs,{}),e.jsx(P,{p:2,children:e.jsx(H,{color:"secondary",variant:"outlined",onClick:()=>l(!0),"data-cy":"button-abort",disabled:!a,"data-perm":R.PM_ABORT,children:t("Abort")})}),e.jsxs(is,{open:r,onClose:()=>l(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Abort Payment Plan")})}),e.jsx(Be,{children:e.jsxs(zs,{children:[e.jsx(P,{p:5,children:t("Are you sure you want to abort this Payment Plan?")}),e.jsx(B.Form,{children:e.jsx(B.Field,{name:"comment",multiline:!0,fullWidth:!0,variant:"filled",label:t("Abort Reason"),component:Se,required:!0})})]})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>l(!1),children:"CANCEL"}),e.jsx(ke,{loading:u,type:"submit",color:"primary",variant:"contained",onClick:g,"data-cy":"button-submit-abort","data-perm":R.PM_ABORT,children:t("Abort")})]})})]})]})})}function Xl({paymentPlan:s,canReject:t,canApprove:a,canAbort:n}){return e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(Ql,{paymentPlanId:s.id}),a&&e.jsx(QC,{paymentPlan:s}),n&&e.jsx(Kn,{paymentPlan:s})]})}function XC({paymentPlan:s}){const{t}=M(),[a,n]=A.useState(!1),{isActiveProgram:i}=Z(),{businessArea:r,programId:l}=U(),{showMessage:o}=Ae(),d=Fe(),{mutateAsync:c,isPending:u}=xe({mutationFn:({businessAreaSlug:x,id:f,programSlug:j,requestBody:y})=>N.restBusinessAreasProgramsPaymentPlansAuthorizeCreate({businessAreaSlug:x,id:f,programSlug:j,requestBody:y}),onSuccess:()=>{o(t("Payment Plan has been authorized.")),n(!1),d.invalidateQueries({queryKey:["paymentPlan",r,s.id,l]})}}),h={comment:""},m=Q.object().shape({comment:Q.string().min(4,"Too short").max(255,"Too long")}),g=()=>{const x=s.approvalProcess?.[s.approvalProcess.length-1]?.authorizationNumberRequired,f=s.approvalProcess?.[s.approvalProcess.length-1].actions?.authorization?.length;return x-1===f};return e.jsx(B.Formik,{initialValues:h,onSubmit:(x,{resetForm:f})=>{c({businessAreaSlug:r,id:s.id,programSlug:l,requestBody:{comment:x.comment}}),f({})},validationSchema:m,children:({submitForm:x})=>e.jsxs(e.Fragment,{children:[a&&e.jsx(Bs,{}),e.jsx(P,{p:2,children:e.jsx(H,{color:"primary",variant:"contained",onClick:()=>n(!0),"data-cy":"button-authorize",disabled:!i,"data-perm":R.PM_ACCEPTANCE_PROCESS_AUTHORIZE,children:t("Authorize")})}),e.jsxs(is,{open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Authorize")})}),e.jsx(Be,{children:e.jsxs(zs,{children:[e.jsx(P,{p:5,children:t("Are you sure you want to authorize this Payment Plan?")}),g()&&e.jsx(P,{p:5,children:e.jsx(it,{children:t("Note: Upon Proceeding, this Payment Plan will be automatically moved to Finance Release stage.")})}),e.jsx(B.Form,{children:e.jsx(B.Field,{name:"comment",multiline:!0,fullWidth:!0,variant:"filled",label:"Comment (optional)",component:Se})})]})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>n(!1),children:"CANCEL"}),e.jsx(ke,{loading:u,type:"submit",color:"primary",variant:"contained",onClick:x,"data-cy":"button-submit","data-perm":R.PM_ACCEPTANCE_PROCESS_AUTHORIZE,children:t("Authorize")})]})})]})]})})}function Jl({paymentPlan:s,canReject:t,canAuthorize:a,canAbort:n}){return e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(Ql,{paymentPlanId:s.id}),a&&e.jsx(XC,{paymentPlan:s}),n&&e.jsx(Kn,{paymentPlan:s})]})}function JC({paymentPlan:s}){const{t}=M(),{isActiveProgram:a}=Z(),{businessArea:n,programId:i}=U(),[r,l]=A.useState(!1),{showMessage:o}=Ae(),d=Fe(),{mutateAsync:c,isPending:u}=xe({mutationFn:({businessAreaSlug:x,id:f,programSlug:j,requestBody:y})=>N.restBusinessAreasProgramsPaymentPlansMarkAsReleasedCreate({businessAreaSlug:x,id:f,programSlug:j,requestBody:y}),onSuccess:()=>{o(t("Payment Plan has been marked as released.")),l(!1),d.invalidateQueries({queryKey:["paymentPlan",n,s.id,i]})}}),h=()=>{const x=s.approvalProcess?.[s.approvalProcess.length-1]?.financeReleaseNumberRequired,f=s.approvalProcess?.[s.approvalProcess.length-1].actions?.financeRelease?.length;return x-1===f},m={comment:""},g=Q.object().shape({comment:Q.string().min(4,"Too short").max(255,"Too long")});return e.jsx(B.Formik,{initialValues:m,onSubmit:(x,{resetForm:f})=>{c({businessAreaSlug:n,id:s.id,programSlug:i,requestBody:{comment:x.comment}}),f({})},validationSchema:g,children:({submitForm:x})=>e.jsxs(e.Fragment,{children:[r&&e.jsx(Bs,{}),e.jsx(P,{p:2,children:e.jsx(H,{color:"primary",variant:"contained",onClick:()=>l(!0),"data-cy":"button-mark-as-released",disabled:!a,children:t("Mark as released")})}),e.jsxs(is,{open:r,onClose:()=>l(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Mark as Released")})}),e.jsx(Be,{children:e.jsxs(zs,{children:[e.jsx(P,{p:5,children:t("Are you sure you want to mark this Payment Plan as released?")}),h()&&e.jsx(P,{p:5,children:e.jsx(it,{children:t("Note: You are the last reviewer. Upon proceeding, this Payment Plan will be automatically moved to accepted status")})}),e.jsx(B.Form,{children:e.jsx(B.Field,{name:"comment",multiline:!0,fullWidth:!0,variant:"filled",label:"Comment (optional)",component:Se})})]})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>l(!1),children:"CANCEL"}),e.jsx(ke,{loading:u,type:"submit",color:"primary",variant:"contained",onClick:x,"data-cy":"button-submit",children:t("Mark as released")})]})})]})]})})}function Zl({paymentPlan:s,canReject:t,canMarkAsReleased:a,canAbort:n}){return e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(Ql,{paymentPlanId:s.id}),a&&e.jsx(JC,{paymentPlan:s}),n&&e.jsx(Kn,{paymentPlan:s})]})}function eo({paymentPlan:s,canUnlock:t,canSendForApproval:a,canAbort:n}){const{t:i}=M(),{showMessage:r}=Ae(),{isActiveProgram:l}=Z(),{businessArea:o,programId:d}=U(),c=Fe(),{mutateAsync:u,isPending:h}=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentPlansUnlockFspRetrieve({businessAreaSlug:o,programSlug:d,id:s.id}),onSuccess:async()=>{r(i("Payment Plan FSPs have been unlocked.")),await c.invalidateQueries({queryKey:["paymentPlan",o,s.id,d],exact:!1})},onError:x=>{fe(x,r)}}),{mutateAsync:m,isPending:g}=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentPlansSendForApprovalRetrieve({businessAreaSlug:o,programSlug:d,id:s.id}),onSuccess:async()=>{r(i("Payment Plan has been sent for approval.")),await c.invalidateQueries({queryKey:["paymentPlan",o,s.id,d],exact:!1})},onError:x=>{fe(x,r)}});return e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(P,{m:2,children:e.jsx(ke,{loading:h,variant:"outlined",color:"primary",onClick:()=>u(),disabled:!l,"data-cy":"button-unlock-fsp",children:i("Unlock FSP")})}),a&&e.jsx(P,{m:2,children:e.jsx(ke,{loading:g,variant:"contained",color:"primary",onClick:()=>m(),"data-cy":"button-send-for-approval",disabled:!l,children:i("Send For Approval")})}),n&&e.jsx(P,{m:2,children:e.jsx(Kn,{paymentPlan:s})})]})}function ZC({paymentPlan:s,permissions:t}){const{t:a}=M(),{showMessage:n}=Ae(),{isActiveProgram:i}=Z(),[r,l]=A.useState(!1),{businessArea:o,programId:d}=U(),c=Fe(),{mutateAsync:u,isPending:h}=xe({mutationFn:({businessAreaSlug:g,id:x,programSlug:f})=>N.restBusinessAreasProgramsPaymentPlansLockFspRetrieve({businessAreaSlug:g,id:x,programSlug:f}),onSuccess:async()=>{n(a("Payment Plan FSPs are locked.")),l(!1),await c.invalidateQueries({queryKey:["paymentPlan",o,s.id,d],exact:!1})},onError:g=>{fe(g,n)}}),m=K(R.PM_LOCK_AND_UNLOCK_FSP,t);return e.jsxs(e.Fragment,{children:[e.jsx(P,{p:2,children:e.jsx(H,{color:"primary",variant:"contained",onClick:()=>l(!0),"data-cy":"button-lock-plan",disabled:!m||!i,"data-perm":R.PM_LOCK_AND_UNLOCK_FSP,children:a("Lock FSP")})}),e.jsxs(is,{open:r,onClose:()=>l(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Lock FSP")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsx(P,{p:5,children:a("After you lock the FSP in this Payment Plan, you will be able to send the Payment Plan for approval.")})})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>l(!1),children:"CANCEL"}),e.jsx(ke,{loading:h,type:"submit",color:"primary",variant:"contained",onClick:()=>u({businessAreaSlug:o,id:s.id,programSlug:d}),"data-cy":"button-submit",children:a("Lock FSP")})]})})]})]})}function so({paymentPlan:s,canUnlock:t,permissions:a,canAbort:n}){const{t:i}=M(),{showMessage:r}=Ae(),{isActiveProgram:l}=Z(),{businessArea:o,programId:d}=U(),c=Fe(),{mutateAsync:u,isPending:h}=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentPlansUnlockRetrieve({businessAreaSlug:o,programSlug:d,id:s.id}),onSuccess:async()=>{r(i("Payment Plan has been unlocked.")),await c.invalidateQueries({queryKey:["paymentPlan",o,s.id,d],exact:!1})},onError:m=>{fe(m,r)}});return e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(P,{m:2,children:e.jsx(ke,{loading:h,variant:"outlined",color:"primary",onClick:()=>u(),disabled:!l,"data-cy":"button-unlock-payment-plan","data-perm":R.PM_LOCK_AND_UNLOCK,children:i("Unlock")})}),e.jsx(ZC,{paymentPlan:s,permissions:a}),n&&e.jsx(P,{m:2,children:e.jsx(Kn,{paymentPlan:s})})]})}function eE({paymentPlan:s}){const t=ge(),{t:a}=M(),{businessArea:n,programId:i}=U(),[r,l]=A.useState(!1),{baseUrl:o}=U(),{showMessage:d}=Ae(),{mutateAsync:c,isPending:u}=xe({mutationFn:({businessAreaSlug:x,id:f,programSlug:j})=>N.restBusinessAreasProgramsPaymentPlansDestroy({businessAreaSlug:x,id:f,programSlug:j})}),{id:h}=s,{isActiveProgram:m}=Z(),g=async()=>{try{await c({businessAreaSlug:n,programSlug:i,id:h}),d(a("Payment Plan Deleted")),t(`/${o}/payment-module/payment-plans`)}catch(x){x.message&&x.message.includes("Unexpected end of JSON input")?(d(a("Payment Plan Deleted")),t(`/${o}/payment-module/payment-plans`)):d(x.message)}};return e.jsxs(e.Fragment,{children:[e.jsx(P,{p:2,children:e.jsx(Ve,{onClick:()=>l(!0),disabled:!m,"data-cy":"button-delete-pp",children:e.jsx(Rs,{})})}),e.jsxs(is,{open:r,onClose:()=>l(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Delete Payment Plan")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsx(P,{p:5,children:a("Are you sure you want to remove this Payment Plan?")})})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>l(!1),children:"CANCEL"}),e.jsx(ke,{loading:u,type:"submit",color:"primary",variant:"contained",onClick:()=>g(),"data-cy":"button-submit",children:a("Delete")})]})})]})]})}function sE({paymentPlan:s}){const{t}=M(),{showMessage:a}=Ae(),{selectedProgram:n}=Z(),{businessArea:i,programId:r}=U(),l=Fe(),o=n?.beneficiaryGroup,[d,c]=A.useState(!1),{mutateAsync:u,isPending:h}=xe({mutationFn:({businessAreaSlug:m,id:g,programSlug:x})=>N.restBusinessAreasProgramsPaymentPlansLockRetrieve({businessAreaSlug:m,id:g,programSlug:x}),onSuccess:async()=>{a(t("Payment Plan has been locked.")),c(!1),await l.invalidateQueries({queryKey:["paymentPlan",i,s.id,r],exact:!1})},onError:m=>{fe(m,a)}});return e.jsxs(e.Fragment,{children:[e.jsx(P,{p:2,children:e.jsx(H,{color:"primary",variant:"contained",onClick:()=>c(!0),"data-cy":"button-lock-plan","data-perm":R.PM_LOCK_AND_UNLOCK,children:t("Lock")})}),e.jsxs(is,{open:d,onClose:()=>c(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Lock Payment Plan")})}),e.jsx(Be,{children:e.jsxs(zs,{children:[e.jsx(P,{p:5,children:t("After you lock this Payment Plan, you will be able to run entitlement formula for selected target population.")}),s.paymentsConflictsCount>0&&e.jsx(P,{p:5,children:e.jsxs(it,{children:[t("Note:")," ",s.paymentsConflictsCount===1?t("There is"):t("There are")," ",s.paymentsConflictsCount," ",s.paymentsConflictsCount===1?t(o?.groupLabel):t(o?.groupLabelPlural)," ",t("that will be ignored in this Payment Plan.")]})})]})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>c(!1),children:"CANCEL"}),e.jsx(ke,{loading:h,type:"submit",color:"primary",variant:"contained",onClick:()=>u({businessAreaSlug:i,id:s.id,programSlug:r}),"data-cy":"button-submit",children:t("Lock")})]})})]})]})}function to({paymentPlan:s,canRemove:t,canEdit:a,canLock:n}){const{t:i}=M(),{isActiveProgram:r}=Z();return e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(eE,{paymentPlan:s}),a&&e.jsx(P,{m:2,children:e.jsx(H,{variant:"outlined",color:"primary",startIcon:e.jsx(Ha,{}),"data-cy":"button-edit-payment-plan",component:ys,to:"./edit",disabled:!r,children:i("Edit")})}),n&&e.jsx(P,{m:2,children:e.jsx(sE,{paymentPlan:s})})]})}const fd=T.div`
  margin-left: 30px;
`;function Hu({baseUrl:s,permissions:t,paymentPlan:a}){const{t:n}=M(),i=[{title:n("Payment Module"),to:`/${s}/payment-module/payment-plans`}],r=K(R.PM_CREATE,t),l=K(R.PM_CREATE,t),o=K(R.PM_LOCK_AND_UNLOCK,t),d=K(R.PM_LOCK_AND_UNLOCK,t),c=K(R.PM_SEND_FOR_APPROVAL,t),u=K(R.PM_ACCEPTANCE_PROCESS_APPROVE,t),h=K(R.PM_ACCEPTANCE_PROCESS_AUTHORIZE,t),m=K(R.PM_ACCEPTANCE_PROCESS_FINANCIAL_REVIEW,t),g=K(R.PM_CLOSE_FINISHED,t),x=K(R.PM_SEND_TO_PAYMENT_GATEWAY,t)&&a.canSendToPaymentGateway,f=K(R.PM_SPLIT,t)&&a.canSplit,j=K(R.PM_ABORT,t);let y=null;switch(a.status){case"OPEN":y=e.jsx(to,{paymentPlan:a,canRemove:r,canEdit:l,canLock:o});break;case"LOCKED":y=e.jsx(so,{paymentPlan:a,canUnlock:d,permissions:t,canAbort:j});break;case"LOCKED_FSP":y=e.jsx(eo,{paymentPlan:a,canUnlock:d,canSendForApproval:c,canAbort:j});break;case"IN_APPROVAL":y=e.jsx(Xl,{paymentPlan:a,canReject:K(R.PM_ACCEPTANCE_PROCESS_APPROVE,t),canApprove:u,canAbort:j});break;case"IN_AUTHORIZATION":y=e.jsx(Jl,{paymentPlan:a,canReject:K(R.PM_ACCEPTANCE_PROCESS_AUTHORIZE,t),canAuthorize:h,canAbort:j});break;case"IN_REVIEW":y=e.jsx(Zl,{paymentPlan:a,canReject:K(R.PM_ACCEPTANCE_PROCESS_FINANCIAL_REVIEW,t),canMarkAsReleased:m,canAbort:j});break;case"ACCEPTED":case"FINISHED":y=e.jsx(Yl,{canSendToPaymentGateway:x,paymentPlan:a,canSplit:f,canClose:g});break}return e.jsx(Ze,{title:e.jsxs(P,{display:"flex",alignItems:"center",children:[n("Follow-up Payment Plan")," ID:"," ",e.jsx(P,{ml:1,children:e.jsx("span",{"data-cy":"pp-unicef-id",children:a.unicefId})}),e.jsx(fd,{children:e.jsx(we,{status:a.status,statusToColor:Vt})}),a.backgroundActionStatus&&e.jsx(fd,{children:e.jsx(we,{status:a.backgroundActionStatus,statusToColor:wi})})]}),breadCrumbs:K(R.PM_VIEW_DETAILS,t)?i:null,flags:e.jsx(gt,{adminUrl:a.adminUrl}),children:y})}const Wu=({...s})=>e.jsx(ks,{...s,variant:"outlined",size:"small"}),tE=T(P)`
  width: 100%;
  height: 30px;
  background-color: #f4f5f6;
  color: '#404040';
`,aE=T.div`
  text-decoration: ${({isDeleted:s})=>s?"line-through":"none"};
`;function nE({id:s,onDelete:t,onUndo:a,isDeleted:n,isEdit:i}){const{t:r}=M();return e.jsxs(tE,{display:"flex",alignItems:"center",justifyContent:"space-between",pl:8,pr:8,pt:4,pb:4,mt:2,children:[e.jsx(aE,{isDeleted:n,children:s}),i&&(n?e.jsx(H,{variant:"text",color:"primary",onClick:a,children:r("Undo")}):e.jsx(Ve,{onClick:t,children:e.jsx(Rs,{})}))]})}function iE({initialOpen:s=!1,paymentPlan:t}){const{status:a,backgroundActionStatus:n,exclusionReason:i,excludeHouseholdError:r}=t,{selectedProgram:l}=Z(),o=l?.beneficiaryGroup,d=t?.excludedHouseholds?.map(ie=>ie.unicefId),[c,u]=A.useState(s),[h,m]=A.useState(""),[g,x]=A.useState(d||[]),[f,j]=A.useState([]),{t:y}=M(),b=ve(),{isActiveProgram:C}=Z(),{businessArea:v,programId:S}=U(),I=Fe(),{showMessage:E}=Ae(),{mutateAsync:D}=xe({mutationFn:ie=>N.restBusinessAreasProgramsPaymentPlansExcludeBeneficiariesCreate({businessAreaSlug:v,programSlug:S,id:t.id,requestBody:ie}),onSuccess:()=>{I.invalidateQueries({queryKey:["paymentPlan",v,t.id,S]})},onError:ie=>{fe(ie,E)}}),F=K(R.PM_EXCLUDE_BENEFICIARIES_FROM_FOLLOW_UP_PP,b),w=a===te.LOCKED||a===te.OPEN,O=()=>w?F?"":y("Permission denied"):`${o?.groupLabelPlural} can only be excluded from a Payment Plan in status open or locked`,[k,$]=A.useState([]),[G,W]=A.useState(!1),Y=ie=>{ie.target.value===""&&$([]),m(ie.target.value)},X={exclusionReason:t.exclusionReason||""},J=Q.object().shape({exclusionReason:Q.string().max(500,y("Too long"))}),ae=ie=>{const Pe=g.filter(ue=>!f.includes(ue));D({excludedHouseholdsIds:Pe,exclusionReason:ie.exclusionReason})},re=()=>{const ie=/^(\s*HH-\d{2}-\d{4}\.\d{4}\s*)(,\s*HH-\d{2}-\d{4}\.\d{4}\s*)*$/,Pe=h.trim().split(/,\s*|\s+/),ue=[],Ge=[],ls=[];for(const xs of Pe)ie.test(xs)?g.includes(xs.trim())?Ge.push(xs):ls.push(xs):ue.push(xs);const qe=[];ue.length>0&&qe.push(` Invalid IDs: ${ue.join(", ")}`),Ge.length>0&&qe.push(` IDs already excluded: ${Ge.join(", ")}`),qe.length>0?$(qe):($([]),x([...g,...ls]),m(""))},se=ie=>{f.includes(ie)||j([...f,ie])},le=ie=>{f.includes(ie)&&j(f.filter(Pe=>Pe!==ie))},ce=ie=>f.includes(ie),_e=g.length-f.length,ne=(ie,Pe,ue)=>{const Ge=_e===0,ls=c&&G,qe=!c&&_e>0||!c&&f.length>0,xs=()=>{u(!1),$([]),m(""),ue(),W(!1)},Oe=()=>{ie()},es=!F||!w||g.length===0||!!n,ye=!F||!w;return ls?e.jsxs(P,{display:"flex",alignItems:"center",justifyContent:"center",children:[e.jsx(P,{mr:2,children:e.jsx(H,{variant:"text",color:"primary","data-cy":"button-cancel-exclusions",onClick:xs,children:y("Cancel")})}),e.jsx(Vs,{title:O(),variant:"contained",color:"primary",disabled:es,onClick:Oe,"data-cy":"button-save-exclusions",children:y("Save")})]}):qe?e.jsx(H,{variant:"contained",color:"primary",onClick:()=>{u(!0),W(!1)},"data-cy":"button-preview-exclusions",children:y("Preview Exclusion")}):c?e.jsxs(P,{display:"flex",alignItems:"center",justifyContent:"center",children:[e.jsx(P,{mr:2,children:e.jsx(H,{variant:"text",color:"primary",onClick:xs,children:y("Close")})}),F&&e.jsx(Vs,{color:"primary",title:O(),disabled:ye,variant:"contained",onClick:()=>W(!0),dataCy:"button-edit-exclusions",dataPerm:R.PM_EXCLUDE_BENEFICIARIES_FROM_FOLLOW_UP_PP,children:y("Edit")})]}):Ge&&!f.length?e.jsx(H,{variant:"contained",color:"primary","data-cy":"button-create-exclusions",onClick:()=>{u(!0),W(!0)},disabled:!C,children:y("Create")}):null},Ue=()=>{const ie=!F||!w||!!n;return G||_e===0?e.jsx(P,{mt:2,display:"flex",alignItems:"center",children:e.jsxs(p,{alignItems:"flex-start",container:!0,spacing:3,children:[e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"exclusionReason",fullWidth:!0,multiline:!0,variant:"outlined",label:y("Reason"),component:Se})}),e.jsx(p,{size:{xs:6},children:e.jsx(P,{mr:2,children:e.jsx(Wu,{label:`${o?.groupLabelPlural} Ids`,"data-cy":"input-households-ids",value:h,onChange:Y,fullWidth:!0,error:k.length>0})})}),e.jsx(p,{children:e.jsx(Vs,{title:O(),variant:"contained",color:"primary",disabled:!h||ie,"data-cy":"button-apply-exclusions",onClick:()=>{re()},children:y("Apply")})})]})}):null},Te=ie=>ie.replace(/\[|\]|'|"/g,"").split(", ");return e.jsx(B.Formik,{initialValues:X,validationSchema:J,onSubmit:ie=>ae(ie),enableReinitialize:!0,children:({submitForm:ie,values:Pe,resetForm:ue})=>e.jsx(B.Form,{children:e.jsxs(ft,{children:[e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(ee,{variant:"h6",children:y("Exclude")}),ne(ie,Pe,ue)]}),!c&&_e>0?e.jsx(P,{mt:2,mb:2,children:e.jsx(it,{children:`${_e} ${_e===1?`${o?.groupLabel}`:`${o?.groupLabelPlural}`} excluded`})}):null,e.jsx(yt,{in:c,children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[c&&i&&!G?e.jsx(p,{container:!0,children:e.jsx(p,{size:{xs:8},children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsxs(P,{display:"flex",alignItems:i.length>100?"flex-start":"center",mt:4,mb:2,children:[e.jsx(P,{mr:2,children:e.jsxs(it,{children:[y("Reason"),":"]})}),e.jsx(ee,{children:i})]}),r&&e.jsx(P,{display:"flex",flexDirection:"column",mt:2,children:Te(r).map(Ge=>e.jsx(Ls,{error:!0,children:Ge},Ge))})]})})}):null,Ue(),e.jsx(p,{container:!0,size:{xs:6},children:k?.map(Ge=>e.jsx(p,{size:{xs:12},children:e.jsx(Ls,{error:!0,children:Ge},Ge)},Ge))}),e.jsx(p,{container:!0,direction:"column",size:{xs:3},children:g.map(Ge=>e.jsx(p,{size:{xs:12},children:e.jsx(nE,{id:Ge,onDelete:()=>se(Ge),onUndo:()=>le(Ge),isDeleted:ce(Ge),isEdit:G},Ge)},Ge))})]})})]})})})}const Ku=oe(iE,"ExcludeSection"),rE=T(Ii)`
  color: ${({theme:s,confirmed:t})=>t?"deeppink":s.hctPalette.orange};
`;function Sa({confirmed:s=!1,message:t="",handleClick:a}){return e.jsx(Ms,{onClick:a,title:t,children:e.jsx(rE,{confirmed:s})})}const lE=Ft(dt)`
  margin-right: 10px;
`,oE=Ft(Ct)`
  color: #707070;
`,ao=({paymentPlan:s})=>{const t=s?.fundsCommitments||null,a=s?.fundsCommitments?.fundsCommitmentItems?.map(E=>E.recSerialNumber)||[],n=Fe(),{showMessage:i}=Ae(),r=ve(),{businessArea:l}=U(),{mutateAsync:o,isPending:d}=xe({mutationFn:async({fundCommitmentItemsIds:E})=>N.restBusinessAreasProgramsPaymentPlansAssignFundsCommitmentsCreate({businessAreaSlug:l,programSlug:s.program.slug,id:s.id,requestBody:{fundCommitmentItemsIds:E}}),onSuccess:()=>{n.invalidateQueries({queryKey:["paymentPlan",s.id]})}}),[c,u]=A.useState(t),[h,m]=A.useState(a),g=K(R.PM_ASSIGN_FUNDS_COMMITMENTS,r),x=A.useMemo(()=>s?.availableFundsCommitments||[],[s]),f=A.useMemo(()=>{if(c)return x.find(E=>E?.fundsCommitmentNumber===c?.fundsCommitmentNumber)},[x,c]),j=E=>{u(E),m([])},y=E=>{const D=E.target.value;if(f)if(D.includes("select-all")){const F=f.fundsCommitmentItems?.map(w=>w.recSerialNumber)||[];h.length===F.length?m([]):m(F)}else{const F=Number(D[D.length-1]);h.includes(F)?m(h.filter(w=>w!==F)):m([...h,F])}},b=async()=>{if(s)try{await o({fundCommitmentItemsIds:h.map(E=>E.toString())}),i(Ee("Funds commitment items assigned successfully")),await n.invalidateQueries({queryKey:["paymentPlan"]})}catch(E){fe(E,i)}},C=(E,D)=>{if(E.length!==D.length)return!1;const F=new Set(E);return D.every(w=>F.has(w))},v=A.useMemo(()=>s?.fundsCommitments?.fundsCommitmentItems?.map(E=>E.recSerialNumber)||[],[s]),S=A.useMemo(()=>C(h,v),[h,v]),I=()=>{m([])};return e.jsx(P,{m:5,children:e.jsxs(Fs,{children:[e.jsx(P,{mt:4,children:e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:Ee("Funds Commitment")})})}),s.status===te.IN_REVIEW&&e.jsxs(Js.Fragment,{children:[e.jsx(P,{mt:2,children:e.jsx(tt,{fullWidth:!0,size:"small",children:e.jsx(ha,{value:c,onChange:(E,D)=>j(D),options:x,getOptionLabel:E=>E?.fundsCommitmentNumber||"",renderInput:E=>e.jsx(ks,{...E,label:Ee("Funds Commitment")}),renderOption:(E,D)=>e.jsx(de,{...E,value:D?.fundsCommitmentNumber,children:D?.fundsCommitmentNumber}),isOptionEqualToValue:(E,D)=>E.fundsCommitmentNumber===D?.fundsCommitmentNumber,noOptionsText:Ee("No options"),clearOnEscape:!0})})}),f&&e.jsx(P,{mt:2,children:e.jsxs(tt,{fullWidth:!0,size:"small",children:[e.jsx(Rt,{children:Ee("Funds Commitment Items")}),e.jsxs(at,{multiple:!0,label:Ee("Funds Commitment Items"),value:h.map(String),onChange:y,renderValue:E=>Array.isArray(E)?E.join(", "):E,endAdornment:e.jsx(lE,{position:"end",children:e.jsx(Ve,{size:"medium",onMouseDown:E=>{E.preventDefault(),I()},children:e.jsx(oE,{fontSize:"small"})})}),children:[e.jsxs(de,{value:"select-all",children:[e.jsx(ns,{checked:f?.fundsCommitmentItems.length>0&&f?.fundsCommitmentItems.every(E=>h.includes(E.recSerialNumber)),indeterminate:f?.fundsCommitmentItems.some(E=>h.includes(E.recSerialNumber))&&!f.fundsCommitmentItems.every(E=>h.includes(E.recSerialNumber))}),e.jsx(ia,{primary:Ee("Select All")})]}),f.fundsCommitmentItems.map(E=>e.jsxs(de,{value:E.recSerialNumber,children:[e.jsx(ns,{checked:h.includes(E.recSerialNumber)}),e.jsx(ia,{primary:`${E.fundsCommitmentItem} - ${E.recSerialNumber}`})]},E.recSerialNumber))]})]})}),e.jsx(P,{mt:3,children:e.jsx(Ms,{title:g?"":Ee("Permission Denied"),arrow:!0,children:e.jsx("span",{children:e.jsx(ke,{variant:"contained",loading:d,color:"primary",onClick:b,disabled:d||!g||!c||h.length===0||S,children:Ee("Assign Funds Commitments")})})})})]}),s?.fundsCommitments?.fundsCommitmentItems?.length>0&&e.jsx(Js.Fragment,{children:e.jsxs(P,{mt:2,children:[s?.fundsCommitments?.fundsCommitmentNumber&&e.jsxs(ee,{variant:"h6",fontWeight:"bold",mb:2,children:[Ee("Funds Commitment Number"),":"," ",Qe(f?.fundsCommitmentNumber)??"-"," ",s.fundsCommitments.insufficientAmount&&e.jsx(Sa,{message:Ee("Insufficient Commitment Amount")})]}),s?.fundsCommitments?.fundsCommitmentItems?.map((E,D)=>e.jsxs(P,{mb:4,children:[e.jsxs(ee,{variant:"subtitle1",fontWeight:"bold",mb:2,children:[Ee("Item")," #",E.fundsCommitmentItem]}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:3,children:e.jsx(L,{label:Ee("WBS Element"),value:E.wbsElement})}),e.jsx(p,{size:3,children:e.jsx(L,{label:Ee("Grant Number"),value:E.grantNumber})}),e.jsx(p,{size:3,children:e.jsx(L,{label:Ee("Currency Code"),value:E.currencyCode})}),e.jsx(p,{size:3,children:e.jsx(L,{label:Ee("Commitment Amount Local"),value:Qe(E.commitmentAmountLocal)})}),e.jsx(p,{size:3,children:e.jsx(L,{label:Ee("Commitment Amount USD"),value:Qe(E.commitmentAmountUsd)})}),e.jsx(p,{size:3,children:e.jsx(L,{label:Ee("Total Open Amount Local"),value:Qe(E.totalOpenAmountLocal)})}),e.jsx(p,{size:3,children:e.jsx(L,{label:Ee("Total Open Amount USD"),value:Qe(E.totalOpenAmountUsd)})}),e.jsx(p,{size:3,children:e.jsx(L,{label:Ee("Sponsor"),value:`${E.sponsor??"-"} ${E.sponsorName??"-"}`})})]}),D<s?.fundsCommitments?.fundsCommitmentItems?.length-1&&e.jsx(P,{sx:{borderBottom:"1px solid #e0e0e0",my:3,width:"100%"}})]},D)),(!s?.fundsCommitments||!s?.fundsCommitments?.fundsCommitmentItems?.length)&&e.jsx(ee,{variant:"body1",children:Ee("No funds commitment items assigned")})]})})]})})},fa={femaleChildren:"#5F02CF",maleChildren:"#1D6A64",femaleAdult:"#DFCCF5",maleAdult:"#B1E3E0"},dE=T.div`
  padding-bottom: ${({theme:s})=>s.spacing(2)};
`,cE=T.div`
  display: flex;
`,tl=T.div`
  padding: ${({theme:s})=>s.spacing(4)};
  border-color: #b1b1b5;
  border-left-width: 1px;
  border-left-style: solid;
`,al=T.div`
  font-family: ${({theme:s})=>s.hctTypography.fontFamily};
  color: #253b46;
  font-size: 36px;
  line-height: 32px;
  margin-top: ${({theme:s})=>s.spacing(2)};
`,uE=T.div`
  width: 100px;
  height: 100px;
  margin: 0 auto;
`,hE=({paymentPlan:s})=>{const{totalHouseholdsCount:t,totalIndividualsCount:a}=s,{selectedProgram:n}=Z(),i=n?.beneficiaryGroup;return e.jsx(p,{size:{xs:4},children:e.jsxs(p,{container:!0,spacing:0,justifyContent:"flex-end",children:[e.jsx(p,{size:{xs:6},children:e.jsx(tl,{children:e.jsx(L,{label:`Total Number of ${i?.groupLabelPlural}`,children:e.jsx(al,{children:t||"0"})})})}),e.jsx(p,{size:{xs:6},children:e.jsx(tl,{children:e.jsx(L,{label:`Targeted ${i?.memberLabelPlural}`,children:e.jsx(al,{children:a||"0"})})})})]})})},mE=({paymentPlan:s})=>{const{t}=M(),{totalHouseholdsCount:a}=s;return e.jsx(p,{size:{xs:4},children:e.jsx(p,{container:!0,spacing:0,justifyContent:"flex-end",children:e.jsx(p,{children:e.jsx(tl,{children:e.jsx(L,{label:t("Total Number of People"),children:e.jsx(al,{children:a||"0"})})})})})})},no=({paymentPlan:s})=>{const{t}=M(),{isSocialDctType:a}=Z(),{femaleChildrenCount:n,maleChildrenCount:i,femaleAdultsCount:r,maleAdultsCount:l}=s,o=a?mE:hE;return e.jsxs(ft,{children:[e.jsx(dE,{children:e.jsx(ee,{variant:"h6",children:t("Results")})}),e.jsx(cE,{children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:4},children:e.jsxs(p,{container:!0,spacing:3,justifyContent:"flex-start",children:[e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:fa.femaleChildren,children:e.jsx(L,{label:t("Female Children"),value:n})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:fa.femaleAdult,children:e.jsx(L,{label:t("Female Adults"),value:r})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:fa.maleChildren,children:e.jsx(L,{label:t("Male Children"),value:i})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:fa.maleAdult,children:e.jsx(L,{label:t("Male Adults"),value:l})})})]})}),e.jsx(p,{size:{xs:4},children:e.jsx(p,{container:!0,spacing:0,justifyContent:"flex-start",alignItems:"center",children:e.jsx(p,{size:{xs:4},children:e.jsx(uE,{"data-cy":"chart-container",children:e.jsx(gl,{width:100,height:100,options:{plugins:{legend:{display:!1}},responsive:!0,maintainAspectRatio:!1},data:{labels:[t("Female Children"),t("Female Adults"),t("Male Children"),t("Male Adults")],datasets:[{data:[n,r,i,l],backgroundColor:[fa.femaleChildren,fa.femaleAdult,fa.maleChildren,fa.maleAdult]}]}})})})})}),e.jsx(o,{paymentPlan:s})]})})]})},pE=T.div`
  padding-bottom: ${({theme:s})=>s.spacing(2)};
`,gE=T.div`
  display: flex;
`,xE=T.div`
  width: 100px;
  height: 100px;
  margin: 0 auto;
`,fE=T.div`
  padding-bottom: 8px;
`;function tr({paymentPlan:s}){const{t}=M(),{reconciliationSummary:{deliveredFully:a,deliveredPartially:n,unsuccessful:i,notDelivered:r,numberOfPayments:l,pending:o,reconciled:d}}=s,c=[{label:t("Delivered fully"),value:a,color:"#10CB16"},{label:t("Delivered partially"),value:n,color:"#FC942A"},{label:t("Not delivered"),value:r,color:"#EF4343"},{label:t("Unsuccessful"),value:i,color:"#EF4343"},{label:t("Pending"),value:o,color:"#4E606A"}],u=(d/l*100).toFixed(0);return e.jsxs(ft,{children:[e.jsx(pE,{children:e.jsx(ee,{variant:"h6",children:t("Reconciliation Summary")})}),e.jsx(gE,{children:e.jsx(p,{container:!0,children:e.jsxs(p,{size:12,children:[e.jsx(p,{size:12,children:e.jsxs(p,{container:!0,spacing:0,justifyContent:"flex-start",children:[c.map(({color:h,label:m,value:g})=>e.jsx(p,{size:2,children:e.jsx(Ws,{color:h,children:e.jsx(L,{label:m,value:g})})},m)),e.jsx(p,{size:2,children:e.jsx(xE,{"data-cy":"chart-container",children:e.jsx(gl,{width:100,height:100,options:{plugins:{legend:{display:!1}},responsive:!0,maintainAspectRatio:!1},data:{labels:c.map(({label:h})=>h),datasets:[{data:c.map(({value:h})=>h),backgroundColor:c.map(({color:h})=>h)}]}})})})]})}),e.jsx(fE,{children:e.jsx(p,{size:12,children:e.jsxs(p,{container:!0,spacing:0,justifyContent:"flex-start",children:[e.jsx(p,{size:2,children:e.jsx(Ws,{color:"#4E606A",children:e.jsx(L,{label:t("Number of payments"),value:l})})}),e.jsx(p,{size:2,children:e.jsx(Ws,{color:"#4E606A",children:e.jsx(L,{label:t("Reconciled"),value:`${d} (${u}%)`})})})]})})})]})})})]})}const yE=T.div`
  width: 500px;
  height: 100px;
  background-color: rgba(2, 62, 144, 0.1);
  color: #023e90;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: 0.5px;
  line-height: 16px;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: ${({theme:s})=>s.spacing(5)};
  padding: ${({theme:s})=>s.spacing(5)};
  cursor: pointer;
  ${({disabled:s})=>s?"filter: grayscale(100%);":""}
`,pn=({onChange:s,loading:t,dontShowFilename:a,accepts:n={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}})=>{const{t:i}=M(),r=A.useCallback(u=>{s(u)},[]),{getRootProps:l,getInputProps:o,acceptedFiles:d}=Ec({disabled:t,accept:n,onDrop:r}),c=d.length>0?d[0].name:null;return e.jsx(P,{display:"flex",justifyContent:"center",p:5,children:e.jsxs(yE,{...l(),disabled:t,children:[e.jsx(Ne,{isLoading:t,absolute:!0}),e.jsx("input",{...o(),accept:Object.values(n).flat().join(","),"data-cy":"file-input"}),a||!c?i("UPLOAD FILE"):c]})})},bE=()=>xe({mutationFn:({businessAreaSlug:s,programId:t,paymentPlanId:a,fileId:n,fileName:i})=>wP(s,t,a,n,i)}),yd=T(P)`
  max-width: 300px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  background-color: ${({theme:s})=>s.palette.grey[200]};
  padding: 4px;
  margin-bottom: 4px;
`,ar=({initialOpen:s=!1,paymentPlan:t})=>{const a=ve(),n=Nt(),{t:i}=M(),{showMessage:r}=Ae(),{mutate:l}=bE(),{businessArea:o,programId:d}=U(),[c,u]=A.useState(t?.supportingDocuments||[]),[h,m]=A.useState(null),[g,x]=A.useState(""),[f,j]=A.useState(s),[y,b]=A.useState(!1),[C,v]=A.useState(!1),[S,I]=A.useState(""),[E,D]=A.useState(""),F=K(R.PM_UPLOAD_SUPPORTING_DOCUMENT,a),w=K(R.PM_DELETE_SUPPORTING_DOCUMENT,a),O=K(R.PM_DOWNLOAD_SUPPORTING_DOCUMENT,a),k=()=>xe({mutationFn:({_businessArea:se,_programId:le,paymentPlanId:ce,file:_e,_title:ne})=>kP(se,le,ce,_e,ne),onSuccess:se=>{m(null),x(""),b(!1),I(""),r(i("File uploaded successfully")),v(!1),u([...c,{id:se.id,title:se.title,file:se.file,uploadedAt:null}])},onError:se=>{fe(se,r),b(!1)}}),{mutate:$}=k(),G=()=>{if(c.length>=10){I(i("You cannot upload more than 10 files."));return}if(!h||!g){I(i("Please select a file and enter a title.")),g||D(i("Title is required."));return}if(h.size>10*1024*1024){I(i("File size must be ≤ 10MB."));return}const ce=["xlsx","pdf","jpg","jpeg","png"],_e=h.name.split(".").pop()?.toLowerCase();if(!_e||!ce.includes(_e)){I(i("Unsupported file type."));return}b(!0),$({_businessArea:o,_programId:d,paymentPlanId:t.id,file:h,_title:g})},W=async(se,le,ce,_e)=>{try{await OP(se,le,ce,_e.toString()),u(c.filter(ne=>ne.id!==_e)),r(i("File deleted successfully."))}catch(ne){I(i(`Failed to delete supporting document: ${ne.message}`))}},Y=i("Deleting Supporting Document"),X=i("Are you sure you want to delete this file? This action cannot be reversed."),J=(se,le)=>{l({businessAreaSlug:o,programId:d,paymentPlanId:t.id,fileId:se.toString(),fileName:le})},ae=()=>{j(!f)},re=()=>{v(!0)};return e.jsxs(ft,{children:[e.jsxs(P,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(ee,{variant:"h6","data-cy":"supporting-documents-title",children:i("Supporting Documents")}),e.jsxs(P,{display:"flex",children:[F&&e.jsx(P,{mr:1,children:e.jsx(H,{variant:"contained",color:"primary",onClick:re,"data-cy":"upload-file-button","date-perm":R.PM_UPLOAD_SUPPORTING_DOCUMENT,children:i("Upload File")})}),e.jsx(P,{children:c.length>0&&e.jsx(Ve,{onClick:ae,"data-cy":"expand-button",children:f?e.jsx(ml,{}):e.jsx(Ti,{})})})]})]}),c.length===0&&e.jsx(it,{"data-cy":"supporting-documents-empty",children:i("No documents uploaded")}),e.jsx(yt,{in:f,children:e.jsx(P,{mt:2,children:e.jsx(p,{container:!0,spacing:3,children:c.map(se=>e.jsx(p,{size:3,children:e.jsx(Su,{p:3,"data-cy":"document-item",children:e.jsxs(P,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(yd,{children:e.jsx(ot,{children:se.title})}),e.jsx(yd,{children:e.jsx(ot,{children:se.file})})]}),e.jsxs(P,{children:[O&&e.jsx(Ve,{onClick:()=>J(se.id,se.file),"data-cy":"download-button",children:e.jsx(wm,{})}),w&&e.jsx(Ve,{onClick:()=>n({title:Y,content:X,type:"error"}).then(()=>W(o,d,t.id,se.id)),children:e.jsx(Rs,{})})]})]})})},se.id))})})}),F&&e.jsxs(is,{open:C,onClose:()=>v(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{"data-cy":"dialog-import",children:e.jsx(Le,{children:i("Select File to Upload")})}),e.jsxs(Be,{children:[e.jsx(P,{pb:2,children:e.jsx(it,{children:i("The system accepts the following file extensions: XLSX, PDF, images (jpg, jpeg, png). File size must be ≤ 10MB.")})}),e.jsxs(e.Fragment,{children:[e.jsx(pn,{dontShowFilename:!1,accepts:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/pdf":[".pdf"],"image/jpeg":[".jpeg",".jpg"],"image/png":[".png"]},loading:y,onChange:se=>{if(se.length===0)return;const le=se[0],ce=le.size/(1024*1024);if(ce>200){I(`File size is too big. It should be under 200MB, File size is ${ce}MB`);return}m(le)},"data-cy":"dropzone-field"}),e.jsx(Ls,{error:!0,children:S}),e.jsx(p,{container:!0,children:e.jsx(p,{size:12,children:e.jsx(ks,{size:"small",label:i("Title"),value:g,onChange:se=>{x(se.target.value),D("")},fullWidth:!0,margin:"normal","data-cy":"title-input",error:!!E,helperText:E})})})]})]}),e.jsxs(os,{children:[e.jsx(H,{"data-cy":"close-button",onClick:()=>{v(!1),m(null),I(""),x("")},children:i("CANCEL")}),e.jsx(ke,{loading:y,disabled:!h,type:"submit",color:"primary",variant:"contained",onClick:G,"data-cy":"button-import-submit",children:i("Upload")})]})]})]})};function jE({acceptanceProcess:s}){const{rejectedOn:t,actions:a,approvalNumberRequired:n,authorizationNumberRequired:i,financeReleaseNumberRequired:r}=s,{t:l}=M(),o=[{name:`${l("Approval")} (${a?.approval?.length}/${n})`,hasError:t==="IN_APPROVAL",isCompleted:a?.approval?.length===n},{name:`${l("Authorization")} (${a.authorization.length}/${i})`,hasError:t==="IN_AUTHORIZATION",isCompleted:a.authorization.length===i},{name:`${l("Finance Release")} (${a.financeRelease.length}/${r})`,hasError:t==="IN_REVIEW",isCompleted:a.financeRelease.length===r}],d=()=>a.authorization.length===i?2:a?.approval?.length===n?1:0;return e.jsx(Ta,{activeStep:d(),children:o.map(c=>e.jsx(Ra,{completed:c.isCompleted,children:e.jsx(qa,{error:c.hasError,children:c.name})},c.name))})}const AE=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
`,_E=T.div`
  padding: 12px 16px;
  margin: 0;
  border-top: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  text-align: right;
`,PE=T.div`
  color: #9e9e9e;
`,CE=T(P)`
  position: relative;
  top: 4px;
  font-size: 16px;
  color: #043f91;
`;function EE({comment:s,date:t,author:a}){const{t:n}=M(),[i,r]=A.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{size:"medium",onClick:()=>r(!0),children:e.jsx(CE,{children:e.jsx(_c,{fontSize:"inherit"})})}),e.jsxs(Ks,{open:i,onClose:()=>r(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(AE,{children:e.jsx(Le,{children:n("Comment")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsxs(P,{mt:2,display:"flex",children:[a," ",e.jsx(PE,{children:e.jsxs(P,{ml:1,children:["on ",e.jsx(pe,{children:t})]})})]}),e.jsx(St,{}),s]})})}),e.jsx(_E,{children:e.jsx(Gs,{children:e.jsx(H,{color:"primary",variant:"contained",onClick:()=>r(!1),children:n("Close")})})})]})]})}const vE=T.div`
  color: #9e9e9e;
`,SE=T.div`
  color: #7c8990;
  text-transform: uppercase;
  font-size: 12px;
`,IE=T.div`
  width: 16px;
  height: 16px;
`,DE=T(P)`
  background-color: #f4f5f6;
`;function ri({topMessage:s,topDate:t,approvals:a,author:n}){const i=a?.map(r=>{const{info:l,createdAt:o,comment:d}=r;return l&&e.jsxs(P,{alignItems:"center",display:"flex",children:[l,e.jsx(P,{ml:1,children:e.jsxs(vE,{children:["on ",e.jsx(pe,{children:o})]})}),e.jsx(P,{p:1,ml:1,children:d?e.jsx(EE,{comment:d,date:o,author:n}):e.jsx(IE,{})})]},o)});return e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(P,{p:3,children:e.jsxs(SE,{children:[s," on ",e.jsx(pe,{children:t})]})}),e.jsx(DE,{display:"flex",flexDirection:"column",alignItems:"center",ml:3,mr:3,p:3,children:i})]})}const TE=T(P)`
  width: 100%;
`;function RE({acceptanceProcess:s,paymentPlan:t}){const{t:a}=M(),{actions:n,sentForApprovalDate:i,sentForApprovalBy:r,sentForAuthorizationDate:l,sentForAuthorizationBy:o,sentForFinanceReleaseDate:d,sentForFinanceReleaseBy:c,rejectedOn:u}=s,{approvalProcess:h}=t,m=g=>{switch(g){case"IN_APPROVAL":return a("Rejected in Approval stage");case"IN_AUTHORIZATION":return a("Rejected in Authorization stage");case"IN_REVIEW":return a("Rejected in Finance Release stage");default:return""}};return e.jsxs(TE,{m:5,children:[e.jsx(jE,{acceptanceProcess:s}),e.jsxs(p,{container:!0,children:[e.jsx(p,{size:4,children:n?.approval?.length>0&&e.jsx(ri,{topMessage:`Sent for approval by ${r}`,topDate:i,approvals:n.approval,author:r})}),e.jsx(p,{size:4,children:n.authorization.length>0&&e.jsx(ri,{topMessage:`Sent for authorization by ${o}`,topDate:l,approvals:n.authorization,author:o})}),e.jsx(p,{size:4,children:n.financeRelease.length>0&&e.jsx(ri,{topMessage:`Sent for review by ${c}`,topDate:d,approvals:n.financeRelease,author:c})}),n.reject.length>0&&e.jsx(p,{container:!0,children:e.jsx(p,{size:12,children:e.jsx(ri,{topMessage:m(u),topDate:n.reject[0]?.createdAt,approvals:n.reject})})})]}),h.length>1&&e.jsx(St,{})]})}const FE=T(P)`
  width: 200px;
`;function nr({paymentPlan:s}){const{t}=M(),{showMessage:a}=Ae(),n=ve(),{isActiveProgram:i}=Z(),{businessArea:r,programId:l}=U(),{approvalProcess:o}=s,[d,c]=A.useState(!1),u=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentPlansExportPdfPaymentPlanSummaryRetrieve({businessAreaSlug:r,programSlug:l,id:s.id})}),h=x=>d?x:[x[0]];if(!o.length)return null;const m=async()=>{try{await u.mutateAsync(),a(t("PDF generated. Please check your email."))}catch(x){fe(x,a,t("Failed to export PDF"))}},g=K(R.PM_EXPORT_PDF_SUMMARY,n)&&(s.status===te.ACCEPTED||s.status===te.FINISHED||s.status===te.IN_REVIEW);return e.jsx(P,{m:5,children:e.jsxs(Fs,{children:[e.jsxs(P,{display:"flex",justifyContent:"space-between",mt:4,children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:t("Acceptance Process")})}),g&&e.jsx(ke,{loading:u.isPending,color:"primary",variant:"contained",onClick:m,disabled:!i,children:t("Download Payment Plan Summary")})]}),h(o).map((x,f)=>e.jsx(RE,{acceptanceProcess:x,paymentPlan:s},f)),o.length>1&&e.jsx(FE,{children:e.jsx(H,{variant:"outlined",color:"primary",onClick:()=>c(!d),endIcon:d?e.jsx(ml,{}):e.jsx(Ti,{}),children:t(d?"HIDE":"SHOW PREVIOUS")})})]})})}const NE=T.div`
  color: ${({theme:s})=>s.palette.error.dark};
  padding: 20px;
`,LE=T(Ka)`
  color: #043f91;
`,OE=T(Ka)`
  color: #00000042;
`,kE=[null,bs.XLSX_EXPORT_ERROR,bs.XLSX_IMPORT_ERROR,bs.RULE_ENGINE_ERROR];function Yu({paymentPlan:s,permissions:t}){const{showMessage:a}=Ae(),{businessArea:n,programId:i}=U(),[r,l]=A.useState(!1),[o,d]=A.useState(null),[c,u]=A.useState(null),{isActiveProgram:h}=Z(),{t:m}=M(),g=s.status!==te.CLOSED&&K(R.PM_IMPORT_XLSX_WITH_RECONCILIATION,t)&&kE.includes(s.backgroundActionStatus)&&s.fspCommunicationChannel=="XLSX",{mutateAsync:x,isPending:f}=xe({mutationFn:({businessAreaSlug:y,id:b,programSlug:C,formData:v})=>N.restBusinessAreasProgramsPaymentPlansReconciliationImportXlsxCreate({businessAreaSlug:y,id:b,programSlug:C,formData:v}),onSuccess:()=>{l(!1),a(m("Your import was successful!")),u(null)},onError:y=>{u(Dl(y))}}),j=async()=>{o&&await x({businessAreaSlug:n,id:s.id,programSlug:i,formData:{file:o}})};return e.jsxs(e.Fragment,{children:[g&&e.jsx(P,{children:e.jsx(H,{startIcon:h?e.jsx(LE,{}):e.jsx(OE,{}),color:"primary","data-cy":"button-import",onClick:()=>l(!0),disabled:!h,"data-perm":R.PM_IMPORT_XLSX_WITH_RECONCILIATION,children:m("Upload Reconciliation Info")})},"import"),e.jsx(is,{open:r,onClose:()=>l(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:e.jsxs(Ye,{"data-cy":"dialog-import",children:[e.jsx(Le,{children:m("Select File to Import")}),e.jsxs(e.Fragment,{children:[e.jsx(pn,{dontShowFilename:!1,loading:f,onChange:y=>{if(y.length===0)return;const b=y[0],C=b.size/(1024*1024);if(C>200){a(`File size is too big. It should be under 200MB, File size is ${C}MB`);return}d(b)}}),o&&c?e.jsxs(NE,{"data-cy":"error-list",children:[e.jsx("p",{children:"Errors"}),e.jsx("p",{children:c})]}):null]}),e.jsxs(os,{children:[e.jsx(H,{"data-cy":"close-button",onClick:()=>{l(!1),d(null)},children:"CANCEL"}),e.jsx(ke,{loading:f,disabled:!o,type:"submit",color:"primary",variant:"contained",onClick:()=>j(),"data-cy":"button-import-submit",children:m("IMPORT")})]})]})})]})}const wE=[{disablePadding:!1,label:"",id:"flag",numeric:!1},{disablePadding:!1,label:"Payment ID",id:"unicef_id",numeric:!1},{disablePadding:!1,label:"Household ID",id:"household__unicef_id",numeric:!1},{disablePadding:!1,label:"Household Size",id:"household__size",numeric:!1},{disablePadding:!1,label:"Administrative Level 2",id:"household__admin2__name",numeric:!1},{disablePadding:!1,label:"Collector",id:"collector_id",numeric:!1},{disablePadding:!1,label:"Alternative Collector",id:"snapshot_alternate_collector_id",numeric:!1},{disablePadding:!1,label:"FSP",id:"financial_service_provider__name",numeric:!1},{disablePadding:!1,label:"Entitlement",id:"entitlement_quantity_usd",numeric:!1},{disablePadding:!1,label:"Delivered Quantity",id:"delivered_quantity",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1,disableSort:!0},{disablePadding:!1,label:"FSP Auth Code",id:"fsp_auth_code",numeric:!1,requiredPermission:R.PM_VIEW_FSP_AUTH_CODE},{disablePadding:!1,label:"Reconciliation",id:"mark",numeric:!1}],ME=T(Ni)`
  color: ${({theme:s})=>s.hctPalette.orange};
`,$E=T(Ni)`
  color: ${({theme:s})=>s.hctPalette.red};
`,UE=T(vc)`
  color: ${({theme:s})=>s.hctPalette.green};
`;function VE({payment:s,canViewDetails:t,onWarningClick:a,permissions:n}){const{t:i}=M(),{baseUrl:r}=U(),{isSocialDctType:l}=Z(),o=`/${r}/payment-module/payments/${s.id}`,d=`/${r}/population/household/${s.householdId}`,c=`/${r}/population/individuals/${s.peopleIndividual?.id}`,u=`/${r}/population/individuals/${s.collectorId}`,h=`/${r}/population/individuals/${s.snapshotAlternateCollectorId}`,m=f=>{f.stopPropagation(),a(s)},g=()=>{const{deliveredQuantity:f,currency:j,deliveredQuantityUsd:y}=s;return f===null?e.jsx(e.Fragment,{children:"-"}):e.jsx(e.Fragment,{children:`${Ps(f,j)}
        (${Ps(y,"USD")})`})},x=()=>{const{deliveredQuantity:f,entitlementQuantity:j}=s;return f===null?e.jsx(e.Fragment,{}):Number(f)===0?e.jsx($E,{}):f===j?e.jsx(UE,{}):e.jsx(ME,{})};return e.jsxs(rs,{hover:!0,role:"checkbox",children:[e.jsx(_,{align:"left",children:(s.paymentPlanHardConflicted||s.paymentPlanSoftConflicted)&&e.jsx(Sa,{handleClick:f=>m(f),message:i("This household is also included in other Payment Plans. Click this icon to view details."),confirmed:s.paymentPlanHardConflicted})}),e.jsx(_,{align:"left",children:t?e.jsx(me,{to:o,state:{parentId:s.parentId},children:s.unicefId}):s.unicefId}),e.jsx(_,{align:"left",children:l?t?e.jsx(me,{to:c,children:s.peopleIndividual?.unicefId}):s.peopleIndividual?.unicefId:t?e.jsx(me,{to:d,children:s.householdUnicefId}):s.householdUnicefId}),e.jsx(_,{align:"left",children:s.householdSize}),e.jsx(_,{align:"left",children:Aa(s.householdAdmin2)}),e.jsx(_,{align:"left",children:t&&s.snapshotCollectorFullName?e.jsx(me,{to:u,children:s.snapshotCollectorFullName}):s.snapshotCollectorFullName||"-"}),e.jsx(_,{align:"left",children:t&&s.snapshotAlternateCollectorFullName?e.jsx(me,{to:h,children:s.snapshotAlternateCollectorFullName}):s.snapshotAlternateCollectorFullName||"-"}),e.jsx(_,{align:"left",children:s.fspName?s.fspName:"-"}),e.jsx(_,{align:"left",children:s.entitlementQuantity!=null&&Number(s.entitlementQuantity)>=0?`${Ps(s.entitlementQuantity,s.currency)} (${Ps(s.entitlementQuantityUsd,"USD")})`:"-"}),e.jsx(_,{"data-cy":"delivered-quantity-cell",align:"left",children:g()}),e.jsx(_,{children:e.jsx(we,{status:s.status,statusToColor:Na,statusNameMapping:Ya})}),K(R.PM_VIEW_FSP_AUTH_CODE,n)&&e.jsx(_,{"data-cy":"fsp-auth-code-cell",align:"left",children:s.fspAuthCode||"-"}),e.jsx(_,{children:x()})]},s.id)}const BE=T(gs)`
  min-width: 100px;
`,bd=T.div`
  font-weight: bold;
  padding: 0 5px;
`,GE=T(P)`
  background-color: #f3f3f3;
`;function zE({paymentPlan:s,payment:t,setDialogOpen:a,baseUrl:n,canViewDetails:i=!1}){const{t:r}=M(),{selectedProgram:l}=Z(),o=l?.beneficiaryGroup;if(!t)return null;const d=()=>{const{paymentPlanSoftConflicted:c,paymentPlanHardConflicted:u,paymentPlanHardConflictedData:h,paymentPlanSoftConflictedData:m}=t,g=x=>e.jsxs(rs,{hover:!0,children:[e.jsx(_,{align:"left",children:i?e.jsx(me,{to:`/${n}/payment-module/payment-plans/${x.paymentPlanId}`,children:x.paymentPlanUnicefId}):x.paymentPlanUnicefId}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:x.paymentPlanStartDate})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:x.paymentPlanEndDate})}),e.jsx(_,{align:"left",children:e.jsx(we,{status:x.paymentPlanStatus,statusToColor:Vt})}),e.jsx(_,{align:"left",children:x.paymentUnicefId})]});return u?h.map(x=>g(x)):c?m.map(x=>g(x)):[]};return e.jsxs(is,{open:!!t,onClose:()=>a(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:r("Warning")})}),e.jsxs(Be,{children:[e.jsxs(P,{mt:4,mb:2,display:"flex",children:[r("Payment Plan ID")," ",e.jsx(bd,{children:s.unicefId})," ",r("details"),":"]}),e.jsx(GE,{p:3,children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:6,children:e.jsx(L,{label:r("Start Date"),children:e.jsx(pe,{children:s.startDate})})}),e.jsx(p,{size:6,children:e.jsx(L,{label:r("End Date"),children:e.jsx(pe,{children:s.endDate})})})]})}),e.jsxs(P,{mt:10,mb:10,display:"flex",children:[`${o?.groupLabel} ID`," ",e.jsx(bd,{children:t.householdUnicefId})," ",r("is also included in the following Payment Plans"),":"]}),e.jsxs(BE,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left",children:r("Payment Plan ID")}),e.jsx(_,{align:"left",children:r("Start Date")}),e.jsx(_,{align:"left",children:r("End Date")}),e.jsx(_,{align:"left",children:r("Status")}),e.jsx(_,{align:"left",children:r("Payment ID")})]})}),e.jsx(cs,{children:d()})]})]}),e.jsx(ss,{children:e.jsx(os,{children:e.jsx(H,{onClick:c=>{c.stopPropagation(),a(!1)},children:r("CLOSE")})})})]})}function Qu({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i}){const{t:r}=M(),l=ge(),o=je(),{isSocialDctType:d,selectedProgram:c}=Z(),u=c?.beneficiaryGroup,{handleFilterChange:h,applyFilterChanges:m,clearFilter:g}=Ss(a,l,o,s,t,n,i),x=()=>{m()},f=()=>{g()};return e.jsx(Ns,{clearHandler:f,applyHandler:x,children:e.jsxs(p,{container:!0,spacing:3,alignItems:"flex-end",children:[e.jsx(p,{size:3,children:e.jsx(Cs,{label:r("Payment ID"),value:s.paymentUnicefId,fullWidth:!0,onChange:j=>h("paymentUnicefId",j.target.value),"data-cy":"filter-payment-unicef-id"})}),e.jsx(p,{size:3,children:d?e.jsx(Cs,{label:r(`${u?.memberLabel} ID`),value:s.individualUnicefId,fullWidth:!0,onChange:j=>h("individualUnicefId",j.target.value),"data-cy":"filter-individual-id"}):e.jsx(Cs,{label:r(`${u?.groupLabel} ID`),value:s.householdUnicefId,fullWidth:!0,onChange:j=>h("householdUnicefId",j.target.value),"data-cy":"filter-household-id"})}),e.jsx(p,{size:3,children:e.jsx(Cs,{label:r("Collector Full Name"),value:s.collectorFullName,fullWidth:!0,onChange:j=>h("collectorFullName",j.target.value),"data-cy":"filter-collector-fullname"})})]})})}const qE=T(P)`
  background-color: #fff;
`,HE=({businessArea:s,paymentPlan:t,permissions:a,canViewDetails:n=!1})=>{const{baseUrl:i,programId:r}=U(),{t:l}=M(),{selectedProgram:o,isSocialDctType:d}=Z(),c=o?.beneficiaryGroup,u={householdUnicefId:"",individualUnicefId:"",collectorFullName:"",paymentUnicefId:""},[h,m]=A.useState(null),g=je(),[x,f]=A.useState(0),[j,y]=A.useState(Ke(g,u)),[b,C]=A.useState(Ke(g,u)),[v,S]=A.useState(!1),I=A.useRef(null);et(I,v,b,()=>S(!1));const E=A.useMemo(()=>({businessAreaSlug:s,programSlug:r,householdUnicefId:b.householdUnicefId||null,individualUnicefId:b.individualUnicefId||null,collectorFullName:b.collectorFullName||null,paymentUnicefId:b.paymentUnicefId||null}),[s,r,b.householdUnicefId,b.individualUnicefId,b.collectorFullName,b.paymentUnicefId]),[D,F]=A.useState(E);A.useEffect(()=>{F(E)},[E]);const{data:w,isLoading:O,error:k}=V({queryKey:["businessAreasProgramsPaymentPlansPaymentsList",D,s,r,t.id],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansPaymentsList(Ce({businessAreaSlug:s,programSlug:r,paymentPlanPk:t.id},D,{withPagination:!0}))}),{data:$}=V({queryKey:["businessAreasProgramsPaymentsCountRetrieve",s,r,t.id,D],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansPaymentsCountRetrieve(Ce({businessAreaSlug:s,programSlug:r,paymentPlanPk:t.id},D)),enabled:!!s&&!!t?.id&&x===0}),G=vs(x,$),Y=$s(wE,c,d?{individual__unicef_id:J=>`${J?.memberLabel} ${l("ID")}`,household__size:J=>`${J?.groupLabel} ${l("Size")}`}:{household__unicef_id:J=>`${J?.groupLabel} ${l("ID")}`,household__size:J=>`${J?.groupLabel} ${l("Size")}`}),X=J=>{C(J),S(!0),f(0)};return e.jsxs(e.Fragment,{children:[e.jsx(P,{p:4,children:e.jsx(Qu,{filter:j,setFilter:y,initialFilter:u,appliedFilter:b,setAppliedFilter:X})}),e.jsx("div",{ref:I,children:e.jsx(Es,{children:e.jsxs(us,{children:[e.jsxs(qE,{p:6,display:"flex",justifyContent:"space-between",children:[e.jsx(ee,{"data-cy":"table-title",variant:"h6",children:l("Payee List")}),(t.status===te.ACCEPTED||t.status===te.FINISHED)&&e.jsx(Yu,{paymentPlan:t,permissions:a})]}),e.jsx(ds,{isOnPaper:!1,headCells:Y,rowsPerPageOptions:[10,25,50],defaultOrderBy:"createdAt",defaultOrderDirection:"desc",isLoading:O,error:k,queryVariables:D,setQueryVariables:F,data:w,itemsCount:G,page:x,setPage:f,renderRow:J=>e.jsx(VE,{payment:J,canViewDetails:n,onWarningClick:ae=>{m(ae)},permissions:a},J.id)})]})})}),e.jsx(zE,{paymentPlan:t,payment:h,setDialogOpen:()=>m(null),canViewDetails:n,baseUrl:i})]})},io=oe(HE,"PaymentsTable"),WE=T.div`
  background-color: #f5f5f5;
  border: 1px solid #f5f5f5;
  border-radius: 3px;
  padding: 15px 25px;
  margin: 10px 0;
  max-width: 600px;
`,KE=T.span`
  font-weight: bold;
  font-size: 14px;
`,jd=T.span`
  font-weight: bold;
  font-size: 14px;
  color: rgba(37, 59, 70, 0.6);
`,YE=T.span`
  font-size: 12px;
`,QE=T.span`
  ${({theme:s})=>s.styledMixins.label}
`,Ad=({label:s,options:t})=>e.jsx(WE,{children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:12,children:e.jsx(P,{display:"flex",alignItems:"flex-start",children:e.jsx(QE,{"data-cy":`label-${s}`,color:"textSecondary",children:s})})}),e.jsx(p,{size:12,children:e.jsx(p,{container:!0,direction:"column",children:t.map(a=>e.jsxs(p,{container:!0,spacing:4,children:[e.jsx(p,{size:4,children:e.jsx(jd,{children:e.jsx(YE,{"data-cy":`label-${a.name}`,children:a.name})})}),a.options.map((n,i)=>e.jsxs(p,{container:!0,size:4,spacing:4,children:[e.jsx(p,{size:6,children:e.jsxs(KE,{"data-cy":`percentage-${a.name}`,children:[n.percentage.toFixed(2),"%"]})}),e.jsx(p,{size:6,children:e.jsxs(jd,{"data-cy":`value-${a.name}`,children:["(",n.count,")"]})})]},a.name+i))]},a.name))})})]})}),an=T.div`
  padding: ${({theme:s})=>s.spacing(6)};
  border-color: #b1b1b5;
  border-left-width: 1px;
  border-left-style: solid;
  display: flex;
`,ba=T.div`
  font-family: ${({theme:s})=>s.hctTypography.fontFamily};
  color: #253b46;
  font-size: 36px;
  line-height: 32px;
  margin-top: ${({theme:s})=>s.spacing(2)};
`,XE=T.p`
  color: ${({theme:s})=>s.hctPalette.red};
  font-size: 12px;
`,_d=T.span`
  font-weight: bold;
  font-size: 14px;
  color: rgba(37, 59, 70, 0.6);
`;function JE({registration:s,isSocialWorkerProgram:t}){const{t:a}=M(),{selectedProgram:n}=Z(),i=n?.beneficiaryGroup,r=[{name:"Unique",options:s?.batchUniqueCountAndPercentage},{name:"Duplicates",options:s?.batchDuplicatesCountAndPercentage}],l=[{name:"Unique",options:s?.goldenRecordUniqueCountAndPercentage},{name:"Duplicates",options:s?.goldenRecordDuplicatesCountAndPercentage},{name:"Need Adjudication",options:s?.goldenRecordPossibleDuplicatesCountAndPercentage}];let o;return t?o=e.jsx(p,{size:{xs:4},children:e.jsx(p,{container:!0,children:e.jsx(p,{size:{xs:6},children:e.jsx(an,{children:e.jsx(L,{label:a("Total Number of Registered People"),dataCy:"individuals",children:e.jsx(ba,{children:Qe(s?.numberOfIndividuals)})})})})})}):o=e.jsxs(p,{size:{xs:"auto"},children:[e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:6},children:e.jsx(an,{children:e.jsx(L,{label:`Total Number of ${i?.groupLabelPlural}`,dataCy:"households",children:e.jsx(ba,{children:Qe(s?.numberOfHouseholds)})})})}),e.jsx(p,{size:{xs:6},children:e.jsx(an,{children:e.jsx(L,{label:`Total Number of ${i?.memberLabelPlural}`,dataCy:"individuals",children:e.jsx(ba,{children:Qe(s?.numberOfIndividuals)})})})})]}),e.jsx(p,{container:!0,children:e.jsx(p,{size:{xs:6},children:e.jsx(P,{mt:2,children:e.jsx(an,{children:e.jsx(L,{label:`${i?.memberLabelPlural} with records at HOPE`,dataCy:"registered-individuals",children:e.jsx(ba,{children:Qe(s?.numberOfRegisteredIndividuals)})})})})})})]}),e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Import Details")})}),e.jsx(vt,{children:e.jsxs(p,{alignItems:"center",container:!0,children:[e.jsx(p,{size:{xs:"auto"},children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:6},children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(L,{label:a("status"),children:e.jsx(we,{status:s?.status,statusToColor:ki})}),s?.errorMessage&&e.jsx(XE,{children:s.errorMessage})]})}),s?.biometricDeduplicationEnabled&&e.jsx(p,{size:{xs:6},children:e.jsx(P,{display:"flex",flexDirection:"column",children:e.jsx(L,{label:a("Biometrics Deduplication Status"),children:e.jsx(we,{status:s?.deduplicationEngineStatus,statusToColor:vp})})})}),e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:a("Source of Data"),value:s?.dataSource})}),e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:a("Import Date"),value:e.jsx(pe,{withTime:!0,children:s?.importDate})})}),e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:a("Imported by"),value:s?.importedBy})}),s.status==="REFUSED"&&s.refuseReason?e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:a("Refuse Reason"),value:s?.refuseReason})}):null]})}),o,s.status==="DEDUPLICATION_FAILED"?null:e.jsx(p,{size:{xs:"auto"},children:e.jsxs(p,{container:!0,direction:"column",children:[e.jsxs(p,{container:!0,size:{xs:12},spacing:3,children:[e.jsx(p,{size:{xs:4}}),e.jsx(p,{size:{xs:4},children:e.jsx(_d,{children:a("Biographical")})}),s.biometricDeduplicationEnabled&&e.jsx(p,{size:{xs:4},children:e.jsx(_d,{children:a("Biometrics")})})]}),e.jsx(Ad,{label:"Within Batch",options:r}),e.jsx(Ad,{label:"In Population",options:l})]})})]})})]})}const Xu=oe(JE,"RegistrationDetails"),ZE=T.div`
  color: ${({theme:s})=>s.palette.error.dark};
  padding: 20px;
`;function ev({paymentPlan:s,permissions:t}){const[a,n]=A.useState(null),{showMessage:i}=Ae(),[r,l]=A.useState(!1),[o,d]=A.useState(null),{isActiveProgram:c}=Z(),{t:u}=M(),{businessArea:h,programId:m}=U(),g=Fe(),{mutateAsync:x,isPending:f}=xe({mutationFn:({businessAreaSlug:C,id:v,programSlug:S,requestBody:I})=>N.restBusinessAreasProgramsPaymentPlansEntitlementImportXlsxCreate({businessAreaSlug:C,id:v,programSlug:S,formData:I}),onSuccess:()=>{l(!1),i(u("Your import was successful!")),n(null),g.invalidateQueries({queryKey:["paymentPlan",s.id]})},onError:C=>{n(Dl(C))}}),j=async()=>{if(o)try{const C={file:o};await x({businessAreaSlug:h,id:s.id,programSlug:m,requestBody:C})}catch{}},y=K(R.PM_IMPORT_XLSX_WITH_ENTITLEMENTS,t),b=s.status!==te.LOCKED||!y||!c;return e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsx(H,{startIcon:e.jsx(Ka,{}),color:"primary","data-cy":"button-import",onClick:()=>l(!0),disabled:b,"data-perm":R.PM_IMPORT_XLSX_WITH_ENTITLEMENTS,children:u("Upload File")})},"import"),e.jsx(is,{open:r,onClose:()=>l(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:e.jsxs(Ye,{"data-cy":"dialog-import",children:[e.jsx(Le,{children:u("Select File to Import")}),e.jsxs(e.Fragment,{children:[e.jsx(pn,{dontShowFilename:!1,loading:f,onChange:C=>{if(C.length===0)return;const v=C[0],S=v.size/(1024*1024);if(S>200){i(`File size is too big. It should be under 200MB, File size is ${S}MB`);return}d(v)}}),o&&a?e.jsxs(ZE,{"data-cy":"error-list",children:[e.jsx("p",{children:"Errors"}),e.jsx("p",{children:a})]}):null]}),e.jsxs(os,{children:[e.jsx(H,{"data-cy":"close-button",onClick:()=>{l(!1),d(null)},children:"CANCEL"}),e.jsx(ke,{loading:f,disabled:!o,type:"submit",color:"primary",variant:"contained",onClick:()=>j(),"data-cy":"button-import-entitlement",children:u("IMPORT")})]})]})})]})}const sv=T.p`
  color: #9e9e9e;
  font-size: 16px;
`,li=T.p`
  color: #9e9e9e;
  font-size: 14px;
`,Pd=T.div`
  border-top: 1px solid #b1b1b5;
  height: 2px;
  width: 50%;
  margin-top: 20px;
`,tv=T.div`
  border-top: 1px solid #b1b1b5;
  height: 20px;
`,av=T.div`
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 500;
  color: #253b46;
  text-transform: uppercase;
  padding: 5px;
  border: 1px solid #b1b1b5;
  border-radius: 50%;
  background-color: #fff;
  margin-top: 20px;
`,nv=T(Ca)`
  color: #043f91;
`,iv=T(P)`
  position: relative;
  top: 4px;
  font-size: 16px;
  color: #666666;
`,rv=T(P)`
  border-right: 1px solid #b1b1b5;
`;function lv({paymentPlan:s,permissions:t}){const{t:a}=M(),{showMessage:n}=Ae(),{isActiveProgram:i}=Z(),{businessArea:r,programId:l}=U(),o=Fe(),[d,c]=A.useState(s.steficonRule?.rule?.id?String(s.steficonRule.rule.id):""),{mutateAsync:u,isPending:h}=xe({mutationFn:({businessAreaSlug:v,id:S,programSlug:I,requestBody:E})=>N.restBusinessAreasProgramsPaymentPlansApplyEngineFormulaCreate({businessAreaSlug:v,id:S,programSlug:I,requestBody:E}),onSuccess:()=>{n(a("Formula is executing, please wait until completed")),o.invalidateQueries({queryKey:["paymentPlan",r,s.id,l]})},onError:v=>{fe(v,n)}}),{data:m,isLoading:g}=V({queryKey:["engineRules",r],queryFn:()=>N.restEngineRulesList({type:"PAYMENT_PLAN",deprecated:!1,enabled:!0,businessArea:r})}),{mutateAsync:x,isPending:f}=xe({mutationFn:({businessAreaSlug:v,id:S,programSlug:I})=>N.restBusinessAreasProgramsPaymentPlansEntitlementExportXlsxRetrieve({businessAreaSlug:v,id:S,programSlug:I}),onSuccess:async()=>{n(a("Exporting XLSX started. Please check your email.")),await o.invalidateQueries({queryKey:["paymentPlan",r,s.id,l]})},onError:v=>{fe(v,n)}});if(!m)return null;if(g)return e.jsx(Ne,{});const y=!K(R.PM_APPLY_RULE_ENGINE_FORMULA_WITH_ENTITLEMENTS,t)||s.status!==te.LOCKED||!i,b=s.status!==te.LOCKED||!i,C=f||s.status!==te.LOCKED||s?.backgroundActionStatus===bs.XLSX_EXPORTING||s?.backgroundActionStatus===bs.RULE_ENGINE_RUN||!i;return e.jsx(P,{m:5,children:e.jsxs(Fs,{children:[e.jsxs(P,{mt:4,children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Entitlement")})}),e.jsx(sv,{children:a("Select Entitlement Formula")}),e.jsxs(p,{container:!0,alignItems:"center",children:[e.jsx(p,{size:{xs:10},children:e.jsxs(tt,{size:"small",variant:"outlined",fullWidth:!0,children:[e.jsx(P,{mb:1,children:e.jsx(Rt,{children:a("Entitlement Formula")})}),e.jsx(at,{size:"small",disabled:y,MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},value:d,"data-cy":"input-entitlement-formula",onChange:v=>c(v.target.value),children:m?.results?.map((v,S)=>{const I=!!v?.description;return e.jsx(de,{"data-cy":`select-option-${S}`,value:v.id,children:I?e.jsx(Ms,{title:v.description,placement:"right",arrow:!0,children:e.jsx(P,{component:"span",sx:{display:"block",width:"100%"},children:v.name})}):v.name},v.id)})})]})}),e.jsx(p,{size:{xs:1},children:e.jsx(H,{variant:"contained",color:"primary",disabled:h||!d||s.status!==te.LOCKED||s.backgroundActionStatus===bs.RULE_ENGINE_RUN||!i,"data-cy":"button-apply-steficon","data-perm":R.PM_APPLY_RULE_ENGINE_FORMULA_WITH_ENTITLEMENTS,onClick:async()=>{try{await u({programSlug:l,businessAreaSlug:r,id:s.id,requestBody:{engineFormulaRuleId:d,version:s.version}}),n(a("Formula is executing, please wait until completed"))}catch(v){fe(v,n)}},children:a("Apply")})})]}),e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsx(Pd,{}),e.jsx(av,{children:"Or"}),e.jsx(Pd,{})]})]}),e.jsxs(P,{display:"flex",children:[e.jsx(P,{width:"50%",children:e.jsxs(rv,{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",children:[s.hasPaymentListExportFile?e.jsx(H,{color:"primary",startIcon:e.jsx(nv,{}),component:"a",download:!0,"data-cy":"button-download-template",href:`/api/download-payment-plan-payment-list/${s.id}`,disabled:b,children:a("DOWNLOAD TEMPLATE")}):e.jsx(ke,{loading:f,disabled:C,color:"primary",startIcon:e.jsx(Ca,{}),"data-cy":"button-export-xlsx",onClick:()=>x({businessAreaSlug:r,programSlug:l,id:s.id}),children:a("Export Xlsx")}),e.jsx(li,{children:a("Template contains payment list with all targeted households")})]})}),e.jsx(P,{width:"50%",children:e.jsxs(P,{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",children:[e.jsx(P,{children:e.jsx(ev,{permissions:t,paymentPlan:s})}),s?.importedFileName?e.jsxs(P,{alignItems:"center",display:"flex",children:[e.jsx(iv,{children:e.jsx(Sc,{fontSize:"inherit"})}),e.jsx(P,{mr:1,children:e.jsx(li,{"data-cy":"imported-file-name",children:s?.importedFileName})}),e.jsx(li,{children:s?.importedFileDate?e.jsx(pe,{children:s?.importedFileDate}):null})]}):e.jsx(li,{children:a("Uploaded file should contain entitlement for each household")})]})})]}),s.totalEntitledQuantityUsd?e.jsxs(e.Fragment,{children:[e.jsx(tv,{}),e.jsx(L,{label:a("Total Entitled Quantity"),children:e.jsx(ba,{"data-cy":"total-entitled-quantity-usd",children:`${Qe(s.totalEntitledQuantity)} ${s.currency} (${Qe(s.totalEntitledQuantityUsd)} USD)`})})]}):null]})})}const Ju=oe(lv,"Entitlement");function ov(){const{paymentPlanId:s}=ts(),t=ve(),{baseUrl:a,businessArea:n,programId:i}=U(),{data:r,error:l}=V({queryKey:["paymentPlan",n,s,i],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansRetrieve({businessAreaSlug:n,id:s,programSlug:i}),refetchInterval:h=>{const m=h.state.data,g=[bs.EXCLUDE_BENEFICIARIES_ERROR,bs.XLSX_EXPORT_ERROR,bs.XLSX_IMPORT_ERROR];return m?.status===te.PREPARING||m?.backgroundActionStatus!==null&&!g.includes(m?.backgroundActionStatus)?3e3:!1},refetchIntervalInBackground:!0});if(!K(R.PM_VIEW_DETAILS,t)||rt(l))return e.jsx(Xe,{permission:R.PM_VIEW_DETAILS});if(!r)return null;const{status:o}=r,d=o!==te.OPEN,c=o===te.ACCEPTED||o===te.FINISHED,u=o===te.IN_REVIEW||o===te.ACCEPTED||o===te.FINISHED;return r?e.jsxs(e.Fragment,{children:[e.jsx(Hu,{paymentPlan:r,baseUrl:a,permissions:t}),e.jsx(qu,{baseUrl:a,paymentPlan:r}),e.jsx(nr,{paymentPlan:r}),u&&e.jsx(ao,{paymentPlan:r}),d&&e.jsx(Ju,{paymentPlan:r,permissions:t}),e.jsx(Ku,{paymentPlan:r}),e.jsx(ar,{paymentPlan:r}),e.jsx(no,{paymentPlan:r}),e.jsx(io,{businessArea:n,paymentPlan:r,permissions:t,canViewDetails:!0}),c&&e.jsx(tr,{paymentPlan:r}),K(R.ACTIVITY_LOG_VIEW,t)&&e.jsx(Lt,{objectId:r.id})]}):null}const dv=oe(ov,"FollowUpPaymentPlanDetailsPage");function Zu({paymentId:s,disabled:t=!1}){const{t:a}=M(),[n,i]=A.useState(!1),{showMessage:r}=Ae(),{paymentPlanId:l}=ts(),{businessArea:o,programId:d}=U(),{mutateAsync:c,isPending:u}=xe({mutationFn:({businessAreaSlug:m,id:g,paymentPlanId:x,programSlug:f})=>N.restBusinessAreasProgramsPaymentPlansPaymentsMarkAsFailedRetrieve({businessAreaSlug:m,paymentId:g,paymentPlanPk:x,programSlug:f}),onSuccess:()=>{r(a("Payment has been marked as failed successfully."))},onError:m=>{fe(m,r)}}),h=()=>{c({businessAreaSlug:o,programSlug:d,paymentPlanId:l,id:s})};return e.jsxs(P,{children:[e.jsx(P,{p:2,children:e.jsx(H,{color:"primary",variant:"contained",onClick:()=>i(!0),"data-cy":"button-mark-as-failed","data-perm":R.PM_MARK_PAYMENT_AS_FAILED,disabled:t,children:a("Mark as failed")})}),e.jsxs(Ks,{open:n,onClose:()=>i(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Mark as failed")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsx(P,{p:5,children:a("Are you sure you would like to mark payment as failed?")})})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>i(!1),children:a("CANCEL")}),e.jsx(H,{type:"submit",color:"primary",variant:"contained",onClick:()=>h(),"data-cy":"button-submit",disabled:u,"data-perm":R.PM_MARK_PAYMENT_AS_FAILED,children:a("Mark as failed")})]})})]})]})}function eh({paymentId:s,disabled:t=!1}){const{t:a}=M(),[n,i]=A.useState(!1),{businessArea:r,programId:l}=U(),{paymentPlanId:o}=ts(),{showMessage:d}=Ae(),{mutateAsync:c,isPending:u}=xe({mutationFn:({businessAreaSlug:g,id:x,paymentPlanId:f,programSlug:j,requestBody:y})=>N.restBusinessAreasProgramsPaymentPlansPaymentsRevertMarkAsFailedCreate({businessAreaSlug:g,paymentId:x,paymentPlanPk:f,programSlug:j,requestBody:y}),onSuccess:()=>{d(a("Force failed has been reverted."))},onError:g=>{fe(g,d)}}),h=Q.object().shape({deliveredQuantity:Q.number().min(0).max(99999999,a("Number is too big")),deliveryDate:Q.date().required(a("Delivery date is required"))}),m=g=>{c({businessAreaSlug:r,programSlug:l,paymentPlanId:o,id:s,requestBody:{deliveredQuantity:g.deliveredQuantity,deliveryDate:g.deliveryDate}})};return e.jsxs(P,{children:[e.jsx(P,{p:2,children:e.jsx(H,{color:"primary",variant:"contained",onClick:()=>i(!0),"data-cy":"button-revert-mark-as-failed",disabled:t,"data-perm":R.PM_MARK_PAYMENT_AS_FAILED,children:a("Revert mark as failed")})}),e.jsx(B.Formik,{initialValues:{deliveredQuantity:0,deliveryDate:""},validationSchema:h,onSubmit:g=>m(g),children:({submitForm:g,resetForm:x})=>e.jsxs(Ks,{open:n,onClose:()=>i(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Revert mark as failed")})}),e.jsx(Be,{children:e.jsxs(B.Form,{children:[e.jsx(B.Field,{name:"deliveredQuantity",label:a("Delivered Quantity"),type:"number",required:!0,fullWidth:!0,variant:"outlined",component:Se}),e.jsx(B.Field,{name:"deliveryDate",label:a("Delivery Date"),component:jt,required:!0,fullWidth:!0,decoratorEnd:e.jsx(bt,{color:"disabled"})})]})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>{i(!1),x()},children:a("CANCEL")}),e.jsx(ke,{type:"submit",color:"primary",variant:"contained",onClick:g,"data-cy":"button-submit",loading:u,children:a("Revert mark as failed")})]})})]})})]})}const ra=T(us)`
  margin: 20px;
  padding: ${({theme:s})=>s.spacing(8)}
    ${({theme:s})=>s.spacing(11)};
`;function cv({payment:s,canViewActivityLog:t,canViewHouseholdDetails:a}){const{t:n}=M(),{baseUrl:i,businessArea:r,programId:l}=U(),{selectedProgram:o,isSocialDctType:d}=Z(),c=o?.beneficiaryGroup;let u=null;s.verification&&s.verification.status!=="PENDING"&&(u=s.verification);const h=["NOT_DISTRIBUTED","FORCE_FAILED","TRANSACTION_ERRONEOUS"].includes(s.status),m=s?.snapshotCollectorAccountData??{};return e.jsxs(e.Fragment,{children:[e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("STATUS"),children:e.jsx(we,{status:s.status,statusToColor:Na,statusNameMapping:Ya})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("ENTITLEMENT QUANTITY"),value:Qe(s.entitlementQuantity)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("DELIVERED QUANTITY"),value:Qe(s.deliveredQuantity)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("CURRENCY"),value:s.currency})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("DELIVERY DATE"),value:e.jsx(pe,{children:s.deliveryDate})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("TARGET POPULATION"),children:e.jsx(me,{to:`/${r}/programs/${l}/target-population/${s.parent.id}`,children:s.parent?.name})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("Distribution Modality"),value:s.parent?.deliveryMechanism?.name})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("Original Payment Plan ID"),children:s.parent&&e.jsx(me,{to:`/${i}/payment-module/${s.parent.isFollowUp?"followup-payment-plans":"payment-plans"}/${s.parent.id}`,children:s.parent.unicefId})})})]})]}),u!=null?e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Verification Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("STATUS"),children:e.jsx(we,{status:u.status,statusToColor:$n})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("AMOUNT RECEIVED"),value:Ps(u.receivedAmount,s.currency)})})]})]}):null,d&&e.jsxs(ra,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:c?.groupLabel})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:`${c?.groupLabel}`,children:s.household?.id&&a?e.jsx(me,{to:`/${r}/programs/${l}/population/household/${s.household.id}`,children:s.household.unicefId}):e.jsx("div",{children:s.household?.id?s.household.unicefId:"-"})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("Collector's Name"),value:s.snapshotCollectorFullName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("Collector's ID"),value:s.collector?.unicefId})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("TOTAL PERSON COVERED"),value:s.household.size})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("PHONE NUMBER"),value:Kt(s.collector.phoneNo,s.collector.phoneNoValid)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("ALT. PHONE NUMBER"),value:Kt(s.collector.phoneNoAlternative,s.collector.phoneNoAlternativeValid)})})]})]}),e.jsxs(ra,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Entitlement Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("DELIVERY MECHANISM"),value:s.deliveryMechanism?.name})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("FSP"),value:s.fspName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("TRANSACTION REFERENCE ID"),value:s.transactionReferenceId})})]}),e.jsx(St,{}),e.jsx(p,{container:!0,spacing:3,children:Object.entries(m).map(([g,x])=>e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n(`Account ${g}`),value:Al(x)})},g))})]}),e.jsxs(ra,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n("Reconciliation Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("Collector's Name"),value:s.additionalCollectorName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("Document Type"),value:s.additionalDocumentType})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("Document Number"),value:s.additionalDocumentNumber})})]}),e.jsx(St,{}),e.jsx(p,{container:!0,spacing:3,children:h&&e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n("Failure Reason"),value:s.reasonForUnsuccessfulPayment})})})]}),t&&e.jsx(Lt,{objectId:s.id})]})}const uv=oe(cv,"PaymentDetails");function hv(){const{t:s}=M(),{paymentId:t}=ts(),n=je().state?.parentId,{businessArea:i,programId:r}=U(),{data:l,isLoading:o}=V({queryKey:["payment",i,t,r,n],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansPaymentsRetrieve({businessAreaSlug:i,paymentId:t,programSlug:r,paymentPlanPk:n})}),d=l?.parent?.status,c=l?.parent?.isFollowUp,u=ve(),{baseUrl:h}=U();if(o)return e.jsx(Ne,{});if(u===null)return null;if(!K(R.PM_VIEW_DETAILS,u))return e.jsx(Xe,{permission:R.PM_VIEW_DETAILS});const m=[{title:s("Payment Module"),to:"../payment-plans"},{title:` ${c?"Follow-up ":""} Payment Plan ${l?.parent?.unicefId}`,to:`/${h}/payment-module/${c?"followup-payment-plans":"payment-plans"}/${l?.parent?.id}/`}],g=()=>{if(!l||!d)return null;if(K(R.PM_MARK_PAYMENT_AS_FAILED,u)&&d===te.ACCEPTED||d===te.FINISHED){const f=l.status===Li.FORCE_FAILED?eh:Zu;return e.jsx(f,{paymentId:l.id})}return null},x=K(R.POPULATION_VIEW_HOUSEHOLDS_DETAILS,u);return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`Payment ${l?.unicefId}`,breadCrumbs:m,flags:e.jsx(gt,{adminUrl:l?.adminUrl}),children:g()}),e.jsx(P,{display:"flex",flexDirection:"column",children:e.jsx(uv,{payment:l,canViewActivityLog:K(R.ACTIVITY_LOG_VIEW,u),canViewHouseholdDetails:x})})]})}const mv=oe(hv,"PaymentDetailsPage"),sh=[te.ACCEPTED,te.DRAFT,te.FINISHED,te.IN_APPROVAL,te.IN_AUTHORIZATION,te.IN_REVIEW,te.LOCKED,te.LOCKED_FSP,te.OPEN,te.PREPARING,te.PROCESSING,te.STEFICON_COMPLETED,te.STEFICON_ERROR,te.STEFICON_RUN,te.STEFICON_WAIT];function pv({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i}){const{t:r}=M(),l=ge(),o=je(),{handleFilterChange:d,applyFilterChanges:c,clearFilter:u}=Ss(a,l,o,s,t,n,i),h=()=>{c()},m=()=>{u()},{data:g}=V({queryKey:["choicesPaymentVerificationPlanStatusList"],queryFn:()=>N.restChoicesPaymentPlanStatusList()}),x=[...g||[]].filter(f=>sh.includes(f.value))||[];return e.jsx(Ns,{clearHandler:m,applyHandler:h,children:e.jsxs(p,{container:!0,spacing:3,alignItems:"flex-end",children:[e.jsx(p,{size:3,children:e.jsx(Cs,{label:r("Search"),value:s.search,fullWidth:!0,onChange:f=>d("search",f.target.value),"data-cy":"filter-search"})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:f=>d("status",f.target.value),variant:"outlined",label:r("Status"),multiple:!0,value:s.status,fullWidth:!0,children:x.map(f=>e.jsx(de,{value:f.value,children:f.name},f.value))})}),e.jsx(p,{size:3,children:e.jsx(js,{id:"totalEntitledQuantityFromFilter",topLabel:r("Entitled Quantity"),value:Qe(s.totalEntitledQuantityUsdFrom),placeholder:r("From"),onChange:f=>d("totalEntitledQuantityUsdFrom",f.target.value),"data-cy":"filters-total-entitled-quantity-from"})}),e.jsx(p,{size:3,children:e.jsx(js,{id:"totalEntitledQuantityToFilter",value:Qe(s.totalEntitledQuantityUsdTo),placeholder:r("To"),onChange:f=>d("totalEntitledQuantityUsdTo",f.target.value),error:!!(s.totalEntitledQuantityFrom&&s.totalEntitledQuantityTo&&s.totalEntitledQuantityFrom>s.totalEntitledQuantityTo),"data-cy":"filters-total-entitled-quantity-to"})}),e.jsx(p,{size:3,children:e.jsx(ms,{topLabel:r("Dispersion Date"),placeholder:r("From"),onChange:f=>{s.dispersionEndDate&&fs(f).isAfter(s.dispersionEndDate)?(d("dispersionStartDate",f?fs(f).format("YYYY-MM-DD"):""),d("dispersionEndDate","")):d("dispersionStartDate",f?fs(f).format("YYYY-MM-DD"):"")},value:s.dispersionStartDate})}),e.jsx(p,{size:3,children:e.jsx(ms,{placeholder:r("To"),onChange:f=>d("dispersionEndDate",f?fs(f).format("YYYY-MM-DD"):""),value:s.dispersionEndDate,minDate:s.dispersionStartDate,minDateMessage:e.jsx("span",{})})}),e.jsx(p,{size:12,children:e.jsx(P,{ml:2,children:e.jsx(sa,{control:e.jsx(ns,{checked:!!s.isFollowUp,value:s.isFollowUp,color:"primary",onChange:f=>{f.target.checked?d("isFollowUp",!0):d("isFollowUp",!1)}}),label:r("Show only Follow-up plans")})})})]})})}const gv=({plan:s,canViewDetails:t})=>{const a=ge(),{baseUrl:n}=U(),i=`/${n}/payment-module/${s.isFollowUp?"followup-payment-plans":"payment-plans"}/${s.id}`,r=()=>{a(i)},l=()=>s.followUps?.length?e.jsx(P,{display:"flex",flexDirection:"column",children:s.followUps?.map(o=>{const d=`/${n}/payment-module/followup-payment-plans/${o?.id}`;return e.jsx(P,{mb:1,children:e.jsx(me,{to:d,children:o?.unicefId},o?.id)},o?.id)})}):e.jsx(e.Fragment,{children:"-"});return e.jsxs(rs,{hover:!0,onClick:t?r:void 0,role:"checkbox",children:[e.jsxs(_,{align:"left",children:[s.isFollowUp?"Follow-up: ":"",t?e.jsx(me,{to:i,children:s.unicefId}):s.unicefId]}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Vt})}),e.jsx(_,{align:"left",children:s.name}),e.jsx(_,{align:"left",children:s.totalHouseholdsCount||"-"}),e.jsx(_,{align:"left",children:s.currency}),e.jsx(_,{align:"right",children:`${Ps(Number(s.totalEntitledQuantity),s.currency)}`}),e.jsx(_,{align:"right",children:`${Ps(Number(s.totalDeliveredQuantity),s.currency)}`}),e.jsx(_,{align:"right",children:`${Ps(Number(s.totalUndeliveredQuantity),s.currency)}`}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.dispersionStartDate})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.dispersionEndDate})}),e.jsx(_,{align:"left",children:l()})]},s.id)},xv=[{disablePadding:!1,label:"Payment Plan ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Target Population",id:"targetPopulation",numeric:!1},{disablePadding:!1,label:"Num. of Households",id:"totalHouseholdsCount",numeric:!1},{disablePadding:!1,label:"Currency",id:"currency",numeric:!1},{disablePadding:!1,label:"Total Entitled Quantity",id:"totalEntitledQuantity",numeric:!0},{disablePadding:!1,label:"Total Delivered Quantity",id:"totalDeliveredQuantity",numeric:!0},{disablePadding:!1,label:"Total Undelivered Quantity",id:"totalUndeliveredQuantity",numeric:!0},{disablePadding:!1,label:"Dispersion Start Date",id:"dispersionStartDate",numeric:!1},{disablePadding:!1,label:"Dispersion End Date",id:"dispersionEndDate",numeric:!1},{disablePadding:!1,label:"Follow-up Payment Plans",id:"followup-id",numeric:!1}];function fv({filter:s,canViewDetails:t}){const{t:a}=M(),{programId:n,businessArea:i}=U(),{selectedProgram:r}=Z(),l=r?.beneficiaryGroup,o=A.useMemo(()=>({businessAreaSlug:i,programSlug:n,search:s.search,status:s.status,totalEntitledQuantityUsdFrom:s.totalEntitledQuantityUsdFrom||null,totalEntitledQuantityUsdTo:s.totalEntitledQuantityUsdTo||null,dispersionStartDate:s.dispersionStartDate||null,dispersionEndDate:s.dispersionEndDate||null,isFollowUp:s.isFollowUp?!0:null,isPaymentPlan:!0}),[i,n,s.search,s.status,s.totalEntitledQuantityUsdFrom,s.totalEntitledQuantityUsdTo,s.dispersionStartDate,s.dispersionEndDate,s.isFollowUp]),[d,c]=A.useState(o);A.useEffect(()=>{c(o)},[o]);const[u,h]=A.useState(0),{data:m,isLoading:g,error:x}=V({queryKey:["businessAreasProgramsPaymentPlansList",d,i,n],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansList(Ce({businessAreaSlug:i,programSlug:n},d,{withPagination:!0}))}),{data:f}=V({queryKey:["businessAreasProgramsPaymentPlansCountRetrieve",n,i,d],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansCountRetrieve(Ce({businessAreaSlug:i,programSlug:n},d)),enabled:!!i&&!!n&&u===0}),j={totalHouseholdsCount:C=>`Num. of ${C?.groupLabelPlural}`},y=vs(u,f),b=$s(xv,l,j);return e.jsx(ds,{defaultOrderBy:"-createdAt",title:a("Payment Plans"),headCells:b,data:m,isLoading:g,error:x,queryVariables:d,setQueryVariables:c,itemsCount:y,page:u,setPage:h,renderRow:C=>e.jsx(gv,{plan:C,canViewDetails:t},C.id)})}const yv=oe(fv,"PaymentPlansTable"),Er={search:"",dispersionStartDate:"",dispersionEndDate:"",status:[],totalEntitledQuantityFrom:"",totalEntitledQuantityTo:"",isFollowUp:""};function bv(){const{t:s}=M(),t=ve(),a=je(),[n,i]=A.useState(Ke(a,Er)),[r,l]=A.useState(Ke(a,Er)),[o,d]=A.useState(!1),c=A.useRef(null);return et(c,o,r,()=>d(!1)),t===null?null:K(R.PM_VIEW_LIST,t)?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:s("Payment Module")}),e.jsx(pv,{filter:n,setFilter:i,initialFilter:Er,appliedFilter:r,setAppliedFilter:u=>{l(u),d(!0)}}),e.jsx("div",{ref:c,children:e.jsx(Es,{children:e.jsx(yv,{filter:r,canViewDetails:K(R.PM_VIEW_DETAILS,t)})})})]}):e.jsx(Xe,{permission:R.PM_VIEW_LIST})}const jv=oe(bv,"PaymentModulePage");function Av({handleSubmit:s,permissions:t,loadingCreate:a}){const{t:n}=M(),{businessArea:i,programId:r}=U(),{programCycleId:l}=ts(),{data:o,isLoading:d}=V({queryKey:["programCyclesDetails",i,l,r],queryFn:()=>N.restBusinessAreasProgramsCyclesRetrieve({businessAreaSlug:i,id:l,programSlug:r})});if(d)return null;const c=[{title:n("Payment Module"),to:"../../.."},{title:`${o.title}`,to:"../.."}];return e.jsx(Ze,{title:n("New Payment Plan"),breadCrumbs:K(R.PM_VIEW_LIST,t)?c:null,children:e.jsxs(P,{display:"flex",mt:2,mb:2,children:[e.jsx(P,{mr:3,children:e.jsx(H,{component:ys,to:"../..",children:n("Cancel")})}),e.jsx(ke,{loading:a,variant:"contained",color:"primary",onClick:s,"data-cy":"button-save-payment-plan",children:n("Save")})]})})}const _v=()=>{const s=ge(),{t}=M(),{businessArea:a,programId:n}=U(),{showMessage:i}=Ae(),r=ve(),{programCycleId:l}=ts(),{mutateAsync:o,isPending:d}=xe({mutationFn:({businessAreaSlug:x,programSlug:f,requestBody:j})=>N.restBusinessAreasProgramsPaymentPlansCreate({businessAreaSlug:x,programSlug:f,requestBody:j})}),{data:c,isLoading:u}=V({queryKey:["businessAreasProgramsTargetPopulationsList",a,n,l],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsList({businessAreaSlug:a,programSlug:n,status:"DRAFT",programCycle:l})});if(u)return e.jsx(Ne,{});if(!c||r===null)return null;if(!K(R.PM_CREATE,r))return e.jsx(Xe,{permission:R.PM_CREATE});const h=Q.object().shape({paymentPlanId:Q.string().required(t("Target Population is required")),currency:Q.string().nullable().required(t("Currency is required")),dispersionStartDate:Q.date().required(t("Dispersion Start Date is required")),dispersionEndDate:Q.date().required(t("Dispersion End Date is required")).min(new Date,t("Dispersion End Date cannot be in the past")).when("dispersionStartDate",(x,f)=>x&&typeof x=="string"?f.min(Gt.parseISO(x),`${t("Dispersion End Date has to be greater than")} ${Gt.format(Gt.parseISO(x),"yyyy-MM-dd")}`):f)}),m={paymentPlanId:"",currency:null,dispersionStartDate:null,dispersionEndDate:null},g=async x=>{try{const f=x.dispersionStartDate?Gt.format(new Date(x.dispersionStartDate),"yyyy-MM-dd"):null,j=x.dispersionEndDate?Gt.format(new Date(x.dispersionEndDate),"yyyy-MM-dd"):null,y={targetPopulationId:x.paymentPlanId,dispersionStartDate:f,dispersionEndDate:j,currency:x.currency},b=await o({businessAreaSlug:a,programSlug:n,requestBody:y});i(t("Payment Plan Created")),s(`../${b.id}`)}catch(f){fe(f,i)}};return e.jsx(B.Formik,{initialValues:m,validationSchema:h,onSubmit:g,validateOnChange:!0,validateOnBlur:!0,children:({submitForm:x,values:f})=>e.jsxs(B.Form,{children:[e.jsx(Bs,{}),e.jsx(Av,{handleSubmit:x,permissions:r,loadingCreate:d}),e.jsx(Wn,{allTargetPopulations:c,loading:u}),e.jsx(Hn,{values:f})]})})},Cd=oe(_v,"CreatePaymentPlanPage");function Pv({followUps:s,baseUrl:t}){const{t:a}=M(),[n,i]=A.useState(!1),r=()=>{i(!n)};let l=null;return s?.length>0&&(l=(n?s:s.slice(0,5)).map(d=>e.jsxs(me,{to:`/${t}/payment-module/followup-payment-plans/${d?.id}`,children:[d?.unicefId,e.jsx("br",{})]},d?.id))),e.jsx(L,{label:a("Related Follow-Up Payment Plans"),children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[l||"-",s?.length>5&&e.jsx(H,{variant:"outlined",color:"primary",onClick:r,children:a(n?"Hide":"See all")})]})})}const Cv=({baseUrl:s,paymentPlan:t})=>{const{t:a}=M(),{createdBy:n,currency:i,startDate:r,endDate:l,dispersionStartDate:o,dispersionEndDate:d,followUps:c,exchangeRate:u,program:h}=t;return e.jsx(p,{size:{xs:12},children:e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Details")})}),e.jsx(vt,{children:e.jsxs(p,{container:!0,children:[e.jsxs(p,{container:!0,size:{xs:9},spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Created By"),children:n})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Programme"),children:e.jsx(me,{to:`/${s}/details/${h.slug}`,children:h.name})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Target Population"),children:e.jsx(me,{to:`/${s}/target-population/${t.id}`,children:t.name})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Currency"),children:i})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Start Date"),children:e.jsx(pe,{children:r})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("End Date"),children:e.jsx(pe,{children:l})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Dispersion Start Date"),children:e.jsx(pe,{children:o})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Dispersion End Date"),children:e.jsx(pe,{children:d})})}),e.jsxs(p,{size:{xs:3},children:[e.jsx(P,{mr:1,children:e.jsx(L,{label:a("FX Rate Applied"),children:u})}),e.jsx(Ms,{title:a("If displayed exchange rate differs from Vision, please contact your designated focal point for resolution"),children:e.jsx(Ve,{color:"primary","aria-label":"exchange-rate","data-cy":"info-exchange-rate",children:e.jsx(dn,{})})})]}),e.jsx(p,{size:{xs:3},children:e.jsx(P,{mr:1,children:e.jsx(L,{label:a("FSP"),children:t.financialServiceProvider.name})})}),e.jsx(p,{size:{xs:3},children:e.jsx(P,{mr:1,children:e.jsx(L,{label:a("Delivery Mechanism"),children:t.deliveryMechanism.name})})})]}),e.jsx(p,{container:!0,direction:"column",size:{xs:3},spacing:6,children:e.jsx(p,{size:{xs:12},children:e.jsx(Ws,{color:"#84A1CA",children:e.jsx(Pv,{followUps:c,baseUrl:s})})})})]})})]})})};function th({paymentPlan:s,canReactivate:t}){const{t:a}=M(),{isActiveProgram:n}=Z(),{businessArea:i,programId:r}=U(),{showMessage:l}=Ae(),o=Fe(),[d,c]=A.useState(!1),{mutateAsync:u}=xe({mutationFn:async()=>{c(!0),await N.restBusinessAreasProgramsPaymentPlansReactivateAbortRetrieve({businessAreaSlug:i,id:s.id,programSlug:r}),c(!1)},onSuccess:()=>{l(a("Payment Plan has been reactivated.")),o.invalidateQueries({queryKey:["paymentPlan",i,s.id,r]})},onError:()=>{c(!1)}}),h=async()=>{await u()};return e.jsx(P,{display:"flex",alignItems:"center",children:t&&e.jsx(P,{m:2,children:e.jsx(H,{variant:"contained",color:"primary","data-cy":"button-reactivate-payment-plan",onClick:h,disabled:!n||d||!t,"data-perm":R.PM_REACTIVATE_ABORT,children:a(d?"Reactivating...":"Reactivate")})})})}const Ev=({permissions:s,paymentPlan:t})=>{const{t:a}=M(),{businessArea:n,programId:i}=U(),r=t.programCycle?.id,{data:l}=V({queryKey:["programCyclesDetails",n,r,i],queryFn:()=>N.restBusinessAreasProgramsCyclesRetrieve({businessAreaSlug:n,id:r,programSlug:i}),enabled:!!r}),o=[];r?(o.push({title:a("Payment Module"),to:"../../.."}),o.push({title:`${l?.title||""}`,to:"../.."})):o.push({title:a("Payment Module"),to:".."});const d=K(R.PM_CREATE,s),c=K(R.PM_CREATE,s),u=K(R.PM_LOCK_AND_UNLOCK,s),h=K(R.PM_LOCK_AND_UNLOCK,s),m=K(R.PM_SEND_FOR_APPROVAL,s),g=K(R.PM_ACCEPTANCE_PROCESS_APPROVE,s),x=K(R.PM_ACCEPTANCE_PROCESS_AUTHORIZE,s),f=K(R.PM_ACCEPTANCE_PROCESS_FINANCIAL_REVIEW,s),j=K(R.PM_SPLIT,s)&&t.canSplit,y=K(R.PM_SEND_TO_PAYMENT_GATEWAY,s)&&t.canSendToPaymentGateway,b=K(R.PM_CLOSE_FINISHED,s),C=K(R.PM_ABORT,s),v=K(R.PM_REACTIVATE_ABORT,s);let S=null;switch(t.status){case te.OPEN:S=e.jsx(to,{paymentPlan:t,canRemove:d,canEdit:c,canLock:u});break;case te.LOCKED:S=e.jsx(so,{paymentPlan:t,canUnlock:u,permissions:s,canAbort:C});break;case te.LOCKED_FSP:S=e.jsx(eo,{paymentPlan:t,canUnlock:h,canSendForApproval:m,canAbort:C});break;case te.IN_APPROVAL:S=e.jsx(Xl,{paymentPlan:t,canReject:K(R.PM_ACCEPTANCE_PROCESS_APPROVE,s),canApprove:g,canAbort:C});break;case te.IN_AUTHORIZATION:S=e.jsx(Jl,{paymentPlan:t,canReject:K(R.PM_ACCEPTANCE_PROCESS_AUTHORIZE,s),canAuthorize:x,canAbort:C});break;case te.IN_REVIEW:S=e.jsx(Zl,{paymentPlan:t,canReject:K(R.PM_ACCEPTANCE_PROCESS_FINANCIAL_REVIEW,s),canMarkAsReleased:f,canAbort:C});break;case te.FINISHED:case te.ACCEPTED:S=e.jsx(Yl,{canSendToPaymentGateway:y,canSplit:j,canClose:b,paymentPlan:t});break;case te.ABORTED:S=e.jsx(th,{paymentPlan:t,canReactivate:v});break}return e.jsx(Ze,{title:e.jsxs(P,{display:"flex",alignItems:"center",children:[a("Payment Plan")," ID:"," ",e.jsx(P,{ml:1,mr:2,children:e.jsx("span",{"data-cy":"pp-unicef-id",children:t.unicefId})}),e.jsx(P,{mr:2,children:e.jsx(we,{status:t.status,statusToColor:Vt})}),e.jsx(P,{mr:2,children:t.backgroundActionStatus&&e.jsx(we,{status:t.backgroundActionStatus,statusToColor:wi})})]}),breadCrumbs:K(R.PM_VIEW_DETAILS,s)?o:null,flags:e.jsx(gt,{adminUrl:t.adminUrl}),children:S})},vv=()=>{const{paymentPlanId:s}=ts(),t=ve(),{baseUrl:a,businessArea:n,programId:i}=U(),{data:r,isLoading:l,error:o}=V({queryKey:["paymentPlan",n,s,i],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansRetrieve({businessAreaSlug:n,id:s,programSlug:i}),refetchInterval:m=>{const g=m.state.data,x=[bs.EXCLUDE_BENEFICIARIES_ERROR,bs.XLSX_EXPORT_ERROR,bs.XLSX_IMPORT_ERROR];return g?.status===te.PREPARING||g?.backgroundActionStatus!==null&&!x.includes(g?.backgroundActionStatus)?3e3:!1},refetchIntervalInBackground:!0});if(l)return e.jsx(Ne,{});if(t===null||!r)return null;if(!K(R.PM_VIEW_DETAILS,t)||rt(o))return e.jsx(Xe,{permission:R.PM_VIEW_DETAILS});if(!r)return null;const{status:d}=r,c=d!==te.OPEN,u=d===te.ACCEPTED||d===te.FINISHED,h=d===te.IN_REVIEW||d===te.ACCEPTED||d===te.FINISHED;return e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(Ev,{paymentPlan:r,permissions:t}),e.jsx(Cv,{baseUrl:a,paymentPlan:r}),d!==te.PREPARING&&e.jsxs(e.Fragment,{children:[e.jsx(nr,{paymentPlan:r}),h&&e.jsx(ao,{paymentPlan:r}),c&&e.jsx(Ju,{paymentPlan:r,permissions:t}),e.jsx(Ku,{paymentPlan:r}),e.jsx(ar,{paymentPlan:r}),e.jsx(no,{paymentPlan:r}),e.jsx(io,{businessArea:n,paymentPlan:r,permissions:t,canViewDetails:!0}),u&&e.jsx(tr,{paymentPlan:r})]}),K(R.ACTIVITY_LOG_VIEW,t)&&e.jsx(Lt,{objectId:r?.id})]})},Ed=oe(vv,"PaymentPlanDetailsPage"),Sv=({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})=>{const{t:r}=M(),l=ge(),o=je(),{handleFilterChange:d,applyFilterChanges:c,clearFilter:u}=Ss(a,l,o,s,t,n,i),h=()=>{c()},m=()=>{u()},{data:g}=V({queryKey:["choicesPaymentPlanStatusList"],queryFn:()=>N.restChoicesPaymentPlanStatusList()});if(!g)return null;const x=[...g||[]].filter(f=>sh.includes(f.value))||[];return e.jsxs(Ns,{clearHandler:m,applyHandler:h,children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:r("Payment Plans Filters")})}),e.jsxs(p,{container:!0,spacing:3,alignItems:"flex-end",children:[e.jsx(p,{size:3,children:e.jsx(Cs,{label:r("Search"),value:s.search,fullWidth:!0,onChange:f=>d("search",f.target.value)})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:f=>d("status",f.target.value),variant:"outlined",label:r("Status"),multiple:!0,value:s.status,fullWidth:!0,children:x.map(f=>e.jsx(de,{value:f.value,children:f.name},f.value))})}),e.jsx(p,{size:3,children:e.jsx(Ot,{display:"flex",flexDirection:"column",children:e.jsx(js,{id:"totalEntitledQuantityFromFilter",topLabel:r("Total Entitled Quantity (USD)"),value:Qe(s.totalEntitledQuantityFrom),placeholder:r("From"),onChange:f=>d("totalEntitledQuantityFrom",f.target.value)})})}),e.jsx(p,{size:3,children:e.jsx(js,{id:"totalEntitledQuantityToFilter",value:Qe(s.totalEntitledQuantityTo),placeholder:r("To"),onChange:f=>d("totalEntitledQuantityTo",f.target.value),error:s.totalEntitledQuantityFrom&&s.totalEntitledQuantityTo&&s.totalEntitledQuantityFrom>s.totalEntitledQuantityTo})}),e.jsx(p,{size:3,children:e.jsx(ms,{topLabel:r("Dispersion Date"),placeholder:r("From"),onChange:f=>{s.dispersionEndDate&&fs(f).isAfter(s.dispersionEndDate)?(d("dispersionStartDate",fs(f).format("YYYY-MM-DD")),d("dispersionEndDate",void 0)):d("dispersionStartDate",fs(f).format("YYYY-MM-DD"))},value:s.dispersionStartDate})}),e.jsx(p,{size:3,children:e.jsx(ms,{placeholder:r("To"),onChange:f=>d("dispersionEndDate",fs(f).format("YYYY-MM-DD")),value:s.dispersionEndDate,minDate:s.dispersionStartDate,minDateMessage:e.jsx("span",{})})})]})]})},Iv=[{disablePadding:!1,label:"Payment Plan ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Num. of Households",id:"totalHouseholdsCount",numeric:!1},{disablePadding:!1,label:"Total Entitled Quantity",id:"totalEntitledQuantity",numeric:!0},{disablePadding:!1,label:"Total Undelivered Quantity",id:"totalUndeliveredQuantity",numeric:!0},{disablePadding:!1,label:"Total Delivered Quantity",id:"totalDeliveredQuantity",numeric:!0},{disablePadding:!1,label:"Dispersion Start Date",id:"dispersionStartDate",numeric:!1},{disablePadding:!1,label:"Dispersion End Date",id:"dispersionEndDate",numeric:!1},{disablePadding:!1,label:"Follow-up Payment Plans",id:"followup-id",numeric:!1}],Dv=T(xl)`
  color: #000;
`,Tv=({paymentPlan:s,canViewDetails:t})=>{const{t:a}=M(),[n,i]=A.useState(!1),{baseUrl:r}=U(),l=s.followUps||[];if(!l.length)return null;const o=l.map(d=>e.jsxs(be,{children:[e.jsx(_,{align:"left",children:e.jsx(me,{to:`/${r}/payment-module/followup-payment-plans/${d.id}`,children:d.unicefId})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:d.dispersionStartDate})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:d.dispersionEndDate})})]},d.id));return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{color:"primary",onClick:()=>i(!0),"data-cy":"button-eye-follow-ups",children:e.jsx(Dv,{})}),e.jsxs(is,{open:n,onClose:()=>i(!1),scroll:"paper",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Follow-up Payment Plans")})}),e.jsxs(Be,{children:[e.jsx(pt,{children:e.jsx(P,{mb:2,children:e.jsx(L,{label:a("Original Payment Plan"),children:t?e.jsx(me,{to:`/${r}/payment-module/payment-plans
                /${s.id}`,children:s.unicefId}):s.unicefId})})}),e.jsxs(Bl,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{"data-cy":"table-cell-follow-up-payment-plan-id",align:"left",children:a("Follow-up Payment Plan ID")}),e.jsx(_,{"data-cy":"table-cell-start-date",align:"left",children:a("Dispersion Start Date")}),e.jsx(_,{"data-cy":"table-cell-end-date",align:"left",children:a("Dispersion End Date")})]})}),e.jsx(cs,{children:o})]})]}),e.jsx(ss,{children:e.jsx(os,{children:e.jsx(H,{"data-cy":"button-close",onClick:()=>i(!1),children:a("Close")})})})]})]})},Rv=({paymentPlan:s,canViewDetails:t})=>{const a=`./payment-plans/${s.id}`;return e.jsxs(rs,{children:[e.jsxs(_,{align:"left",children:[s.isFollowUp?"Follow-up: ":"",t?e.jsx(me,{to:a,children:s.unicefId}):s.unicefId]}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Vt})}),e.jsx(_,{align:"left",children:s.totalHouseholdsCount||"-"}),e.jsx(_,{align:"right",children:`${Ps(Number(s.totalEntitledQuantity),s.currency)}`}),e.jsx(_,{align:"right",children:`${Ps(Number(s.totalUndeliveredQuantity),s.currency)}`}),e.jsx(_,{align:"right",children:`${Ps(Number(s.totalDeliveredQuantity),s.currency)}`}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.dispersionStartDate})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.dispersionEndDate})}),e.jsx(_,{align:"left",children:e.jsx(Tv,{paymentPlan:s,canViewDetails:t})})]},s.id)},Fv=({programCycle:s,filter:t,canViewDetails:a,title:n})=>{const{programId:i,businessArea:r}=U(),{selectedProgram:l}=Z(),o=l?.beneficiaryGroup,d=Js.useMemo(()=>({programSlug:i,businessAreaSlug:r,search:t.search,status:t.status,totalEntitledQuantityFrom:t.totalEntitledQuantityFrom,totalEntitledQuantityTo:t.totalEntitledQuantityTo,dispersionStartDate:t.dispersionStartDate,dispersionEndDate:t.dispersionEndDate,isFollowUp:null,program:i,programCycle:s.id,isPaymentPlan:!0}),[r,t.search,t.status,t.totalEntitledQuantityFrom,t.totalEntitledQuantityTo,t.dispersionStartDate,t.dispersionEndDate,i,s.id]),[c,u]=A.useState(d);A.useEffect(()=>{u(d)},[d]);const[h,m]=A.useState(0),{data:g,isLoading:x,error:f}=V({queryKey:["businessAreasPaymentPlans",c,i,r],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansList(Ce({businessAreaSlug:r,programSlug:i},c,{withPagination:!0})),enabled:!!r&&!!i}),{data:j}=V({queryKey:["businessAreasProgramsPaymentPlansCountRetrieve",c,i,r],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansCountRetrieve(Ce({businessAreaSlug:r,programSlug:i},c)),enabled:!!r&&!!i&&h===0}),y={totalHouseholdsCount:v=>`Num. of ${v?.groupLabelPlural}`},b=vs(h,j),C=$s(Iv,o,y);return e.jsx(ds,{defaultOrderBy:"-createdAt",title:n,headCells:C,queryVariables:c,data:g,error:f,isLoading:x,setQueryVariables:u,itemsCount:b,page:h,setPage:m,renderRow:v=>e.jsx(Rv,{paymentPlan:v,canViewDetails:a},v.id)})},Nv=({programCycle:s})=>{const t=ve(),{showMessage:a}=Ae(),{t:n}=M(),i=Fe(),{businessArea:r,programId:l}=U(),{mutateAsync:o,isPending:d}=xe({mutationFn:({businessAreaSlug:f,id:j,programSlug:y})=>N.restBusinessAreasProgramsCyclesFinishCreate({businessAreaSlug:f,id:j,programSlug:y}),onSuccess:async()=>{await i.invalidateQueries({queryKey:["programCyclesDetails",r,s.id,l]}),a(n("Programme Cycle Finished"))},onError:f=>{fe(f,a)}}),{mutateAsync:c,isPending:u}=xe({mutationFn:({businessAreaSlug:f,id:j,programSlug:y})=>N.restBusinessAreasProgramsCyclesReactivateCreate({businessAreaSlug:f,id:j,programSlug:y}),onSuccess:async()=>{await i.invalidateQueries({queryKey:["programCyclesDetails",r,s.id,l]})}}),h=[{title:n("Payment Module"),to:".."},{title:n("Programme Cycle"),to:".."}],m=async()=>{try{await o({businessAreaSlug:r,id:s.id,programSlug:l}),a(n("Programme Cycle Finished"))}catch(f){fe(f,a)}},g=async()=>{try{await c({businessAreaSlug:r,id:s.id,programSlug:l}),a(n("Programme Cycle Reactivated"))}catch(f){fe(f,a)}},x=e.jsx(e.Fragment,{children:e.jsxs(P,{display:"flex",mt:2,mb:2,children:[s.status!=="Finished"&&K(R.PM_CREATE,t)&&e.jsx(P,{children:e.jsx(H,{variant:"outlined",color:"primary",component:ys,startIcon:e.jsx(pa,{}),to:"payment-plans/new-plan","data-cy":"button-create-payment-plan","data-perm":R.PM_CREATE,children:n("Create Payment Plan")})}),s.status==="Active"&&K(R.PM_PROGRAMME_CYCLE_UPDATE,t)&&e.jsx(P,{ml:2,children:e.jsx(H,{variant:"contained",color:"primary",onClick:m,disabled:d,"data-cy":"button-finish-programme-cycle","data-perm":R.PM_PROGRAMME_CYCLE_UPDATE,children:n("Finish Cycle")})}),s.status==="Finished"&&K(R.PM_PROGRAMME_CYCLE_UPDATE,t)&&e.jsx(P,{ml:2,children:e.jsx(H,{variant:"contained",color:"primary",onClick:g,disabled:u,"data-cy":"button-reactivate-programme-cycle","data-perm":R.PM_PROGRAMME_CYCLE_UPDATE,children:n("Reactivate Cycle")})})]})});return e.jsx(Ze,{title:e.jsx(P,{display:"flex",alignItems:"center",children:e.jsx(P,{display:"flex",flexDirection:"column",children:e.jsx(P,{children:s.title})})}),breadCrumbs:h,flags:e.jsx(gt,{adminUrl:s.adminUrl}),children:x})},Lv=({programCycle:s})=>{const{t}=M();return e.jsx(p,{size:12,children:e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:t("Details")})}),e.jsx(vt,{children:e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:12,children:e.jsx(we,{status:s.status,statusToColor:vl})}),e.jsx(p,{size:3,children:e.jsx(L,{label:t("Created By"),children:s.createdBy})}),e.jsx(p,{size:3,children:e.jsx(L,{label:t("Start Date"),children:e.jsx(pe,{children:s.startDate})})}),e.jsx(p,{size:3,children:e.jsx(L,{label:t("End Date"),children:e.jsx(pe,{children:s.endDate})})}),e.jsx(p,{size:3,children:e.jsx(L,{label:t("Programme Start Date"),children:e.jsx(pe,{children:s.programStartDate})})}),e.jsx(p,{size:3,children:e.jsx(L,{label:t("Programme End Date"),children:e.jsx(pe,{children:s.programEndDate})})}),e.jsx(p,{size:3,children:e.jsx(L,{label:t("Frequency of Payment"),children:s.frequencyOfPayments})})]})})]})})},vr={search:"",dispersionStartDate:void 0,dispersionEndDate:void 0,status:[],totalEntitledQuantityFrom:null,totalEntitledQuantityTo:null,isFollowUp:!1},Ov=()=>{const{businessArea:s,programId:t}=U(),{programCycleId:a}=ts(),n=je(),i=ve(),{data:r,isLoading:l}=V({queryKey:["programCyclesDetails",s,a,t],queryFn:()=>N.restBusinessAreasProgramsCyclesRetrieve({businessAreaSlug:s,id:a,programSlug:t})}),[o,d]=A.useState(Ke(n,vr)),[c,u]=A.useState(Ke(n,vr)),[h,m]=A.useState(!1),g=A.useRef(null);return et(g,h,c,()=>m(!1)),l?null:e.jsxs(e.Fragment,{children:[e.jsx(Nv,{programCycle:r}),e.jsx(Lv,{programCycle:r}),e.jsx(Es,{children:e.jsx(Sv,{filter:o,setFilter:d,initialFilter:vr,appliedFilter:c,setAppliedFilter:x=>{u(x),m(!0)}})}),e.jsx("div",{ref:g,children:e.jsx(Es,{children:e.jsx(Fv,{programCycle:r,filter:c,canViewDetails:K(R.PM_VIEW_DETAILS,i)})})})]})},vd=oe(Ov,"ProgramCycleDetailsPage"),kv=[{value:"ACTIVE",name:"Active"},{value:"DRAFT",name:"Draft"},{value:"FINISHED",name:"Finished"}],wv=({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})=>{const{t:r}=M(),l=ge(),o=je(),{handleFilterChange:d,applyFilterChanges:c,clearFilter:u}=Ss(a,l,o,s,t,n,i),h=()=>{c()},m=()=>{u()};return e.jsx(Ns,{clearHandler:m,applyHandler:h,children:e.jsxs(p,{container:!0,spacing:3,alignItems:"flex-end",children:[e.jsx(p,{size:3,children:e.jsx(Cs,{label:r("Search"),value:s.search,fullWidth:!0,onChange:g=>d("search",g.target.value)})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:g=>d("status",g.target.value),variant:"outlined",label:r("Status"),value:s.status,fullWidth:!0,children:kv.map(g=>e.jsx(de,{value:g.value,children:g.name},g.value))})}),e.jsx(p,{size:3,children:e.jsx(js,{id:"totalEntitledQuantityUsdFromFilter",topLabel:r("Total Entitled Quantity"),value:Qe(s.totalEntitledQuantityUsdFrom),placeholder:r("From"),onChange:g=>d("totalEntitledQuantityUsdFrom",g.target.value)})}),e.jsx(p,{size:3,children:e.jsx(js,{id:"totalEntitledQuantityUsdToFilter",value:Qe(s.totalEntitledQuantityUsdTo),placeholder:r("To"),onChange:g=>d("totalEntitledQuantityUsdTo",g.target.value),error:s.totalEntitledQuantityUsdFrom&&s.totalEntitledQuantityUsdTo&&s.totalEntitledQuantityUsdFrom>s.totalEntitledQuantityUsdTo})}),e.jsx(p,{size:3,children:e.jsx(ms,{topLabel:"Date",onChange:g=>d("startDate",g?fs(g).format("YYYY-MM-DD"):""),value:s.startDate})}),e.jsx(p,{size:3,children:e.jsx(ms,{onChange:g=>d("end_date",g?fs(g).format("YYYY-MM-DD"):""),value:s.endDate})})]})})},Mv=({program:s,filters:t,adjustedHeadCells:a})=>{const{showMessage:n}=Ae(),{businessArea:i,programId:r,isAllPrograms:l}=U(),[o,d]=A.useState(0),[c,u]=A.useState({offset:0,limit:5,ordering:"created_at",businessAreaSlug:i,programSlug:r,...t}),{t:h}=M(),m=Fe(),g=!!(!l&&s?.id),x=c&&typeof c.limit=="number"?c.limit:5,{data:f,refetch:j,error:y,isLoading:b}=V({queryKey:["programCycles",c,i,r,o,x],queryFn:()=>N.restBusinessAreasProgramsCyclesList(Ce({businessAreaSlug:i,programSlug:r},{...c,offset:o*x},{withPagination:!0})),enabled:g}),{data:C}=V({queryKey:["businessAreasProgramsCyclesCountRetrieve",r,i,c,o],queryFn:()=>N.restBusinessAreasProgramsCyclesCountRetrieve(Ce({businessAreaSlug:i,programSlug:r},c)),enabled:o===0}),v=vs(o,C),{mutateAsync:S,isPending:I}=xe({mutationFn:({businessAreaSlug:$,id:G,programSlug:W})=>N.restBusinessAreasProgramsCyclesFinishCreate({businessAreaSlug:$,id:G,programSlug:W}),onSuccess:async()=>{await m.invalidateQueries({queryKey:["programCycles",i,s.slug],exact:!1}),await m.invalidateQueries({queryKey:["programCycles",c,i,r],exact:!1})},mutationKey:["finishProgramCycle",i,s.id]}),{mutateAsync:E,isPending:D}=xe({mutationFn:({businessAreaSlug:$,id:G,programSlug:W})=>N.restBusinessAreasProgramsCyclesReactivateCreate({businessAreaSlug:$,id:G,programSlug:W}),onSuccess:async()=>{await m.invalidateQueries({queryKey:["programCycles",i,s.slug],exact:!1}),await m.invalidateQueries({queryKey:["programCycles",c,i,r],exact:!1})},mutationKey:["reactivateProgramCycle",i,s.id]});A.useEffect(()=>{u($=>({...$,...t}))},[t]),A.useEffect(()=>{j()},[c,j]);const F=async $=>{try{await S({businessAreaSlug:i,id:$.id,programSlug:r}),n(h("Programme Cycle Finished"))}catch(G){fe(G,n)}},w=async $=>{try{await E({businessAreaSlug:i,id:$.id,programSlug:r}),n(h("Programme Cycle Reactivated"))}catch(G){fe(G,n)}},O=[e.jsx($u,{lastProgramCycle:(f?.results||[])[(f?.results||[]).length-1]},"add-new")],k=$=>e.jsxs(rs,{"data-cy":"program-cycle-row",children:[e.jsx(_,{"data-cy":"program-cycle-title",children:e.jsx(me,{to:`./${$.id}`,children:$.title})}),e.jsx(_,{"data-cy":"program-cycle-status",children:e.jsx(we,{status:$.status,statusToColor:vl})}),e.jsx(_,{align:"right","data-cy":"program-cycle-total-entitled-quantity-usd",children:$.totalEntitledQuantityUsd?Qe($.totalEntitledQuantityUsd):"-"}),e.jsx(_,{"data-cy":"program-cycle-start-date",children:e.jsx(pe,{children:$.startDate})}),e.jsx(_,{"data-cy":"program-cycle-end-date",children:e.jsx(pe,{children:$.endDate})}),e.jsxs(_,{"data-cy":"program-cycle-details-btn",children:[$.status==="Finished"&&e.jsx(H,{onClick:()=>w($),variant:"text",disabled:D,children:h("REACTIVATE")}),$.status==="Active"&&e.jsx(H,{onClick:()=>F($),variant:"text",disabled:I,children:h("FINISH")})]})]},$.id);return e.jsx(ds,{title:"Programme Cycles",actions:O,renderRow:k,headCells:a,itemsCount:v,data:f,error:y,isLoading:b,queryVariables:c,setQueryVariables:u,page:o,setPage:d})},$v=[{id:"title",numeric:!1,disablePadding:!1,label:"Programme Cycle Title",disableSort:!0,dataCy:"head-cell-programme-cycles-title"},{id:"status",numeric:!1,disablePadding:!1,label:"Status",disableSort:!0,dataCy:"head-cell-status"},{id:"total_entitled_quantity_usd",numeric:!0,disablePadding:!1,label:"Total Entitled Quantity (USD)",disableSort:!0,dataCy:"head-cell-total-entitled-quantity-usd"},{id:"startDate",numeric:!1,disablePadding:!1,label:"Start Date",dataCy:"head-cell-start-date"},{id:"end_date",numeric:!1,disablePadding:!1,label:"End Date",disableSort:!0,dataCy:"head-cell-end-date"},{id:"empty",numeric:!1,disablePadding:!1,label:"",disableSort:!0,dataCy:"head-cell-empty"}],Sr={search:"",status:"",totalEntitledQuantityUsdFrom:"",totalEntitledQuantityUsdTo:"",startDate:"",end_date:""},Uv=()=>{const{t:s}=M(),t=ve(),a=je(),{selectedProgram:n}=Z(),{isAllPrograms:i}=U(),r=n?.beneficiaryGroup,[l,o]=A.useState(Ke(a,Sr)),[d,c]=A.useState(Ke(a,Sr)),[u,h]=A.useState(!1),m=A.useRef(null);et(m,u,d,()=>h(!1));const x=$s($v,r,{totalHouseholdsCount:f=>`Total ${f?.groupLabelPlural} Count`});return t===null||!n?null:i?e.jsx(Xe,{permission:"Unavailable in All Programs"}):K(R.PM_PROGRAMME_CYCLE_VIEW_LIST,t)?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:s("Payment Module")}),e.jsx(wv,{filter:l,setFilter:o,initialFilter:Sr,appliedFilter:d,setAppliedFilter:f=>{c(f),h(!0)}}),e.jsx("div",{ref:m,children:e.jsx(Es,{children:e.jsx(Mv,{program:n,filters:d,adjustedHeadCells:x})})})]}):e.jsx(Xe,{permission:R.PM_PROGRAMME_CYCLE_VIEW_LIST})},Sd=oe(Uv,"ProgramCyclePage"),Vv=()=>{const s=ge(),{paymentPlanId:t}=ts(),{t:a}=M(),{baseUrl:n,businessArea:i,programId:r}=U(),{data:l,isLoading:o}=V({queryKey:["paymentPlan",i,t,r],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansRetrieve({businessAreaSlug:i,id:t,programSlug:r}),refetchInterval:()=>{const{status:y,backgroundActionStatus:b}=l;return y===te.PREPARING||b!==null&&b!==bs.EXCLUDE_BENEFICIARIES_ERROR?3e3:!1},refetchIntervalInBackground:!0}),{mutateAsync:d,isPending:c}=xe({mutationFn:({businessAreaSlug:y,id:b,programSlug:C,requestBody:v})=>N.restBusinessAreasProgramsPaymentPlansPartialUpdate({businessAreaSlug:y,id:b,programSlug:C,requestBody:v})}),{showMessage:u}=Ae(),h=ve(),{data:m,isLoading:g}=V({queryKey:["businessAreasProgramsTargetPopulationsList",i,r],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsList({businessAreaSlug:i,programSlug:r,status:"DRAFT"})});if(g||o)return e.jsx(Ne,{});if(!m||!l||h===null)return null;if(!K(R.PM_CREATE,h))return e.jsx(Xe,{permission:R.PM_CREATE});const x={paymentPlanId:l.id,currency:{name:l.currency,value:l.currency},dispersionStartDate:l.dispersionStartDate,dispersionEndDate:l.dispersionEndDate},f=Q.object().shape({targetingId:Q.string().required(a("Target Population is required")),currency:Q.string().nullable().required(a("Currency is required")),dispersionStartDate:Q.date().required(a("Dispersion Start Date is required")),dispersionEndDate:Q.date().required(a("Dispersion End Date is required")).min(ta,a("Dispersion End Date cannot be in the past")).when("dispersionStartDate",(y,b)=>y?b.min(y,`${a("Dispersion End Date has to be greater than")} ${fs(y).format("YYYY-MM-DD")}`):b)}),j=async y=>{const b={dispersionStartDate:y.dispersionStartDate,dispersionEndDate:y.dispersionEndDate,currency:y.currency?.value?y.currency.value:y.currency};try{const C=await d({businessAreaSlug:i,id:t,programSlug:r,requestBody:b});u(a("Follow-up Payment Plan Edited")),s(`/${n}/payment-module/followup-payment-plans/${C.id}`)}catch(C){fe(C,u)}};return e.jsx(B.Formik,{initialValues:x,validationSchema:f,onSubmit:j,children:({submitForm:y,values:b})=>e.jsxs(B.Form,{children:[e.jsx(Bs,{}),e.jsx(sr,{paymentPlan:l,handleSubmit:y,baseUrl:n,permissions:h,loadingUpdate:c}),e.jsx(Wn,{allTargetPopulations:m,loading:g,disabled:!0}),e.jsx(Hn,{paymentPlan:l,values:b})]})})},Bv=oe(Vv,"EditPeopleFollowUpPaymentPlanPage"),Gv=()=>{const s=ge(),{paymentPlanId:t}=ts(),{baseUrl:a,businessArea:n,programId:i}=U(),{t:r}=M(),{data:l,isLoading:o}=V({queryKey:["paymentPlan",n,t,i],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansRetrieve({businessAreaSlug:n,id:t,programSlug:i})}),{mutateAsync:d,isPending:c}=xe({mutationFn:({businessAreaSlug:y,id:b,programSlug:C,requestBody:v})=>N.restBusinessAreasProgramsPaymentPlansPartialUpdate({businessAreaSlug:y,id:b,programSlug:C,requestBody:v})}),{showMessage:u}=Ae(),h=ve(),{data:m,isLoading:g}=V({queryKey:["businessAreasProgramsTargetPopulationsList",n,i],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsList({businessAreaSlug:n,programSlug:i,status:"DRAFT"})});if(g||o)return e.jsx(Ne,{});if(!m||!l||h===null)return null;if(!K(R.PM_CREATE,h))return e.jsx(Xe,{permission:R.PM_CREATE});const x={currency:{name:l.currency,value:l.currency},dispersionStartDate:l.dispersionStartDate,dispersionEndDate:l.dispersionEndDate},f=Q.object().shape({dispersionStartDate:Q.date().required(r("Dispersion Start Date is required")),dispersionEndDate:Q.date().required(r("Dispersion End Date is required")).min(ta,r("Dispersion End Date cannot be in the past")).when("dispersionStartDate",(y,b)=>y?b.min(y,`${r("Dispersion End Date has to be greater than")} ${fs(y).format("YYYY-MM-DD")}`):b)}),j=async y=>{const b={dispersionStartDate:y.dispersionStartDate,dispersionEndDate:y.dispersionEndDate,currency:y.currency?.value?y.currency.value:y.currency};try{const C=await d({businessAreaSlug:n,id:t,programSlug:i,requestBody:b});u(r("Payment Plan Edited")),s(`/${a}/payment-module/payment-plans/${C.id}`)}catch(C){fe(C,u)}};return e.jsx(B.Formik,{initialValues:x,validationSchema:f,onSubmit:j,children:({submitForm:y,values:b})=>e.jsxs(B.Form,{children:[e.jsx(Bs,{}),e.jsx(sr,{paymentPlan:l,handleSubmit:y,baseUrl:a,permissions:h,loadingUpdate:c}),e.jsx(Wn,{allTargetPopulations:m,loading:g,disabled:!0}),e.jsx(Hn,{paymentPlan:l,values:b})]})})},zv=oe(Gv,"EditPeoplePaymentPlanPage"),qv=T.div`
  color: ${({theme:s})=>s.palette.error.dark};
  padding: 20px;
`;function Hv({paymentPlan:s,permissions:t}){const[a,n]=A.useState(null),{showMessage:i}=Ae(),[r,l]=A.useState(!1),[o,d]=A.useState(null),{isActiveProgram:c}=Z(),{t:u}=M(),{businessArea:h,programId:m}=U(),{mutateAsync:g,isPending:x}=xe({mutationFn:({businessAreaSlug:b,id:C,programSlug:v,requestBody:S})=>N.restBusinessAreasProgramsPaymentPlansEntitlementImportXlsxCreate({businessAreaSlug:b,id:C,programSlug:v,formData:S}),onSuccess:()=>{l(!1),i(u("Your import was successful!")),n(null)},onError:b=>{n(Dl(b))}}),f=async()=>{o&&await g({businessAreaSlug:h,id:s.id,programSlug:m,requestBody:{file:o}})},j=K(R.PM_IMPORT_XLSX_WITH_ENTITLEMENTS,t),y=s.status!==te.LOCKED||!j||!c;return e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsx(H,{startIcon:e.jsx(Ka,{}),color:"primary","data-cy":"button-import",onClick:()=>l(!0),disabled:y,children:u("Upload File")})},"import"),e.jsx(is,{open:r,onClose:()=>l(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:e.jsxs(Ye,{"data-cy":"dialog-import",children:[e.jsx(Le,{children:u("Select File to Import")}),e.jsxs(e.Fragment,{children:[e.jsx(pn,{dontShowFilename:!1,loading:x,onChange:b=>{if(b.length===0)return;const C=b[0],v=C.size/(1024*1024);if(v>200){i(`File size is too big. It should be under 200MB, File size is ${v}MB`);return}d(C)}}),o&&a?e.jsxs(qv,{"data-cy":"error-list",children:[e.jsx("p",{children:"Errors"}),e.jsx("p",{children:a})]}):null]}),e.jsxs(os,{children:[e.jsx(H,{"data-cy":"close-button",onClick:()=>{l(!1),d(null)},children:"CANCEL"}),e.jsx(ke,{loading:x,disabled:!o,type:"submit",color:"primary",variant:"contained",onClick:()=>f(),"data-cy":"button-import-entitlement",children:u("IMPORT")})]})]})})]})}const Wv=T.p`
  color: #9e9e9e;
  font-size: 16px;
`,oi=T.p`
  color: #9e9e9e;
  font-size: 14px;
`,Id=T.div`
  border-top: 1px solid #b1b1b5;
  height: 2px;
  width: 50%;
  margin-top: 20px;
`,Kv=T.div`
  border-top: 1px solid #b1b1b5;
  height: 20px;
`,Yv=T.div`
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 500;
  color: #253b46;
  text-transform: uppercase;
  padding: 5px;
  border: 1px solid #b1b1b5;
  border-radius: 50%;
  background-color: #fff;
  margin-top: 20px;
`,Qv=T(Ca)`
  color: #043f91;
`,Xv=T(P)`
  position: relative;
  top: 4px;
  font-size: 16px;
  color: #666666;
`,Jv=T(P)`
  border-right: 1px solid #b1b1b5;
`;function ah({paymentPlan:s,permissions:t}){const{t:a}=M(),{showMessage:n}=Ae(),{isActiveProgram:i}=Z(),{businessArea:r,programId:l}=U(),o=Fe(),[d,c]=A.useState(s.steficonRule?.rule?.id?String(s.steficonRule.rule.id):""),{mutateAsync:u,isPending:h}=xe({mutationFn:({businessAreaSlug:v,id:S,programSlug:I,requestBody:E})=>N.restBusinessAreasProgramsPaymentPlansApplyEngineFormulaCreate({businessAreaSlug:v,id:S,programSlug:I,requestBody:E}),onSuccess:()=>{n(a("Formula is executing, please wait until completed")),o.invalidateQueries({queryKey:["paymentPlan",r,s.id,l]})},onError:v=>{fe(v,n)}}),{data:m,isLoading:g}=V({queryKey:["engineRules",r],queryFn:()=>N.restEngineRulesList({type:"PAYMENT_PLAN",deprecated:!1,enabled:!0,businessArea:r})}),{mutateAsync:x,isPending:f}=xe({mutationFn:({businessAreaSlug:v,id:S,programSlug:I})=>N.restBusinessAreasProgramsPaymentPlansEntitlementExportXlsxRetrieve({businessAreaSlug:v,id:S,programSlug:I}),onSuccess:()=>{n(a("Exporting XLSX started. Please check your email."))},onError:v=>{fe(v,n)}});if(!m)return null;if(g)return e.jsx(Ne,{});const y=!K(R.PM_APPLY_RULE_ENGINE_FORMULA_WITH_ENTITLEMENTS,t)||s.status!==te.LOCKED||!i,b=s.status!==te.LOCKED||!i,C=f||s.status!==te.LOCKED||s?.backgroundActionStatus===bs.XLSX_EXPORTING||s?.backgroundActionStatus===bs.RULE_ENGINE_RUN||!i;return e.jsx(P,{m:5,children:e.jsxs(Fs,{children:[e.jsxs(P,{mt:4,children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Entitlement")})}),e.jsx(Wv,{children:a("Select Entitlement Formula")}),e.jsxs(p,{container:!0,alignItems:"center",children:[e.jsx(p,{size:{xs:10},children:e.jsxs(tt,{size:"small",variant:"outlined",fullWidth:!0,children:[e.jsx(P,{mb:1,children:e.jsx(Rt,{children:a("Entitlement Formula")})}),e.jsx(at,{size:"small",disabled:y,MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},value:d,"data-cy":"input-entitlement-formula",onChange:v=>c(v.target.value),children:m?.results?.map((v,S)=>{const I=!!v?.description;return e.jsx(de,{"data-cy":`select-option-${S}`,value:v.id,children:I?e.jsx(Ms,{title:v.description,placement:"right",arrow:!0,children:e.jsx(P,{component:"span",sx:{display:"block",width:"100%"},children:v.name})}):v.name},v.id)})})]})}),e.jsx(p,{children:e.jsx(P,{ml:2,children:e.jsx(H,{variant:"contained",color:"primary",disabled:h||!d||s.status!==te.LOCKED||s.backgroundActionStatus===bs.RULE_ENGINE_RUN||!i,"data-cy":"button-apply-steficon",onClick:async()=>{try{await u({programSlug:l,businessAreaSlug:r,id:s.id,requestBody:{engineFormulaRuleId:d,version:s.version}}),n(a("Formula is executing, please wait until completed"))}catch(v){fe(v,n)}},children:a("Apply")})})})]}),e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsx(Id,{}),e.jsx(Yv,{children:"Or"}),e.jsx(Id,{})]})]}),e.jsxs(P,{display:"flex",children:[e.jsx(P,{width:"50%",children:e.jsxs(Jv,{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",children:[s.hasPaymentListExportFile?e.jsx(H,{color:"primary",startIcon:e.jsx(Qv,{}),component:"a",download:!0,"data-cy":"button-download-template",href:`/api/download-payment-plan-payment-list/${s.id}`,disabled:b,children:a("DOWNLOAD TEMPLATE")}):e.jsx(ke,{loading:f,disabled:C,color:"primary",startIcon:e.jsx(Ca,{}),"data-cy":"button-export-xlsx",onClick:()=>x({businessAreaSlug:r,programSlug:l,id:s.id}),children:a("Export Xlsx")}),e.jsx(oi,{children:a("Template contains payment list with all targeted households")})]})}),e.jsx(P,{width:"50%",children:e.jsxs(P,{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",children:[e.jsx(P,{children:e.jsx(Hv,{permissions:t,paymentPlan:s})}),s?.importedFileName?e.jsxs(P,{alignItems:"center",display:"flex",children:[e.jsx(Xv,{children:e.jsx(Sc,{fontSize:"inherit"})}),e.jsx(P,{mr:1,children:e.jsx(oi,{"data-cy":"imported-file-name",children:s?.importedFileName})}),e.jsx(oi,{children:s?.importedFileName?e.jsx(pe,{children:s?.importedFileDate}):null})]}):e.jsx(oi,{children:a("Uploaded file should contain entitlement for each household")})]})})]}),s.totalEntitledQuantityUsd?e.jsxs(e.Fragment,{children:[e.jsx(Kv,{}),e.jsx(L,{label:a("Total Entitled Quantity"),children:e.jsx(ba,{"data-cy":"total-entitled-quantity-usd",children:`${Qe(s.totalEntitledQuantity)} ${s.currency} (${Qe(s.totalEntitledQuantityUsd)} USD)`})})]}):null]})})}const Zv=T(P)`
  width: 100%;
  height: 30px;
  background-color: #f4f5f6;
  color: '#404040';
`,eS=T.div`
  text-decoration: ${({isDeleted:s})=>s?"line-through":"none"};
`;function sS({id:s,onDelete:t,onUndo:a,isDeleted:n,isEdit:i}){const{t:r}=M();return e.jsxs(Zv,{display:"flex",alignItems:"center",justifyContent:"space-between",pl:8,pr:8,pt:4,pb:4,mt:2,children:[e.jsx(eS,{isDeleted:n,children:s}),i&&(n?e.jsx(H,{variant:"text",color:"primary",onClick:a,children:r("Undo")}):e.jsx(Ve,{onClick:t,children:e.jsx(Rs,{})}))]})}function nh({initialOpen:s=!1,paymentPlan:t}){const{status:a,backgroundActionStatus:n,exclusionReason:i,excludeHouseholdError:r}=t,l=t?.excludedHouseholds?.map(Te=>Te.unicefId),[o,d]=A.useState(s),[c,u]=A.useState(""),[h,m]=A.useState(l||[]),[g,x]=A.useState([]),{t:f}=M(),j=ve(),{isActiveProgram:y}=Z(),b=K(R.PM_EXCLUDE_BENEFICIARIES_FROM_FOLLOW_UP_PP,j),C=a===te.LOCKED||a===te.OPEN,v=()=>C?b?"":f("Permission denied"):f("Beneficiaries can only be excluded from a Payment Plan in status open or locked"),{showMessage:S}=Ae(),[I,E]=A.useState([]),[D,F]=A.useState(!1),w=Fe(),{businessArea:O,programId:k}=U(),{mutateAsync:$,error:G}=xe({mutationFn:Te=>N.restBusinessAreasProgramsPaymentPlansExcludeBeneficiariesCreate({businessAreaSlug:O,programSlug:k,id:t.id,requestBody:Te}),onSuccess:()=>{w.invalidateQueries({queryKey:["paymentPlan",O,t.id,k]})}}),W=Te=>{Te.target.value===""&&E([]),u(Te.target.value)},Y={exclusionReason:t.exclusionReason||""},X=Q.object().shape({exclusionReason:Q.string().max(500,f("Too long"))}),J=async Te=>{const ie=h.filter(Pe=>!g.includes(Pe));try{await $({excludedHouseholdsIds:ie,exclusionReason:Te.exclusionReason||void 0}),G||(S(f("Beneficiaries exclusion started")),d(!1))}catch(Pe){fe(Pe,S)}},ae=()=>{const Te=/^(\s*IND-\d{2}-\d{4}\.\d{4}\s*)(,\s*IND-\d{2}-\d{4}\.\d{4}\s*)*$/,ie=c.trim().split(/,\s*|\s+/),Pe=[],ue=[],Ge=[];for(const qe of ie)Te.test(qe)?h.includes(qe.trim())?ue.push(qe):Ge.push(qe):Pe.push(qe);const ls=[];Pe.length>0&&ls.push(` Invalid IDs: ${Pe.join(", ")}`),ue.length>0&&ls.push(` IDs already excluded: ${ue.join(", ")}`),ls.length>0?E(ls):(E([]),m([...h,...Ge]),u(""))},re=Te=>{g.includes(Te)||x([...g,Te])},se=Te=>{g.includes(Te)&&x(g.filter(ie=>ie!==Te))},le=Te=>g.includes(Te),ce=h.length-g.length,_e=(Te,ie,Pe)=>{const ue=ce===0,Ge=o&&D,ls=!o&&ce>0||!o&&g.length>0,qe=()=>{d(!1),E([]),u(""),Pe(),F(!1)},xs=()=>{Te()},Oe=!b||!C||h.length===0||!!n,es=!b||!C;return Ge?e.jsxs(P,{display:"flex",alignItems:"center",justifyContent:"center",children:[e.jsx(P,{mr:2,children:e.jsx(H,{variant:"text",color:"primary","data-cy":"button-cancel-exclusions",onClick:qe,children:f("Cancel")})}),e.jsx(Vs,{title:v(),variant:"contained",color:"primary",disabled:Oe,onClick:xs,"data-cy":"button-save-exclusions",children:f("Save")})]}):ls?e.jsx(H,{variant:"contained",color:"primary",onClick:()=>{d(!0),F(!1)},"data-cy":"button-preview-exclusions",children:f("Preview Exclusion")}):o?e.jsxs(P,{display:"flex",alignItems:"center",justifyContent:"center",children:[e.jsx(P,{mr:2,children:e.jsx(H,{variant:"text",color:"primary",onClick:qe,children:f("Close")})}),b&&e.jsx(Vs,{color:"primary",title:v(),disabled:es,variant:"contained",onClick:()=>F(!0),dataCy:"button-edit-exclusions",dataPerm:R.PM_EXCLUDE_BENEFICIARIES_FROM_FOLLOW_UP_PP,children:f("Edit")})]}):ue&&!g.length?e.jsx(H,{variant:"contained",color:"primary","data-cy":"button-create-exclusions",onClick:()=>{d(!0),F(!0)},disabled:!y,children:f("Create")}):null},ne=()=>{const Te=!b||!C||!!n;return D||ce===0?e.jsx(P,{mt:2,display:"flex",alignItems:"center",children:e.jsxs(p,{container:!0,alignItems:"flex-start",spacing:3,children:[e.jsx(p,{size:12,children:e.jsx(B.Field,{name:"exclusionReason",fullWidth:!0,multiline:!0,variant:"outlined",label:f("Reason"),component:Se})}),e.jsx(p,{size:6,children:e.jsx(P,{mr:2,children:e.jsx(Wu,{label:f("Beneficiaries Ids"),"data-cy":"input-beneficiaries-ids",value:c,onChange:W,fullWidth:!0,error:I.length>0})})}),e.jsx(p,{children:e.jsx(Vs,{title:v(),variant:"contained",color:"primary",disabled:!c||Te,dataCy:"button-apply-exclusions",onClick:()=>{ae()},children:f("Apply")})})]})}):null},Ue=Te=>Te.replace(/\[|\]|'|"/g,"").split(", ");return e.jsx(B.Formik,{initialValues:Y,validationSchema:X,onSubmit:Te=>J(Te),enableReinitialize:!0,children:({submitForm:Te,values:ie,resetForm:Pe})=>e.jsx(B.Form,{children:e.jsxs(ft,{children:[e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(ee,{variant:"h6",children:f("Exclude")}),_e(Te,ie,Pe)]}),!o&&ce>0?e.jsx(P,{mt:2,mb:2,children:e.jsx(it,{children:`${ce} ${ce===1?"Beneficiary":"Beneficiaries"} excluded`})}):null,e.jsx(yt,{in:o,children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[o&&i&&!D?e.jsx(p,{container:!0,children:e.jsx(p,{size:8,children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsxs(P,{display:"flex",alignItems:i.length>100?"flex-start":"center",mt:4,mb:2,children:[e.jsx(P,{mr:2,children:e.jsxs(it,{children:[f("Reason"),":"]})}),e.jsx(ee,{children:i})]}),r&&e.jsx(P,{display:"flex",flexDirection:"column",mt:2,children:Ue(r).map(ue=>e.jsx(Ls,{error:!0,children:ue},ue))})]})})}):null,ne(),e.jsx(p,{container:!0,children:I?.map(ue=>e.jsx(p,{size:12,children:e.jsx(Ls,{error:!0,children:ue},ue)},ue))}),e.jsx(p,{container:!0,direction:"column",children:h.map(ue=>e.jsx(p,{size:12,children:e.jsx(sS,{id:ue,onDelete:()=>re(ue),onUndo:()=>se(ue),isDeleted:le(ue),isEdit:D},ue)},ue))})]})})]})})})}const tS=()=>{const{paymentPlanId:s}=ts(),t=ve(),{baseUrl:a,businessArea:n,programId:i}=U(),{data:r,isLoading:l,error:o}=V({queryKey:["paymentPlan",n,s,i],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansRetrieve({businessAreaSlug:n,id:s,programSlug:i}),refetchInterval:h=>{const m=h.state.data,g=[bs.EXCLUDE_BENEFICIARIES_ERROR,bs.XLSX_EXPORT_ERROR,bs.XLSX_IMPORT_ERROR];return m?.status===te.PREPARING||m?.backgroundActionStatus!==null&&!g.includes(m?.backgroundActionStatus)?3e3:!1},refetchIntervalInBackground:!0});if(l&&!r)return e.jsx(Ne,{});if(t===null||!r)return null;if(!K(R.PM_VIEW_DETAILS,t)||rt(o))return e.jsx(Xe,{permission:R.PM_VIEW_DETAILS});const{status:d}=r,c=d!==te.OPEN,u=d===te.ACCEPTED||d===te.FINISHED;return e.jsxs(e.Fragment,{children:[e.jsx(Hu,{paymentPlan:r,baseUrl:a,permissions:t}),e.jsx(qu,{baseUrl:a,paymentPlan:r}),e.jsx(nr,{paymentPlan:r}),c&&e.jsx(ah,{paymentPlan:r,permissions:t}),e.jsx(nh,{paymentPlan:r}),e.jsx(ar,{paymentPlan:r}),e.jsx(no,{paymentPlan:r}),e.jsx(io,{businessArea:n,paymentPlan:r,permissions:t,canViewDetails:!0}),u&&e.jsx(tr,{paymentPlan:r}),K(R.ACTIVITY_LOG_VIEW,t)&&e.jsx(Lt,{objectId:r.id})]})},aS=oe(tS,"PeopleFollowUpPaymentPlanDetailsPage");function nS({payment:s,canViewActivityLog:t}){const{baseUrl:a,businessArea:n,programId:i}=U(),{t:r}=M();let l=null;s.verification&&s.verification.status!=="PENDING"&&(l=s.verification);const o=["NOT_DISTRIBUTED","FORCE_FAILED","TRANSACTION_ERRONEOUS"].includes(s.status),d=s?.snapshotCollectorAccountData??{};return e.jsxs(e.Fragment,{children:[e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:r("Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("STATUS"),children:e.jsx(we,{status:s.status,statusToColor:Na,statusNameMapping:Ya})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("ENTITLEMENT QUANTITY"),value:s.entitlementQuantity!=null?Qe(s.entitlementQuantity):s.entitlementQuantity})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("DELIVERED QUANTITY"),value:s.deliveredQuantity!=null?Qe(s.deliveredQuantity):s.deliveredQuantity})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("CURRENCY"),value:s.currency})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("DELIVERY DATE"),value:e.jsx(pe,{children:s.deliveryDate})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("TARGET POPULATION"),children:e.jsx(me,{to:`/${n}/programs/${i}/target-population/${s.parent.id}`,children:s.parent?.name})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Distribution Modality"),value:s.parent?.deliveryMechanism?.name})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Original Payment Plan ID"),children:s.parent&&e.jsx(me,{to:`/${a}/payment-module/${s.parent.isFollowUp?"followup-payment-plans":"payment-plans"}/${s.parent.id}`,children:s.parent.unicefId})})})]})]}),l!=null?e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:r("Verification Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("STATUS"),children:e.jsx(we,{status:l.status,statusToColor:$n})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("AMOUNT RECEIVED"),value:Ps(l.receivedAmount,s.currency)})})]})]}):null,e.jsxs(ra,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:r("Entitlement Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("DELIVERY MECHANISM"),value:s.deliveryMechanism?.name})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("FSP"),value:s.fspName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("TRANSACTION REFERENCE ID"),value:s.transactionReferenceId})})]}),e.jsx(St,{}),e.jsx(p,{container:!0,spacing:3,children:Object.entries(d).map(([c,u])=>e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r(`Account ${c}`),value:Al(u)})},c))})]}),e.jsxs(ra,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:r("Reconciliation Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Collector's Name"),value:s.additionalCollectorName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Document Type"),value:s.additionalDocumentType})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Document Number"),value:s.additionalDocumentNumber})})]}),e.jsx(St,{}),e.jsx(p,{container:!0,spacing:3,children:o&&e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Failure Reason"),value:s.reasonForUnsuccessfulPayment})})})]}),t&&e.jsx(Lt,{objectId:s.id})]})}const iS=()=>{const{t:s}=M(),{paymentId:t}=ts(),n=je().state?.parentId,{businessArea:i,programId:r}=U(),{data:l,isLoading:o}=V({queryKey:["payment",i,t,r,n],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansPaymentsRetrieve({businessAreaSlug:i,paymentId:t,programSlug:r,paymentPlanPk:n})}),d=l?.parent?.status,c=l?.parent?.isFollowUp,u=ve(),{baseUrl:h}=U();if(o)return e.jsx(Ne,{});if(u===null)return null;if(!K(R.PM_VIEW_DETAILS,u))return e.jsx(Xe,{permission:R.PM_VIEW_DETAILS});if(!l)return null;const m=[{title:s("Payment Module"),to:`/${h}/payment-module/payment-plans`},{title:` ${c?"Follow-up ":""} Payment Plan ${l.parent.unicefId}`,to:`/${h}/payment-module/${c?"followup-payment-plans":"payment-plans"}/${l.parent.id}/`}],g=()=>{if(K(R.PM_MARK_PAYMENT_AS_FAILED,u)&&d===te.ACCEPTED||d===te.FINISHED){const f=l.status===Li.FORCE_FAILED?eh:Zu;return e.jsx(f,{paymentId:l.id})}return null},x=K(R.POPULATION_VIEW_HOUSEHOLDS_DETAILS,u);return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`Payment ${l.unicefId}`,breadCrumbs:m,flags:e.jsx(gt,{adminUrl:l.adminUrl}),children:g()}),e.jsx(P,{display:"flex",flexDirection:"column",children:e.jsx(nS,{payment:l,canViewActivityLog:K(R.ACTIVITY_LOG_VIEW,u),canViewHouseholdDetails:x})})]})},rS=oe(iS,"PeoplePaymentDetailsPage"),lS=({plan:s,canViewDetails:t})=>{const a=ge(),{baseUrl:n}=U(),i=`/${n}/payment-module/${s.isFollowUp?"followup-payment-plans":"payment-plans"}/${s.id}`,r=()=>{a(i)},l=()=>s.followUps?.length?e.jsx(P,{display:"flex",flexDirection:"column",children:s.followUps?.map(o=>{const d=`/${n}/payment-module/followup-payment-plans/${o?.id}`;return e.jsx(P,{mb:1,children:e.jsx(me,{to:d,children:o?.unicefId},o?.id)},o?.id)})}):e.jsx(e.Fragment,{children:"-"});return e.jsxs(rs,{hover:!0,onClick:t?r:void 0,role:"checkbox",children:[e.jsxs(_,{align:"left",children:[s.isFollowUp?"Follow-up: ":"",t?e.jsx(me,{to:i,children:s.unicefId}):s.unicefId]}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Vt})}),e.jsx(_,{align:"left",children:s.name}),e.jsx(_,{align:"left",children:s.totalIndividualsCount||"-"}),e.jsx(_,{align:"left",children:s.currencyName}),e.jsx(_,{align:"right",children:`${Ps(s.totalEntitledQuantity,s.currency)}`}),e.jsx(_,{align:"right",children:`${Ps(s.totalDeliveredQuantity,s.currency)}`}),e.jsx(_,{align:"right",children:`${Ps(s.totalUndeliveredQuantity,s.currency)}`}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.dispersionStartDate})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.dispersionEndDate})}),e.jsx(_,{align:"left",children:l()})]},s.id)},oS=[{disablePadding:!1,label:"Payment Plan ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Target Population",id:"targetPopulation",numeric:!1},{disablePadding:!1,label:"Num. of People",id:"totalIndividualsCount",numeric:!1},{disablePadding:!1,label:"Currency",id:"currency",numeric:!1},{disablePadding:!1,label:"Total Entitled Quantity",id:"totalEntitledQuantity",numeric:!0},{disablePadding:!1,label:"Total Delivered Quantity",id:"totalDeliveredQuantity",numeric:!0},{disablePadding:!1,label:"Total Undelivered Quantity",id:"totalUndeliveredQuantity",numeric:!0},{disablePadding:!1,label:"Dispersion Start Date",id:"dispersionStartDate",numeric:!1},{disablePadding:!1,label:"Dispersion End Date",id:"dispersionEndDate",numeric:!1},{disablePadding:!1,label:"Follow-up Payment Plans",id:"followup-id",numeric:!1}],ih=({filter:s,canViewDetails:t})=>{const{t:a}=M(),{programId:n,businessArea:i}=U(),r=A.useMemo(()=>({businessAreaSlug:i,programSlug:n,search:s.search,status:s.status,totalEntitledQuantityFrom:s.totalEntitledQuantityFrom||null,totalEntitledQuantityTo:s.totalEntitledQuantityTo||null,dispersionStartDate:s.dispersionStartDate||null,dispersionEndDate:s.dispersionEndDate||null,isFollowUp:s.isFollowUp?!0:null,isPaymentPlan:!0}),[i,n,s.search,s.status,s.totalEntitledQuantityFrom,s.totalEntitledQuantityTo,s.dispersionStartDate,s.dispersionEndDate,s.isFollowUp]),[l,o]=A.useState(r);A.useEffect(()=>{o(r)},[r]);const[d,c]=A.useState(0),{data:u,isLoading:h,error:m}=V({queryKey:["businessAreasProgramsPaymentPlansList",l,i,n],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansList(Ce({businessAreaSlug:i,programSlug:n},l,{withPagination:!0}))}),{data:g}=V({queryKey:["businessAreasProgramsPaymentPlansCountRetrieve",l,n,i],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansCountRetrieve(Ce({businessAreaSlug:i,programSlug:n},l)),enabled:!!i&&!!n&&d===0}),x=vs(d,g);return e.jsx(ds,{defaultOrderBy:"-createdAt",title:a("Payment Plans"),headCells:oS,data:u,isLoading:h,error:m,queryVariables:l,setQueryVariables:o,itemsCount:x,page:d,setPage:c,renderRow:f=>e.jsx(lS,{plan:f,canViewDetails:t},f.id)})};oe(ih,"PeoplePaymentPlansTable");const dS=({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})=>{const{t:r}=M(),l=ge(),o=je(),{handleFilterChange:d,applyFilterChanges:c,clearFilter:u}=Ss(a,l,o,s,t,n,i),h=()=>{c()},m=()=>{u()},{data:g}=V({queryKey:["choicesPaymentPlanStatusList"],queryFn:()=>N.restChoicesPaymentPlanStatusList()});return g?e.jsx(Ns,{clearHandler:m,applyHandler:h,children:e.jsxs(p,{container:!0,spacing:3,alignItems:"flex-end",children:[e.jsx(p,{size:3,children:e.jsx(Cs,{label:r("Search"),value:s.search,fullWidth:!0,onChange:x=>d("search",x.target.value)})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:x=>d("status",x.target.value),variant:"outlined",label:r("Status"),multiple:!0,value:s.status,fullWidth:!0,children:g?.map(x=>e.jsx(de,{value:x.value,children:x.name},x.value))})}),e.jsx(p,{size:3,children:e.jsx(js,{id:"totalEntitledQuantityFromFilter",topLabel:r("Entitled Quantity"),value:s.totalEntitledQuantityFrom,placeholder:r("From"),onChange:x=>d("totalEntitledQuantityFrom",x.target.value),"data-cy":"filters-total-entitled-quantity-from"})}),e.jsx(p,{size:3,children:e.jsx(js,{id:"totalEntitledQuantityToFilter",value:s.totalEntitledQuantityTo,placeholder:r("To"),onChange:x=>d("totalEntitledQuantityTo",x.target.value),error:!!(s.totalEntitledQuantityFrom&&s.totalEntitledQuantityTo&&s.totalEntitledQuantityFrom>s.totalEntitledQuantityTo),"data-cy":"filters-total-entitled-quantity-to"})}),e.jsx(p,{size:3,children:e.jsx(ms,{topLabel:r("Dispersion Date"),placeholder:r("From"),onChange:x=>{s.dispersionEndDate&&fs(x).isAfter(s.dispersionEndDate)?(d("dispersionStartDate",x?fs(x).format("YYYY-MM-DD"):""),d("dispersionEndDate","")):d("dispersionStartDate",x?fs(x).format("YYYY-MM-DD"):"")},value:s.dispersionStartDate})}),e.jsx(p,{size:3,children:e.jsx(ms,{placeholder:r("To"),onChange:x=>d("dispersionEndDate",x?fs(x).format("YYYY-MM-DD"):""),value:s.dispersionEndDate,minDate:s.dispersionStartDate,minDateMessage:e.jsx("span",{})})}),"isFollowUp",e.jsx(p,{size:12,children:e.jsx(P,{ml:2,children:e.jsx(sa,{control:e.jsx(ns,{checked:!!s.isFollowUp,value:s.isFollowUp,color:"primary",onChange:x=>{x.target.checked?d("isFollowUp",!0):d("isFollowUp",!1)}}),label:r("Show only Follow-up plans")})})})]})}):null},Ir={search:"",dispersionStartDate:"",dispersionEndDate:"",status:[],totalEntitledQuantityFrom:"",totalEntitledQuantityTo:"",isFollowUp:""},cS=()=>{const{t:s}=M(),t=ve(),a=je(),[n,i]=A.useState(Ke(a,Ir)),[r,l]=A.useState(Ke(a,Ir)),[o,d]=A.useState(!1),c=A.useRef(null);return et(c,o,r,()=>d(!1)),t===null?null:K(R.PM_VIEW_LIST,t)?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:s("Payment Module")}),e.jsx(dS,{filter:n,setFilter:i,initialFilter:Ir,appliedFilter:r,setAppliedFilter:u=>{l(u),d(!0)}}),e.jsx("div",{ref:c,children:e.jsx(Es,{children:e.jsx(ih,{filter:r,canViewDetails:K(R.PM_VIEW_DETAILS,t)})})})]}):e.jsx(Xe,{permission:R.PM_VIEW_LIST})},uS=oe(cS,"PeoplePaymentModulePage");function hS({baseUrl:s,permissions:t,paymentPlan:a}){const{t:n}=M(),i=[{title:n("Payment Module"),to:`/${s}/payment-module/payment-plans`}],r=K(R.PM_CREATE,t),l=K(R.PM_CREATE,t),o=K(R.PM_LOCK_AND_UNLOCK,t),d=K(R.PM_LOCK_AND_UNLOCK,t),c=K(R.PM_SEND_FOR_APPROVAL,t),u=K(R.PM_ACCEPTANCE_PROCESS_APPROVE,t),h=K(R.PM_ACCEPTANCE_PROCESS_AUTHORIZE,t),m=K(R.PM_ACCEPTANCE_PROCESS_FINANCIAL_REVIEW,t),g=K(R.PM_SEND_TO_PAYMENT_GATEWAY,t)&&a.canSendToPaymentGateway,x=K(R.PM_SPLIT,t)&&a.canSplit,f=K(R.PM_CLOSE_FINISHED,t),j=K(R.PM_ABORT,t),y=K(R.PM_REACTIVATE_ABORT,t);let b=null;switch(a.status){case te.OPEN:b=e.jsx(to,{paymentPlan:a,canRemove:r,canEdit:l,canLock:o});break;case te.LOCKED:b=e.jsx(so,{paymentPlan:a,canUnlock:o,permissions:t,canAbort:j});break;case te.LOCKED_FSP:b=e.jsx(eo,{paymentPlan:a,canUnlock:d,canSendForApproval:c,canAbort:j});break;case te.IN_APPROVAL:b=e.jsx(Xl,{paymentPlan:a,canReject:K(R.PM_ACCEPTANCE_PROCESS_APPROVE,t),canApprove:u,canAbort:j});break;case te.IN_AUTHORIZATION:b=e.jsx(Jl,{paymentPlan:a,canReject:K(R.PM_ACCEPTANCE_PROCESS_AUTHORIZE,t),canAuthorize:h,canAbort:j});break;case te.IN_REVIEW:b=e.jsx(Zl,{paymentPlan:a,canReject:K(R.PM_ACCEPTANCE_PROCESS_FINANCIAL_REVIEW,t),canMarkAsReleased:m,canAbort:j});break;case te.FINISHED:case te.ACCEPTED:b=e.jsx(Yl,{canSendToPaymentGateway:g,canSplit:x,paymentPlan:a,canClose:f});break;case te.ABORTED:b=e.jsx(th,{paymentPlan:a,canReactivate:y});break}return e.jsx(Ze,{title:e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsxs(P,{children:[" ",n("Payment Plan")," ID: "]}),e.jsx(P,{children:e.jsx("span",{"data-cy":"pp-unicef-id",children:a.unicefId})})]}),e.jsx(P,{ml:2,children:e.jsx(we,{status:a.status,statusToColor:Vt})}),a.backgroundActionStatus&&e.jsx(P,{children:e.jsx(we,{status:a.backgroundActionStatus,statusToColor:wi})})]}),breadCrumbs:K(R.PM_VIEW_DETAILS,t)?i:null,flags:e.jsx(gt,{adminUrl:a.adminUrl}),children:b})}function mS({followUps:s,baseUrl:t}){const{t:a}=M(),[n,i]=A.useState(!1),r=()=>{i(!n)};let l=null;return s?.length>0&&(l=(n?s:s.slice(0,5)).map(d=>e.jsxs(me,{to:`/${t}/payment-module/followup-payment-plans/${d?.id}`,children:[d?.unicefId,e.jsx("br",{})]},d?.id))),e.jsx(L,{label:a("Related Follow-Up Payment Plans"),children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[l||"-",s?.length>5&&e.jsx(H,{variant:"outlined",color:"primary",onClick:r,children:a(n?"Hide":"See all")})]})})}const pS=({baseUrl:s,paymentPlan:t})=>{const{t:a}=M(),{id:n,name:i,createdBy:r,program:l,currency:o,startDate:d,endDate:c,dispersionStartDate:u,dispersionEndDate:h,followUps:m,exchangeRate:g}=t;return e.jsx(p,{size:{xs:12},children:e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Details")})}),e.jsx(vt,{children:e.jsxs(p,{container:!0,children:[e.jsxs(p,{container:!0,size:{xs:9},spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Created By"),children:r})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Programme"),children:e.jsx(me,{to:`/${s}/details/${l.slug}`,children:l.name})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Target Population"),children:e.jsx(me,{to:`/${s}/target-population/${n}`,children:i})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Currency"),children:o})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Start Date"),children:e.jsx(pe,{children:d})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("End Date"),children:e.jsx(pe,{children:c})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Dispersion Start Date"),children:e.jsx(pe,{children:u})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Dispersion End Date"),children:e.jsx(pe,{children:h})})}),e.jsxs(p,{size:{xs:3},children:[e.jsx(P,{mr:1,children:e.jsx(L,{label:a("FX Rate Applied"),children:g})}),e.jsx(Ms,{title:a("If displayed exchange rate differs from Vision, please contact your designated focal point for resolution"),children:e.jsx(Ve,{color:"primary","aria-label":"exchange-rate","data-cy":"info-exchange-rate",children:e.jsx(dn,{})})})]}),e.jsx(p,{size:{xs:3},children:e.jsx(P,{mr:1,children:e.jsx(L,{label:a("FSP"),children:t.financialServiceProvider.name})})}),e.jsx(p,{size:{xs:3},children:e.jsx(P,{mr:1,children:e.jsx(L,{label:a("Delivery Mechanism"),children:t.deliveryMechanism.name})})})]}),e.jsx(p,{container:!0,direction:"column",size:{xs:3},spacing:6,children:e.jsx(p,{size:{xs:12},children:e.jsx(Ws,{color:"#84A1CA",children:e.jsx(mS,{followUps:m,baseUrl:s})})})})]})})]})})},ya={femaleChildren:"#5F02CF",maleChildren:"#1D6A64",femaleAdult:"#DFCCF5",maleAdult:"#B1E3E0"},gS=T.div`
  padding-bottom: ${({theme:s})=>s.spacing(2)};
`,xS=T.div`
  display: flex;
`,fS=T.div`
  padding: ${({theme:s})=>s.spacing(4)};
  border-color: #b1b1b5;
  border-left-width: 1px;
  border-left-style: solid;
`,yS=T.div`
  font-family: ${({theme:s})=>s.hctTypography.fontFamily};
  color: #253b46;
  font-size: 36px;
  line-height: 32px;
  margin-top: ${({theme:s})=>s.spacing(2)};
`,bS=T.div`
  width: 100px;
  height: 100px;
  margin: 0 auto;
`,jS=({paymentPlan:s})=>{const{t}=M(),{femaleChildrenCount:a,maleChildrenCount:n,femaleAdultsCount:i,maleAdultsCount:r,totalIndividualsCount:l}=s;return e.jsxs(ft,{children:[e.jsx(gS,{children:e.jsx(ee,{variant:"h6",children:t("Results")})}),e.jsx(xS,{children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:4},children:e.jsxs(p,{container:!0,spacing:3,justifyContent:"flex-start",children:[e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:ya.femaleChildren,children:e.jsx(L,{label:t("Female Children"),value:a})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:ya.femaleAdult,children:e.jsx(L,{label:t("Female Adults"),value:i})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:ya.maleChildren,children:e.jsx(L,{label:t("Male Children"),value:n})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:ya.maleAdult,children:e.jsx(L,{label:t("Male Adults"),value:r})})})]})}),e.jsx(p,{size:{xs:4},children:e.jsx(p,{container:!0,spacing:0,justifyContent:"flex-start",alignItems:"center",children:e.jsx(p,{size:{xs:4},children:e.jsx(bS,{"data-cy":"chart-container",children:e.jsx(gl,{width:100,height:100,options:{plugins:{legend:{display:!1}},responsive:!0,maintainAspectRatio:!1},data:{labels:[t("Female Children"),t("Female Adults"),t("Male Children"),t("Male Adults")],datasets:[{data:[a,i,n,r],backgroundColor:[ya.femaleChildren,ya.femaleAdult,ya.maleChildren,ya.maleAdult]}]}})})})})}),e.jsx(p,{size:{xs:4},children:e.jsx(p,{container:!0,spacing:0,justifyContent:"flex-end",children:e.jsx(p,{size:{xs:6},children:e.jsx(fS,{children:e.jsx(L,{label:t("Total Number of People"),children:e.jsx(yS,{children:l||"0"})})})})})})]})})]})},AS=[{disablePadding:!1,label:"",id:"flag",numeric:!1},{disablePadding:!1,label:"Payment ID",id:"unicef_id",numeric:!1},{disablePadding:!1,label:"Individual ID",id:"individual__unicef_id",numeric:!1,disableSort:!0},{disablePadding:!1,label:"Individual Name",id:"individual__full_name",numeric:!1,disableSort:!0},{disablePadding:!1,label:"Administrative Level 2",id:"household__admin2__name",numeric:!1},{disablePadding:!1,label:"FSP",id:"financial_service_provider__name",numeric:!1},{disablePadding:!1,label:"Entitlement",id:"entitlement_quantity_usd",numeric:!1},{disablePadding:!1,label:"Delivered Quantity",id:"delivered_quantity",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1,disableSort:!0},{disablePadding:!1,label:"FSP Auth Code",id:"fsp_auth_code",numeric:!1,requiredPermission:R.PM_VIEW_FSP_AUTH_CODE},{disablePadding:!1,label:"Reconciliation",id:"mark",numeric:!1}];T.div`
  color: #000;
  text-decoration: underline;
  cursor: pointer;
  display: flex;
  align-content: center;
`;const _S=T.div`
  color: ${({theme:s})=>s.hctPalette.red};
  background-color: ${({theme:s})=>`${s.hctPalette.red}${wc(.15)}`};
  border-radius: 16px;
  font-family: Roboto;
  font-size: 10px;
  font-weight: 500;
  letter-spacing: 1.2px;
  line-height: 16px;
  padding: ${({theme:s})=>s.spacing(1)};
  text-align: center;
  margin-right: 20px;
`,PS=T(Ni)`
  color: ${({theme:s})=>s.hctPalette.orange};
`,CS=T(Ni)`
  color: ${({theme:s})=>s.hctPalette.red};
`,ES=T(vc)`
  color: ${({theme:s})=>s.hctPalette.green};
`,vS=({payment:s,canViewDetails:t,onWarningClick:a,permissions:n})=>{const{t:i}=M(),{baseUrl:r}=U(),l=`/${r}/payment-module/payments/${s.id}`,o=m=>{m.stopPropagation(),a(s)},d=()=>{const{deliveredQuantity:m,currency:g,deliveredQuantityUsd:x,status:f}=s;return f===Li.TRANSACTION_ERRONEOUS?e.jsx(_S,{children:"UNSUCCESSFUL"}):m===null?e.jsx(e.Fragment,{}):e.jsx(e.Fragment,{children:`${Ps(m,g)}
        (${Ps(x,"USD")})`})},c=()=>{const{deliveredQuantity:m,entitlementQuantity:g}=s;return m===null?e.jsx(e.Fragment,{}):Number(m)===0?e.jsx(CS,{}):m===g?e.jsx(ES,{}):e.jsx(PS,{})},u=s?.peopleIndividual,h=`/${r}/population/people/${u?.id}`;return e.jsxs(rs,{hover:!0,role:"checkbox",children:[e.jsx(_,{align:"left",children:(s.paymentPlanHardConflicted||s.paymentPlanSoftConflicted)&&e.jsx(Sa,{handleClick:m=>o(m),message:i("This individual is also included in other Payment Plans. Click this icon to view details."),confirmed:s.paymentPlanHardConflicted})}),e.jsx(_,{align:"left",children:t?e.jsx(me,{to:l,state:{parentId:s.parentId},children:s.unicefId}):s.unicefId}),e.jsx(_,{align:"left",children:t?e.jsx(me,{to:h,children:u?.unicefId}):u?.unicefId}),e.jsx(_,{align:"left",children:t?e.jsx(me,{to:h,children:u?.fullName}):u?.fullName}),e.jsx(_,{align:"left",children:Aa(s.householdAdmin2)}),e.jsx(_,{align:"left",children:s.fspName?s.fspName:"-"}),e.jsx(_,{align:"left",children:s.entitlementQuantity!=null&&Number(s.entitlementQuantity)>=0?`${Ps(s.entitlementQuantity,s.currency)} (${Ps(s.entitlementQuantityUsd,"USD")})`:"-"}),e.jsx(_,{"data-cy":"delivered-quantity-cell",align:"left",children:d()}),e.jsx(_,{children:e.jsx(we,{status:s.status,statusToColor:Na,statusNameMapping:Ya})}),K(R.PM_VIEW_FSP_AUTH_CODE,n)&&e.jsx(_,{"data-cy":"fsp-auth-code-cell",align:"left",children:s.fspAuthCode||"-"}),e.jsx(_,{children:c()})]},s.id)},SS=T(gs)`
  min-width: 100px;
`,Dd=T.div`
  font-weight: bold;
  padding: 0 5px;
`,IS=T(P)`
  background-color: #f3f3f3;
`;function DS({paymentPlan:s,payment:t,setDialogOpen:a,baseUrl:n,canViewDetails:i=!1}){const{t:r}=M(),{selectedProgram:l}=Z(),o=l?.beneficiaryGroup;if(!t)return null;const d=()=>{const{paymentPlanSoftConflicted:c,paymentPlanHardConflicted:u,paymentPlanHardConflictedData:h,paymentPlanSoftConflictedData:m}=t,g=x=>e.jsxs(rs,{hover:!0,children:[e.jsx(_,{align:"left",children:i?e.jsx(me,{to:`/${n}/payment-module/payment-plans/${x.paymentPlanId}`,children:x.paymentPlanUnicefId}):x.paymentPlanUnicefId}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:x.paymentPlanStartDate})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:x.paymentPlanEndDate})}),e.jsx(_,{align:"left",children:e.jsx(we,{status:x.paymentPlanStatus,statusToColor:Vt})}),e.jsx(_,{align:"left",children:x.paymentUnicefId})]});return u?h.map(x=>g(x)):c?m.map(x=>g(x)):[]};return e.jsxs(is,{open:!!t,onClose:()=>a(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:r("Warning")})}),e.jsxs(Be,{children:[e.jsxs(P,{mt:4,mb:2,display:"flex",children:[r("Payment Plan ID")," ",e.jsx(Dd,{children:s.unicefId})," ",r("details"),":"]}),e.jsx(IS,{p:3,children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:6,children:e.jsx(L,{label:r("Start Date"),children:e.jsx(pe,{children:s.startDate})})}),e.jsx(p,{size:6,children:e.jsx(L,{label:r("End Date"),children:e.jsx(pe,{children:s.endDate})})})]})}),e.jsxs(P,{mt:10,mb:10,display:"flex",children:[`${o?.groupLabel} ID`," ",e.jsx(Dd,{children:t.householdUnicefId})," ",r("is also included in the following Payment Plans"),":"]}),e.jsxs(SS,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left",children:r("Payment Plan ID")}),e.jsx(_,{align:"left",children:r("Start Date")}),e.jsx(_,{align:"left",children:r("End Date")}),e.jsx(_,{align:"left",children:r("Status")}),e.jsx(_,{align:"left",children:r("Payment ID")})]})}),e.jsx(cs,{children:d()})]})]}),e.jsx(ss,{children:e.jsx(os,{children:e.jsx(H,{onClick:c=>{c.stopPropagation(),a(!1)},children:r("CLOSE")})})})]})}const TS=T(P)`
  background-color: #fff;
`,RS=({businessArea:s,paymentPlan:t,permissions:a,canViewDetails:n=!1})=>{const{baseUrl:i,programId:r}=U(),{selectedProgram:l,isSocialDctType:o}=Z(),d=l?.beneficiaryGroup,{t:c}=M(),[u,h]=A.useState(null),m=je(),g={householdUnicefId:"",individualUnicefId:"",collectorFullName:"",paymentPk:""},[x,f]=A.useState(Ke(m,g)),[j,y]=A.useState(Ke(m,g)),[b,C]=A.useState(!1),v=A.useRef(null);et(v,b,j,()=>C(!1));const[S,I]=A.useState(0),E=A.useMemo(()=>({businessAreaSlug:s,programSlug:r,householdUnicefId:j.householdUnicefId||null,individualUnicefId:j.individualUnicefId||null,collectorFullName:j.collectorFullName||null,paymentUnicefId:j.paymentUnicefId||null}),[s,r,j.householdUnicefId,j.individualUnicefId,j.collectorFullName,j.paymentUnicefId]),[D,F]=A.useState(E);A.useEffect(()=>{F(E)},[E]);const{data:w,isLoading:O,error:k}=V({queryKey:["businessAreasProgramsPaymentPlansPaymentsList",D,s,r,t.id],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansPaymentsList(Ce({businessAreaSlug:s,programSlug:r,paymentPlanPk:t.id},{...D},{withPagination:!0}))}),{data:$}=V({queryKey:["businessAreasProgramsPaymentsCountRetrieve",s,r,t.id,D],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansPaymentsCountRetrieve(Ce({businessAreaSlug:s,programSlug:r,paymentPlanPk:t.id},D)),enabled:!!s&&!!t?.id&&S===0}),G=vs(S,$),Y=$s(AS,d,o?{individual__unicef_id:J=>`${J?.memberLabel} ${c("ID")}`,household__size:J=>`${J?.groupLabel} ${c("Size")}`}:{household__unicef_id:J=>`${J?.groupLabel} ${c("ID")}`,household__size:J=>`${J?.groupLabel} ${c("Size")}`}),X=J=>{y(J),C(!0),I(0)};return e.jsxs(e.Fragment,{children:[e.jsx(P,{p:4,children:e.jsx(Qu,{filter:x,setFilter:f,initialFilter:g,appliedFilter:j,setAppliedFilter:X})}),e.jsx("div",{ref:v,children:e.jsx(Es,{children:e.jsxs(us,{children:[e.jsxs(TS,{p:6,display:"flex",justifyContent:"space-between",children:[e.jsx(ee,{"data-cy":"table-title",variant:"h6",children:c("Payee List")}),(t.status===te.ACCEPTED||t.status===te.FINISHED)&&e.jsx(Yu,{paymentPlan:t,permissions:a})]}),e.jsx(ds,{isOnPaper:!1,headCells:Y,rowsPerPageOptions:[10,25,50],defaultOrderBy:"createdAt",defaultOrderDirection:"desc",isLoading:O,error:k,queryVariables:D,setQueryVariables:F,data:w,itemsCount:G,page:S,setPage:I,renderRow:J=>e.jsx(vS,{payment:J,canViewDetails:n,onWarningClick:ae=>{h(ae)},permissions:a},J.id)})]})})}),e.jsx(DS,{paymentPlan:t,payment:u,setDialogOpen:()=>h(null),canViewDetails:n,baseUrl:i})]})},FS=oe(RS,"PeoplePaymentsTable"),NS=()=>{const{paymentPlanId:s}=ts(),t=ve(),{baseUrl:a,businessArea:n,programId:i}=U(),{data:r,isLoading:l,error:o}=V({queryKey:["paymentPlan",n,s,i],queryFn:()=>N.restBusinessAreasProgramsPaymentPlansRetrieve({businessAreaSlug:n,id:s,programSlug:i}),refetchInterval:m=>{const g=m.state.data,x=[bs.EXCLUDE_BENEFICIARIES_ERROR,bs.XLSX_EXPORT_ERROR,bs.XLSX_IMPORT_ERROR];return g?.status===te.PREPARING||g?.backgroundActionStatus!==null&&!x.includes(g?.backgroundActionStatus)?3e3:!1},refetchIntervalInBackground:!0});if(l&&!r)return e.jsx(Ne,{});if(t===null||!r)return null;if(!K(R.PM_VIEW_DETAILS,t)||rt(o))return e.jsx(Xe,{permission:R.PM_VIEW_DETAILS});const{status:d}=r,c=d!==te.OPEN,u=d===te.ACCEPTED||d===te.FINISHED,h=d===te.IN_REVIEW||d===te.ACCEPTED||d===te.FINISHED;return r?e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(hS,{paymentPlan:r,baseUrl:a,permissions:t}),e.jsx(pS,{baseUrl:a,paymentPlan:r}),d!==te.PREPARING&&e.jsxs(e.Fragment,{children:[e.jsx(nr,{paymentPlan:r}),h&&e.jsx(ao,{paymentPlan:r}),c&&e.jsx(ah,{paymentPlan:r,permissions:t}),e.jsx(nh,{paymentPlan:r}),e.jsx(ar,{paymentPlan:r}),e.jsx(jS,{paymentPlan:r}),e.jsx(FS,{businessArea:n,paymentPlan:r,permissions:t,canViewDetails:!0}),u&&e.jsx(tr,{paymentPlan:r}),K(R.ACTIVITY_LOG_VIEW,t)&&e.jsx(Lt,{objectId:r.id})]})]}):null},Td=oe(NS,"PeoplePaymentPlanDetailsPage"),LS=()=>{const{isSocialDctType:s}=Z();let t=[];return s?t=[{path:"payment-plans",children:[{path:"",element:e.jsx(uS,{})},{path:":paymentPlanId",children:[{path:"",element:e.jsx(Td,{})},{path:"edit",element:e.jsx(Cr,{})}]}]},{path:"followup-payment-plans/:paymentPlanId",children:[{path:"",element:e.jsx(aS,{})},{path:"edit",element:e.jsx(Bv,{})}]},{path:"payments/:paymentId",element:e.jsx(rS,{})},{path:"program-cycles",children:[{path:"",element:e.jsx(Sd,{})},{path:":programCycleId",children:[{path:"",element:e.jsx(vd,{})},{path:"payment-plans",children:[{path:"new-plan",element:e.jsx(Cd,{})},{path:":paymentPlanId",children:[{path:"",element:e.jsx(Td,{})},{path:"edit",element:e.jsx(zv,{})}]}]}]}]}]:t=[{path:"payment-plans",children:[{path:"",element:e.jsx(jv,{})},{path:":paymentPlanId",children:[{path:"",element:e.jsx(Ed,{})},{path:"edit",element:e.jsx(Cr,{})}]}]},{path:"followup-payment-plans/:paymentPlanId",children:[{path:"",element:e.jsx(dv,{})},{path:"edit",element:e.jsx(zC,{})}]},{path:"payments/:paymentId",element:e.jsx(mv,{})},{path:"program-cycles",children:[{path:"",element:e.jsx(Sd,{})},{path:":programCycleId",children:[{path:"",element:e.jsx(vd,{})},{path:"payment-plans",children:[{path:"new-plan",element:e.jsx(Cd,{})},{path:":paymentPlanId",children:[{path:"",element:e.jsx(Ed,{})},{path:"edit",element:e.jsx(Cr,{})}]}]}]}]}],oa([{path:"payment-module",children:t}])},OS=T.div`
  width: 100%;
  height: 100%;
`,kS=T.div`
  padding-left: ${({theme:s})=>s.spacing(6)};
  border-left: 1px solid #e0e0e0;
  height: 100%;
`;function wS({planNode:s}){const{t}=M(),{baseUrl:a}=U(),n=Jr(s.bankReconciliationSuccess,s.eligiblePaymentsCount),i=Jr(s.bankReconciliationError,s.eligiblePaymentsCount);return e.jsxs(p,{container:!0,children:[e.jsxs(p,{size:{xs:7},children:[e.jsx(Ie,{"data-cy":"div-payment-plan-details",children:e.jsx(ee,{variant:"h6",children:t("Payment Plan Details")})}),e.jsx(P,{pr:2,children:e.jsx(p,{"data-cy":"grid-payment-plan-details",container:!0,spacing:3,children:[{label:t("PROGRAMME NAME"),value:e.jsx(me,{to:`/${a}/details/${s.programId}`,children:s.programName})},{label:t("PAYMENT RECORDS"),value:Qe(s.availablePaymentRecordsCount)},{label:t("START DATE"),value:e.jsx(pe,{children:s.startDate})},{label:t("END DATE"),value:e.jsx(pe,{children:s.endDate})}].map(r=>e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r.label,children:r.value})},r.label))})})]}),e.jsx(p,{"data-cy":"grid-bank-reconciliation",size:{xs:5},children:e.jsxs(kS,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6","data-cy":"table-label",children:t("Reconciliation Summary")})}),e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:3},children:e.jsxs(p,{container:!0,direction:"column",children:[e.jsx(L,{label:t("SUCCESSFUL"),children:e.jsxs("p",{children:[Qe(n),"%"]})}),e.jsx(L,{label:t("ERRONEOUS"),children:e.jsxs("p",{children:[Qe(i),"%"]})})]})}),e.jsx(p,{size:{xs:9},children:e.jsx(OS,{children:e.jsx(ul,{options:{maintainAspectRatio:!1,cutout:"80%",plugins:{legend:{display:!1}}},data:{labels:[t("SUCCESSFUL"),t("ERRONEOUS")],datasets:[{data:[n,i],backgroundColor:["#00509F","#FFAA1F"],hoverBackgroundColor:["#00509F","#FFAA1F"]}]}})})})]})]})})]})}const MS=T(tt)`
  margin: ${s=>s.theme.spacing(1)};
  min-width: 500px;
  max-width: 500px;
`,$S=T(Mm)`
  width: 500px !important;
`,US=T.div`
  display: flex;
  flex-wrap: wrap;
  max-height: 150px;
  overflow-y: auto;
`,VS=T(fl)`
  margin: 2px;
`,BS=T.div`
  margin-top: ${s=>s.theme.spacing(3)};
`,GS=48,zS=8,qS={PaperProps:{style:{maxHeight:GS*4.5+zS,width:500}}};function HS(s,t,a){return!s||!t||!a?null:{fontWeight:t.indexOf(s)===-1?a.typography.fontWeightRegular:a.typography.fontWeightMedium}}function Ia({field:s,form:t,label:a,choices:n,...i}){const r=$m(),l=o=>{t.setFieldValue(s.name,o.target.value)};return n?e.jsxs(MS,{children:[a?e.jsx(Rt,{id:"mutiple-chip-label",children:a}):e.jsx(BS,{}),e.jsx(at,{labelId:"mutiple-chip-label",id:"mutiple-chip",multiple:!0,fullWidth:!0,"data-cy":`select-${s.name}`,value:s.value,onChange:l,input:e.jsx($S,{id:"select-multiple-chip"}),renderValue:o=>e.jsx(US,{children:o.map(d=>e.jsx(VS,{label:n.find(c=>c.value===d)?.name||""},d))}),MenuProps:qS,...i,children:n.map(o=>e.jsx(de,{value:o.value,style:HS(o.value,s.value,r),children:o.name},o.value))})]}):null}const WS=ut(P)({width:400}),Da=({field:s,form:t,suffix:a,min:n,max:i,dataCy:r,...l})=>{const o=(d,c)=>{t.setFieldValue(s.name,c)};return e.jsxs(WS,{children:[e.jsx(ee,{variant:"caption",children:l.label}),e.jsxs(p,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(Um,{...l,"data-cy":r,min:n,max:i,size:"medium",value:typeof s.value=="number"?s.value:0,onChange:o,"aria-labelledby":"input-slider"}),e.jsx(p,{size:2,children:e.jsxs("p",{children:[s.value,a||null]})})]})]})};function KS({onChange:s,values:t}){const a=Vm(t);return A.useEffect(()=>{a&&typeof s=="function"&&!Bm(a,t)&&s({prevValues:a,nextValues:t})},[t,s,a]),null}const ir=B.connect(KS),rh=({open:s,verificationChannel:t,loadRapidProFlows:a})=>(A.useEffect(()=>{s&&t==="RAPIDPRO"&&a()},[s,t,a]),null),YS=T(La)`
  && {
    max-width: 500px;
  }
`,QS=T.div`
  border-bottom: 1px solid #e8e8e8;
`,di={confidenceInterval:95,marginOfError:5,filterAgeMin:null,filterAgeMax:null,filterSex:"",excludedAdminAreasFull:[],excludedAdminAreasRandom:[],verificationChannel:"MANUAL",rapidProFlow:"",adminCheckbox:!1,ageCheckbox:!1,sexCheckbox:!1};function XS(s,t,a){const n=s===0?Ht.FULL_LIST:Ht.RANDOM,i=s===0?{excludedAdminAreas:t.excludedAdminAreasFull||[]}:void 0,r=s===1?{confidenceInterval:t.confidenceInterval*.01,marginOfError:t.marginOfError*.01,excludedAdminAreas:t.adminCheckbox?t.excludedAdminAreasRandom||[]:[],age:t.ageCheckbox?{min:t.filterAgeMin||0,max:t.filterAgeMax||999}:null,sex:t.sexCheckbox?t.filterSex||"":null}:void 0;return{paymentPlan:a,samplingType:n,fullListArguments:i,randomSamplingArguments:r}}function JS(s,t){return{sampling:s===0?"FULL_LIST":"RANDOM",verificationChannel:t.verificationChannel,fullListArguments:s===0?{excludedAdminAreas:t.excludedAdminAreasFull||[]}:null,randomSamplingArguments:s===1?{confidenceInterval:t.confidenceInterval*.01,marginOfError:t.marginOfError*.01,excludedAdminAreas:t.adminCheckbox?t.excludedAdminAreasRandom:[],age:t.ageCheckbox?{min:t.filterAgeMin,max:t.filterAgeMax}:null,sex:t.sexCheckbox?t.filterSex:null}:null,rapidProArguments:t.verificationChannel==="RAPIDPRO"?{flowId:t.rapidProFlow}:null}}const ZS=({cashOrPaymentPlanId:s,canCreatePaymentVerificationPlan:t,isPaymentPlan:a})=>{const{t:n}=M(),i=ge(),[r,l]=A.useState(!1),[o,d]=A.useState(0),{showMessage:c}=Ae(),{businessArea:u,baseUrl:h,programId:m}=U(),{isActiveProgram:g,isSocialDctType:x}=Z(),f=Fe(),j=xe({mutationFn:Y=>N.restBusinessAreasProgramsPaymentVerificationsCreateVerificationPlanCreate({businessAreaSlug:u,id:s,programSlug:m,requestBody:Y}),onSuccess:()=>{f.invalidateQueries({queryKey:["PaymentVerificationPlanDetails",u,s,m]})}}),[y,b]=A.useState(di),{data:C,refetch:v}=V({queryKey:["rapidProFlows",u,m],queryFn:()=>N.restBusinessAreasProgramsSurveysAvailableFlowsList({businessAreaSlug:u,programSlug:m}),enabled:!1}),S=C?{allRapidProFlows:C}:null,I=v,{data:E}=V({queryKey:["adminAreas",u,{level:2}],queryFn:async()=>N.restBusinessAreasGeoAreasList({businessAreaSlug:u,level:2}),enabled:!!u}),[D,F]=A.useState(null),w=A.useCallback(async()=>{if(!(!u||!m))try{const Y=XS(o,y,s),X=await N.restBusinessAreasProgramsMessagesSampleSizeCreate({businessAreaSlug:u,programSlug:m,requestBody:Y});F({sampleSize:{sampleSize:X.sampleSize||0,paymentRecordCount:X.numberOfRecipients||0}})}catch(Y){fe(Y,c)}},[u,m,o,y,s,c]);A.useEffect(()=>{r&&w()},[r,w,o]);const O=async Y=>{try{const X=JS(o,Y);await j.mutateAsync(X),l(!1),c(n("New verification plan created."))}catch(X){fe(X,c)}},k=E?.length?E.map(Y=>({value:Y.id,name:Y.name||""})):[],$=Y=>{b(Y)},G=()=>{const Y=D?.sampleSize?.sampleSize,X=D?.sampleSize?.paymentRecordCount;return isNaN(Y)||isNaN(X)?"":`(${Mi(Y,X)})`},W=()=>t?g?"":n("Program has to be active to create a Verification Plan"):n("There are no payment records that could be assigned to a new Verification Plan.");return e.jsx(B.Formik,{initialValues:di,onSubmit:O,children:({submitForm:Y,values:X,setValues:J})=>(S&&!S?.allRapidProFlows?.length&&X.verificationChannel==="RAPIDPRO"&&i(`/error/${u}`,{state:{errorMessage:n("RapidPro is not set up in your country, please contact your Roll Out Focal Point"),lastSuccessfulPage:`/${h}/payment-verification/${a?"payment-plan":"cash-plan"}/${s}`}}),e.jsxs(B.Form,{children:[e.jsx(rh,{open:r,verificationChannel:X.verificationChannel,loadRapidProFlows:I}),e.jsx(Bs,{}),e.jsx(ir,{values:X,onChange:()=>$(X)}),e.jsx(P,{mr:2,children:e.jsx(Vs,{title:W(),disabled:!g||!t,color:"primary",variant:"contained",onClick:()=>l(!0),dataCy:"button-new-plan",dataPerm:R.PAYMENT_VERIFICATION_CREATE,children:n("CREATE VERIFICATION PLAN")})}),e.jsxs(Ks,{open:r,onClose:()=>l(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{"data-cy":"dialog-title",children:n("Create Verification Plan")})}),e.jsx(Be,{children:e.jsxs(zs,{children:[e.jsx(QS,{children:e.jsxs(YS,{"data-cy":"tabs",value:o,onChange:(ae,re)=>{J(di),b(di),d(re)},indicatorColor:"primary",textColor:"primary",variant:"fullWidth","aria-label":"full width tabs example",children:[e.jsx(Tt,{"data-cy":"tab-full-list",label:n("FULL LIST")}),e.jsx(Tt,{"data-cy":"tab-random-sampling",label:n("RANDOM SAMPLING")})]})}),e.jsx(Qt,{value:o,index:0,children:e.jsxs(P,{pt:6,children:[k&&e.jsx(B.Field,{name:"excludedAdminAreasFull",choices:k,variant:"outlined",label:n("Filter Out Administrative Level Areas"),component:Ia}),e.jsxs(P,{pt:3,children:[e.jsx(P,{pt:3,children:e.jsxs(P,{pb:3,pt:3,fontSize:16,fontWeight:"fontWeightBold",children:["Sample size:"," ",isNaN(D?.sampleSize?.sampleSize)?"":D?.sampleSize?.sampleSize," ","out of"," ",isNaN(D?.sampleSize?.paymentRecordCount)?"":D?.sampleSize?.paymentRecordCount,G()]})}),e.jsx(P,{fontSize:12,color:"#797979",children:n("This option is recommended for RapidPro")}),e.jsx(B.Field,{name:"verificationChannel",label:n("Verification Channel"),style:{flexDirection:"row"},"data-cy":"checkbox-verification-channel",choices:[{value:"RAPIDPRO",name:"RAPIDPRO",dataCy:"radio-rapidpro"},{value:"XLSX",name:"XLSX",dataCy:"radio-xlsx"},{value:"MANUAL",name:"MANUAL",dataCy:"radio-manual"}],component:ea,alignItems:"center"}),X.verificationChannel==="RAPIDPRO"&&e.jsx(B.Field,{name:"rapidProFlow",label:n("RapidPro Flow"),style:{width:"90%"},choices:S?.allRapidProFlows?.map(ae=>({value:ae.uuid,name:ae.name}))||[],component:We})]})]})}),e.jsx(Qt,{value:o,index:1,children:e.jsxs(P,{pt:3,children:[e.jsx(B.Field,{name:"confidenceInterval",label:n("Confidence Interval"),min:90,max:99,component:Da,suffix:"%",dataCy:"slider-confidence-interval"}),e.jsx(B.Field,{name:"marginOfError",label:n("Margin of Error"),min:0,max:9,component:Da,suffix:"%",dataCy:"slider-margin-of-error"}),e.jsx(ee,{variant:"caption",children:n("Cluster Filters")}),e.jsxs(P,{flexDirection:"column",display:"flex",children:[e.jsxs(P,{display:"flex",children:[e.jsx(B.Field,{name:"adminCheckbox",label:n("Administrative Level"),component:ws}),e.jsx(B.Field,{name:"ageCheckbox",label:n(x?"Age":"Age of HoH"),component:ws}),e.jsx(B.Field,{name:"sexCheckbox",label:n(x?"Gender":"Gender of HoH"),component:ws})]}),X.adminCheckbox&&e.jsx(B.Field,{name:"excludedAdminAreasRandom",choices:k,variant:"outlined",label:n("Filter Out Administrative Level Areas"),component:Ia}),e.jsxs(p,{container:!0,children:[X.ageCheckbox&&e.jsx(p,{size:{xs:12},children:e.jsx(P,{mt:6,children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:4},children:e.jsx(B.Field,{name:"filterAgeMin",label:n("Minimum Age"),type:"number",color:"primary",component:Se})}),e.jsx(p,{size:{xs:4},children:e.jsx(B.Field,{name:"filterAgeMax",label:n("Maximum Age"),type:"number",color:"primary",component:Se})})]})})}),X.sexCheckbox&&e.jsx(p,{size:{xs:5},children:e.jsx(P,{mt:6,children:e.jsx(B.Field,{name:"filterSex",label:n("Gender"),color:"primary",choices:[{value:"FEMALE",name:n("Female")},{value:"MALE",name:n("Male")},{value:"OTHER",name:n("Other")},{value:"NOT_COLLECTED",name:n("Not Collected")},{value:"NOT_ANSWERED",name:n("Not Answered")}],component:We})})})]})]}),e.jsxs(P,{pb:3,pt:3,fontSize:16,fontWeight:"fontWeightBold",children:["Sample size: ",D?.sampleSize?.sampleSize," ","out of ",D?.sampleSize?.paymentRecordCount,G()]}),e.jsx(B.Field,{name:"verificationChannel",label:n("Verification Channel"),style:{flexDirection:"row"},alignItems:"center",choices:[{value:"RAPIDPRO",name:"RAPIDPRO",dataCy:"radio-rapidpro"},{value:"XLSX",name:"XLSX",dataCy:"radio-xlsx"},{value:"MANUAL",name:"MANUAL",dataCy:"radio-manual"}],component:ea}),X.verificationChannel==="RAPIDPRO"&&e.jsx(B.Field,{name:"rapidProFlow",label:"RapidPro Flow",style:{width:"90%"},choices:S?S.allRapidProFlows.map(ae=>({value:ae.uuid,name:ae.name})):[],component:We})]})})]})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{"data-cy":"button-cancel",onClick:()=>l(!1),children:"CANCEL"}),e.jsx(ke,{loading:j.isPending,type:"submit",color:"primary",variant:"contained",onClick:Y,"data-cy":"button-submit",children:"SAVE"})]})})]})]}))})};function eI({paymentVerificationPlanId:s,cashOrPaymentPlanId:t}){const{t:a}=M(),[n,i]=A.useState(!1),{isActiveProgram:r}=Z(),{businessArea:l,programId:o}=U(),{showMessage:d}=Ae(),c=Fe(),u=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentVerificationsActivateVerificationPlanCreate({businessAreaSlug:l,id:t,programSlug:o,verificationPlanId:s}),onSuccess:()=>{c.invalidateQueries({queryKey:["PaymentVerificationPlanDetails",l,t,o]})}}),h=async()=>{try{await u.mutateAsync(),i(!1),d(a("Verification plan has been activated."))}catch(m){fe(m,d)}};return e.jsxs(e.Fragment,{children:[e.jsx(P,{p:2,children:e.jsx(H,{color:"primary",variant:"contained",onClick:()=>i(!0),"data-cy":"button-activate-plan",disabled:!r,children:a("ACTIVATE")})}),e.jsxs(Ks,{open:n,onClose:()=>i(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Activate Verification Plan")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsx(P,{p:5,children:a("Are you sure you want to activate the Verification Plan for this Payment Plan?")})})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>i(!1),children:"CANCEL"}),e.jsx(H,{type:"submit",color:"primary",variant:"contained",onClick:()=>h(),"data-cy":"button-submit",children:a("ACTIVATE")})]})})]})]})}const sI=ut(H)({backgroundColor:"#C21313",color:"white","&:hover":{backgroundColor:"#9f1010"}});function lh({children:s,...t}){return e.jsx(sI,{variant:"contained",...t,children:s})}function tI({paymentVerificationPlanId:s,cashOrPaymentPlanId:t}){const{t:a}=M(),[n,i]=A.useState(!1),{showMessage:r}=Ae(),{isActiveProgram:l}=Z(),{businessArea:o,programId:d}=U(),c=Fe(),u=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentVerificationsDeleteVerificationPlanCreate({businessAreaSlug:o,id:t,programSlug:d,verificationPlanId:s}),onSuccess:()=>{c.invalidateQueries({queryKey:["PaymentVerificationPlanDetails",o,t,d]})}}),h=async()=>{try{await u.mutateAsync(),i(!1),r(a("Verification plan has been deleted."))}catch(m){fe(m,r)}};return e.jsxs(e.Fragment,{children:[e.jsx(P,{p:2,children:e.jsx(Xi,{startIcon:e.jsx(hl,{}),onClick:()=>i(!0),"data-cy":"button-delete-plan",disabled:!l,children:"DELETE"})}),e.jsxs(Ks,{open:n,onClose:()=>i(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Delete Verification Plan")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsx(P,{p:5,children:e.jsx("div",{children:a("Are you sure you would like to remove this verification plan?")})})})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>i(!1),children:a("CANCEL")}),e.jsx(lh,{type:"submit",onClick:()=>h(),"data-cy":"button-submit",children:a("DELETE")})]})})]})]})}function Rd({paymentVerificationPlanId:s,cashOrPaymentPlanId:t}){const{t:a}=M(),[n,i]=A.useState(!1),{showMessage:r}=Ae(),{isActiveProgram:l}=Z(),{businessArea:o,programId:d}=U(),c=Fe(),u=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentVerificationsDiscardVerificationPlanCreate({businessAreaSlug:o,id:t,programSlug:d,verificationPlanId:s}),onSuccess:()=>{c.invalidateQueries({queryKey:["PaymentVerificationPlanDetails",o,t,d]})}}),h=async()=>{try{await u.mutateAsync(),i(!1),r(a("Verification plan has been discarded."))}catch(m){fe(m,r)}};return e.jsxs(e.Fragment,{children:[e.jsx(P,{p:2,children:e.jsx(Xi,{startIcon:e.jsx(hl,{}),onClick:()=>i(!0),"data-cy":"button-discard-plan",disabled:!l,children:"DISCARD"})}),e.jsxs(Ks,{open:n,onClose:()=>i(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Discard Verification Plan")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsx(P,{p:5,children:e.jsxs("div",{children:[a("Are you sure you would like to remove payment verification records"),e.jsx("br",{})," ",a("and restart the verification process?")]})})})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>i(!1),children:a("CANCEL")}),e.jsx(lh,{type:"submit",onClick:()=>h(),"data-cy":"button-submit",children:a("DISCARD")})]})})]})]})}const aI=T(La)`
  && {
    max-width: 500px;
  }
`,nI=T.div`
  border-bottom: 1px solid #e8e8e8;
`;function iI(s,t,a){const n=s===0?Ht.FULL_LIST:Ht.RANDOM,i=s===0?{excludedAdminAreas:t.excludedAdminAreasFull||[]}:void 0,r=s===1?{confidenceInterval:t.confidenceInterval*.01,marginOfError:t.marginOfError*.01,excludedAdminAreas:t.adminCheckbox?t.excludedAdminAreasRandom||[]:[],age:t.ageCheckbox?{min:t.filterAgeMin||0,max:t.filterAgeMax||999}:null,sex:t.sexCheckbox?t.filterSex||"":null}:void 0;return{paymentPlan:a,samplingType:n,fullListArguments:i,randomSamplingArguments:r}}const rI=({paymentVerificationPlanNode:s,cashOrPaymentPlanId:t})=>{const{t:a}=M(),[n,i]=A.useState(!1),[r,l]=A.useState(0),{showMessage:o}=Ae(),{baseUrl:d,businessArea:c,programId:u}=U(),{isActiveProgram:h,isSocialDctType:m}=Z(),g=ge(),x=Fe(),f=(Y,X)=>{const J={sampling:Y===0?"FULL_LIST":"RANDOM",verificationChannel:X.verificationChannel};if(Y===0){const ae={...J,fullListArguments:{excludedAdminAreas:X.excludedAdminAreasFull||[]}};return X.verificationChannel==="RAPIDPRO"&&(ae.rapidProArguments={flowId:X.rapidProFlow}),ae}else{const ae={...J,randomSamplingArguments:{confidenceInterval:X.confidenceInterval*.01,marginOfError:X.marginOfError*.01,excludedAdminAreas:X.adminCheckbox?X.excludedAdminAreasRandom||[]:[],age:X.ageCheckbox?{min:X.filterAgeMin||0,max:X.filterAgeMax||999}:{min:0,max:999},sex:X.sexCheckbox&&X.filterSex||""}};return X.verificationChannel==="RAPIDPRO"&&(ae.rapidProArguments={flowId:X.rapidProFlow}),ae}},j=xe({mutationFn:Y=>N.restBusinessAreasProgramsPaymentVerificationsUpdateVerificationPlanPartialUpdate({businessAreaSlug:c,id:t,programSlug:u,verificationPlanId:s.id,requestBody:Y}),onSuccess:()=>{x.invalidateQueries({queryKey:["PaymentVerificationPlanDetails",c,t,u]})}});A.useEffect(()=>{s.sampling==="FULL_LIST"?l(0):l(1)},[s.sampling]);const y={confidenceInterval:s.confidenceInterval*100||95,marginOfError:s.marginOfError*100||5,filterAgeMin:s.ageFilterMin||"",filterAgeMax:s.ageFilterMax||"",filterSex:s.sexFilter||"",excludedAdminAreasFull:s.excludedAdminAreasFilter||[],excludedAdminAreasRandom:s.excludedAdminAreasFilter||[],verificationChannel:s.verificationChannel||"",rapidProFlow:s.rapidProFlowId||"",adminCheckbox:s.excludedAdminAreasFilter?.length!==0,ageCheckbox:!!s.ageFilterMin||!!s.ageFilterMax||!1,sexCheckbox:!!s.sexFilter||!1},[b,C]=A.useState(y),{data:v,refetch:S}=V({queryKey:["rapidProFlows",c,u],queryFn:()=>N.restBusinessAreasProgramsSurveysAvailableFlowsList({businessAreaSlug:c,programSlug:u}),enabled:!1}),I=v?{allRapidProFlows:v}:null,E=S,{data:D}=V({queryKey:["adminAreas",c,{level:2}],queryFn:async()=>N.restBusinessAreasGeoAreasList({businessAreaSlug:c,level:2}),enabled:!!c}),[F,w]=A.useState(null),O=A.useCallback(async()=>{if(!(!c||!u))try{const Y=iI(r,b,t),X=await N.restBusinessAreasProgramsMessagesSampleSizeCreate({businessAreaSlug:c,programSlug:u,requestBody:Y});w({sampleSize:{sampleSize:X.sampleSize||0,paymentRecordCount:X.numberOfRecipients||0}})}catch(Y){fe(Y,o)}},[c,u,r,b,t,o]);A.useEffect(()=>{n&&O()},[n,O,r]);const k=async Y=>{try{const X=f(r,Y);await j.mutateAsync(X),i(!1),o(a("Verification plan edited."))}catch(X){fe(X,o)}},$=D?.length?D.map(Y=>({value:Y.id,name:Y.name||""})):[],G=Y=>{C(Y)},W=()=>{const Y=F?.sampleSize?.sampleSize,X=F?.sampleSize?.paymentRecordCount;return!Y||!X||isNaN(Y)||isNaN(X)?"":` (${Y/X*100}%)`};return e.jsx(B.Formik,{initialValues:y,onSubmit:k,children:({submitForm:Y,values:X,setValues:J})=>(I&&!I?.allRapidProFlows?.length&&X.verificationChannel==="RAPIDPRO"&&g(`/error/${c}`,{state:{errorMessage:a("RapidPro is not set up in your country, please contact your Roll Out Focal Point"),lastSuccessfulPage:`/${d}/payment-verification/payment-plan/${t}`}}),e.jsxs(B.Form,{children:[e.jsx(rh,{open:n,verificationChannel:X.verificationChannel,loadRapidProFlows:E}),e.jsx(Bs,{}),e.jsx(ir,{values:X,onChange:()=>G(X)}),e.jsx(H,{color:"primary",onClick:()=>i(!0),startIcon:e.jsx(Ha,{}),"data-cy":"button-edit-plan",disabled:!h,children:a("Edit")}),e.jsxs(Ks,{open:n,onClose:()=>i(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Edit Verification Plan")})}),e.jsx(Be,{children:e.jsxs(zs,{children:[e.jsx(nI,{children:e.jsxs(aI,{value:r,onChange:(ae,re)=>{J(y),C(y),l(re)},indicatorColor:"primary",textColor:"primary",variant:"fullWidth","aria-label":"full width tabs example",children:[e.jsx(Tt,{"data-cy":"tab-full-list",label:a("FULL LIST")}),e.jsx(Tt,{"data-cy":"tab-random-sampling",label:a("RANDOM SAMPLING")})]})}),e.jsx(Qt,{value:r,index:0,children:e.jsxs(P,{pt:6,children:[$&&e.jsx(B.Field,{name:"excludedAdminAreasFull",choices:$,variant:"outlined",label:a("Filter Out Administrative Level Areas"),component:Ia}),e.jsxs(P,{pt:3,children:[e.jsxs(P,{pb:3,pt:3,fontSize:16,fontWeight:"fontWeightBold",children:["Sample size:"," ",isNaN(F?.sampleSize?.sampleSize)?" 0":` ${F?.sampleSize?.sampleSize}`," ","out of"," ",isNaN(F?.sampleSize?.paymentRecordCount)?" 0":` ${F?.sampleSize?.paymentRecordCount}`,W()]}),e.jsx(P,{fontSize:12,color:"#797979",children:a("This option is recommended for RapidPro")}),e.jsx(B.Field,{name:"verificationChannel",label:a("Verification Channel"),style:{flexDirection:"row",alignItems:"center"},choices:[{value:"RAPIDPRO",name:"RAPIDPRO",dataCy:"radio-rapidpro"},{value:"XLSX",name:"XLSX",dataCy:"radio-xlsx"},{value:"MANUAL",name:"MANUAL",dataCy:"radio-manual"}],component:ea,alignItems:"center"}),X.verificationChannel==="RAPIDPRO"&&e.jsx(B.Field,{name:"rapidProFlow",label:"RapidPro Flow",style:{width:"90%"},choices:I?I.allRapidProFlows.map(ae=>({value:ae.uuid,name:ae.name})):[],component:We})]})]})}),e.jsx(Qt,{value:r,index:1,children:e.jsxs(P,{pt:3,children:[e.jsx(B.Field,{name:"confidenceInterval",label:a("Confidence Interval"),min:90,max:99,component:Da,suffix:"%"}),e.jsx(B.Field,{name:"marginOfError",label:a("Margin of Error"),min:0,max:9,component:Da,suffix:"%"}),e.jsx(ee,{variant:"caption",children:a("Cluster Filters")}),e.jsxs(P,{flexDirection:"column",display:"flex",children:[e.jsxs(P,{display:"flex",children:[e.jsx(B.Field,{name:"adminCheckbox",label:a("Administrative Level"),component:ws}),e.jsx(B.Field,{name:"ageCheckbox",label:a(m?"Age":"Age of HoH"),component:ws}),e.jsx(B.Field,{name:"sexCheckbox",label:a(m?"Gender":"Gender of HoH"),component:ws})]}),X.adminCheckbox&&e.jsx(B.Field,{name:"excludedAdminAreasRandom",choices:$,variant:"outlined",label:a("Filter Out Administrative Level Areas"),component:Ia}),e.jsxs(p,{container:!0,children:[X.ageCheckbox&&e.jsx(p,{size:{xs:12},children:e.jsx(P,{mt:6,children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:4},children:e.jsx(B.Field,{name:"filterAgeMin",label:a("Minimum Age"),type:"number",color:"primary",component:Se})}),e.jsx(p,{size:{xs:4},children:e.jsx(B.Field,{name:"filterAgeMax",label:a("Maximum Age"),type:"number",color:"primary",component:Se})})]})})}),X.sexCheckbox&&e.jsx(p,{size:{xs:5},children:e.jsx(P,{mt:6,children:e.jsx(B.Field,{name:"filterSex",label:a("Gender"),color:"primary",choices:[{value:"FEMALE",name:a("Female")},{value:"MALE",name:a("Male")},{value:"OTHER",name:a("Other")},{value:"NOT_COLLECTED",name:a("Not Collected")},{value:"NOT_ANSWERED",name:a("Not Answered")}],component:We})})})]})]}),e.jsxs(P,{pb:3,pt:3,fontSize:16,fontWeight:"fontWeightBold",children:["Sample size:"," ",isNaN(F?.sampleSize?.sampleSize)?" 0":` ${Qe(F?.sampleSize?.sampleSize)}`," ","out of"," ",isNaN(F?.sampleSize?.paymentRecordCount)?" 0":` ${Qe(F?.sampleSize?.paymentRecordCount)}`,W()]}),e.jsx(B.Field,{name:"verificationChannel",label:"Verification Channel",style:{flexDirection:"row"},alignItems:"center",choices:[{value:"RAPIDPRO",name:"RAPIDPRO",dataCy:"radio-rapidpro"},{value:"XLSX",name:"XLSX",dataCy:"radio-xlsx"},{value:"MANUAL",name:"MANUAL",dataCy:"radio-manual"}],component:ea}),X.verificationChannel==="RAPIDPRO"&&e.jsx(B.Field,{name:"rapidProFlow",label:"RapidPro Flow",style:{width:"90%"},choices:I?I.allRapidProFlows:[],component:We})]})})]})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>i(!1),children:a("CANCEL")}),e.jsx(ke,{loading:j.isPending,type:"submit",color:"primary",variant:"contained",onClick:Y,"data-cy":"button-submit",children:a("SAVE")})]})})]})]}))})};function Fd({verificationPlan:s,cashOrPaymentPlanId:t}){const{t:a}=M(),[n,i]=A.useState(!1),{showMessage:r}=Ae(),{isActiveProgram:l}=Z(),{businessArea:o,programId:d}=U(),c=Fe(),u=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentVerificationsFinishVerificationPlanCreate({businessAreaSlug:o,id:t,programSlug:d,verificationPlanId:s.id}),onSuccess:()=>{c.invalidateQueries({queryKey:["PaymentVerificationPlanDetails",o,t,d]})}}),h=async()=>{try{await u.mutateAsync(),i(!1),r(a("Verification plan has been finished"))}catch(f){fe(f,r)}},m=()=>{const f=s?.respondedCount||0,j=s?.sampleSize;return j?Mi(f,j):null},g=()=>{if(s?.sampleSize){const f=s?.notReceivedCount,j=s?.receivedWithProblemsCount;return f+j}return null},x=()=>{const f=parseFloat(m());return f?f<100?`Only ${m()}`:"All":"None"};return e.jsxs(e.Fragment,{children:[e.jsx(P,{p:2,children:e.jsx(H,{color:"primary",variant:"contained",onClick:()=>i(!0),"data-cy":"button-ed-plan",disabled:!l,children:a("Finish")})}),e.jsxs(Ks,{open:n,onClose:()=>i(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:a("Finish Verification Plan")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsxs(P,{children:[m()&&e.jsxs(ee,{variant:"body2",style:{marginTop:"20px"},children:[x(),a(" of the beneficiaries have responded to this payment verification.")]}),e.jsx(ee,{variant:"body2",children:a("Are you sure that you want to finish?")}),g()?e.jsxs(ee,{style:{marginTop:"20px",marginBottom:"20px"},variant:"body2",children:[a("Closing this verification will generate")," ",g()," ",a("grievance tickets"),"."]}):null]})})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>i(!1),children:a("CANCEL")}),e.jsx(H,{type:"submit",color:"primary",variant:"contained",onClick:()=>h(),"data-cy":"button-submit",children:a("FINISH")})]})})]})]})}const lI=T.div`
  color: ${({theme:s})=>s.palette.error.dark};
  padding: 20px;
`,oI=T(H)`
  width: 150px;
`,dI=({paymentVerificationPlanId:s,cashOrPaymentPlanId:t})=>{const{showMessage:a}=Ae(),{businessArea:n,programId:i}=U(),[r,l]=A.useState(!1),[o,d]=A.useState(null),c=Fe(),{t:u}=M(),h=xe({mutationFn:f=>N.restBusinessAreasProgramsPaymentVerificationsImportXlsxCreate({businessAreaSlug:n,id:t,programSlug:i,verificationPlanId:s,formData:f}),onSuccess:()=>{c.invalidateQueries({queryKey:["PaymentVerificationPlanDetails",n,t,i]}),c.invalidateQueries({queryKey:["businessAreasProgramsPaymentVerificationsVerificationsList"]})}}),m=async()=>{if(o)try{await h.mutateAsync({file:o}),l(!1),a(u("Your import was successful!"))}catch(f){fe(f,a)}},x=h.error?.body;return e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsx(oI,{startIcon:e.jsx(Ka,{}),color:"primary",variant:"outlined","data-cy":"button-import",onClick:()=>l(!0),children:u("Import XLSX")})},"import"),e.jsx(is,{open:r,onClose:()=>l(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:e.jsxs(Ye,{children:[e.jsx(Le,{children:u("Select File to Import")}),e.jsxs(e.Fragment,{children:[e.jsx(pn,{dontShowFilename:!1,loading:h.isPending,onChange:f=>{if(f.length===0)return;const j=f[0],y=j.size/(1024*1024);if(y>200){a(`File size is too big. It should be under 200MB, File size is ${y}MB`);return}d(j)}}),o&&h.error&&e.jsxs(lI,{children:[e.jsx("p",{children:"Errors"}),e.jsx("p",{children:JSON.stringify(x)})]})]}),e.jsxs(os,{children:[e.jsx(H,{onClick:()=>{l(!1),d(null)},children:"CANCEL"}),e.jsx(ke,{loading:h.isPending,disabled:!o,type:"submit",color:"primary",variant:"contained",onClick:()=>m(),"data-cy":"button-import-entitlement",children:u("IMPORT")})]})]})})]})},cI=T.a`
  text-decoration: none;
`;function uI({verificationPlan:s,paymentPlanNode:t}){const{t:a}=M(),n=ve(),{showMessage:i}=Ae(),{businessArea:r,programSlug:l}=U(),o=Fe(),d=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentVerificationsExportXlsxCreate({businessAreaSlug:r,id:t.id,programSlug:l,verificationPlanId:s.id}),onSuccess:()=>{o.invalidateQueries({queryKey:["PaymentVerificationPlanDetails",r,t.id,l]})}}),c=xe({mutationFn:()=>N.restBusinessAreasProgramsPaymentVerificationsInvalidVerificationPlanCreate({businessAreaSlug:r,id:t.id,programSlug:l,verificationPlanId:s.id}),onSuccess:()=>{o.invalidateQueries({queryKey:["PaymentVerificationPlanDetails",r,t.id,l]})}});if(!s||!n)return null;const u=s.status===rn.PENDING,h=s.status===rn.ACTIVE,m=s.verificationChannel==="XLSX",g=K(R.PAYMENT_VERIFICATION_UPDATE,n),x=K(R.PAYMENT_VERIFICATION_ACTIVATE,n),f=K(R.PAYMENT_VERIFICATION_DELETE,n),j=K(R.PAYMENT_VERIFICATION_FINISH,n),y=K(R.PAYMENT_VERIFICATION_DISCARD,n),b=K(R.PAYMENT_VERIFICATION_IMPORT,n),C=K(R.PAYMENT_VERIFICATION_EXPORT,n)&&!s.hasXlsxFile,v=K(R.PAYMENT_VERIFICATION_EXPORT,n)&&s.hasXlsxFile&&!s.xlsxFileExporting,S=s.xlsxFileWasDownloaded||s.xlsxFileImported;return e.jsx(Ie,{children:e.jsxs(P,{display:"flex",alignItems:"center",justifyContent:"flex-end",children:[u&&e.jsxs(e.Fragment,{children:[e.jsx(P,{mr:2,children:f&&e.jsx(tI,{cashOrPaymentPlanId:t.id,paymentVerificationPlanId:s.id})}),g&&e.jsx(rI,{paymentVerificationPlanNode:s,cashOrPaymentPlanId:t.id}),x&&e.jsx(P,{alignItems:"center",display:"flex",children:e.jsx(eI,{paymentVerificationPlanId:s.id,cashOrPaymentPlanId:t.id})})]}),h&&e.jsxs(P,{display:"flex",children:[m&&e.jsxs(e.Fragment,{children:[C&&e.jsx(P,{p:2,children:e.jsx(ke,{loading:d.isPending,disabled:d.isPending||s.xlsxFileExporting,color:"primary",variant:"outlined",startIcon:e.jsx(Ca,{}),"data-cy":"export-xlsx",onClick:async()=>{try{await d.mutateAsync(),i(a("Exporting XLSX started. Please check your email."))}catch(I){fe(I,i)}},children:s.xlsxFileExporting?a("Exporting..."):a("Export Xlsx")})}),v&&e.jsx(P,{p:2,children:e.jsx(cI,{download:!0,href:`/api/download-payment-verification-plan/${s.id}`,children:e.jsx(H,{color:"primary",variant:"outlined","data-cy":"download-xlsx",startIcon:e.jsx(Ca,{}),"data-perm":R.PAYMENT_VERIFICATION_EXPORT,children:a("Download Xlsx")})})}),b&&e.jsx(P,{p:2,"data-cy":"import-xlsx",children:e.jsx(dI,{paymentVerificationPlanId:s.id,cashOrPaymentPlanId:t.id})}),j&&s.xlsxFileImported&&e.jsx(Fd,{verificationPlan:s,cashOrPaymentPlanId:t.id}),y&&!s.xlsxFileWasDownloaded&&!s.xlsxFileImported&&e.jsx(Rd,{paymentVerificationPlanId:s.id,cashOrPaymentPlanId:t.id}),S&&e.jsx(P,{p:2,children:e.jsx(ke,{loading:c.isPending,color:"primary",variant:"outlined","data-cy":"button-mark-as-invalid",onClick:async()=>{try{await c.mutateAsync(),i(a("Verification plan marked as invalid."))}catch(I){fe(I,i)}},children:a("Mark as Invalid")})})]}),!m&&e.jsxs(e.Fragment,{children:[j&&e.jsx(Fd,{verificationPlan:s,cashOrPaymentPlanId:t.id}),y&&e.jsx(Rd,{paymentVerificationPlanId:s.id,cashOrPaymentPlanId:t.id})]})]})]})})}const hI=T.div`
  width: 100%;
  height: 100%;
`;function mI({verificationPlan:s}){const{t}=M();return e.jsx(hI,{children:e.jsx(ul,{options:{maintainAspectRatio:!1,cutout:"%",plugins:{legend:{display:!1}}},data:{labels:[t("RECEIVED"),t("RECEIVED WITH ISSUES"),t("NOT RECEIVED"),t("PENDING")],datasets:[{data:[s.receivedCount,s.receivedWithProblemsCount,s.notReceivedCount,s.sampleSize-s.respondedCount],backgroundColor:["#31D237","#F57F1A","#FF0100","#DCDCDC"],hoverBackgroundColor:["#31D237","#F57F1A","#FF0100","#DCDCDC"]}]}})})}const pI=T.div`
  display: flex;
  flex: 1;
  width: 100%;
  background-color: #fff;
  padding: ${({theme:s})=>s.spacing(8)}
    ${({theme:s})=>s.spacing(11)};
  flex-direction: column;
  border-color: #b1b1b5;
  border-bottom-width: 1px;
  border-bottom-style: solid;
`;function gI({verificationPlan:s,paymentPlanNode:t}){const{t:a}=M();return e.jsxs(pI,{children:[e.jsxs(P,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(Ie,{children:e.jsxs(ee,{"data-cy":`verification-plan-${s.unicefId}`,variant:"h6",children:[a("Verification Plan")," #",s.unicefId,e.jsx(gt,{adminUrl:s.adminUrl,sx:{ml:2}})]})}),e.jsx(uI,{verificationPlan:s,paymentPlanNode:t})]}),e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:9},children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("STATUS"),children:e.jsx(we,{status:s.status,statusToColor:El,dataCy:"verification-plan-status"})})}),[{label:a("SAMPLING"),value:s.sampling},{label:a("RESPONDED"),value:Qe(s.respondedCount)},{label:a("RECEIVED WITH ISSUES"),value:Qe(s.receivedWithProblemsCount)},{label:a("VERIFICATION CHANNEL"),value:s.verificationChannel},{label:a("SAMPLE SIZE"),value:Qe(s.sampleSize)},{label:a("RECEIVED"),value:Qe(s.receivedCount)},{label:a("NOT RECEIVED"),value:Qe(s.notReceivedCount)},{label:a("ACTIVATION DATE"),value:e.jsx(pe,{children:s.activationDate})},{label:a("COMPLETION DATE"),value:e.jsx(pe,{children:s.completionDate})}].map(n=>e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:n.label,value:n.value})},n.label))]})}),e.jsx(p,{size:{xs:3},children:e.jsx(mI,{verificationPlan:s})})]})]})}function xI({planNode:s}){const{t}=M();return e.jsx(p,{container:!0,children:e.jsxs(p,{"data-cy":"grid-verification-plans-summary",size:{xs:9},children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6","data-cy":"table-label",children:t("Verification Plans Summary")})}),e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:3},children:e.jsx(P,{pt:2,pb:2,children:e.jsx(L,{label:t("Status"),children:e.jsx(we,{dataCy:"verification-plans-summary-status",status:s.paymentVerificationSummary?.status,statusToColor:El})})})}),e.jsx(p,{size:{xs:3},children:e.jsx(P,{pt:2,pb:2,children:e.jsx(L,{dataCy:"summary-activation-date",label:t("Activation Date"),children:e.jsx(pe,{children:s.paymentVerificationSummary?.activationDate})})})}),e.jsx(p,{size:{xs:3},children:e.jsx(P,{pt:2,pb:2,children:e.jsx(L,{dataCy:"summary-completion-date",label:t("Completion Date"),children:e.jsx(pe,{children:s.paymentVerificationSummary?.completionDate})})})}),e.jsx(p,{size:{xs:3},children:e.jsx(P,{pt:2,pb:2,children:e.jsx(L,{dataCy:"summary-number-of-plans",label:t("Number of Verification Plans"),children:s.paymentVerificationPlans.length})})})]})]})})}function Jt({children:s,...t}){const a=ve();if(a===null)return null;const n=!K(R.ALL_VIEW_PII_DATA_ON_LISTS,a);return e.jsx(_,{align:"left",...t,children:wp(s,n)})}function fI({payment:s,canViewRecordDetails:t,showStatusColumn:a=!0}){const{baseUrl:n}=U(),i=`/${n}/verification/payment/${s.id}`;return e.jsxs(be,{hover:!0,role:"checkbox",children:[e.jsx(_,{align:"left",children:t?e.jsx(me,{to:i,children:s?.unicefId}):e.jsx("span",{children:s?.unicefId})}),e.jsx(_,{align:"left",children:s.verification.verificationChannel}),e.jsx(_,{align:"left",children:s.verification.paymentVerificationPlanUnicefId}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:$n})}),e.jsx(Jt,{children:s.hohFullName}),e.jsx(_,{align:"left",children:s.householdUnicefId}),a&&e.jsx(_,{align:"left",children:e.jsx(we,{status:s.householdStatus,statusToColor:Un})}),e.jsx(_,{align:"right",children:Ps(s.deliveredQuantity,s.currency)}),e.jsx(_,{align:"right",children:Ps(s.verification.receivedAmount,s.currency)}),e.jsx(_,{align:"left",children:s.hohPhoneNo}),e.jsx(_,{align:"left",children:s.hohPhoneNoAlternative||"-"})]},s.id)}const yI=[{disablePadding:!1,label:"Payment ID",id:"unicef_id",numeric:!1},{disablePadding:!1,label:"Verification Channel",id:"payment_verification_plan__verification_channel",numeric:!1},{disablePadding:!1,label:"Verification Plan Id",id:"payment_verification_plan__unicef_id",numeric:!1},{disablePadding:!1,label:"Verification Status",id:"status",numeric:!1},{disablePadding:!1,label:"Individual",id:"payment_record__head_of_household__family_name",numeric:!1},{disablePadding:!1,label:"Individual ID",id:"payment_record__head_of_household__unicef_id",numeric:!1},{disablePadding:!1,label:"Delivered",id:"payment_record__delivered_quantity",numeric:!0},{disablePadding:!1,label:"Received",id:"received_amount",numeric:!0},{disablePadding:!1,label:"Phone #",id:"payment_record__head_of_household__phone_no",numeric:!1},{disablePadding:!1,label:"Alt. Phone #",id:"payment_record__head_of_household__phone_no_alternative",numeric:!1}];function bI({paymentPlanId:s,filter:t,canViewRecordDetails:a,businessArea:n}){const{t:i}=M(),{programId:r}=U(),[l,o]=A.useState(0),d=A.useMemo(()=>({...t,businessAreaSlug:n,programSlug:r,paymentVerificationPk:s,page:l}),[t,n,r,s,l]),[c,u]=A.useState(d);A.useEffect(()=>{u(d)},[d]);const{data:h,isLoading:m,error:g}=V({queryKey:["businessAreasProgramsPaymentVerificationsVerificationsList",c,n,r,s],queryFn:()=>N.restBusinessAreasProgramsPaymentVerificationsVerificationsList(Ce({businessAreaSlug:n,programSlug:r,paymentVerificationPk:s},c,{withPagination:!0}))}),{data:x}=V({queryKey:["businessAreasProgramsPaymentVerificationsVerificationsCount",c,n,r,s],queryFn:()=>N.restBusinessAreasProgramsPaymentVerificationsVerificationsCountRetrieve(Ce({businessAreaSlug:n,programSlug:r,paymentVerificationPk:s},c)),enabled:l===0}),f=vs(l,x);return e.jsx(ds,{title:i("Verification Records"),headCells:yI,isLoading:m,error:g,queryVariables:c,setQueryVariables:u,data:h,page:l,setPage:o,itemsCount:f,renderRow:j=>e.jsx(fI,{payment:j,canViewRecordDetails:a,showStatusColumn:!1},j.id)})}const xt=[{disablePadding:!1,label:"Date",id:"timestamp",numeric:!1,weight:.4},{disablePadding:!1,label:"User",id:"actor",numeric:!1,weight:.6},{disablePadding:!1,label:"Verification Plan",id:"content_object__unicef_id",numeric:!1,weight:.6},{disablePadding:!1,label:"Action",id:"action",numeric:!1,weight:.4},{disablePadding:!1,label:"Change from",id:"change_from",numeric:!1},{disablePadding:!1,label:"Change to",id:"change_to",numeric:!1}],nl=T.div`
  width: 48px;
  border-bottom: 1px solid rgba(224, 224, 224, 1);
`,xi=T.div`
  width: 100%;
  display: flex;
  flex-direction: row;
  cursor: ${({hover:s})=>s?"pointer":"auto"};
  &:hover {
    background-color: ${({hover:s})=>s?"#e8e8e8":"transparent"};
  }
`,_t=T.div`
  display: flex;
  flex: ${({weight:s})=>s||1};

  padding: 16px;
  font-size: 0.875rem;
  text-align: left;
  line-height: 1.43;
  border-bottom: 1px solid rgba(224, 224, 224, 1);
  letter-spacing: 0.01071em;
  vertical-align: inherit;
  overflow-wrap: break-word;
  word-wrap: break-word;

  -ms-word-break: break-all;
  /* This is the dangerous one in WebKit, as it breaks things wherever */
  word-break: break-all;
  /* Instead use this non-standard one: */
  word-break: break-word;

  /* Adds a hyphen where the word breaks, if supported (No Blink) */
  -ms-hyphens: auto;
  -moz-hyphens: auto;
  -webkit-hyphens: auto;
  hyphens: auto;
`,jI=T.div`
  border-bottom: 1px solid rgba(224, 224, 224, 1);
`,AI=T(yt)`
  background-color: #fafafa;
`,_I=T(Ve)`
  transform: rotate(0deg);
  transition: ${({theme:s})=>s.transitions.create("transform",{duration:400})};
  ${({expanded:s})=>s&&on.css`
      transform: rotate(180deg);
    `}
`,PI=({logEntry:s})=>{const{changes:t}=s,[a,n]=A.useState(!1),i=Object.keys(t),{length:r}=i;return r===1?e.jsxs(xi,{role:"checkbox",children:[e.jsx(_t,{weight:xt[0].weight,children:fs(s.timestamp).format("DD MMM YYYY HH:mm")}),e.jsx(_t,{weight:xt[1].weight,children:s.user?`${s.user}`:null}),e.jsx(_t,{weight:xt[2].weight,children:s.objectId}),e.jsx(_t,{weight:xt[3].weight,children:t[i[0]].from}),e.jsx(_t,{weight:xt[4].weight,children:t[i[0]].to}),e.jsx(nl,{})]}):e.jsxs(e.Fragment,{children:[e.jsxs(xi,{onClick:()=>n(!a),hover:!0,children:[e.jsx(_t,{weight:xt[0].weight,children:fs(s.timestamp).format("DD MMM YYYY HH:mm")}),e.jsx(_t,{weight:xt[1].weight,children:s.user?`${s.user}`:null}),e.jsx(_t,{weight:xt[2].weight,children:s.objectId}),e.jsx(_t,{weight:xt[3].weight,children:"Multiple"}),e.jsx(_t,{weight:xt[4].weight}),e.jsx(_t,{weight:xt[5].weight}),e.jsx(jI,{children:e.jsx(_I,{expanded:a,onClick:()=>n(!a),children:e.jsx(za,{})})})]}),e.jsx(AI,{in:a,children:i.map(l=>e.jsxs(xi,{children:[e.jsx(_t,{weight:xt[0].weight}),e.jsx(_t,{weight:xt[1].weight}),e.jsx(_t,{weight:xt[2].weight}),e.jsx(_t,{weight:xt[3].weight,children:l}),e.jsx(_t,{weight:xt[4].weight,children:t[l].from}),e.jsx(_t,{weight:xt[5].weight,children:t[l].to}),e.jsx(nl,{})]},s.objectId))})]})},CI=T.div`
  display: flex;
  flex-direction: column;
`,EI=T.div`
  display: flex;
  flex: ${({weight:s})=>s||1};
  padding: 16px;
  font-size: 12px;
  text-align: left;
  font-weight: 500;
  line-height: 1.43rem;
  border-bottom: 1px solid rgba(224, 224, 224, 1);
  letter-spacing: 0.01071em;
  vertical-align: inherit;
`,vI=T(us)`
  width: 100%;
  padding: ${({theme:s})=>s.spacing(5)} 0;
  margin-bottom: ${({theme:s})=>s.spacing(5)};
`,SI=T.div`
  margin: 0 ${({theme:s})=>s.spacing(6)};
  display: flex;
  flex-direction: row;
  justify-content: space-between;
`;function II({logEntries:s,totalCount:t,rowsPerPage:a,page:n,onChangePage:i,onChangeRowsPerPage:r}){const[l,o]=A.useState(!1),{t:d}=M();return e.jsxs(vI,{children:[e.jsxs(SI,{children:[e.jsx(ee,{variant:"h6",children:d("Activity Log")}),e.jsx(H,{variant:"outlined",color:"primary",endIcon:l?e.jsx(Di,{}):e.jsx(za,{}),onClick:()=>o(!l),children:l?"HIDE":"SHOW"})]}),e.jsxs(yt,{in:l,children:[e.jsxs(CI,{children:[e.jsxs(xi,{children:[xt.map(c=>e.jsx(EI,{style:{flex:c.weight||1},children:c.label},c.id)),e.jsx(nl,{})]}),s.map(c=>e.jsx(PI,{logEntry:c},c.objectId))]}),e.jsx(Ua,{rowsPerPageOptions:[5,10,15],component:"div",count:t,rowsPerPage:a,page:n,onPageChange:i,onRowsPerPageChange:r})]})]})}function DI({objectId:s}){const[t,a]=A.useState(0),{businessAreaSlug:n}=U(),[i,r]=A.useState(5),{data:l}=V({queryKey:["activityLogs",n,s,t,i],queryFn:()=>N.restBusinessAreasActivityLogsList({businessAreaSlug:n,objectId:s,limit:i,offset:t*i}),enabled:!!(n&&s)}),{data:o}=V({queryKey:["activityLogsCount",n],queryFn:()=>N.restBusinessAreasActivityLogsCountRetrieve({businessAreaSlug:n}),enabled:!!n});if(!l||!o)return null;const d=l?.results,c=o.count;return e.jsx(II,{totalCount:c,rowsPerPage:i,logEntries:d,page:t,onChangePage:(u,h)=>{a(h)},onChangeRowsPerPage:u=>{const h=parseInt(u.target.value,10);r(h),a(0)}})}function TI({payment:s,canViewRecordDetails:t,paymentPlanId:a,showStatusColumn:n=!0}){const{baseUrl:i}=U(),r=`/${i}/payment-verification/payment-plan/${a}/verification/payment/${s.id}`;return e.jsxs(be,{hover:!0,role:"checkbox",children:[e.jsx(_,{align:"left",children:t?e.jsx(me,{to:r,children:s?.unicefId}):e.jsx("span",{children:s?.unicefId})}),e.jsx(_,{align:"left",children:s.verification.verificationChannel}),e.jsx(_,{align:"left",children:s.verification.paymentVerificationPlanUnicefId}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.verification.status,statusToColor:$n})}),e.jsx(Jt,{children:s.hohFullName}),e.jsx(_,{align:"left",children:s.householdUnicefId}),n&&e.jsx(_,{align:"left",children:e.jsx(we,{status:s.householdStatus,statusToColor:Un})}),e.jsx(_,{align:"right",children:Ps(s.deliveredQuantity,s.currency)}),e.jsx(_,{align:"right",children:Ps(s.verification.receivedAmount,s.currency)}),e.jsx(_,{align:"left",children:s.hohPhoneNo}),e.jsx(_,{align:"left",children:s.hohPhoneNoAlternative||"-"})]},s.id)}const RI=[{disablePadding:!1,label:"Payment ID",id:"unicef_id",numeric:!1},{disablePadding:!1,label:"Verification Channel",id:"payment_verification_plan__verification_channel",numeric:!1},{disablePadding:!1,label:"Verification Plan Id",id:"payment_verification_plan__unicef_id",numeric:!1},{disablePadding:!1,label:"Verification Status",id:"status",numeric:!1},{disablePadding:!1,label:"Head of Household",id:"payment_record__head_of_household__family_name",numeric:!1},{disablePadding:!1,label:"Household ID",id:"payment_record__household__unicef_id",numeric:!1},{disablePadding:!1,label:"Delivered",id:"payment_record__delivered_quantity",numeric:!0},{disablePadding:!1,label:"Received",id:"received_amount",numeric:!0},{disablePadding:!1,label:"Phone #",id:"payment_record__head_of_household__phone_no",numeric:!1},{disablePadding:!1,label:"Alt. Phone #",id:"payment_record__head_of_household__phone_no_alternative",numeric:!1}];function FI({paymentPlanId:s,filter:t,canViewRecordDetails:a,businessArea:n}){const{t:i}=M(),{programId:r}=U(),l=A.useMemo(()=>({...t,businessAreaSlug:n,programSlug:r,paymentVerificationPk:s}),[t,n,r,s]),[o,d]=A.useState(l),[c,u]=A.useState(0),{data:h}=V({queryKey:["businessAreasProgramsPaymentVerificationsVerificationsCount",o,n,r,s],queryFn:()=>N.restBusinessAreasProgramsPaymentVerificationsVerificationsCountRetrieve({businessAreaSlug:n,programSlug:r,paymentVerificationPk:s,...o}),enabled:c===0}),m=vs(c,h);A.useEffect(()=>{d(l)},[l]);const{data:g,isLoading:x,error:f}=V({queryKey:["businessAreasProgramsPaymentVerificationsVerificationsList",o,n,r,s],queryFn:()=>N.restBusinessAreasProgramsPaymentVerificationsVerificationsList(Ce({businessAreaSlug:n,programSlug:r,paymentVerificationPk:s},o,{withPagination:!0}))}),{selectedProgram:j}=Z(),y=j?.beneficiaryGroup,C=$s(RI,y,{payment_record__head_of_household__family_name:v=>`Head of ${v?.groupLabel}`,payment_record__household__unicef_id:v=>`${v?.groupLabel} ID`});return e.jsx(ds,{title:i("Verification Records"),headCells:C,isLoading:x,error:f,queryVariables:o,setQueryVariables:d,data:g,page:c,setPage:u,itemsCount:m,renderRow:v=>e.jsx(TI,{payment:v,canViewRecordDetails:a,paymentPlanId:s,showStatusColumn:!1},v.id)})}function NI({filter:s,verifications:t,setFilter:a,initialFilter:n,appliedFilter:i,setAppliedFilter:r}){const{t:l}=M(),o=ge(),d=je(),{handleFilterChange:c,applyFilterChanges:u,clearFilter:h}=Ss(n,o,d,s,a,i,r),m=()=>{u()},g=()=>{h()},{data:x}=V({queryKey:["verificationStatusChoices"],queryFn:()=>N.restChoicesPaymentVerificationStatusList()}),f=[{name:"Manual",value:"MANUAL"},{name:"RapidPro",value:"RAPIDPRO"},{name:"XLSX",value:"XLSX"}];if(!x)return null;const j=t.map(y=>e.jsx(de,{value:y.id,children:y.unicefId},y.unicefId));return e.jsx(Ns,{applyHandler:m,clearHandler:g,children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:3,children:e.jsx(Cs,{value:s.search,label:l("Search"),onChange:y=>c("search",y.target.value),"data-cy":"filters-search",fullWidth:!0})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:y=>c("verificationStatus",y.target.value),label:l("Verification Status"),value:s.verificationStatus,fullWidth:!0,children:x.map(y=>e.jsx(de,{value:y.value,children:y.name},y.value))})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:y=>c("verificationChannel",y.target.value),label:l("Verification Channel"),value:s.verificationChannel,children:f.map(y=>e.jsx(de,{value:y.value,children:y.name},y.value))})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:y=>c("verificationPlanId",y.target.value),label:l("Verification Plan Id"),value:s.verificationPlanId,children:j})})]})})}const Nd=T.div`
  display: flex;
  flex: 1;
  width: 100%;
  background-color: #fff;
  padding: 32px 44px;
  flex-direction: column;
  border-color: #b1b1b5;
  border-bottom-width: 1px;
  border-bottom-style: solid;
`,Ld=T.div`
  color: rgba(0, 0, 0, 0.38);
  font-size: 24px;
  line-height: 28px;
  text-align: center;
  padding: 70px;
`,Dr={search:void 0,status:"",verificationChannel:void 0,paymentVerificationPlan:""};function LI(){const{t:s}=M(),t=ge(),a=ve(),{paymentPlanId:n}=ts(),{baseUrl:i,businessArea:r,isAllPrograms:l,programId:o}=U(),d=je(),[c,u]=A.useState(Ke(d,Dr)),[h,m]=A.useState(Ke(d,Dr)),[g,x]=A.useState(!1),f=A.useRef(null);et(f,g,h,()=>x(!1));const{data:j,isLoading:y,error:b}=V({queryKey:["PaymentVerificationPlanDetails",r,n,o],queryFn:()=>N.restBusinessAreasProgramsPaymentVerificationsRetrieve({businessAreaSlug:r,id:n,programSlug:o})}),{data:C,isLoading:v}=V({queryKey:["samplingChoices",r],queryFn:()=>N.restChoicesPaymentVerificationPlanSamplingList()}),{isSocialDctType:S}=Z();if(y||v)return e.jsx(Ne,{});if(rt(b))return e.jsx(Xe,{permission:R.PAYMENT_VERIFICATION_VIEW_DETAILS});if(!j||!C||a===null)return null;const I=[{title:"Payment Verification",to:`/${i}/payment-verification`}],E=K(R.PAYMENT_VERIFICATION_CREATE,a),D=j.paymentVerificationPlans?.map(Y=>Y.status),F=()=>(D.includes(rn.FINISHED)||D.includes(rn.ACTIVE))&&D.length>0,w=()=>D.length===0,O=()=>!F()&&!w(),k=j?.paymentVerificationSummary?.status==="FINISHED",{isFollowUp:$}=j,G=e.jsx(Ze,{handleBack:()=>t(`/${i}/payment-verification`),title:e.jsxs(me,{"data-cy":"plan-link",to:`/${i}/payment-module/${$?"followup-payment-plans":"payment-plans"}/${j.id}`,fullWidth:!0,children:[s("Payment Plan")," ",e.jsx("span",{"data-cy":"plan-id",children:j.unicefId})]}),breadCrumbs:K(R.PAYMENT_VERIFICATION_VIEW_LIST,a)?I:null,children:e.jsxs(e.Fragment,{children:[E&&e.jsx(ZS,{cashOrPaymentPlanId:j.id,canCreatePaymentVerificationPlan:j.canCreatePaymentVerificationPlan,isPaymentPlan:!0}),k&&(l?e.jsx(H,{variant:"contained",color:"primary",component:ys,to:`/${i}/grievance/payment-verification/${Ea(j.id)}`,children:s("View Tickets")}):null)]})}),W=()=>S?e.jsx(bI,{paymentPlanId:j.id,filter:h,businessArea:r,canViewRecordDetails:K(R.PAYMENT_VERIFICATION_VIEW_PAYMENT_RECORD_DETAILS,a)}):e.jsx(FI,{paymentPlanId:j.id,filter:h,businessArea:r,canViewRecordDetails:K(R.PAYMENT_VERIFICATION_VIEW_PAYMENT_RECORD_DETAILS,a)});return e.jsxs(e.Fragment,{children:[G,e.jsx(Nd,{children:e.jsx(wS,{planNode:j})}),e.jsx(Nd,{children:e.jsx(xI,{planNode:j})}),j.paymentVerificationPlans?.length?j.paymentVerificationPlans.map(Y=>e.jsx(gI,{verificationPlan:Y,paymentPlanNode:j},Y.id)):null,F()?e.jsxs(e.Fragment,{children:[e.jsx(NI,{filter:c,setFilter:u,initialFilter:Dr,appliedFilter:h,setAppliedFilter:Y=>{m(Y),x(!0)},verifications:j.paymentVerificationPlans}),e.jsx("div",{ref:f,children:e.jsx(Es,{children:W()})})]}):null,O()?e.jsx(Ld,{children:s("To see more details please activate Verification Plan")}):null,w()?e.jsx(Ld,{children:s("To see more details please create Verification Plan")}):null,j.paymentVerificationPlans?.[0]?.id&&K(R.ACTIVITY_LOG_VIEW,a)&&e.jsx(DI,{objectId:j.id})]})}const OI=oe(LI,"PaymentPlanVerificationDetailsPage"),kI=({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})=>{const r=ge(),l=je(),{handleFilterChange:o,applyFilterChanges:d,clearFilter:c}=Ss(a,r,l,s,t,n,i),u=()=>{d()},h=()=>{c()},{data:m}=V({queryKey:["choicesPaymentVerificationSummaryStatusList"],queryFn:()=>N.restChoicesPaymentVerificationSummaryStatusList()}),{data:g}=V({queryKey:["choicesPaymentRecordDeliveryTypeList"],queryFn:()=>N.restChoicesPaymentRecordDeliveryTypeList()});return!m||!g?null:e.jsx(Ns,{applyHandler:u,clearHandler:h,children:e.jsxs(p,{container:!0,alignItems:"flex-start",spacing:3,children:[e.jsx(p,{size:3,children:e.jsx(Cs,{value:s.search,"data-cy":"filter-search",label:"Payment Plan ID",onChange:x=>o("search",x.target.value),fullWidth:!0})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:x=>o("paymentVerificationSummaryStatus",x.target.value),label:"Status",multiple:!0,fullWidth:!0,"data-cy":"filter-status",value:s.paymentVerificationSummaryStatus,children:m.map(x=>e.jsx(de,{value:x.value,children:x.name},x.value))})}),e.jsx(p,{size:3,children:e.jsx(Cs,{value:s.serviceProvider,"data-cy":"filter-fsp",label:"FSP",fullWidth:!0,onChange:x=>o("serviceProvider",x.target.value)})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:x=>o("deliveryTypes",x.target.value),label:"Delivery Mechanism","data-cy":"filter-Modality",multiple:!0,value:s.deliveryTypes,fullWidth:!0,icon:e.jsx(Gm,{}),children:g.map(x=>e.jsx(de,{value:x.value,children:x.name},x.name))})}),e.jsx(p,{size:3,children:e.jsx(ms,{label:"Start Date",fullWidth:!0,dataCy:"filter-start-date",onChange:x=>o("startDate",x),value:s.startDate})}),e.jsx(p,{size:3,children:e.jsx(ms,{label:"End Date",fullWidth:!0,dataCy:"filter-end-date",onChange:x=>o("endDate",x),value:s.endDate})})]})})},wI=oe(kI,"PaymentVerificationFilters"),MI=[{disablePadding:!1,label:"Payment Plan ID",id:"unicefId",numeric:!1,dataCy:"unicefId"},{disablePadding:!1,label:"Verification Status",id:"verificationStatus",numeric:!1,dataCy:"verificationStatus"},{disablePadding:!1,label:"Total Amount",id:"totalDeliveredQuantity",numeric:!0,dataCy:"totalDeliveredQuantity"},{disablePadding:!1,label:"Payment Disbursement Dates",id:"timeframe",numeric:!1,dataCy:"startDate"},{disablePadding:!1,label:"Programme Cycle Title",id:"cycleTitle",numeric:!1,dataCy:"cycleTitle"},{disablePadding:!1,label:"Last Modified Date",id:"updatedAt",numeric:!1,dataCy:"updatedAt"}];function $I({plan:s,canViewDetails:t}){const a=ge(),{baseUrl:n}=U(),i=`/${n}/payment-verification/payment-plan/${s.id}`,r=()=>{a(i)};return e.jsxs(rs,{hover:!0,onClick:t?r:void 0,role:"checkbox","data-cy":"cash-plan-table-row",children:[e.jsx(_,{align:"left",children:t?e.jsx(me,{to:i,children:s.unicefId}):s.unicefId}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s?.verificationStatus,statusToColor:El})}),e.jsx(_,{align:"right",children:Ps(s.totalDeliveredQuantity,s.currency)}),e.jsxs(_,{align:"left",children:[e.jsx(pe,{children:s.dispersionStartDate})," -"," ",e.jsx(pe,{children:s.dispersionEndDate})]}),e.jsx(_,{align:"left","data-cy":"cycle-title",children:s?.programCycleTitle||"-"}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.updatedAt})})]},s.id)}function UI({filter:s,canViewDetails:t,businessArea:a}){const[n,i]=A.useState(0),{t:r}=M(),{programId:l}=U(),o=A.useMemo(()=>({programSlug:l,businessAreaSlug:a,search:s.search,paymentVerificationSummaryStatus:s.paymentVerificationSummaryStatus,fsp:s.serviceProvider,deliveryMechanism:s.deliveryTypes,startDate:s.startDate,endDate:s.endDate,isPaymentPlan:!0}),[l,a,s.search,s.paymentVerificationSummaryStatus,s.serviceProvider,s.deliveryTypes,s.startDate,s.endDate]),[d,c]=A.useState(o);A.useEffect(()=>{c(o)},[o]);const{data:u}=V({queryKey:["businessAreasProgramsHouseholdsCount",l,a,d],queryFn:()=>N.restBusinessAreasProgramsPaymentVerificationsCountRetrieve(Ce({businessAreaSlug:a,programSlug:l},d)),enabled:!!a&&!!l&&n===0}),{data:h,isLoading:m,error:g}=V({queryKey:["businessAreasProgramsPaymentPlansList",d,a,l],queryFn:()=>N.restBusinessAreasProgramsPaymentVerificationsList(Ce({businessAreaSlug:a,programSlug:l},d,{withPagination:!0}))}),x=vs(n,u);return e.jsx(ds,{title:r("List of Payment Plans"),headCells:MI,data:h,isLoading:m,error:g,queryVariables:d,setQueryVariables:c,page:n,setPage:i,itemsCount:x,renderRow:f=>e.jsx($I,{plan:f,canViewDetails:t},f.id)})}const VI=oe(UI,"PaymentVerificationTable"),Tr={status:[te.FINISHED,te.ACCEPTED],search:"",paymentVerificationSummaryStatus:[],serviceProvider:"",deliveryTypes:[],startDate:"",endDate:""};function BI(){const{t:s}=M(),{businessArea:t}=U(),a=ve(),n=je(),[i,r]=A.useState(Ke(n,Tr)),[l,o]=A.useState(Ke(n,Tr)),[d,c]=A.useState(!1),u=A.useRef(null);return et(u,d,l,()=>c(!1)),a===null?null:K(R.PAYMENT_VERIFICATION_VIEW_LIST,a)?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:s("Payment Verification")}),e.jsx(wI,{filter:i,setFilter:r,initialFilter:Tr,appliedFilter:l,setAppliedFilter:h=>{o(h),c(!0)}}),e.jsx("div",{ref:u,children:e.jsx(Es,{children:e.jsx(VI,{filter:l,businessArea:t,canViewDetails:K(R.PAYMENT_VERIFICATION_VIEW_DETAILS,a)})})})]}):e.jsx(Xe,{permission:R.PAYMENT_VERIFICATION_VIEW_LIST})}const GI=oe(BI,"PaymentVerificationPage"),zI=({household:s})=>{const{t}=M(),{selectedProgram:a}=Z(),n=a?.beneficiaryGroup;return e.jsxs(ra,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:n?.groupLabel})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:`${n?.groupLabel} ID`,value:s.unicefId})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:`HEAD OF ${n?.groupLabel}`,value:s.headOfHousehold.fullName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("TOTAL PERSON COVERED"),value:Qe(s.size)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("PHONE NUMBER"),value:Kt(s.headOfHousehold.phoneNo,s.headOfHousehold.phoneNoValid)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("ALT. PHONE NUMBER"),value:Kt(s.headOfHousehold.phoneNoAlternative,s.headOfHousehold.phoneNoAlternativeValid)})})]})]})},qI=({individual:s})=>{const{t}=M(),{selectedProgram:a}=Z(),n=a?.beneficiaryGroup;return e.jsxs(ra,{children:[e.jsxs(Ie,{children:[e.jsx(ee,{variant:"h6",children:t(`${n?.memberLabel}`)})," "]}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t(`${n?.memberLabel.toUpperCase()} ID`),value:s.unicefId})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t(`${n?.memberLabel.toUpperCase()} ID`),value:s.fullName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("PHONE NUMBER"),value:Kt(s.phoneNo,s.phoneNoValid)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("ALT. PHONE NUMBER"),value:Kt(s.phoneNoAlternative,s.phoneNoAlternativeValid)})})]})]})};function HI({payment:s,canViewActivityLog:t}){const{t:a}=M(),{isSocialDctType:n}=Z();return e.jsxs(e.Fragment,{children:[e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Payment Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("STATUS"),children:e.jsx(we,{status:s.status,statusToColor:Na,statusNameMapping:Ya})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("TARGET POPULATION"),value:s.parent.name})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("DISTRIBUTION MODALITY"),value:s.parent?.deliveryMechanism?.name})})]})]}),e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Verification Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("STATUS"),children:e.jsx(we,{status:s.verification.status,statusToColor:$n})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("AMOUNT RECEIVED"),value:Ps(s.verification.receivedAmount,s.currency)})})]})]}),n?e.jsx(qI,{individual:s.household.headOfHousehold}):e.jsx(zI,{household:s.household}),e.jsxs(ra,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Entitlement Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("ENTITLEMENT QUANTITY"),value:Qe(s.entitlementQuantity)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("DELIVERED QUANTITY"),value:Qe(s.deliveredQuantity)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("CURRENCY"),value:s.currency})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("DELIVERY TYPE"),value:s.deliveryMechanism?.name})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("DELIVERY DATE"),value:e.jsx(pe,{children:s.deliveryDate})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("FSP"),value:s.fspName})})]})]}),t&&e.jsx(Lt,{objectId:s.parent.paymentVerificationPlans[0].id})]})}function WI({paymentVerificationId:s,status:t,enabled:a,receivedAmount:n,verificationPlanId:i,paymentId:r,paymentPlanId:l}){const{t:o}=M(),[d,c]=A.useState(!1),{showMessage:u}=Ae(),h=Fe(),{programSlug:m,businessAreaSlug:g}=U(),x=xe({mutationFn:y=>N.restBusinessAreasProgramsPaymentVerificationsVerificationsPartialUpdate({businessAreaSlug:g,id:r,programSlug:m,paymentVerificationPk:i,requestBody:y}),onSuccess:()=>{h.invalidateQueries({queryKey:["payment",g,r,m,l]})}}),f=async y=>{try{await x.mutateAsync({received:y.status==="RECEIVED",receivedAmount:y.status==="RECEIVED"?parseFloat(y.receivedAmount):0}),c(!1),u(o("Payment has been verified."))}catch(b){fe(b,u)}},j={paymentVerificationId:s,status:"RECEIVED",receivedAmount:n??0};return e.jsx(B.Formik,{initialValues:j,onSubmit:f,children:({values:y})=>e.jsxs(B.Form,{children:[d&&e.jsx(Bs,{}),e.jsx(P,{p:2,children:e.jsx(H,{color:"primary",variant:"contained",onClick:()=>c(!0),"data-cy":"button-ed-plan",disabled:!a,children:o(t==="PENDING"?"Verify":"Edit")})}),e.jsxs(Ks,{open:d,onClose:()=>c(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md",children:[e.jsx(Ye,{children:e.jsx(Le,{children:o("Verify Payment")})}),e.jsx(Be,{children:e.jsx(zs,{children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"status",label:"Status",style:{flexDirection:"row"},choices:[{value:"RECEIVED",name:o("Received"),dataCy:"choice-received"},{value:"NOT_RECEIVED",name:o("Not Received"),dataCy:"choice-not-received"}],component:ea})}),e.jsx(p,{size:{xs:6},children:y.status==="RECEIVED"&&e.jsx(B.Field,{name:"receivedAmount",type:"number",label:o("Amount Received"),color:"primary",component:Se})})]})})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>c(!1),children:o("CANCEL")}),e.jsx(H,{type:"submit",color:"primary",variant:"contained",onClick:()=>f(y),"data-cy":"button-submit",children:o("Verify")})]})})]})]})})}function KI(){const{t:s}=M(),{businessArea:t,programId:a}=U(),{paymentPlanId:n,id:i}=ts(),r=ve(),{data:l,isLoading:o,error:d}=V({queryKey:["payment",t,i,a,n],queryFn:()=>N.restBusinessAreasProgramsPaymentVerificationsVerificationsRetrieve({businessAreaSlug:t,paymentVerificationPk:n,id:i,programSlug:a})}),{baseUrl:c}=U();if(o)return e.jsx(Ne,{});if(rt(d))return e.jsx(Xe,{permission:R.PAYMENT_VERIFICATION_VIEW_DETAILS});if(!l||r===null)return null;const{paymentVerificationPlans:u}=l?.parent||{},h=u?.length,m=u[h-1],g=[...K(R.PAYMENT_VERIFICATION_VIEW_LIST,r)?[{title:s("Payment Verification"),to:`/${c}/payment-verification`}]:[],...K(R.PAYMENT_VERIFICATION_VIEW_DETAILS,r)?[{title:`${s("Payment Plan")} ${l.parent?.unicefId}`,to:`/${c}/payment-verification/payment-plan/${l.parent?.id}`}]:[]],x=e.jsx(Ze,{title:`${s("Payment ID")} ${l.unicefId}`,breadCrumbs:g,flags:e.jsx(gt,{adminUrl:l.verification?.adminUrl}),children:m?.verificationChannel==="MANUAL"&&K(R.PAYMENT_VERIFICATION_VERIFY,r)&&m?.status!==rn.FINISHED?e.jsx(WI,{paymentVerificationId:l.verification?.id,status:l.verification?.status,enabled:l.verification?.isManuallyEditable,receivedAmount:l.verification?.receivedAmount,paymentId:l?.id,paymentPlanId:n,verificationPlanId:n}):null});return e.jsxs(e.Fragment,{children:[x,e.jsx(HI,{payment:l,canViewActivityLog:K(R.ACTIVITY_LOG_VIEW,r)})]})}const YI=oe(KI,"VerificationPaymentDetailsPage"),QI=()=>oa([{path:"payment-verification",element:e.jsx(GI,{})},{path:"payment-verification/payment-plan/:paymentPlanId",element:e.jsx(OI,{})},{path:"payment-verification/payment-plan/:paymentPlanId/verification/payment/:id",element:e.jsx(YI,{})}]),XI=T.div`
  color: ${({theme:s})=>s.palette.error.dark};
  padding: 20px;
`,JI=T(Ka)`
  color: #fff;
`,ZI=T(Ka)`
  color: #fff;
  opacity: 0.5;
`,eD=()=>{const{showMessage:s}=Ae(),{businessArea:t,programId:a}=U(),n=ve(),[i,r]=A.useState(!1),[l,o]=A.useState(!1),[d,c]=A.useState(null),{isActiveProgram:u}=Z(),{t:h}=M(),[m,g]=A.useState(null),x=K(R.PDU_UPLOAD,n),f=Fe(),j=async()=>{if(d){o(!0),g(null);try{await N.restBusinessAreasProgramsPeriodicDataUpdateUploadsUploadCreate({businessAreaSlug:t,programSlug:a,formData:{file:d}}),s(h("File uploaded successfully")),f.invalidateQueries({queryKey:["periodicDataUpdateUploads",{ordering:"created_at",businessAreaSlug:t,programSlug:a},t,a,0]}),f.invalidateQueries({queryKey:["periodicDataUpdateUploadsCount"],refetchType:"active"}),r(!1),c(null)}catch(b){g(b),s(b?b.toString():h("Error uploading file"))}finally{o(!1)}}};let y=null;return m&&(y=e.jsxs(XI,{"data-cy":"pdu-upload-error",children:[h("Error uploading file:")," ",m.message||m.toString()]})),e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsx(Vs,{variant:"contained",startIcon:u?e.jsx(JI,{}):e.jsx(ZI,{}),color:"primary",dataCy:"button-import",onClick:()=>r(!0),disabled:!u||!x,"data-perm":R.PDU_UPLOAD,children:h("Upload Data")})},"import"),e.jsx(is,{open:i,onClose:()=>r(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:e.jsxs(Ye,{"data-cy":"dialog-import",children:[e.jsx(Le,{children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[h("Select Files to Upload"),e.jsx(it,{children:h("The system accepts the following file extensions: XLSX. File size must be ≤ 10MB.")})]})}),e.jsxs(e.Fragment,{children:[e.jsx(pn,{dontShowFilename:!1,loading:l,onChange:b=>{if(b.length===0)return;const C=b[0],v=C.size/(1024*1024);if(v>200){s(`File size is too big. It should be under 200MB, File size is ${v}MB`);return}c(C)}}),y]}),e.jsxs(os,{children:[e.jsx(H,{"data-cy":"close-button",onClick:()=>{r(!1),c(null)},children:h("CANCEL")}),e.jsx(ke,{loading:l,disabled:!d,type:"submit",color:"primary",variant:"contained",onClick:j,"data-cy":"button-import-submit",children:h("IMPORT")})]})]})})]})},sD=({open:s,onClose:t,template:a})=>{const{t:n}=M(),{businessArea:i,programId:r}=U(),{data:l,isLoading:o}=V({queryKey:["PDUXlsxTemplateDetails",i,r,a.id],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateTemplatesRetrieve({businessAreaSlug:i,id:a.id,programSlug:r})}),{data:d,isLoading:c}=V({queryKey:["periodicFields",i,r],queryFn:()=>N.restBusinessAreasProgramsPeriodicFieldsList({businessAreaSlug:i,programSlug:r})}),u=Hs(d?.results,"name","*");return o||c||!u?e.jsx(Ne,{}):e.jsxs(is,{open:s,onClose:t,scroll:"paper","data-cy":"periodic-data-update-detail",children:[e.jsx(Le,{children:n("Periodic Data Updates")}),e.jsxs(Be,{children:[e.jsx(L,{label:n("Template Id"),children:a.id}),l&&e.jsxs(gs,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{children:n("Field")}),e.jsx(_,{children:n("Round Number")}),e.jsx(_,{children:n("Round Name")}),e.jsx(_,{children:n("Number of individuals")})]})}),e.jsx(cs,{children:l?.roundsData?.map((h,m)=>e.jsxs(be,{children:[e.jsx(_,{"data-cy":`template-field-${m}`,children:typeof u[h.field]?.label=="object"?u[h.field]?.label.englishEn||h.field:u[h.field]?.label||h.field}),e.jsx(_,{"data-cy":`template-round-number-${m}`,children:h.round}),e.jsx(_,{"data-cy":`template-round-name-${m}`,children:h.roundName}),e.jsx(_,{"data-cy":`template-number-of-individuals-${m}`,children:h.numberOfRecords})]},m))})]})]}),e.jsx(os,{children:e.jsx(H,{onClick:t,children:n("Close")})})]})},tD=()=>{const s=Fe();return xe({mutationFn:({businessAreaSlug:t,programSlug:a,templateId:n})=>N.restBusinessAreasProgramsPeriodicDataUpdateTemplatesExportCreate({businessAreaSlug:t,programSlug:a,id:n}),onSuccess:()=>{s.invalidateQueries({queryKey:["periodicDataUpdateTemplates"]})}})},aD=()=>{const s=Fe();return xe({mutationFn:({businessAreaSlug:t,programSlug:a,requestBody:n})=>N.restBusinessAreasProgramsPeriodicDataUpdateTemplatesCreate({businessAreaSlug:t,programSlug:a,requestBody:n}),onSuccess:()=>{s.invalidateQueries({queryKey:["periodicDataUpdateUploads"]})}})},nD=[{id:"id",numeric:!1,disablePadding:!1,label:"ID",dataCy:"head-cell-template-id"},{id:"name",numeric:!1,disablePadding:!1,label:"Name",dataCy:"head-cell-template-name"},{id:"number_of_records",numeric:!0,disablePadding:!1,label:"Number of Records",dataCy:"head-cell-number-of-records"},{id:"created_at",numeric:!1,disablePadding:!1,label:"Creation Date",dataCy:"head-cell-created-at"},{id:"created_by",numeric:!1,disablePadding:!1,label:"Created by",dataCy:"head-cell-created-by"},{id:"details",numeric:!1,disablePadding:!1,label:"Details",disableSort:!0,dataCy:"head-cell-details"},{id:"status",numeric:!1,disablePadding:!1,label:"Status",dataCy:"head-cell-status"},{id:"empty",numeric:!1,disablePadding:!1,label:"",disableSort:!0,dataCy:"head-cell-empty"}],iD=()=>{const[s,t]=A.useState(0),{t:a}=M(),{businessArea:n,programId:i}=U(),{data:r}=V({queryKey:["periodicDataUpdateTemplatesCount",n,i],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateTemplatesCountRetrieve({businessAreaSlug:n,programSlug:i}),enabled:!!n&&!!i&&s===0}),[l,o]=A.useState(!1),d=ve(),[c,u]=A.useState(null),{mutate:h,error:m}=tD(),{showMessage:g}=Ae();A.useEffect(()=>{if(m){const O=m?.data?.error||m.message;g(O)}},[m,g]);const x=O=>{h({businessAreaSlug:n,programSlug:i,templateId:O})},f=O=>{u(O.id),o(!0)},j=()=>{o(!1),u(null)},y=A.useMemo(()=>({ordering:"-created_at",businessAreaSlug:n,programSlug:i}),[n,i]),[b,C]=A.useState(y);A.useEffect(()=>{C(y)},[y]);const{data:v,isLoading:S,error:I}=V({queryKey:["periodicDataUpdateTemplates",b,n,i],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateTemplatesList(Ce({businessAreaSlug:n,programSlug:i},b,{withPagination:!0}))}),E=v?.results?.find(O=>O.id===c),D=K(R.PDU_TEMPLATE_DOWNLOAD,d),F=vs(s,r),w=O=>e.jsxs(rs,{"data-cy":`template-row-${O.id}`,children:[e.jsx(_,{"data-cy":`template-id-${O.id}`,children:e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsx(P,{mr:2,children:O.id})," ",e.jsx(gt,{adminUrl:O.adminUrl})]})}),e.jsx(_,{"data-cy":`template-name-${O.id}`,children:O.name}),e.jsx(_,{"data-cy":`template-records-${O.id}`,align:"right",children:O.numberOfRecords}),e.jsx(_,{"data-cy":`template-created-at-${O.id}`,children:e.jsx(pe,{children:O.createdAt})}),e.jsx(_,{"data-cy":`template-created-by-${O.id}`,children:O.createdBy}),e.jsx(_,{"data-cy":`template-details-btn-${O.id}`,children:e.jsx(Ve,{color:"primary",onClick:()=>f(O),children:e.jsx(xl,{})})}),e.jsx(_,{"data-cy":`template-status-${O.id}`,children:e.jsx(we,{status:O.status,statusDisplay:O.statusDisplay,statusToColor:Ip})}),e.jsx(_,{"data-cy":`template-action-${O.id}`,children:O.status==="EXPORTED"?e.jsx(Ms,{title:O?.numberOfRecords===0?a("There are no records available"):"",children:e.jsx("span",{children:e.jsx(Vs,{variant:"contained",color:"primary",startIcon:e.jsx(Ca,{}),"data-cy":`download-btn-${O.id}`,href:`/api/rest/business-areas/${n}/programs/${i}/periodic-data-update-templates/${O.id}/download/`,disabled:O?.numberOfRecords===0||!D,dataPerm:R.PDU_TEMPLATE_DOWNLOAD,children:"Download"})})}):O.canExport?e.jsx(Vs,{variant:"contained",color:"primary",onClick:()=>x(O.id),startIcon:e.jsx(zm,{}),"data-cy":`export-btn-${O.id}`,disabled:!D,dataPerm:R.PDU_TEMPLATE_DOWNLOAD,children:"Export"}):null})]},O.id);return e.jsxs(e.Fragment,{children:[e.jsx(ds,{itemsCount:F,isOnPaper:!0,noEmptyMessage:!0,renderRow:w,headCells:nD,data:v??{},isLoading:S,error:I,queryVariables:b,setQueryVariables:C,page:s,setPage:t}),E&&e.jsx(sD,{open:l,onClose:j,template:E})]})},rD=({formErrors:s})=>!s||!s.length?null:e.jsx("div",{children:s.map((t,a)=>e.jsxs("div",{"data-cy":"pdu-form-errors",children:[e.jsxs("h3",{children:["Row: ",t.row]}),e.jsx("ul",{children:Object.entries(t.errors).map(([n,i],r)=>e.jsxs("li",{children:[e.jsx("strong",{children:n}),i.map((l,o)=>e.jsx("div",{style:{color:"red"},children:l.message},o))]},r))})]},a))}),lD=({nonFormErrors:s})=>{const t=s;return!t||!t.length?null:e.jsx("div",{children:t.map((a,n)=>e.jsx("p",{style:{color:"red"},children:a},n))})},oD=({open:s,onClose:t,uploadId:a})=>{const{t:n}=M(),{businessArea:i,programId:r}=U(),{data:l,isLoading:o}=V({queryKey:["periodicDataUpdateUploadDetails",i,r,a],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateUploadsRetrieve({businessAreaSlug:i,programSlug:r,id:a}),enabled:!!a});return o?e.jsx(Ne,{}):e.jsxs(is,{open:s,onClose:t,scroll:"paper",children:[e.jsx(Le,{children:n("Periodic Data Updates Errors")}),e.jsx(Be,{children:l?.errorsInfo?e.jsxs(e.Fragment,{children:[e.jsx(lD,{nonFormErrors:l?.errorsInfo?.nonFormErrors}),e.jsx(rD,{formErrors:l?.errorsInfo?.formErrors})]}):e.jsx(ee,{children:"No errors to display."})}),e.jsx(os,{children:e.jsx(H,{onClick:t,children:n("Close")})})]})},dD=[{id:"id",numeric:!1,disablePadding:!1,label:"Import ID",dataCy:"head-cell-import-id"},{id:"template",numeric:!1,disablePadding:!1,label:"Template ID",dataCy:"head-cell-template-id"},{id:"created_at",numeric:!1,disablePadding:!1,label:"Import Date",dataCy:"head-cell-import-date"},{id:"created_by",numeric:!1,disablePadding:!1,label:"Imported by",dataCy:"head-cell-imported-by"},{id:"details",numeric:!1,disablePadding:!1,label:"Details",disableSort:!0,dataCy:"head-cell-details"},{id:"status",numeric:!1,disablePadding:!1,label:"Status",dataCy:"head-cell-status"}],cD=()=>{const{businessArea:s,programId:t}=U(),[a,n]=A.useState(!1),[i,r]=A.useState(null),l=A.useMemo(()=>({ordering:"created_at",businessAreaSlug:s,programSlug:t}),[s,t]),[o,d]=A.useState(l);A.useEffect(()=>{d(l)},[l]);const[c,u]=A.useState(0),{data:h,isLoading:m,error:g}=V({queryKey:["periodicDataUpdateUploads",o,s,t,c],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateUploadsList(Ce({businessAreaSlug:s,programSlug:t},o,{withPagination:!0,rowsPerPage:5}))}),{data:x}=V({queryKey:["periodicDataUpdateUploadsCount",s,t],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateUploadsCountRetrieve({businessAreaSlug:s,programSlug:t}),enabled:!!s&&!!t}),f=C=>{r(C),n(!0)},j=()=>{n(!1),r(null)},y=vs(c,x),b=C=>e.jsxs(rs,{"data-cy":`update-row-${C.id}`,children:[e.jsx(_,{"data-cy":`update-id-${C.id}`,children:C.id}),e.jsx(_,{"data-cy":`update-template-${C.id}`,children:C.template}),e.jsx(_,{"data-cy":`update-created-at-${C.id}`,children:e.jsx(pe,{children:C.createdAt})}),e.jsx(_,{"data-cy":`update-created-by-${C.id}`,children:C.createdBy}),e.jsx(_,{"data-cy":`update-details-${C.id}`,children:C.status==="FAILED"?e.jsx(Ve,{"data-cy":`update-details-btn-${C.id}`,color:"primary",onClick:()=>f(C.id),children:e.jsx(xl,{})}):null}),e.jsx(_,{"data-cy":`update-status-${C.id}`,children:e.jsx(we,{status:C.status,statusToColor:Dp,statusDisplay:C.statusDisplay})})]},C.id);return e.jsxs(e.Fragment,{children:[i&&e.jsx(oD,{open:a,onClose:j,uploadId:i}),e.jsx(ds,{isOnPaper:!0,noEmptyMessage:!0,renderRow:b,headCells:dD,data:h??{},isLoading:m,error:g,queryVariables:o,setQueryVariables:d,itemsCount:y,page:c,setPage:u})]})},uD=[{id:"id",numeric:!1,disablePadding:!1,label:"Template ID",dataCy:"head-cell-id"},{id:"name",numeric:!1,disablePadding:!1,label:"Name",dataCy:"head-cell-name"},{id:"numberOfRecords",numeric:!0,disablePadding:!1,label:"Number of Records",dataCy:"head-cell-number-of-records"},{id:"createdAt",numeric:!1,disablePadding:!1,label:"Creation Date",dataCy:"head-cell-creation-date"},{id:"createdBy",numeric:!1,disablePadding:!1,label:"Created by",dataCy:"head-cell-created-by"},{id:"status",numeric:!1,disablePadding:!1,label:"Status",dataCy:"head-cell-status"},{id:"empty",numeric:!1,disablePadding:!1,label:"",dataCy:"head-cell-empty"}],hD=()=>{const{baseUrl:s}=U(),{t}=M(),{businessArea:a,programId:n}=U(),{isSocialDctType:i}=Z(),r=ve(),l=K(R.PDU_TEMPLATE_CREATE,r),o=i?`/${s}/population/people/new-online-template`:`/${s}/population/individuals/new-online-template`,d=A.useMemo(()=>({businessAreaSlug:a,programSlug:n,ordering:"-created_at",status:["NEW"]}),[a,n]),[c,u]=A.useState(d);A.useEffect(()=>{u(d)},[d]);const{data:h,isLoading:m,error:g}=V({queryKey:["periodicDataUpdateOnlineEdits",c,a,n],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsList({businessAreaSlug:a,programSlug:n,ordering:c.ordering,status:c.status}),enabled:!!c.businessAreaSlug&&!!c.programSlug}),[x,f]=A.useState(0),j=ge(),y=b=>{const C=`/${s}/population/individuals/online-templates/${b.id}`;return e.jsxs(rs,{"data-cy":`online-edit-row-${b.id}`,onClick:()=>j(C),style:{cursor:"pointer"},children:[e.jsx(_,{children:e.jsx(me,{to:`/${s}/population/individuals/online-templates/${b.id}`,"data-cy":`template-id-link-${b.id}`,children:b.id})}),e.jsx(_,{children:b.name}),e.jsx(_,{align:"right",children:b.numberOfRecords}),e.jsx(_,{children:e.jsx(pe,{children:b.createdAt})}),e.jsx(_,{children:b.createdBy}),e.jsx(_,{children:e.jsx(we,{status:b.status,statusDisplay:b.statusDisplay,statusToColor:cn})}),e.jsx(_,{})]},b.id)};return e.jsx(ds,{isOnPaper:!0,noEmptyMessage:!0,renderRow:y,headCells:uD,data:h??[],isLoading:m,error:g,queryVariables:c,setQueryVariables:u,title:"New Periodic Data Updates",page:x,setPage:f,actions:[e.jsx(H,{variant:"contained",color:"primary",startIcon:e.jsx(pa,{}),component:ys,to:o,disabled:!l,"data-perm":R.PDU_TEMPLATE_CREATE,children:t("New Online Edit")},"add-new-online-edit")]})},mD=[{id:"checkbox",numeric:!1,disablePadding:!0,label:"",dataCy:"head-cell-checkbox",disableSort:!0},{id:"id",numeric:!1,disablePadding:!1,label:"Template ID",dataCy:"head-cell-id"},{id:"name",numeric:!1,disablePadding:!1,label:"Template Name",dataCy:"head-cell-name"},{id:"numberOfRecords",numeric:!0,disablePadding:!1,label:"Number of Records",dataCy:"head-cell-number-of-records"},{id:"createdAt",numeric:!1,disablePadding:!1,label:"Creation Date",dataCy:"head-cell-creation-date"},{id:"createdBy",numeric:!1,disablePadding:!1,label:"Created by",dataCy:"head-cell-created-by"},{id:"status",numeric:!1,disablePadding:!1,label:"Status",dataCy:"head-cell-status"}],pD=()=>{const s=Fe(),t=ge(),{t:a}=M(),{showMessage:n}=Ae(),i=ve(),r=K(R.PDU_ONLINE_APPROVE,i),{businessArea:l,programId:o,baseUrl:d}=U(),[c,u]=A.useState([]),[h,m]=A.useState(0),g={ordering:"created_at",businessAreaSlug:l,programSlug:o,status:["READY"]},[x,f]=A.useState(g),{mutateAsync:j}=xe({mutationFn:O=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsBulkApproveCreate({businessAreaSlug:l,programSlug:o,requestBody:{ids:O}}),onSuccess:()=>{n(a("Templates approved successfully.")),u([]),s.invalidateQueries({queryKey:["periodicDataUpdatePendingForApproval",x,l,o]}),s.invalidateQueries({queryKey:["periodicDataUpdatePendingForMerge",{ordering:"created_at",businessAreaSlug:l,programSlug:o,status:["APPROVED"]},l,o]})},onError:O=>{fe(O,n)}}),y=async()=>{const O=c.map(k=>Number(k)).filter(k=>!isNaN(k));await j(O)},{data:b,isLoading:C,error:v}=V({queryKey:["periodicDataUpdatePendingForApproval",x,l,o],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsList({businessAreaSlug:l,programSlug:o,ordering:x.ordering,status:x.status}),enabled:!!x.businessAreaSlug&&!!x.programSlug}),I=(b?.results??[]).filter(O=>O.isAuthorized).map(O=>O.id),E=O=>{if(c.length>0&&c.length<I.length){u([]);return}O.target.checked?u(I):u([])},D=O=>{u(k=>k.includes(O)?k.filter($=>$!==O):[...k,O])},F=O=>e.jsxs(rs,{"data-cy":`pending-approval-row-${O.id}`,onClick:()=>t(`/${d}/population/individuals/online-templates/${O.id}`),style:{cursor:"pointer"},children:[e.jsx(_,{padding:"checkbox",children:O.isAuthorized?e.jsx(ns,{checked:c.includes(O.id),onChange:()=>D(O.id),onClick:k=>k.stopPropagation(),slotProps:{input:{"aria-label":`select row ${O.id}`}}}):e.jsx(Ms,{title:"You are not within authorized users for this Edit",children:e.jsx("span",{children:e.jsx(ns,{checked:c.includes(O.id),disabled:!0,onClick:k=>k.stopPropagation(),slotProps:{input:{"aria-label":`select row ${O.id}`}}})})})}),e.jsx(_,{children:e.jsx(me,{to:`/${d}/population/individuals/online-templates/${O.id}`,children:O.id})}),e.jsx(_,{children:O.name}),e.jsx(_,{children:O.numberOfRecords}),e.jsx(_,{children:e.jsx(pe,{children:O.createdAt})}),e.jsx(_,{children:O.createdBy}),e.jsx(_,{children:e.jsx(we,{status:O.status,statusDisplay:O.statusDisplay,statusToColor:cn})})]},O.id),w=({headCells:O})=>e.jsx(hs,{children:e.jsx(be,{children:O.map(k=>e.jsx(_,{padding:k.id==="checkbox"?"checkbox":void 0,children:k.id==="checkbox"?e.jsx(ns,{indeterminate:c.length>0&&c.length<I.length,checked:c.length>0&&c.length===I.length,onChange:E,slotProps:{input:{"aria-label":"select all rows"}}}):e.jsx("div",{style:{fontSize:12},children:k.label})},String(k.id)))})});return e.jsx(ds,{isOnPaper:!0,noEmptyMessage:!0,renderRow:F,headCells:mD,data:b??[],isLoading:C,error:v,queryVariables:x,setQueryVariables:f,title:"Periodic Data Updates pending for Approval",numSelected:c.length,customHeadRenderer:w,page:h,setPage:m,actions:r?[e.jsx(H,{variant:"outlined",color:"primary",onClick:y,disabled:c.length===0,sx:{mr:1},"data-perm":R.PDU_ONLINE_APPROVE,children:a("Approve")},"approve-selected")]:[]})},gD=[{id:"checkbox",numeric:!1,disablePadding:!0,label:"",dataCy:"head-cell-checkbox",disableSort:!0},{id:"id",numeric:!1,disablePadding:!1,label:"Template ID",dataCy:"head-cell-id"},{id:"name",numeric:!1,disablePadding:!1,label:"Template Name",dataCy:"head-cell-name"},{id:"numberOfRecords",numeric:!0,disablePadding:!1,label:"Number of Records",dataCy:"head-cell-number-of-records"},{id:"createdAt",numeric:!1,disablePadding:!1,label:"Creation Date",dataCy:"head-cell-creation-date"},{id:"createdBy",numeric:!1,disablePadding:!1,label:"Created by",dataCy:"head-cell-created-by"},{id:"status",numeric:!1,disablePadding:!1,label:"Status",dataCy:"head-cell-status"}],xD=()=>{const{showMessage:s}=Ae(),t=ve(),a=K(R.PDU_ONLINE_MERGE,t),n=Fe(),i=ge(),{businessArea:r,programId:l,baseUrl:o}=U(),[d,c]=A.useState([]),[u,h]=A.useState(0),m={ordering:"created_at",businessAreaSlug:r,programSlug:l,status:["APPROVED"]},[g,x]=A.useState(m),{mutateAsync:f}=xe({mutationFn:w=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsBulkMergeCreate({businessAreaSlug:r,programSlug:l,requestBody:{ids:w}}),onSuccess:()=>{s("Templates merged successfully."),c([]),n.invalidateQueries({queryKey:["periodicDataUpdatePendingForMerge",g,r,l]}),n.invalidateQueries({queryKey:["mergedPeriodicDataUpdates",{ordering:"created_at",businessAreaSlug:r,programSlug:l,status:["MERGED"]},r,l]})},onError:w=>{fe(w,s)}}),j=async()=>{const w=d.map(O=>Number(O)).filter(O=>!isNaN(O));await f(w)},{data:y,isLoading:b,error:C}=V({queryKey:["periodicDataUpdatePendingForMerge",g,r,l],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsList({businessAreaSlug:r,programSlug:l,ordering:g.ordering,status:g.status}),enabled:!!g.businessAreaSlug&&!!g.programSlug}),S=(y?.results??[]).filter(w=>w.isAuthorized).map(w=>w.id),I=w=>{if(d.length>0&&d.length<S.length){c([]);return}w.target.checked?c(S):c([])},E=w=>{c(O=>O.includes(w)?O.filter(k=>k!==w):[...O,w])},D=w=>e.jsxs(rs,{"data-cy":`pending-approval-row-${w.id}`,onClick:()=>i(`/${o}/population/individuals/online-templates/${w.id}`),style:{cursor:"pointer"},children:[e.jsx(_,{padding:"checkbox",onClick:O=>O.stopPropagation(),children:w.isAuthorized?e.jsx(ns,{checked:d.includes(w.id),onChange:O=>{O.stopPropagation(),E(w.id)},slotProps:{input:{"aria-label":`select row ${w.id}`}}}):e.jsx(Ms,{title:"You are not within authorized users for this Edit",children:e.jsx("span",{children:e.jsx(ns,{checked:d.includes(w.id),disabled:!0,slotProps:{input:{"aria-label":`select row ${w.id}`}}})})})}),e.jsx(_,{children:e.jsx(me,{to:`/${o}/population/individuals/online-templates/${w.id}`,"data-cy":`template-id-link-${w.id}`,children:w.id})}),e.jsx(_,{children:w.name}),e.jsx(_,{children:w.numberOfRecords}),e.jsx(_,{children:e.jsx(pe,{children:w.createdAt})}),e.jsx(_,{children:w.createdBy}),e.jsx(_,{children:e.jsx(we,{status:w.status,statusDisplay:w.statusDisplay,statusToColor:cn})})]},w.id),F=({headCells:w})=>e.jsx(hs,{children:e.jsx(be,{children:w.map(O=>e.jsx(_,{padding:O.id==="checkbox"?"checkbox":void 0,children:O.id==="checkbox"?e.jsx(ns,{indeterminate:d.length>0&&d.length<S.length,checked:d.length>0&&d.length===S.length,onChange:I,slotProps:{input:{"aria-label":"select all rows"}}}):e.jsx("div",{style:{fontSize:12},children:O.label})},String(O.id)))})});return e.jsx(ds,{isOnPaper:!0,noEmptyMessage:!0,renderRow:D,headCells:gD,data:y??[],isLoading:b,error:C,queryVariables:g,setQueryVariables:x,title:"Periodic Data Updates pending for Merge",numSelected:d.length,customHeadRenderer:F,page:u,setPage:h,actions:a?[e.jsx(H,{variant:"outlined",color:"primary",onClick:j,disabled:d.length===0,sx:{mr:1},"data-perm":R.PDU_ONLINE_MERGE,children:"Merge"},"merge-selected")]:[]})},fD=[{id:"templateId",numeric:!1,disablePadding:!1,label:"Template ID",dataCy:"head-cell-template-id"},{id:"templateName",numeric:!1,disablePadding:!1,label:"Template Name",dataCy:"head-cell-template-name"},{id:"numberOfRecords",numeric:!0,disablePadding:!1,label:"Number of Records",dataCy:"head-cell-number-of-records"},{id:"createdAt",numeric:!1,disablePadding:!1,label:"Creation Date",dataCy:"head-cell-creation-date"},{id:"createdBy",numeric:!1,disablePadding:!1,label:"Created by",dataCy:"head-cell-created-by"},{id:"status",numeric:!1,disablePadding:!1,label:"Status",dataCy:"head-cell-status"}],yD=()=>{const s=ge(),{businessArea:t,programId:a,baseUrl:n}=U(),i={ordering:"created_at",businessAreaSlug:t,programSlug:a,status:["MERGED"]},[r,l]=A.useState(i),{data:o,isLoading:d,error:c}=V({queryKey:["mergedPeriodicDataUpdates",r,t,a],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsList({businessAreaSlug:t,programSlug:a,ordering:r.ordering,status:r.status}),enabled:!!r.businessAreaSlug&&!!r.programSlug}),[u,h]=A.useState(0),m=g=>e.jsxs(rs,{"data-cy":`merged-row-${g.id}`,onClick:()=>s(`/${n}/population/individuals/online-templates/${g.id}`),style:{cursor:"pointer"},children:[e.jsx(_,{children:e.jsx(me,{to:`/${n}/population/individuals/online-templates/${g.id}`,"data-cy":`template-id-link-${g.id}`,children:g.id})}),e.jsx(_,{children:g.name}),e.jsx(_,{children:g.numberOfRecords}),e.jsx(_,{children:e.jsx(pe,{children:g.createdAt})}),e.jsx(_,{children:g.createdBy}),e.jsx(_,{children:e.jsx(we,{status:g.status,statusDisplay:g.statusDisplay,statusToColor:cn})})]},g.id);return e.jsx(ds,{isOnPaper:!0,noEmptyMessage:!0,renderRow:m,headCells:fD,data:o??[],isLoading:d,error:c,queryVariables:r,setQueryVariables:l,title:"Merged Periodic Data Updates",page:u,setPage:h})},bD=[{id:"templateId",numeric:!1,disablePadding:!1,label:"Template ID",dataCy:"head-cell-template-id"},{id:"templateName",numeric:!1,disablePadding:!1,label:"Template Name",dataCy:"head-cell-template-name"},{id:"numberOfRecords",numeric:!0,disablePadding:!1,label:"Number of Records",dataCy:"head-cell-number-of-records"},{id:"createdAt",numeric:!1,disablePadding:!1,label:"Creation Date",dataCy:"head-cell-creation-date"},{id:"createdBy",numeric:!1,disablePadding:!1,label:"Created by",dataCy:"head-cell-created-by"},{id:"status",numeric:!1,disablePadding:!1,label:"Status",dataCy:"head-cell-status"}],jD=()=>{const s=ge(),{businessArea:t,programId:a,baseUrl:n}=U(),i={ordering:"created_at",businessAreaSlug:t,programSlug:a,status:["CREATING","MERGING","PENDING_CREATE","NOT_SCHEDULED_CREATE","CANCELED_CREATE","NOT_SCHEDULED_MERGE","CANCELED_MERGE","FAILED_MERGE","FAILED_CREATE"]},[r,l]=A.useState(i),{data:o,isLoading:d,error:c}=V({queryKey:["otherPeriodicDataUpdates",r,t,a],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsList({businessAreaSlug:t,programSlug:a,ordering:r.ordering,status:[...r.status]}),enabled:!!r.businessAreaSlug&&!!r.programSlug}),u=h=>e.jsxs(rs,{"data-cy":`other-row-${h.id}`,onClick:()=>s(`/${n}/population/individuals/online-templates/${h.id}`),style:{cursor:"pointer"},children:[e.jsx(_,{children:e.jsx(me,{to:`/${n}/population/individuals/online-templates/${h.id}`,"data-cy":`template-id-link-${h.id}`,children:h.id})}),e.jsx(_,{children:h.name}),e.jsx(_,{children:h.numberOfRecords}),e.jsx(_,{children:e.jsx(pe,{children:h.createdAt})}),e.jsx(_,{children:h.createdBy}),e.jsx(_,{children:e.jsx(we,{status:h.status,statusDisplay:h.statusDisplay,statusToColor:cn})})]},h.id);return e.jsx(ds,{isOnPaper:!0,noEmptyMessage:!0,renderRow:u,headCells:bD,data:o??[],isLoading:d,error:c,queryVariables:r,setQueryVariables:l,title:"Other Periodic Data Updates",hidePagination:!0})};function AD(){return e.jsxs(e.Fragment,{children:[e.jsx(P,{pr:3,pl:3,children:e.jsx(hD,{})}),e.jsx(P,{p:3,children:e.jsx(pD,{})}),e.jsx(P,{p:3,children:e.jsx(xD,{})}),e.jsx(P,{p:3,children:e.jsx(yD,{})}),e.jsx(P,{p:3,children:e.jsx(jD,{})})]})}const _D=oe(AD,"PeriodicDataUpdatesOnlineEdits"),oh=()=>{const s=je(),t=ge(),a=new URLSearchParams(s.search),n=a.get("subtab"),i=A.useMemo(()=>({"offline-templates":0,"offline-edits":1,"online-edits":2}),[]),r=i[n]??0,[l,o]=A.useState(r);A.useEffect(()=>{const x=new URLSearchParams(s.search).get("subtab"),f=i[x]??0;f!==l&&o(f)},[s.search,i,l]);const{baseUrl:d}=U(),{isSocialDctType:c}=Z(),u=ve(),h=K(R.PDU_TEMPLATE_CREATE,u),m=(x,f)=>{o(f);const j=a.get("tab")||"periodic-data-updates";let y="offline-templates";f===1&&(y="offline-edits"),f===2&&(y="online-edits"),t({search:`?tab=${j}&subtab=${y}`},{replace:!0})},g=c?`/${d}/population/people/new-offline-template`:`/${d}/population/individuals/new-offline-template`;return e.jsxs(e.Fragment,{children:[e.jsx(P,{p:3,children:e.jsx(us,{elevation:1,sx:{mb:0,borderRadius:2},children:e.jsx(st,{title:"Periodic Data Updates",tabs:e.jsx(P,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(ol,{value:l,onChange:m,"aria-label":"periodic data updates tabs",children:[e.jsx(Ma,{label:"Offline Templates","data-cy":"pdu-offline-templates"}),e.jsx(Ma,{label:"Offline Edits","data-cy":"pdu-offline-edits"}),e.jsx(Ma,{label:"Online Edits","data-cy":"pdu-online-edits"})]})})})})}),e.jsx(Wt,{in:!0,timeout:500,children:e.jsxs("div",{children:[l===0&&e.jsx(P,{p:3,children:e.jsxs(us,{children:[e.jsx(P,{display:"flex",justifyContent:"flex-end",p:6,children:e.jsx(Vs,{variant:"contained",color:"primary",component:ys,to:g,startIcon:e.jsx(pa,{}),"data-cy":"new-template-button",disabled:!h,dataPerm:R.PDU_TEMPLATE_CREATE,children:"New Template"})}),e.jsx(iD,{})]})}),l===1&&e.jsx(P,{p:3,children:e.jsxs(us,{children:[e.jsx(P,{display:"flex",justifyContent:"flex-end",p:6,children:e.jsx(eD,{})}),e.jsx(cD,{})]})}),l===2&&e.jsx(P,{children:e.jsx(_D,{})})]})},l)]})},PD=[{disablePadding:!1,label:"",id:"sanctionListPossibleMatch",numeric:!1,dataCy:"sanction-list-possible-match"},{disablePadding:!1,label:"Individual ID",id:"unicefId",numeric:!1,dataCy:"individual-id"},{disablePadding:!1,label:"Individual",id:"fullName",numeric:!1,dataCy:"individual-name"},{disablePadding:!1,label:"Household ID",id:"household__unicef_id",numeric:!1,dataCy:"household-id"},{disablePadding:!1,label:"Relationship to HoH",id:"relationship",numeric:!1,dataCy:"relationship"},{disablePadding:!1,label:"Age",id:"-birthDate",numeric:!0,dataCy:"individual-age"},{disablePadding:!1,label:"Gender",id:"sex",numeric:!1,dataCy:"individual-sex"},{disablePadding:!1,label:"Administrative Level 2",id:"household__admin_area__name",numeric:!1,dataCy:"individual-location"}],rr=({individual:s})=>{const{t}=M(),a=r=>r?.status==="DUPLICATE"?e.jsx(Sa,{"data-cy":"tooltip-confirmed-duplicate",confirmed:!0,message:t("Confirmed Duplicate")}):r?.deduplicationGoldenRecordStatus!=="UNIQUE"?e.jsx(Sa,{"data-cy":"tooltip-possible-duplicate",message:t("Possible Duplicate")}):null,n=r=>r?.sanctionListPossibleMatch?e.jsx(Ga,{"data-cy":"tooltip-sanction-list-possible",message:t("Sanction List Possible Match")}):null,i=r=>r?.sanctionListConfirmedMatch?e.jsx(Ga,{"data-cy":"sanction-list-confirmed",message:t("Sanction List Confirmed Match"),confirmed:!0}):null;return e.jsxs(e.Fragment,{children:[e.jsx(P,{mr:2,children:a(s)}),e.jsx(P,{mr:2,children:n(s)}),e.jsx(P,{mr:2,children:i(s)})]})};function CD({individual:s,canViewDetails:t,choicesData:a}){const n=ge(),{baseUrl:i}=U(),r=_s(a.relationshipChoices),l=`/${i}/population/individuals/${s.id}`,o=()=>{n(l)};return e.jsxs(rs,{hover:!0,onClick:t?o:void 0,role:"checkbox","data-cy":"individual-table-row",children:[e.jsx(_,{align:"left",children:e.jsx(rr,{individual:s})}),e.jsx(_,{align:"left",children:e.jsx(me,{to:l,children:s.unicefId})}),e.jsx(Jt,{children:s.fullName}),e.jsx(_,{align:"left",children:s.household?s.household.unicefId:""}),e.jsx(_,{align:"left",children:r[s.relationship]}),e.jsx(_,{align:"right",children:s.age}),e.jsx(_,{align:"left",children:ga(s.sex)}),e.jsx(_,{align:"left",children:s.household?.admin2?.name})]},s.id)}function ED({businessArea:s,filter:t,canViewDetails:a,choicesData:n}){const{programId:i}=U(),{selectedProgram:r}=Z(),l=r?.beneficiaryGroup,[o,d]=A.useState(0),c=A.useMemo(()=>({businessAreaSlug:s,programSlug:i,ageMax:t.ageMax,ageMin:t.ageMin,sex:[t.sex],search:t.search.trim(),documentType:t.documentType,documentNumber:t.documentNumber.trim(),admin2:t.admin2,flags:t.flags,status:t.status,lastRegistrationDateBefore:t.lastRegistrationDateMin,lastRegistrationDateAfter:t.lastRegistrationDateMax,rdiMergeStatus:"MERGED",orderBy:t.orderBy,page:o}),[t.ageMin,t.ageMax,t.sex,t.search,t.documentType,t.documentNumber,t.admin2,t.flags,t.status,t.lastRegistrationDateMin,t.lastRegistrationDateMax,t.orderBy,i,s,o]);A.useEffect(()=>{d(0)},[t,t.ageMin,t.ageMax,t.sex,t.search,t.documentType,t.documentNumber,t.admin2,t.flags,t.status,t.lastRegistrationDateMin,t.lastRegistrationDateMax,t.orderBy,i,s]);const h=$s(PD,l,{unicefId:C=>`${C?.memberLabel} ID`,fullName:C=>C?.memberLabel,household__unicef_id:C=>`${C?.groupLabel} ID`,relationship:C=>`Relationship to Head of ${C?.groupLabel}`}),[m,g]=A.useState(c);A.useEffect(()=>{g(c)},[c]);const{data:x,isLoading:f,error:j}=V({queryKey:["businessAreasProgramsIndividualsList",m,s,i],queryFn:()=>N.restBusinessAreasProgramsIndividualsList(Ce({businessAreaSlug:s,programSlug:i},m,{withPagination:!0}))}),{data:y}=V({queryKey:["businessAreasProgramsIndividualsCountRetrieve",s,i,t.search,t.sex,t.documentType,t.documentNumber,t.admin2,t.flags,t.status,t.lastRegistrationDateMin,t.lastRegistrationDateMax,t.ageMin,t.ageMax,t.orderBy],queryFn:()=>N.restBusinessAreasProgramsIndividualsCountRetrieve(Ce({businessAreaSlug:s,programSlug:i},{ageMax:t.ageMax,ageMin:t.ageMin,sex:[t.sex],search:t.search?.trim(),documentType:t.documentType,documentNumber:t.documentNumber?.trim(),admin2:t.admin2,flags:t.flags,status:t.status,lastRegistrationDateBefore:t.lastRegistrationDateMin,lastRegistrationDateAfter:t.lastRegistrationDateMax,rdiMergeStatus:"MERGED",orderBy:t.orderBy})),enabled:o===0}),b=vs(o,y);return e.jsx(Es,{children:e.jsx(ds,{title:l?.memberLabelPlural,headCells:h,rowsPerPageOptions:[10,15,20],queryVariables:m,setQueryVariables:g,data:x,error:j,isLoading:f,allowSort:!1,filterOrderBy:t.orderBy,itemsCount:b,page:o,setPage:d,renderRow:C=>e.jsx(CD,{individual:C,canViewDetails:a,choicesData:n},C.id)})})}const dh=()=>{const{t:s}=M(),t=je(),a=ge(),{programHasPdu:n,selectedProgram:i}=Z(),r=i?.beneficiaryGroup,{businessArea:l}=U(),o=ve(),{data:d,isLoading:c}=V({queryKey:["individualChoices",l],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:l})}),u={search:"",documentType:d?.documentTypeChoices?.[0]?.value,documentNumber:"",admin2:"",sex:"",ageMin:"",ageMax:"",flags:[],orderBy:"unicef_id",status:"",lastRegistrationDateMin:"",lastRegistrationDateMax:""},[h,m]=A.useState(Ke(t,u)),[g,x]=A.useState(Ke(t,u)),[f,j]=A.useState(!1),y=A.useRef(null);et(y,f,g,()=>j(!1));const C=new URLSearchParams(t.search).get("tab")==="periodic-data-updates"?1:0,[v,S]=A.useState(C);A.useEffect(()=>{const F=new URLSearchParams(t.search).get("tab");F==="periodic-data-updates"&&v!==1?S(1):(F==="individuals"||!F)&&v!==0&&S(0)},[t.search,v]);const I=K(R.PDU_VIEW_LIST_AND_DETAILS,o),E=K(R.POPULATION_VIEW_INDIVIDUALS_LIST,o),D=F=>{S(F),F===0?a({search:"?tab=individuals"},{replace:!0}):F===1&&a({search:"?tab=periodic-data-updates"},{replace:!0})};return c?e.jsx(Ne,{}):!d||o===null?null:E?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:r?.memberLabelPlural,tabs:e.jsxs(La,{value:v,onChange:(F,w)=>{D(w)},children:[e.jsx(Tt,{"data-cy":"tab-individuals",label:r?.memberLabelPlural}),n?I?e.jsx(Tt,{"data-cy":"tab-periodic-data-updates",label:"Periodic Data Updates"}):e.jsx(Ms,{title:s("Permission Denied"),children:e.jsx("span",{children:e.jsx(Tt,{disabled:!0,"data-cy":"tab-periodic-data-updates",label:"Periodic Data Updates"})})}):e.jsx(Ms,{title:s("Programme does not have defined fields for periodic updates"),children:e.jsx("span",{children:e.jsx(Tt,{disabled:!0,"data-cy":"tab-periodic-data-updates",label:"Periodic Data Updates"})})})]})}),e.jsx(Wt,{in:!0,timeout:500,children:e.jsx(P,{children:v===0?e.jsxs(e.Fragment,{children:[e.jsx(Vl,{filter:h,choicesData:d,setFilter:m,initialFilter:u,appliedFilter:g,setAppliedFilter:F=>{x(F),j(!0)}}),e.jsx(P,{display:"flex",flexDirection:"column","data-cy":"page-details-container",ref:y,children:e.jsx(ED,{filter:g,businessArea:l,choicesData:d,canViewDetails:K(R.POPULATION_VIEW_INDIVIDUALS_DETAILS,o)})})]}):I?e.jsx(oh,{}):e.jsx(Xe,{permission:R.PDU_VIEW_LIST_AND_DETAILS})})},v)]}):e.jsx(Xe,{permission:R.POPULATION_VIEW_INDIVIDUALS_LIST})};oe(dh,"HouseholdMembersPage");function ch({individual:s,documentNumber:t,documentId:a}){const{businessArea:n}=U(),{selectedProgram:i}=Z(),{data:r}=V({queryKey:["individualPhotos",n,i?.slug,s?.id],queryFn:()=>N.restBusinessAreasProgramsIndividualsPhotosRetrieve({businessAreaSlug:n,programSlug:i?.slug||"",id:s?.id}),enabled:!!n&&!!i?.slug&&!!s?.id}),l=r?.documents?.find(o=>o.id===a);return e.jsx(nt,{src:l?.photo,linkText:t,variant:"link",title:"Document's Photo"})}const vD=T.div`
  color: #000;
  text-decoration: underline;
  cursor: pointer;
  display: flex;
  align-content: center;
`,SD=T(gs)`
  min-width: 100px;
`,ID=T(Ks)`
  max-height: 800px;
`;function ro({household:s,businessArea:t,baseUrl:a,grievancesChoices:n}){const[i,r]=A.useState(!1),l=ge(),{t:o}=M(),{selectedProgram:d}=Z(),c=d?.beneficiaryGroup,{data:u}=V({queryKey:["linkedGrievanceTickets",t,d?.id,s.unicefId],queryFn:()=>{const b={household:s.unicefId,limit:1e3};if(d?.id&&d.id!=="all")return N.restBusinessAreasProgramsGrievanceTicketsList(Ce({businessAreaSlug:t,programSlug:d.slug},b,{withPagination:!0}))},refetchOnWindowFocus:!1}),h=_s(n.grievanceTicketStatusChoices),m=_s(n.grievanceTicketCategoryChoices),g=b=>{const C=$t(b.id,b.category,a);return e.jsxs(rs,{hover:!0,onClick:()=>l(C),children:[e.jsx(_,{align:"left",children:e.jsx(me,{to:C,children:b.unicefId})}),e.jsx(_,{align:"left",children:m[b.category]}),e.jsx(_,{align:"left",children:e.jsx(we,{status:h[b.status],statusToColor:Vn})})]},b.id)},x=u?u.results:[],f=()=>x.length?x.map(b=>{const C=$t(b.id,b.category,a);return e.jsxs("span",{children:[e.jsx(Us,{href:C,children:`${b.unicefId} - ${m[b.category]} - ${h[b.status]}`})," ",e.jsx("br",{})]},b.id)}):[e.jsx("span",{children:"-"},"empty")],j=()=>x.length===0?e.jsx(L,{label:o("Linked Grievances"),value:e.jsx("span",{children:"-"})}):e.jsxs(e.Fragment,{children:[e.jsx(L,{label:o("Linked Grievances"),value:f().slice(0,3)}),x.length>3&&e.jsx(vD,{onClick:b=>{b.stopPropagation(),r(!0)},children:"See More"})]}),y=()=>e.jsx(e.Fragment,{children:x.map(b=>g(b))});return e.jsxs(e.Fragment,{children:[j(),e.jsxs(ID,{open:i,onClose:()=>r(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"lg",children:[e.jsx(Ye,{children:e.jsx(Le,{children:o("Linked Grievances")})}),e.jsxs(Be,{children:[e.jsx(P,{mt:2,mb:6,children:e.jsxs(ee,{children:[e.jsxs(zn,{children:[c?.groupLabel," ID ",s.unicefId]}),"is linked to following Grievances."]})}),e.jsxs(SD,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left",children:o("Ticket Id")}),e.jsx(_,{align:"left",children:o("Category")}),e.jsx(_,{align:"left",children:o("Status")})]})}),e.jsx(cs,{children:y()})]})]}),e.jsx(ss,{children:e.jsx(os,{children:e.jsx(H,{onClick:b=>{b.stopPropagation(),r(!1)},children:o("CANCEL")})})})]})]})}const An=T.div`
  border-bottom: 1px solid #e1e1e1;
`,DD=({individual:s,baseUrl:t,businessArea:a,choicesData:n,grievancesChoices:i})=>{const{t:r}=M(),{selectedProgram:l}=Z(),o=_s(n.maritalStatusChoices),d=_s(n.workStatusChoices),c=_s(n.roleChoices),u=_s(n.severityOfDisabilityChoices),h=_s(n.observedDisabilityChoices),m=s?.documents?.map(j=>e.jsx(p,{size:{xs:3},children:e.jsxs(P,{flexDirection:"column",children:[e.jsx(P,{mb:1,children:e.jsx(L,{label:j.type?.label,children:j.photo?e.jsx(ch,{documentNumber:j.documentNumber,documentId:j.id,individual:s}):j.documentNumber})}),e.jsx(L,{label:"issued",children:j.country?.name})]})},j.id)),g=s?.identities?.map(j=>e.jsx(p,{size:{xs:3},children:e.jsxs(P,{flexDirection:"column",children:[e.jsx(P,{mb:1,children:e.jsx(L,{label:`${j.partner} ID`,children:j.number})}),e.jsx(L,{label:"issued",children:j.country.name})]})},j.id)),x=()=>e.jsxs(e.Fragment,{children:[e.jsx(p,{size:{xs:12},children:e.jsx(An,{})}),e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:r("Wallet Name"),children:s?.walletName})}),e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:r("Blockchain Name"),children:s?.blockchainName})}),e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:r("Wallet Address"),children:s?.walletAddress})})]});let f=null;if(s?.household){const j=s.household;f=e.jsxs(e.Fragment,{children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Residence Status"),children:j?.residenceStatus})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Country"),children:j?.country})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Country of Origin"),children:j.countryOrigin})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Address"),children:j.address})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Vilage"),children:j.village})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Zip Code"),children:j.zipCode})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Administrative Level 1"),children:j?.admin1?.name})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Administrative Level 2"),children:j?.admin2?.name})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Administrative Level 3"),children:j?.admin3?.name})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Administrative Level 4"),children:j?.admin4?.name})}),e.jsx(p,{size:{xs:6},children:e.jsx(L,{label:r("Geolocation"),children:j?.geopoint})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Data Collecting Type"),children:l?.dataCollectingType?.label})})]})}return e.jsxs(ra,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:r("Bio Data")})}),e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Full Name"),children:s?.fullName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Given Name"),children:s?.givenName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Middle Name"),children:s?.middleName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Family Name"),children:s?.familyName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Gender"),children:ga(s?.sex)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Age"),children:Sl(s?.age)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Date of Birth"),children:e.jsx(pe,{children:s?.birthDate})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Estimated Date of Birth"),children:Va(s?.estimatedBirthDate)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Marital Status"),children:o[s?.maritalStatus]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Work Status"),children:d[s?.workStatus]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Pregnant"),children:Va(s?.pregnant)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Role"),children:c[s?.role]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Preferred language"),children:s?.preferredLanguage})}),f,e.jsx(p,{size:{xs:12},children:e.jsx(An,{})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Observed disabilities"),children:h[s?.observedDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Seeing disability severity"),children:u[s?.seeingDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Hearing disability severity"),children:u[s?.hearingDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Physical disability severity"),children:u[s?.physicalDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Remembering or concentrating disability severity"),children:u[s?.memoryDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Self-care disability severity"),children:u[s?.selfcareDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Communicating disability severity"),children:u[s?.commsDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Disability"),children:s?.disability===yl.DISABLED?"Disabled":"Not Disabled"})}),!m?.length&&!g?.length?null:e.jsx(p,{size:{xs:12},children:e.jsx(An,{})}),m,g,e.jsx(p,{size:{xs:12},children:e.jsx(An,{})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Email"),children:s?.email})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Phone Number"),children:Kt(s?.phoneNo,s?.phoneNoValid)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Alternative Phone Number"),children:Kt(s?.phoneNoAlternative,s?.phoneNoAlternativeValid)})}),e.jsx(p,{size:{xs:12},children:e.jsx(An,{})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Date of last screening against sanctions list"),children:e.jsx(pe,{children:s?.sanctionListLastCheck})})}),e.jsx(p,{size:{xs:6},children:s?.household?.unicefId&&e.jsx(ro,{household:s?.household,baseUrl:t,businessArea:a,grievancesChoices:i})}),x()]})]})},TD=T(us)`
  padding: ${({theme:s})=>s.spacing(8)}
    ${({theme:s})=>s.spacing(11)};
  margin-top: ${({theme:s})=>s.spacing(6)};
  margin-bottom: ${({theme:s})=>s.spacing(4)};
`,RD=({account:s,lastItem:t,accountFinancialInstitutionsDict:a})=>{const n=s.dataFields;return e.jsxs(p,{size:12,children:[e.jsx(ee,{variant:"h6",children:s.name}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:3,children:e.jsx(L,{label:Ee("Financial Institution"),children:Aa(a[s.financialInstitution])})}),e.jsx(p,{size:3,children:e.jsx(L,{label:Ee("Number"),children:Aa(s.number)})}),n.map((i,r)=>e.jsx(p,{size:3,children:e.jsx(L,{label:Vp(i.key),children:Aa(i.value)})},r))]}),!t&&e.jsx(St,{})]},s.id)},uh=({individual:s,choicesData:t})=>{const a=ve(),n=K(R.POPULATION_VIEW_INDIVIDUAL_DELIVERY_MECHANISMS_SECTION,a),{selectedProgram:i}=Z(),r=i?.beneficiaryGroup,l=Hs(t.accountFinancialInstitutionChoices,"value","name");return!s?.accounts?.length||!n?null:e.jsxs(TD,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:Ee(`${r?.memberLabel} Accounts`)})}),e.jsx(p,{container:!0,spacing:6,children:s.accounts.map((o,d)=>e.jsx(RD,{account:o,lastItem:d+1===s.accounts.length,accountFinancialInstitutionsDict:l},o.id))})]})};function FD({field:s}){const{id:t}=ts(),{businessArea:a,programId:n}=U(),{data:i}=V({queryKey:["individual",a,n,t],queryFn:()=>N.restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:a,programSlug:n,id:t}),enabled:!!a&&!!n&&!!t});if(!i)return null;const r=i.flexFields?.[s.name];return r?e.jsx(nt,{src:r}):e.jsx(P,{style:{height:"100%"},display:"flex",alignItems:"center",children:"-"})}const Od=T(us)`
  padding: ${({theme:s})=>s.spacing(8)}
    ${({theme:s})=>s.spacing(11)};
  margin-top: ${({theme:s})=>s.spacing(6)};
  margin-bottom: ${({theme:s})=>s.spacing(4)};
`,hh=({individual:s,flexFieldsData:t})=>{const{t:a}=M(),n=Hs(t?.allIndividualsFlexFieldsAttributes,"name","*");if(Object.entries(s?.flexFields||{}).length===0)return e.jsx(Od,{children:e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("No additional registration information available")})})});const i=Object.entries(s?.flexFields||{}).map(([r,l])=>{const o=r.replaceAll("_i_f","").replaceAll("IF"," ").replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2");if(n[r]?.type==="IMAGE")return e.jsx(L,{label:o,children:e.jsx(FD,{field:n[r]})},r);if(n[r]?.type==="SELECT_MANY"||n[r]?.type==="SELECT_ONE"){let d=n[r].choices.find(c=>c.value===l)?.labelEn||"-";return Array.isArray(l)&&(d=l.map(c=>n[r].choices.find(u=>u.value===c)?.labelEn||"-").join(", ")),e.jsx(L,{label:o,value:d},r)}if(l&&typeof l=="object"&&!Array.isArray(l)){const d=Bc(l);return e.jsx(L,{label:o,children:e.jsx("div",{style:{whiteSpace:"pre-line",fontFamily:"monospace",fontSize:"0.9em"},children:d})},r)}if(Array.isArray(l)){const d=l.map(c=>bi(c)).join(", ");return e.jsx(L,{label:o,value:d},r)}return e.jsx(L,{label:o,value:bi(l)},r)});return e.jsxs(Od,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Additional Registration information")})}),e.jsx(p,{container:!0,spacing:6,children:i.map((r,l)=>e.jsx(p,{size:4,children:r},l))})]})};function lo({individual:s}){const{businessArea:t}=U(),{selectedProgram:a}=Z(),{data:n}=V({queryKey:["individualPhotos",t,a?.slug,s?.id],queryFn:()=>N.restBusinessAreasProgramsIndividualsPhotosRetrieve({businessAreaSlug:t,programSlug:a?.slug||"",id:s?.id}),enabled:!!t&&!!a?.slug&&!!s?.id});return e.jsx(nt,{src:n?.photo,variant:"button",title:"Individuals's Photo"})}const _n=T(_)`
  color: #adadad !important;
`,mh=({individual:s,periodicFieldsData:t})=>{const{t:a}=M(),n=Hs(t?.results||[],"name","*"),i=[];if(s.flexFields&&Object.keys(s.flexFields).length>0){for(const r of Object.keys(s.flexFields))if(s.flexFields[r]&&Object.keys(s.flexFields[r]).length>0)for(const l of Object.keys(s.flexFields[r])){const o=s.flexFields[r][l];if(o&&n[r]&&n[r].pduData.roundsNames){const d=n[r].pduData.roundsNames[parseInt(l)-1],c=o.value,u=o.collection_date;i.push({key:`${n[r]}-roundNumber`,fieldName:n[r].label,roundNumber:l,roundName:d,value:c,dateOfCollection:u})}}}return e.jsx(P,{mb:3,children:e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Programme Time Series Fields")})}),e.jsx(Ut,{component:"div",style:{backgroundColor:"#f5f5f5"},children:e.jsxs(gs,{"aria-label":"programme time series fields",children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_n,{children:a("Field Name")}),e.jsx(_n,{align:"right",children:a("Round Number")}),e.jsx(_n,{align:"left",children:a("Round Name")}),e.jsx(_n,{align:"left",children:a("Value")}),e.jsx(_n,{align:"right",children:a("Date of Collection")})]})}),e.jsx(cs,{children:i.length>0?i.map(r=>e.jsxs(be,{children:[e.jsx(_,{component:"th",scope:"row",children:r.fieldName}),e.jsx(_,{align:"right",children:r.roundNumber}),e.jsx(_,{align:"left",children:r.roundName}),e.jsx(_,{align:"left",children:typeof r.value=="boolean"?r.value?"YES":"NO":r.value}),e.jsx(_,{align:"right",children:e.jsx(pe,{children:r.dateOfCollection})})]},r.fieldName)):e.jsx(be,{children:e.jsx(_,{colSpan:5,align:"center",children:a("No data available")})})})]})})]})})},ND=[{disablePadding:!1,label:"Payment ID",id:"internalData__caId",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Entitlement Quantity",id:"entitlement_quantity",numeric:!0},{disablePadding:!1,label:"Delivered Quantity",id:"delivered_quantity",numeric:!0},{disablePadding:!1,label:"Delivery Date",id:"delivery_date",numeric:!0}];function LD({payment:s,openInNewTab:t,canViewDetails:a}){const{baseUrl:n}=U(),i=ge(),r=`/${n}/payment-module/payments/${s.id}`,l=()=>{t?window.open(r):i(r)};return e.jsxs(rs,{hover:!0,onClick:a?l:void 0,role:"checkbox",children:[e.jsx(_,{align:"left",children:a?e.jsx(me,{to:r,children:s.unicefId}):s.unicefId}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Na,statusNameMapping:Ya})}),e.jsx(_,{align:"right",children:Ps(s.entitlementQuantity,s.currency)}),e.jsx(_,{align:"right",children:Ps(s.deliveredQuantity,s.currency)}),e.jsx(_,{align:"right",children:e.jsx(pe,{children:s.deliveryDate})})]},s.id)}function OD({household:s,openInNewTab:t=!1,businessArea:a,canViewPaymentRecordDetails:n}){const{t:i}=M(),{programId:r}=U(),l={businessAreaSlug:a,programSlug:r,id:s.id},[o,d]=A.useState(l),[c,u]=A.useState(0),{data:h,isLoading:m,error:g}=V({queryKey:["businessAreasProgramsPaymentPlansPaymentsList",o,a,s.id,r],queryFn:()=>N.restBusinessAreasProgramsHouseholdsPaymentsList(Ce({businessAreaSlug:a,programSlug:r,id:s.id},o,{withPagination:!0}))}),{data:x}=V({queryKey:["businessAreasProgramsHouseholdsPaymentsCount",r,a,o,s.id],queryFn:()=>N.restBusinessAreasProgramsHouseholdsPaymentsCountRetrieve(Ce({businessAreaSlug:a,programSlug:r,id:s.id},o)),enabled:c===0}),f=vs(c,x);return e.jsx(ds,{title:i("Payments"),headCells:ND,data:h,error:g,isLoading:m,queryVariables:o,setQueryVariables:d,page:c,setPage:u,itemsCount:f,renderRow:j=>e.jsx(LD,{payment:j,openInNewTab:t,canViewDetails:n},j.id)})}const kD=oe(OD,"PaymentsPeopleTable"),wD=T.div`
  padding: 20px 20px 00px 20px;
  && {
    display: flex;
    flex-direction: column;
    width: 100%;
  }
`,MD=T(us)`
  margin: 0px 0px 20px 0px;
  padding: 20px ${({theme:s})=>s.spacing(11)};
`,$D=T(us)`
  margin: 15px 0px 20px 0px;
  padding: 20px ${({theme:s})=>s.spacing(11)};
`,UD=T(ee)`
  && {
    font-size: 16px;
  }
`,VD=()=>{const{t:s}=M(),{id:t}=ts(),{baseUrl:a,businessArea:n,programId:i}=U(),r=ve(),{data:l,isLoading:o,error:d}=mn(t,N.restBusinessAreasProgramsIndividualsRetrieve,{}),{data:c,isLoading:u}=V({queryKey:["individualChoices",n],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:n})}),{data:h,isLoading:m}=V({queryKey:["fieldsAttributes"],queryFn:async()=>({allIndividualsFlexFieldsAttributes:await qc.fieldsAttributesRetrieve()})}),{data:g,isLoading:x}=V({queryKey:["businessAreasGrievanceTicketsChoices",n],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:n})}),{data:f,isLoading:j}=V({queryKey:["periodicFields",n,i],queryFn:()=>N.restBusinessAreasProgramsPeriodicFieldsList({businessAreaSlug:n,programSlug:i,limit:1e3})});if(o||u||m||x||j)return e.jsx(Ne,{});if(rt(d))return e.jsx(Xe,{permission:R.POPULATION_VIEW_INDIVIDUALS_DETAILS});if(!l||!c||!h||!g||r===null)return null;const y=[{title:"People",to:`/${a}/population/people`}],b=l?.household;return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`${s("Individual ID")}: ${l?.unicefId}`,breadCrumbs:K(R.POPULATION_VIEW_INDIVIDUALS_LIST,r)?y:null,flags:e.jsxs(e.Fragment,{children:[e.jsx(rr,{individual:l}),e.jsx(gt,{adminUrl:l?.adminUrl})]}),children:e.jsx(P,{sx:{mr:2},children:l?.photo?e.jsx(lo,{individual:l}):null})}),e.jsxs(wD,{children:[e.jsx(DD,{baseUrl:a,businessArea:n,individual:l,choicesData:c,grievancesChoices:g}),e.jsx(uh,{individual:l,choicesData:c}),e.jsx(hh,{flexFieldsData:h,individual:l}),e.jsx(P,{sx:{mb:4},children:e.jsx(mh,{individual:l,periodicFieldsData:f})}),e.jsxs(MD,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:s("Benefits")})}),e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("Cash received"),children:b?.deliveredQuantities?.length?e.jsx(P,{sx:{mb:2},children:e.jsx(p,{container:!0,children:e.jsx(p,{size:{xs:6},children:e.jsx(P,{sx:{display:"flex",flexDirection:"column"},children:b?.deliveredQuantities?.map(C=>e.jsx(P,{children:C.currency==="USD"?Ps(C.totalDeliveredQuantity,C.currency):`(${Ps(C.totalDeliveredQuantity,C.currency)})`},`${C.currency}-${C.totalDeliveredQuantity}`))})})})}):e.jsx(e.Fragment,{children:"-"})})}),e.jsx(p,{size:{xs:3},children:e.jsx(an,{children:e.jsx(L,{label:s("Total Cash Received"),children:e.jsx(ba,{children:Ps(b?.totalCashReceivedUsd,"USD")})})})})]})]}),K(R.PM_VIEW_PAYMENT_LIST,r)&&e.jsx(kD,{openInNewTab:!0,household:b,businessArea:n,canViewPaymentRecordDetails:K(R.PROGRAMME_VIEW_PAYMENT_RECORD_DETAILS,r)}),e.jsxs($D,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:s("Registration Details")})}),e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("Source"),children:e.jsx("div",{children:l?.registrationDataImport?.dataSource})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("Import name"),children:e.jsx("div",{children:l?.registrationDataImport?.name})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("Registration Date"),children:e.jsx("div",{children:e.jsx(pe,{children:b?.lastRegistrationDate})})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("User name"),children:l?.registrationDataImport?.importedBy?.email})})]}),l?.registrationDataImport?.dataSource==="XLS"?null:e.jsxs(e.Fragment,{children:[e.jsx("hr",{}),e.jsx(UD,{variant:"h6",children:s("Data Collection")}),e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("Start time"),children:e.jsx(pe,{children:b?.start})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("End time"),children:b?.firstRegistrationDate})})]})]})]})]}),K(R.ACTIVITY_LOG_VIEW,r)&&e.jsx(Lt,{objectId:l?.id})]})},BD=oe(VD,"PeopleDetailsPage");function GD({filter:s,programs:t,choicesData:a,setFilter:n,initialFilter:i,appliedFilter:r,setAppliedFilter:l,isOnPaper:o=!0}){const{t:d}=M(),c=ge(),u=je(),{isAllPrograms:h}=U(),{selectedProgram:m}=Z(),g=m?.beneficiaryGroup||null,{handleFilterChange:x,applyFilterChanges:f,clearFilter:j}=Ss(i,c,u,s,n,r,l),y=()=>{f()},b=()=>{j()},C=m?.dataCollectingType?.type?.toUpperCase()==="SOCIAL",v=kc(g)||[];return e.jsx(Ns,{clearHandler:b,applyHandler:y,isOnPaper:o,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{label:d("Search"),value:s.search,onChange:S=>x("search",S.target.value),"data-cy":"ind-filters-search"})}),e.jsxs(p,{container:!0,size:{xs:6},spacing:3,children:[e.jsx(p,{size:{xs:6},children:e.jsx(He,{onChange:S=>x("documentType",S.target.value),label:d("Document Type"),value:s.documentType,borderRadius:"0px 4px 4px 0px","data-cy":"filters-document-type",fullWidth:!0,disableClearable:!0,children:a?.documentTypeChoices?.map(({name:S,value:I})=>e.jsx(de,{value:I,children:S},I))||null})}),e.jsx(p,{size:{xs:6},children:e.jsx(Cs,{label:d("Document number"),value:s.documentNumber,onChange:S=>x("documentNumber",S.target.value),"data-cy":"filters-document-number"})})]}),h&&e.jsx(p,{size:{xs:2},children:e.jsx(He,{onChange:S=>x("program",S.target.value),label:d("Programme"),value:s.program,fullWidth:!0,icon:e.jsx(Si,{}),"data-cy":"filters-program",children:t.map(S=>e.jsx(de,{value:S.id,children:S.name},S.id))})}),C&&e.jsxs(e.Fragment,{children:[e.jsx(p,{size:{xs:2},children:e.jsx(ua,{level:1,name:"admin1",value:s.admin1,disabled:s.admin2,setFilter:n,filter:s,initialFilter:i,appliedFilter:r,setAppliedFilter:l,dataCy:"ind-filters-admin1"})}),e.jsx(p,{size:{xs:2},children:e.jsx(ua,{level:2,name:"admin2",value:s.admin2,disabled:s.admin1,setFilter:n,filter:s,initialFilter:i,appliedFilter:r,setAppliedFilter:l,dataCy:"ind-filters-admin2"})})]}),e.jsx(p,{size:{xs:2},children:e.jsxs(He,{onChange:S=>x("sex",S.target.value),value:s.sex,label:d("Gender"),"data-cy":"ind-filters-gender",fullWidth:!0,children:[e.jsx(de,{value:"FEMALE",children:d("Female")}),e.jsx(de,{value:"MALE",children:d("Male")}),e.jsx(de,{value:"OTHER",children:d("Other")}),e.jsx(de,{value:"NOT_COLLECTED",children:d("Not Collected")}),e.jsx(de,{value:"NOT_ANSWERED",children:d("Not Answered")})]})}),e.jsx(p,{size:{xs:2},children:e.jsx(js,{fullWidth:!0,topLabel:d("Age"),placeholder:d("From"),value:s.ageMin,"data-cy":"ind-filters-age-from",onChange:S=>{S.target.value<0||S.target.value>120||x("ageMin",S.target.value)},icon:e.jsx(fi,{})})}),e.jsx(p,{size:{xs:2},children:e.jsx(js,{fullWidth:!0,placeholder:d("To"),value:s.ageMax,"data-cy":"ind-filters-age-to",onChange:S=>{S.target.value<0||S.target.value>120||x("ageMax",S.target.value)},icon:e.jsx(fi,{})})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:S=>x("flags",S.target.value),label:d("Flags"),multiple:!0,fullWidth:!0,value:s.flags,"data-cy":"ind-filters-flags",children:a?.flagChoices.map((S,I)=>e.jsx(de,{value:S.value,"data-cy":`select-option-${I}`,children:S.name},S.value))})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:S=>x("orderBy",S.target.value),label:d("Sort by"),value:s.orderBy,fullWidth:!0,"data-cy":"ind-filters-order-by",disableClearable:!0,children:v.map(S=>e.jsx(de,{value:S.value,children:S.name},S.value))})}),e.jsx(p,{size:{xs:2},children:e.jsxs(He,{onChange:S=>x("status",S.target.value),label:d("Status"),value:s.status,"data-cy":"ind-filters-status",children:[e.jsx(de,{value:"ACTIVE",children:"Active"},"active"),e.jsx(de,{value:"DUPLICATE",children:"Duplicate"},"duplicate"),e.jsx(de,{value:"WITHDRAWN",children:"Withdrawn"},"withdrawn")]})}),e.jsx(p,{size:{xs:2},children:e.jsx(ms,{topLabel:d("Registration Date"),placeholder:d("From"),onChange:S=>x("lastRegistrationDateMin",S),value:s.lastRegistrationDateMin,dataCy:"ind-filters-reg-date-from"})}),e.jsx(p,{size:{xs:2},children:e.jsx(ms,{placeholder:d("To"),onChange:S=>x("lastRegistrationDateMax",S),value:s.lastRegistrationDateMax,dataCy:"ind-filters-reg-date-to"})}),h&&e.jsx(p,{size:{xs:2},children:e.jsxs(He,{onChange:S=>x("programState",S.target.value),label:d("Programme State"),value:s.programState,fullWidth:!0,disableClearable:!0,"data-cy":"filters-program-state",children:[e.jsx(de,{value:"active",children:d("Active Programmes")}),e.jsx(de,{value:"all",children:d("All Programmes")})]})})]})})}const zD=[{disablePadding:!1,label:"",id:"sanctionListPossibleMatch",numeric:!1,dataCy:"sanction-list-possible-match"},{disablePadding:!1,label:"Individual ID",id:"unicefId",numeric:!1,dataCy:"individual-id"},{disablePadding:!1,label:"Individual",id:"fullName",numeric:!1,dataCy:"individual-name"},{disablePadding:!1,label:"Status",id:"status",numeric:!1,dataCy:"status",disableSort:!0},{disablePadding:!1,label:"Type",id:"type",numeric:!1,dataCy:"individual-age"},{disablePadding:!1,label:"Age",id:"birthDate",numeric:!0,dataCy:"individual-age"},{disablePadding:!1,label:"Gender",id:"sex",numeric:!1,dataCy:"individual-sex"},{disablePadding:!1,label:"Administrative Level 2",id:"household__admin_area__name",numeric:!1,dataCy:"individual-location"}],qD=({individual:s,canViewDetails:t})=>{const a=ge(),{baseUrl:n}=U(),{t:i}=M(),r=`/${n}/population/people/${s.id}`,l=()=>{a(r)};return e.jsxs(rs,{hover:!0,onClick:t?l:void 0,role:"checkbox","data-cy":"individual-table-row",children:[e.jsx(_,{align:"left",children:e.jsx(rr,{individual:s})}),e.jsx(_,{align:"left",children:e.jsx(me,{to:r,children:s.unicefId})}),e.jsx(Jt,{children:s.fullName}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Rp})}),e.jsx(_,{align:"left",children:s.relationship===Fc.HEAD?i("Beneficiary"):i("Non-beneficiary")}),e.jsx(_,{align:"right",children:s.age}),e.jsx(_,{align:"left",children:ga(s.sex)}),e.jsx(_,{align:"left",children:s.household?.admin2?.name})]},s.id)},HD=({businessArea:s,filter:t,canViewDetails:a})=>{const{t:n}=M(),{programId:i}=U(),[r,l]=A.useState(0),o=A.useMemo(()=>({businessAreaSlug:s,programSlug:i,ageMax:t.ageMax,ageMin:t.ageMin,sex:[t.sex],search:t.search.trim(),documentType:t.documentType,documentNumber:t.documentNumber.trim(),admin1:[t.admin1],admin2:[t.admin2],flags:t.flags,status:t.status,lastRegistrationDateBefore:t.lastRegistrationDateMin,lastRegistrationDateAfter:t.lastRegistrationDateMax,rdiMergeStatus:"MERGED",orderBy:t.orderBy,page:r}),[t.ageMin,t.ageMax,t.sex,t.search,t.documentType,t.documentNumber,t.admin1,t.admin2,t.flags,t.status,t.lastRegistrationDateMin,t.lastRegistrationDateMax,t.orderBy,i,s,r]),[d,c]=A.useState(o);A.useEffect(()=>{c(o)},[o]);const{data:u}=V({queryKey:["businessAreasProgramsHouseholdsCount",i,s,d],queryFn:()=>N.restBusinessAreasProgramsIndividualsCountRetrieve(Ce({businessAreaSlug:s,programSlug:i},d,{withPagination:!0})),enabled:r===0}),h=vs(r,u),{data:m,isLoading:g,error:x}=V({queryKey:["businessAreasProgramsIndividualsList",d,s,i],queryFn:()=>N.restBusinessAreasProgramsIndividualsList(Ce({businessAreaSlug:s,programSlug:i},d,{withPagination:!0}))});return e.jsx(Es,{children:e.jsx(ds,{title:n("People"),headCells:zD,rowsPerPageOptions:[10,15,20],queryVariables:d,setQueryVariables:c,data:m,error:x,isLoading:g,allowSort:!1,filterOrderBy:t.orderBy,itemsCount:h,page:r,setPage:l,renderRow:f=>e.jsx(qD,{individual:f,canViewDetails:a},f.id)})})},WD=()=>{const{t:s}=M(),t=je(),a=ge(),{programHasPdu:n=!1}=Z(),{businessArea:i}=U(),r=ve(),{data:l,isLoading:o}=V({queryKey:["householdChoices",i],queryFn:()=>N.restBusinessAreasHouseholdsChoicesRetrieve({businessAreaSlug:i})}),{data:d,isLoading:c}=V({queryKey:["individualChoices",i],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:i})}),u={search:"",documentType:l?.documentTypeChoices?.[0].value,documentNumber:"",admin1:"",admin2:"",sex:"",ageMin:"",ageMax:"",flags:[],orderBy:"unicef_id",status:"",lastRegistrationDateMin:"",lastRegistrationDateMax:""},[h,m]=A.useState(Ke(t,u)),[g,x]=A.useState(Ke(t,u)),[f,j]=A.useState(!1),y=A.useRef(null);et(y,f,g,()=>j(!1));const C=new URLSearchParams(t.search).get("tab")==="periodic-data-updates"?1:0,[v,S]=A.useState(C);A.useEffect(()=>{const E=new URLSearchParams(t.search).get("tab");E==="periodic-data-updates"&&v!==1?S(1):(E==="individuals"||!E)&&v!==0&&S(0)},[t.search,v]);const I=E=>{S(E),E===0?a({search:"?tab=individuals"},{replace:!0}):E===1&&a({search:"?tab=periodic-data-updates"},{replace:!0})};return o||c?e.jsx(Ne,{}):!d||!l||r===null?null:K(R.POPULATION_VIEW_INDIVIDUALS_LIST,r)?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:s("People"),tabs:e.jsxs(ol,{value:v,onChange:(E,D)=>{I(D)},children:[e.jsx(Ma,{"data-cy":"tab-individuals",label:"Individuals"}),n?e.jsx(Ma,{disabled:!n,"data-cy":"tab-periodic-data-updates",label:"Periodic Data Updates"}):e.jsx(Ms,{title:s("Programme does not have defined fields for periodic updates"),children:e.jsx("span",{children:e.jsx(Ma,{disabled:!n,"data-cy":"tab-periodic-data-updates",label:"Periodic Data Updates"})})})]})}),e.jsx(Wt,{in:!0,timeout:500,children:e.jsx(P,{children:v===0?e.jsxs(e.Fragment,{children:[e.jsx(GD,{filter:h,choicesData:d,setFilter:m,initialFilter:u,appliedFilter:g,setAppliedFilter:E=>{x(E),j(!0)}}),e.jsx(P,{display:"flex",flexDirection:"column","data-cy":"page-details-container",ref:y,children:e.jsx(HD,{filter:g,businessArea:i,canViewDetails:K(R.POPULATION_VIEW_INDIVIDUALS_DETAILS,r)})})]}):e.jsx(oh,{})})},v)]}):e.jsx(Xe,{permission:R.POPULATION_VIEW_INDIVIDUALS_LIST})},KD=oe(WD,"PeoplePage");function YD({field:s}){const{id:t}=ts(),{businessArea:a,programId:n}=U(),{selectedProgram:i}=Z(),{data:r}=V({queryKey:["household",a,t,n,i?.slug],queryFn:()=>N.restBusinessAreasProgramsHouseholdsRetrieve({businessAreaSlug:a,id:t,programSlug:n||i?.slug||""}),enabled:!!a&&!!t&&(!!n||!!i?.slug)});if(!r)return null;const{flexFields:l}=r,o=l[s.name];return o?e.jsx(nt,{src:o}):e.jsx(P,{display:"flex",alignItems:"center",children:"-"})}const kd=T(us)`
  padding: ${({theme:s})=>s.spacing(8)}
    ${({theme:s})=>s.spacing(11)};
  margin-top: 20px;
  &:first-child {
    margin-top: 0px;
  }
`,QD=({household:s,flexFieldsData:t})=>{const{t:a}=M(),n=Hs(t?.allHouseholdsFlexFieldsAttributes,"name","*");if(Object.entries(s?.flexFields||{}).length===0)return e.jsx(kd,{children:e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("No additional registration information available")})})});const i=Object.entries(s?.flexFields||{}).map(([r,l])=>{const o=r.replaceAll("_h_f","").replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2");if(n[r]?.type==="IMAGE")return e.jsx(L,{label:o,children:e.jsx(YD,{field:n[r]})},r);if(n[r]?.type==="SELECT_MANY"||n[r]?.type==="SELECT_ONE"){let d=n[r].choices.find(c=>c.value===l)?.labelEn||"-";return Array.isArray(l)&&(d=l.map(c=>n[r].choices.find(u=>u.value===c)?.labelEn||"-").join(", ")),e.jsx(L,{label:o,value:d},r)}if(l&&typeof l=="object"&&!Array.isArray(l)){const d=Bc(l);return e.jsx(L,{label:o,children:e.jsx("div",{style:{whiteSpace:"pre-line",fontFamily:"monospace",fontSize:"0.9em"},children:d})},r)}if(Array.isArray(l)){const d=l.map(c=>bi(c)).join(", ");return e.jsx(L,{label:o,value:d},r)}return e.jsx(L,{label:o,value:bi(l)},r)});return e.jsx("div",{children:e.jsxs(kd,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Additional Registration information")})}),e.jsx(p,{container:!0,spacing:6,children:i.map((r,l)=>e.jsx(p,{size:4,children:r},l))})]})})},XD=T.div`
  display: flex;
  flex: 1;
  width: 100%;
  background-color: #fff;
  padding: ${({theme:s})=>s.spacing(8)}
    ${({theme:s})=>s.spacing(11)};
  flex-direction: column;
  align-items: center;
  border-color: #b1b1b5;
  border-bottom-width: 1px;
  border-bottom-style: solid;

  && > div {
    margin: 5px;
  }
`;function JD({household:s,baseUrl:t,businessArea:a,grievancesChoices:n}){const{t:i}=M(),{selectedProgram:r}=Z(),l=r?.beneficiaryGroup;return e.jsxs(e.Fragment,{children:[e.jsxs(XD,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:i("Details")})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:3,children:e.jsx(L,{label:`${l?.groupLabel} Size`,children:s?.size})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("Residence Status"),children:s?.residenceStatus})}),e.jsx(p,{size:6,children:e.jsx(L,{label:`Head of ${l?.groupLabel}`,children:e.jsx(Us,{href:`/${t}/population/individuals/${s?.headOfHousehold?.id}`,children:s?.headOfHousehold?.fullName})})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("FEMALE CHILD HEADED "+l?.groupLabel),children:s?.fchildHoh?i("Yes"):i("No")})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("CHILD HEADED "+l?.groupLabel),children:s?.childHoh?i("Yes"):i("No")})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("Country"),children:s?.country})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("Country of Origin"),children:s?.countryOrigin})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("Address"),children:s?.address})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("Village"),children:s?.village})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("Zip code"),children:s?.zipCode})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("Administrative Level 1"),children:s?.admin1?.name})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("Administrative Level 2"),children:s?.admin2?.name})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("Administrative Level 3"),children:s?.admin3?.name})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("Administrative Level 4"),children:s?.admin4?.name})}),e.jsx(p,{size:6,children:e.jsx(L,{label:i("Geolocation"),children:s?.geopoint?`${s?.geopoint?.[0]}, ${s?.geopoint?.[1]}`:"-"})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("UNHCR CASE ID"),children:s?.unhcrId})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("LENGTH OF TIME SINCE ARRIVAL"),children:s?.flexFields?.months_displaced_h_f})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("NUMBER OF TIMES DISPLACED"),children:s?.flexFields?.number_times_displaced_h_f})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("IS THIS A RETURNEE "+l?.groupLabel+"?"),children:s?.returnee?i("Yes"):i("No")})}),e.jsx(p,{size:3,children:s?.unicefId&&e.jsx(ro,{household:s,baseUrl:t,businessArea:a,grievancesChoices:n})}),e.jsx(p,{size:3,children:e.jsx(L,{label:i("Data Collecting Type"),children:r?.dataCollectingType?.label})})]})]}),e.jsxs(ra,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:i("Benefits")})}),e.jsxs(p,{container:!0,children:[e.jsx(p,{size:3,children:e.jsx(L,{label:i("Cash received"),children:s?.deliveredQuantities?.length?e.jsx(P,{mb:2,children:e.jsx(p,{container:!0,children:e.jsx(p,{size:6,children:e.jsx(P,{display:"flex",flexDirection:"column",children:s?.deliveredQuantities?.map(o=>e.jsx(P,{children:o.currency==="USD"?Ps(o.totalDeliveredQuantity,o.currency):`(${Ps(o.totalDeliveredQuantity,o.currency)})`},`${o.currency}-${o.totalDeliveredQuantity}`))})})})}):e.jsx(e.Fragment,{children:"-"})})}),e.jsx(p,{size:3,children:e.jsx(an,{children:e.jsx(L,{label:i("Total Cash Received"),children:e.jsx(ba,{children:Ps(Number(s?.totalCashReceivedUsd),"USD")})})})})]})]})]})}const ZD=[{disablePadding:!1,label:"Payment ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Head of Household",id:"headOfHousehold",numeric:!1},{disablePadding:!1,label:"Entitlement Quantity",id:"entitlement_quantity",numeric:!0},{disablePadding:!1,label:"Delivered Quantity",id:"delivered_quantity",numeric:!0},{disablePadding:!1,label:"Delivery Date",id:"delivery_date",numeric:!0}];function eT({payment:s,openInNewTab:t,canViewDetails:a}){const{baseUrl:n}=U(),i=ge(),r=`/${n}/payment-module/payments/${s.id}`,l=()=>{t?window.open(r):i(r)};return e.jsxs(rs,{hover:!0,onClick:a?l:void 0,role:"checkbox",children:[e.jsx(_,{align:"left",children:a?e.jsx(me,{to:r,children:s.unicefId}):s.unicefId}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Na,statusNameMapping:Ya})}),e.jsx(_,{align:"left",children:s.hohFullName}),e.jsx(_,{align:"right",children:Ps(Number(s.entitlementQuantity),s.currency)}),e.jsx(_,{align:"right",children:Ps(s.deliveredQuantity,s.currency)}),e.jsx(_,{align:"right",children:e.jsx(pe,{children:s.deliveryDate})})]},s.id)}function sT({household:s,openInNewTab:t=!1,businessArea:a,canViewPaymentRecordDetails:n}){const{t:i}=M(),{programId:r}=U(),l={id:s?.id,businessAreaSlug:a,programSlug:r},[o,d]=A.useState(l),[c,u]=A.useState(0),{data:h,isLoading:m,error:g}=V({queryKey:["businessAreasProgramsPaymentPlansPaymentsList",o,s?.id,a,r],queryFn:()=>N.restBusinessAreasProgramsHouseholdsPaymentsList(Ce({businessAreaSlug:a,programSlug:r,id:s?.id},o,{withPagination:!0}))}),{data:x}=V({queryKey:["businessAreasProgramsHouseholdsPaymentsCount",r,a,o,s?.id],queryFn:()=>N.restBusinessAreasProgramsHouseholdsPaymentsCountRetrieve(Ce({businessAreaSlug:a,programSlug:r,id:s?.id},o)),enabled:c===0}),{selectedProgram:f}=Z(),j=f?.beneficiaryGroup,b=$s(ZD,j,{headOfHousehold:v=>`Head of ${v?.groupLabel}`,fullName:v=>`${v?.memberLabel}`,relationship:v=>`Relationship to Head of ${v?.groupLabel}`}),C=vs(c,x);return e.jsx(ds,{title:i("Payments"),headCells:b,data:h,error:g,isLoading:m,queryVariables:o,setQueryVariables:d,page:c,setPage:u,itemsCount:C,renderRow:v=>e.jsx(eT,{payment:v,openInNewTab:t,canViewDetails:n},v.id)})}const tT=oe(sT,"PaymentsHouseholdTable"),aT=T("div")`
  width: 100%;
`,nT=T(us)`
  width: 100%;
  margin-bottom: 8px;
  overflow: clip;
`,iT=T(gs)`
  min-width: 750px;
`,Rr=T(be)`
  height: 70px;
  min-height: 70px;
`,Fr=T(_)`
  col-span: ${s=>s.colSpan};
  && {
    white-space: nowrap;
    overflow: auto;
  }
`,rT=T(Ut)``,wd=T(P)`
  display: flex;
  justify-content: space-between;
`,lT=T(iT)`
  aria-labelledby: 'tableTitle';
  size: 'medium';
  aria-label: 'enhanced table';
  data-cy: 'table-title';
`,oT=T.div`
  display: flex;
  width: 100%;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  color: #a9a9a9;
  font-size: 24px;
  line-height: 28px;
  text-align: center;
  padding: 70px;
`,dT=T(P)`
  font-size: 16px;
  color: #a9a9a9;
`,cT=T(P)`
  font-size: 50px;
`,uT=T(mc)`
  & svg {
    color: #9e9e9e;
  }
`;function hT({title:s="",renderRow:t,data:a,headCells:n,rowsPerPageOptions:i,rowsPerPage:r,page:l,itemsCount:o,handleChangePage:d,handleChangeRowsPerPage:c,handleRequestSort:u,order:h,orderBy:m,onSelectAllClick:g,loading:x=!1,allowSort:f=!0,isOnPaper:j=!0,actions:y=[],numSelected:b=0}){const{t:C}=M(),v=()=>{const D=w=>{d(w,l-1)},F=w=>{d(w,l+1)};return e.jsxs(P,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(Ve,{onClick:D,disabled:l===0||x,"aria-label":"previous page",children:e.jsx(rl,{})}),e.jsx(Ve,{onClick:F,disabled:l>=Math.ceil(o/r)-1||x,"aria-label":"next page",children:e.jsx(ll,{})})]})},S=o?r-Math.min(r,o-l*r):r;let I;x?I=Array.from({length:r}).map(()=>e.jsx(Rr,{"data-cy":"table-row",children:e.jsx(Fr,{colSpan:n.length,children:e.jsx(pc,{variant:"rectangular",width:"100%",height:70})})},crypto.randomUUID())):a?.length?I=e.jsxs(e.Fragment,{children:[a.map(D=>t(D)),S>0&&e.jsx(Rr,{style:{height:70},children:e.jsx(Fr,{colSpan:n.length})})]}):I=e.jsx(Rr,{"data-cy":"table-row",style:{height:70*S},children:e.jsx(Fr,{colSpan:n.length,children:e.jsxs(oT,{children:[e.jsx(cT,{children:e.jsx(uT,{fontSize:"inherit"})}),e.jsx(P,{mt:2,children:"No results"}),e.jsx(dT,{mt:2,children:C("Try adjusting your search or your filters to find what you are looking for.")})]})})});const E=e.jsxs(e.Fragment,{children:[e.jsxs(rT,{children:[e.jsxs(wd,{children:[s?e.jsx(Ml,{title:s}):null,e.jsx(wd,{p:5,children:y||null})]}),e.jsxs(lT,{children:[e.jsx(wl,{order:h,headCells:n,orderBy:m,onRequestSort:u,rowCount:a.length,allowSort:f,onSelectAllClick:g,data:a,numSelected:b}),e.jsx(cs,{children:I})]})]}),e.jsx(Ua,{rowsPerPageOptions:i,component:"div",count:o,rowsPerPage:r,page:l,onPageChange:d,onRowsPerPageChange:c,ActionsComponent:v,"data-cy":"table-pagination"})]});return e.jsx(aT,{children:j?e.jsx(nT,{children:E}):E})}const mT=[{disablePadding:!1,label:"Role",id:"role",numeric:!1},{disablePadding:!1,label:"Individual",id:"fullName",numeric:!1},{disablePadding:!1,label:"Relationship to Household",id:"relationship",numeric:!1}],pT=({household:s,choicesData:t})=>{const a=ge(),{baseUrl:n,businessArea:i,programId:r}=U(),[l,o]=A.useState(0),[d,c]=A.useState(5),[u,h]=A.useState(null),[m,g]=A.useState("asc"),x=O=>{a(`/${n}/population/individuals/${O.id}`)},{selectedProgram:f}=Z(),j=f?.beneficiaryGroup,b=$s(mT,j,{fullName:O=>`${O?.memberLabel}`,relationship:O=>`Relationship to ${O?.groupLabel}`}),C=_s(t?.roleChoices),v=_s(t?.relationshipChoices),{data:S,isLoading:I,error:E}=V({queryKey:["businessAreasProgramsHouseholdsMembers",r,i,s.id],queryFn:()=>N.restBusinessAreasProgramsHouseholdsMembersList({businessAreaSlug:i,programSlug:r,id:s.id}),enabled:!!i&&!!r&&!!s?.id});if(I)return e.jsx(Ne,{});if(E)return console.error("Error loading household members:",E),e.jsx("div",{children:"Error loading collectors. Please try again."});const D=(S?.results||[]).filter(O=>O.role!==null);let F=[...D];u&&(m==="asc"?F.sort((O,k)=>O[u]<k[u]?1:-1):F.sort((O,k)=>O[u]>k[u]?1:-1)),F=F.sort((O,k)=>O.role==="PRIMARY"?-1:k.role==="PRIMARY"?1:O.role==="ALTERNATE"?-1:k.role==="ALTERNATE"?1:0);const w=D.length;return e.jsx(hT,{title:"Collectors",data:F.slice(l*d,l*d+d),allowSort:!1,renderRow:O=>{const k=O.relationship==="HEAD",$=W=>k?e.jsx(zn,{children:W}):W,G=()=>{if(!O.household)return"Not a beneficiary";if(s?.id!==O?.household?.id)return e.jsxs(me,{to:`/${n}/population/household/${O.household.id}`,children:["Member of ",O.household.unicefId]});if(s?.id===O?.household?.id)return e.jsx("span",{children:$(v[O.relationship])})};return e.jsxs(rs,{hover:!0,onClick:()=>x(O),role:"checkbox",children:[e.jsx(_,{align:"left",children:C[O.role]}),e.jsx(_,{align:"left",children:O.fullName}),e.jsx(_,{align:"left",children:G()})]},O.id)},headCells:b,rowsPerPageOptions:w<5?[w||1]:[5,10,15],rowsPerPage:w>5?d:w||1,page:l,itemsCount:w,handleChangePage:(O,k)=>{o(k)},handleChangeRowsPerPage:O=>{c(Number(O.target.value)),o(0)},handleRequestSort:(O,k)=>{let $="asc";k===u&&($=m==="asc"?"desc":"asc"),h(k),g($)},orderBy:u,order:m})},gT=[{disablePadding:!1,label:"Individual ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Individual",id:"fullName",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Relationship to HoH",id:"relationship",numeric:!1},{disablePadding:!1,label:"Date of Birth",id:"birthDate",numeric:!0},{disablePadding:!1,label:"Gender",id:"sex",numeric:!1}],xT=({household:s,choicesData:t})=>{const a=ge(),{baseUrl:n}=U(),i=b=>{a(`/${n}/population/individuals/${b.id}`)},r=_s(t?.relationshipChoices),{selectedProgram:l}=Z(),o=l?.beneficiaryGroup,c=$s(gT,o,{unicefId:b=>`${b?.memberLabel} ID`,fullName:b=>`${b?.memberLabel}`,relationship:b=>`Relationship to Head of ${b?.groupLabel}`}),{programId:u,businessArea:h}=U(),m=A.useMemo(()=>({businessAreaSlug:h,programSlug:u}),[h,u]),[g,x]=A.useState(m);A.useEffect(()=>{x(m)},[m]);const{data:f,isLoading:j,error:y}=V({queryKey:["businessAreasProgramsHouseholdsMembers",u,h,s.id],queryFn:()=>N.restBusinessAreasProgramsHouseholdsMembersList({businessAreaSlug:h,programSlug:u,id:s.id}),enabled:!!h&&!!u});return e.jsx(ds,{title:`${o?.groupLabel} Members`,allowSort:!1,headCells:c,data:f,error:y,isLoading:j,queryVariables:g,setQueryVariables:x,renderRow:b=>{const C=b.relationship==="HEAD",v=S=>C?e.jsx(zn,{children:S}):S;return e.jsxs(rs,{hover:!0,onClick:()=>i(b),role:"checkbox",children:[e.jsx(_,{align:"left",children:v(e.jsx(me,{to:`/${n}/population/individuals/${b.id}`,children:b.unicefId}))}),e.jsx(_,{align:"left",children:v(b.fullName)}),e.jsx(_,{align:"left",children:e.jsx(we,{status:b.status,statusToColor:Ep})}),e.jsx(_,{align:"left",children:v(s?.id===b?.household?.id?r[b.relationship]:r.NON_BENEFICIARY)}),e.jsx(_,{align:"right",children:v(e.jsx(pe,{children:b.birthDate}))}),e.jsx(_,{align:"left",children:v(ga(b.sex))})]},b.id)}})},Ds=T(_)`
  background-color: #eeeeee;
`,fT=T(us)`
  margin: 20px 20px 0 20px;
  padding: 20px ${({theme:s})=>s.spacing(11)};
`;function yT({household:s}){const{t}=M(),{selectedProgram:a}=Z(),n=a?.beneficiaryGroup;return e.jsxs(fT,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:`${n?.groupLabel} Composition`})}),e.jsxs(gs,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{align:"left",children:t("Age Group")}),e.jsx(Ds,{align:"left",children:t("Females")}),e.jsx(Ds,{align:"left",children:t("with disability")}),e.jsx(Ds,{align:"left",children:t("Pregnant")}),e.jsx(_,{align:"left"}),e.jsx(Ds,{align:"left",children:t("Males")}),e.jsx(Ds,{align:"left",children:t("with disability")})]})}),e.jsxs(cs,{children:[e.jsxs(be,{"data-cy":"row05",children:[e.jsx(_,{align:"left",children:"0 - 5"}),e.jsx(Ds,{align:"left",children:s?.femaleAgeGroup05Count}),e.jsx(Ds,{align:"left",children:s?.femaleAgeGroup05DisabledCount}),e.jsx(Ds,{align:"left",children:"-"}),e.jsx(_,{align:"left"}),e.jsx(Ds,{align:"left",children:s?.maleAgeGroup05Count}),e.jsx(Ds,{align:"left",children:s?.maleAgeGroup05DisabledCount})]}),e.jsxs(be,{children:[e.jsx(_,{align:"left",children:"6 - 11"}),e.jsx(Ds,{align:"left",children:s?.femaleAgeGroup611Count}),e.jsx(Ds,{align:"left",children:s?.femaleAgeGroup611DisabledCount}),e.jsx(Ds,{align:"left",children:"-"}),e.jsx(_,{align:"left"}),e.jsx(Ds,{align:"left",children:s?.maleAgeGroup611Count}),e.jsx(Ds,{align:"left",children:s?.maleAgeGroup611DisabledCount})]}),e.jsxs(be,{children:[e.jsx(_,{align:"left",children:"12 - 17"}),e.jsx(Ds,{align:"left",children:s?.femaleAgeGroup1217Count}),e.jsx(Ds,{align:"left",children:s?.femaleAgeGroup1217DisabledCount}),e.jsx(Ds,{align:"left",children:"-"}),e.jsx(_,{align:"left"}),e.jsx(Ds,{align:"left",children:s?.maleAgeGroup1217Count}),e.jsx(Ds,{align:"left",children:s?.maleAgeGroup1217DisabledCount})]}),e.jsxs(be,{children:[e.jsx(_,{align:"left",children:"18 - 59"}),e.jsx(Ds,{align:"left",children:s?.femaleAgeGroup1859Count}),e.jsx(Ds,{align:"left",children:s?.femaleAgeGroup1859DisabledCount}),e.jsx(Ds,{align:"left",children:s?.pregnantCount}),e.jsx(_,{align:"left"}),e.jsx(Ds,{align:"left",children:s?.maleAgeGroup1859Count}),e.jsx(Ds,{align:"left",children:s?.maleAgeGroup1859DisabledCount})]}),e.jsxs(be,{children:[e.jsx(_,{align:"left",children:"60 +"}),e.jsx(Ds,{align:"left",children:s?.femaleAgeGroup60Count}),e.jsx(Ds,{align:"left",children:s?.femaleAgeGroup60DisabledCount}),e.jsx(Ds,{align:"left",children:"-"}),e.jsx(_,{align:"left"}),e.jsx(Ds,{align:"left",children:s?.maleAgeGroup60Count}),e.jsx(Ds,{align:"left",children:s?.maleAgeGroup60DisabledCount})]})]})]}),e.jsx(P,{display:"flex",mt:2,children:e.jsx(P,{children:e.jsx(L,{label:t("Other"),value:s?.otherSexGroupCount})})})]})}const bT=T.div`
  padding: 20px;
  && {
    display: flex;
    flex-direction: column;
    width: 100%;
  }
`,jT=T(us)`
  padding: ${({theme:s})=>s.spacing(8)}
    ${({theme:s})=>s.spacing(11)};
  margin-top: 20px;
  &:first-child {
    margin-top: 0;
  }
`,AT=T(ee)`
  && {
    font-size: 16px;
  }
`,_T=()=>{const{t:s}=M(),{id:t}=ts(),{baseUrl:a,businessArea:n,programId:i}=U(),r=je(),l=ve(),{selectedProgram:o}=Z(),d=o?.beneficiaryGroup,{data:c,isLoading:u,error:h}=mn(t,N.restBusinessAreasProgramsHouseholdsRetrieve,{}),{data:m,isLoading:g}=V({queryKey:["fieldsAttributes",n,i],queryFn:async()=>({allHouseholdsFlexFieldsAttributes:await N.restBusinessAreasProgramsHouseholdsAllFlexFieldsAttributesList({businessAreaSlug:n,programSlug:i})})}),{data:x,isLoading:f}=V({queryKey:["individualChoices",n],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:n})}),{data:j,isLoading:y}=V({queryKey:["businessAreasGrievanceTicketsChoices",n],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:n})});if(f||g||y||u)return e.jsx(Ne,{});if(rt(h))return e.jsx(Xe,{permission:R.POPULATION_VIEW_HOUSEHOLDS_DETAILS});if(!x||!j||!m||l===null||!c)return null;let b=[{title:d?.groupLabelPlural,to:`/${a}/population/household`}];const C=r?.state?.breadcrumbTitle,v=r?.state?.breadcrumbUrl;return C&&v&&(b=[{title:C,to:v}]),e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`${d?.groupLabel}: ${Aa(c?.unicefId)}`,breadCrumbs:K(R.POPULATION_VIEW_HOUSEHOLDS_LIST,l)?b:null,flags:e.jsxs(e.Fragment,{children:[e.jsx(P,{sx:{mr:2},children:c?.hasDuplicates&&e.jsx(Sa,{confirmed:!0,message:`${d?.groupLabel} has Duplicates`})}),e.jsx(P,{sx:{mr:2},children:c?.sanctionListPossibleMatch&&e.jsx(Ga,{message:s("Sanction List Possible Match")})}),e.jsx(P,{sx:{mr:2},children:c?.sanctionListConfirmedMatch&&e.jsx(Ga,{message:s("Sanction List Confirmed Match"),confirmed:!0})}),e.jsx(gt,{adminUrl:c?.adminUrl})]})}),e.jsx(JD,{household:c,baseUrl:a,businessArea:n,grievancesChoices:j}),e.jsx(yT,{household:c}),e.jsxs(bT,{children:[c?e.jsxs(e.Fragment,{children:[e.jsx(xT,{choicesData:x,household:c}),e.jsx(pT,{choicesData:x,household:c})]}):null,K(R.PROGRAMME_VIEW_PAYMENT_RECORD_DETAILS,l)&&e.jsx(tT,{openInNewTab:!0,household:c,businessArea:n,canViewPaymentRecordDetails:K(R.PM_VIEW_PAYMENT_LIST,l)}),e.jsx(QD,{household:c,flexFieldsData:m}),e.jsxs(jT,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:s("Registration Details")})}),e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("Source"),children:e.jsx("div",{children:c?.registrationDataImport?.dataSource})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("Import name"),children:e.jsx("div",{children:c?.registrationDataImport?.name})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("Registration Date"),children:e.jsx("div",{children:e.jsx(pe,{children:c?.lastRegistrationDate})})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("User name"),children:c?.registrationDataImport?.importedBy?.email})}),c?.programRegistrationId&&e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("Programme registration id"),children:c.programRegistrationId})})]}),c?.registrationDataImport?.dataSource==="XLS"?null:e.jsxs(e.Fragment,{children:[e.jsx("hr",{}),e.jsx(AT,{variant:"h6",children:s("Data Collection")}),e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("Start time"),children:e.jsx(pe,{children:c?.start})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("End time"),children:e.jsx(pe,{children:c?.firstRegistrationDate})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:s("Device ID"),children:c?.deviceid})})]})]})]})]}),K(R.ACTIVITY_LOG_VIEW,l)&&e.jsx(Lt,{objectId:c?.id})]})},PT=oe(_T,"PopulationHouseholdDetailsPage"),CT=[{disablePadding:!1,label:"",id:"sanctionListPossibleMatch",numeric:!1,dataCy:"sanction-list-possible-match"},{disablePadding:!1,label:"Household ID",id:"unicefId",numeric:!1,dataCy:"household-id"},{disablePadding:!1,label:"Status",id:"status_label",numeric:!1,dataCy:"status"},{disablePadding:!1,label:"Head of Household",id:"head_of_household__full_name",numeric:!1,dataCy:"household-head-name"},{disablePadding:!1,label:"Household Size",id:"size",numeric:!1,dataCy:"household-size"},{disablePadding:!1,label:"Administrative Level 2",id:"admin_area__name",numeric:!1,dataCy:"household-location"},{disablePadding:!1,label:"Residence Status",id:"residenceStatus",numeric:!1,dataCy:"household-residence-status"},{disablePadding:!1,label:"Total Cash Received",id:"totalCashReceived",numeric:!0,dataCy:"household-total-cash-received"},{disablePadding:!1,label:"Registration Date",id:"firstRegistrationDate",numeric:!0,dataCy:"household-registration-date"}],ET=({filter:s,canViewDetails:t})=>{const{selectedProgram:a}=Z(),{businessArea:n,programId:i}=U(),r=a?.beneficiaryGroup,[l,o]=A.useState(0),d=A.useMemo(()=>{const I=()=>{if(s.withdrawn==="true")return!0;if(s.withdrawn==="false")return!1};return{businessAreaSlug:n,programSlug:i,sizeMin:s.householdSizeMin,sizeMax:s.householdSizeMax,search:s.search.trim(),documentType:s.documentType,documentNumber:s.documentNumber.trim(),admin1:s.admin1,admin2:s.admin2,residenceStatus:s.residenceStatus,withdrawn:I(),ordering:s.orderBy,rdiMergeStatus:"MERGED",page:l}},[n,i,s.householdSizeMin,s.householdSizeMax,s.search,s.documentType,s.documentNumber,s.admin1,s.admin2,s.residenceStatus,s.withdrawn,s.orderBy,l]);A.useEffect(()=>{o(0)},[n,i,s,s.householdSizeMin,s.householdSizeMax,s.search,s.documentType,s.documentNumber,s.admin1,s.admin2,s.residenceStatus,s.withdrawn,s.orderBy]);const[c,u]=A.useState(d);A.useEffect(()=>{u(d)},[d]);const{data:h,isLoading:m,error:g}=V({queryKey:["businessAreasProgramsHouseholdsList",c,i,n],queryFn:()=>N.restBusinessAreasProgramsHouseholdsList(Ce({businessAreaSlug:n,programSlug:i},c,{withPagination:!0}))}),{data:x}=V({queryKey:["businessAreasProgramsHouseholdsCount",i,n,c],queryFn:()=>N.restBusinessAreasProgramsHouseholdsCountRetrieve(Ce({businessAreaSlug:n,programSlug:i},c)),enabled:l===0}),f=vs(l,x),y=$s(CT,r,{unicefId:I=>`${I?.groupLabel} ID`,head_of_household__full_name:I=>`Head of ${I?.groupLabel}`,size:I=>`${I?.groupLabel} Size`}),b=ge(),{t:C}=M(),{baseUrl:v}=U(),S=I=>{if(!I)return e.jsx(e.Fragment,{});const E=`/${v}/population/household/${I.id}`,D=()=>{b(E)};return e.jsxs(rs,{hover:!0,onClick:t?D:void 0,role:"checkbox","data-cy":"household-table-row",children:[e.jsx(_,{align:"left",children:e.jsxs(e.Fragment,{children:[e.jsx(Ot,{mr:2,children:I.hasDuplicates&&e.jsx(Sa,{confirmed:!0,message:C("Houesehold has Duplicates")})}),e.jsx(Ot,{mr:2,children:I.sanctionListPossibleMatch&&e.jsx(Ga,{message:C("Sanction List Possible Match")})}),e.jsx(Ot,{mr:2,children:I.sanctionListConfirmedMatch&&e.jsx(Ga,{message:C("Sanction List Confirmed Match"),confirmed:!0})})]})}),e.jsx(_,{align:"left",children:e.jsx(me,{to:E,children:I.unicefId})}),e.jsx(_,{align:"left",children:e.jsx(we,{status:I.status,statusToColor:Un})}),e.jsx(Jt,{children:I.headOfHousehold}),e.jsx(_,{align:"left",children:I.size}),e.jsx(_,{align:"left",children:I.admin2?.name||"-"}),e.jsx(_,{align:"left",children:I.residenceStatus}),e.jsx(_,{align:"right",children:Ps(Number(I.totalCashReceived),I.currency?.toString())}),e.jsx(_,{align:"right",children:e.jsx(pe,{children:I.lastRegistrationDate})})]},I.unicefId)};return e.jsx(Es,{children:e.jsx(ds,{title:`${r?.groupLabelPlural}`,renderRow:S,headCells:y,rowsPerPageOptions:[10,15,20],data:h,error:g,isLoading:m,queryVariables:c,setQueryVariables:u,itemsCount:f,page:l,setPage:o})})};function vT(){const s=je(),{businessArea:t}=U(),{selectedProgram:a}=Z(),n=a?.beneficiaryGroup,{data:i,isLoading:r}=V({queryKey:["householdChoices",t],queryFn:()=>N.restBusinessAreasHouseholdsChoicesRetrieve({businessAreaSlug:t})}),l={search:"",documentType:i?.documentTypeChoices?.[0]?.value,documentNumber:"",residenceStatus:"",admin1:"",admin2:"",householdSizeMin:"",householdSizeMax:"",orderBy:"unicef_id",withdrawn:""},[o,d]=A.useState(Ke(s,l)),[c,u]=A.useState(Ke(s,l)),[h,m]=A.useState(!1),g=A.useRef(null);et(g,h,c,()=>m(!1));const x=ve();return r?e.jsx(Ne,{}):x===null?null:K(R.POPULATION_VIEW_HOUSEHOLDS_LIST,x)?i?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:n?.groupLabelPlural}),e.jsx(bu,{filter:o,choicesData:i,setFilter:d,initialFilter:l,appliedFilter:c,setAppliedFilter:f=>{u(f),m(!0)}}),e.jsx(P,{display:"flex",flexDirection:"column","data-cy":"page-details-container",ref:g,children:e.jsx(ET,{filter:c,canViewDetails:K(R.POPULATION_VIEW_HOUSEHOLDS_DETAILS,x)})})]}):null:e.jsx(Xe,{permission:R.POPULATION_VIEW_HOUSEHOLDS_LIST})}const ST=oe(vT,"PopulationHouseholdPage"),IT=T(us)`
  padding: ${({theme:s})=>s.spacing(8)}
    ${({theme:s})=>s.spacing(11)};
`,Pn=T.div`
  border-bottom: 1px solid #e1e1e1;
`,DT=({individual:s,baseUrl:t,businessArea:a,choicesData:n,grievancesChoices:i})=>{const{t:r}=M(),{selectedProgram:l}=Z(),o=l?.beneficiaryGroup,d=_s(n.relationshipChoices),c=_s(n.maritalStatusChoices),u=_s(n.workStatusChoices),h=_s(n.roleChoices),m=_s(n.severityOfDisabilityChoices),g=_s(n.observedDisabilityChoices),x=s?.documents?.map(b=>e.jsx(p,{size:{xs:3},children:e.jsxs(P,{flexDirection:"column",children:[e.jsx(P,{mb:1,children:e.jsx(L,{label:b.type.label,children:b.photo?e.jsx(ch,{documentNumber:b.documentNumber,documentId:b.id,individual:s}):b.documentNumber})}),e.jsx(L,{label:"issued",children:b.country.name})]})},b.id)),f=s?.identities?.map(b=>e.jsx(p,{size:{xs:3},children:e.jsxs(P,{flexDirection:"column",children:[e.jsx(P,{mb:1,children:e.jsx(L,{label:`${b.partner} ID`,children:b.number})}),e.jsx(L,{label:"issued",children:b.country.name})]})},b.id)),j=e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:`Linked ${o?.groupLabelPlural}`,children:s?.rolesInHouseholds?.length?s?.rolesInHouseholds?.map(b=>e.jsxs(P,{children:[b.household.unicefId," -",h[b.role]]},b.id)):"-"})}),y=()=>e.jsxs(e.Fragment,{children:[e.jsx(p,{size:{xs:12},children:e.jsx(Pn,{})}),e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:r("Wallet Name"),children:s?.walletName})}),e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:r("Blockchain Name"),children:s?.blockchainName})}),e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:r("Wallet Address"),children:s?.walletAddress})})]});return e.jsxs(IT,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:r("Bio Data")})}),e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Full Name"),children:s?.fullName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Given Name"),children:s?.givenName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Middle Name"),children:s?.middleName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Family Name"),children:s?.familyName})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Gender"),children:ga(s?.sex)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Age"),children:Sl(s?.age)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Date of Birth"),children:e.jsx(pe,{children:s?.birthDate})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Estimated Date of Birth"),children:Va(s?.estimatedBirthDate)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Marital Status"),children:c[s?.maritalStatus]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Work Status"),children:u[s?.workStatus]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Pregnant"),children:Va(s?.pregnant)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:`${o?.groupLabel} ID`,children:s?.household?.id?e.jsx(Us,{href:`/${t}/population/household/${s?.household?.id}`,children:s?.household?.unicefId}):e.jsx("span",{children:"-"})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Role"),children:h[s?.role]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:`Relationship to Head Of ${o?.groupLabel}`,children:d[s?.relationship]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Preferred language"),children:s?.preferredLanguage})}),j,e.jsx(p,{size:{xs:12},children:e.jsx(Pn,{})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Observed disabilities"),children:g[s?.observedDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Seeing disability severity"),children:m[s?.seeingDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Hearing disability severity"),children:m[s?.hearingDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Physical disability severity"),children:m[s?.physicalDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Remembering or concentrating disability severity"),children:m[s?.memoryDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Self-care disability severity"),children:m[s?.selfcareDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Communicating disability severity"),children:m[s?.commsDisability]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Disability"),children:s?.disability===yl.DISABLED?"Disabled":"Not Disabled"})}),!x?.length&&!f?.length?null:e.jsx(p,{size:{xs:12},children:e.jsx(Pn,{})}),x,f,e.jsx(p,{size:{xs:12},children:e.jsx(Pn,{})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Email"),children:s?.email})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Phone Number"),children:Kt(s?.phoneNo,s?.phoneNoValid)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Alternative Phone Number"),children:Kt(s?.phoneNoAlternative,s?.phoneNoAlternativeValid)})}),e.jsx(p,{size:{xs:12},children:e.jsx(Pn,{})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:r("Date of last screening against sanctions list"),children:e.jsx(pe,{children:s?.sanctionListLastCheck})})}),e.jsx(p,{size:{xs:6},children:s?.household?.unicefId&&e.jsx(ro,{household:s?.household,baseUrl:t,businessArea:a,grievancesChoices:i})}),y()]})]})},TT=T.div`
  padding: 20px;
  && {
    display: flex;
    flex-direction: column;
    width: 100%;
  }
`,RT=()=>{const{id:s}=ts(),t=je(),{selectedProgram:a}=Z(),n=a?.beneficiaryGroup,{t:i}=M(),{baseUrl:r,businessArea:l,programId:o}=U(),d=ve(),{data:c,isLoading:u,error:h}=mn(s,N.restBusinessAreasProgramsIndividualsRetrieve,{}),{data:m,isLoading:g}=V({queryKey:["individualChoices",l],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:l})}),{data:x,isLoading:f}=V({queryKey:["fieldsAttributes",l,o],queryFn:async()=>({allIndividualsFlexFieldsAttributes:await N.restBusinessAreasProgramsIndividualsAllFlexFieldsAttributesList({businessAreaSlug:l,programSlug:o})})}),{data:j,isLoading:y}=V({queryKey:["businessAreasGrievanceTicketsChoices",l],queryFn:()=>N.restBusinessAreasGrievanceTicketsChoicesRetrieve({businessAreaSlug:l})}),{data:b,isLoading:C}=V({queryKey:["periodicFields",l,o],queryFn:()=>N.restBusinessAreasProgramsPeriodicFieldsList({businessAreaSlug:l,programSlug:o,limit:1e3})});if(u||g||f||y||C)return e.jsx(Ne,{});if(rt(h))return e.jsx(Xe,{permission:R.POPULATION_VIEW_INDIVIDUALS_DETAILS});if(!c&&h?.message==="Not Found")return e.jsx(Gi,{specificError:`${n?.memberLabel} has been removed or does not exist`,goBackAddress:`/${r}/population/individuals`});if(!c||!m||!x||!j||!b||d===null)return null;let v=[{title:`${n?.memberLabelPlural}`,to:`/${r}/population/individuals`}];const S=t?.state?.breadcrumbTitle,I=t?.state?.breadcrumbUrl;return S&&I&&(v=[{title:S,to:I}]),e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`${i(`${n?.memberLabel} ID`)}: ${c?.unicefId}`,breadCrumbs:K(R.POPULATION_VIEW_INDIVIDUALS_LIST,d)?v:null,flags:e.jsxs(e.Fragment,{children:[e.jsx(rr,{individual:c}),e.jsx(gt,{adminUrl:c?.adminUrl})]}),children:e.jsx(P,{mr:2,children:c?.photo?e.jsx(lo,{individual:c}):null})}),e.jsxs(TT,{children:[e.jsx(DT,{baseUrl:r,businessArea:l,individual:c,choicesData:m,grievancesChoices:j}),e.jsx(uh,{individual:c,choicesData:m}),e.jsx(hh,{flexFieldsData:x,individual:c}),e.jsx(mh,{individual:c,periodicFieldsData:b}),K(R.ACTIVITY_LOG_VIEW,d)&&e.jsx(Lt,{objectId:c?.id})]})]})},FT=oe(RT,"PopulationIndividualsDetailsPage"),Cn=({shouldScroll:s,children:t})=>e.jsx(_,{style:{...s?{position:"sticky",top:0,background:"#fff",zIndex:3}:{},borderBottom:"1px solid #888"},children:t}),NT=({editRows:s,setEditRows:t,editingRows:a,setEditingRows:n,allPduFields:i,handleSaveRow:r,canSave:l,templateStatus:o,isAuthorized:d})=>{const{baseUrl:c}=U(),u=s.length>10||i.length>6,h=e.jsxs(gs,{children:[e.jsx(hs,{children:e.jsxs(be,{style:u?{position:"sticky",top:0,zIndex:2,background:"#fff"}:{},children:[e.jsx(Cn,{shouldScroll:u,children:Ee("Individual ID")}),e.jsx(Cn,{shouldScroll:u,children:Ee("First Name")}),e.jsx(Cn,{shouldScroll:u,children:Ee("Last Name")}),i.map(m=>e.jsx(Cn,{shouldScroll:u,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:120},children:[e.jsx("span",{style:{fontWeight:600},children:m.label}),m.roundNumber&&e.jsxs("span",{style:{fontSize:13,color:"#888"},children:[Ee("Round")," ",m.roundNumber||""]}),m.roundName&&e.jsx("span",{style:{fontSize:11,color:"#888"},children:m.roundName})]})},m.key)),e.jsx(Cn,{shouldScroll:u,children:e.jsx(e.Fragment,{})})]})}),e.jsx(cs,{children:s.length===0?e.jsx(be,{children:e.jsx(_,{colSpan:3+i.length,align:"center",children:Ee("No data available")})}):s.map((m,g)=>{const x=a.has(g),f=m.pduFields&&Object.values(m.pduFields).some(j=>j.isEditable);return e.jsxs(be,{children:[e.jsx(_,{children:m.individualUuid?e.jsx(me,{to:`/${c}/population/individuals/${m.individualUuid}`,children:m.unicefId}):Ee("-")}),e.jsx(_,{children:m.firstName}),e.jsx(_,{children:m.lastName}),i.map(j=>{const y=j.fieldName,b=m.pduFields?m.pduFields[y]:null;return e.jsx(_,{align:"center",children:b?x&&b.isEditable?b.subtype==="DATE"?e.jsx(Wr.LocalizationProvider,{dateAdapter:Ic.AdapterDateFns,children:e.jsx(Wr.DatePicker,{value:b.value?new Date(b.value):null,onChange:C=>{t(v=>{const S=[...v],I={...S[g].pduFields};let E=null;return C instanceof Date&&!isNaN(C.getTime())&&(E=Gt.format(C,"yyyy-MM-dd")),I[y]={...I[y],value:E},S[g]={...S[g],pduFields:I},S})},format:"yyyy-MM-dd",slotProps:{textField:{fullWidth:!0,inputProps:{mask:"____-__-__"}}}})}):b.subtype==="BOOL"?e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[e.jsx("span",{style:{cursor:"pointer"},title:Ee("Set YES"),onClick:()=>{t(C=>{const v=[...C],S={...v[g].pduFields};return S[y]={...S[y],value:!0},v[g]={...v[g],pduFields:S},v})},children:e.jsx(ja,{fontSize:"small",style:{color:b.value===!0?"green":"#ccc"}})}),e.jsx("span",{style:{cursor:"pointer"},title:Ee("Set NO"),onClick:()=>{t(C=>{const v=[...C],S={...v[g].pduFields};return S[y]={...S[y],value:!1},v[g]={...v[g],pduFields:S},v})},children:e.jsx(Ct,{fontSize:"small",style:{color:b.value===!1?"red":"#ccc"}})}),e.jsx("span",{style:{cursor:"pointer"},title:Ee("Clear"),onClick:()=>{t(C=>{const v=[...C],S={...v[g].pduFields};return S[y]={...S[y],value:null},v[g]={...v[g],pduFields:S},v})},children:e.jsx(Dc,{fontSize:"small",style:{color:b.value==null?"#888":"#ccc"}})})]}):e.jsx(ks,{variant:"outlined",fullWidth:!0,size:"small",type:b.subtype==="DECIMAL"?"number":"text",value:b.value??"",onChange:C=>{let v;b.subtype==="DECIMAL"?v=C.target.value===""?null:Number(C.target.value):v=C.target.value,t(S=>{const I=[...S],E={...I[g].pduFields};return E[y]={...E[y],value:v},I[g]={...I[g],pduFields:E},I})}}):b.subtype==="DATE"?b.value?e.jsx(pe,{children:b.value}):e.jsx("span",{style:{color:"#aaa"},children:Ee("-")}):b.subtype==="BOOL"?b.value===!0?e.jsx("span",{style:{color:"green"},children:e.jsx(ja,{fontSize:"small"})}):b.value===!1?e.jsx("span",{style:{color:"red"},children:e.jsx(Ct,{fontSize:"small"})}):e.jsx("span",{style:{color:"#aaa"},children:Ee("-")}):b.value!==void 0&&b.value!==null&&b.value!==""?e.jsx("span",{children:String(b.value)}):e.jsx("span",{style:{color:"#aaa"},children:Ee("-")}):e.jsx("span",{style:{color:"#aaa"},children:Ee("-")})},y)}),e.jsx(_,{children:l&&f&&o==="NEW"&&(x?e.jsx(H,{variant:"contained",color:"primary",size:"small",onClick:()=>{t(j=>{const y=[...j],b={...y[g].pduFields};return i.forEach(C=>{const v=b[C.key];v&&v.isEditable&&(typeof v.value=="string"&&v.value.trim()===""||v.value===void 0)&&v.subtype!=="BOOL"&&(b[C.key]={...v,value:null})}),y[g]={...y[g],pduFields:b},y}),r(g)},children:Ee("Save")}):e.jsx(H,{variant:"outlined",color:"primary",size:"small",disabled:!d,onClick:()=>n(j=>{const y=new Set(j);return y.add(g),y}),children:Ee("Edit")}))})]},m.individualUuid||g)})})]});return e.jsx(Ot,{pt:6,children:e.jsx(st,{p:0,containerPadding:{py:3,px:0},title:e.jsx(Ot,{p:6,children:e.jsx(ee,{"data-cy":"title",variant:"h6",children:"Periodic Data Update"})}),children:e.jsx("div",{style:{width:"100%",maxHeight:800,overflow:"auto",border:"1px solid #eee"},children:h})})})},LT=({comment:s,date:t,author:a})=>{let n=t;try{n=Gt.format(new Date(t),"yyyy-MM-dd HH:mm")}catch{}return e.jsxs(P,{sx:{background:"#FFF3EC",borderRadius:3,p:2.5,display:"flex",alignItems:"center",gap:2,mb:2,maxWidth:900,minHeight:64},"data-testid":"sent-back-comment",children:[e.jsx(P,{sx:{display:"flex",alignItems:"center",height:"100%"},children:e.jsx(xc,{sx:{color:"#F2994A",fontSize:32}})}),e.jsxs(P,{children:[e.jsxs(ee,{variant:"subtitle1",sx:{color:"#7B5E3B",fontWeight:600},children:["Sent Back Comment | ",n," | ",a]}),e.jsx(ee,{variant:"h6",sx:{fontWeight:700,mt:.5},children:s})]})]})};function OT(s,t){if(!s||!Array.isArray(s.pduPermissions))return"-";const a=[];return s.pduPermissions.indexOf("PDU_ONLINE_SAVE_DATA")!==-1&&a.push(t("Edit")),s.pduPermissions.indexOf("PDU_ONLINE_APPROVE")!==-1&&a.push(t("Approve")),s.pduPermissions.indexOf("PDU_ONLINE_MERGE")!==-1&&a.push(t("Merge")),a.length>0?a.join(", "):"-"}const kT=()=>{const{businessArea:s,programId:t,baseUrl:a}=U(),n=ge(),{selectedProgram:i}=Z(),{id:r}=ts(),{t:l}=M(),{showMessage:o}=Ae(),d=i?.beneficiaryGroup,c=r?parseInt(r,10):void 0,u=Fe(),h=ve(),m=K(R.PDU_ONLINE_SAVE_DATA,h),g=K(R.PDU_ONLINE_APPROVE,h),x=K(R.PDU_ONLINE_MERGE,h),[f,j]=A.useState(!1),[y,b]=A.useState(""),[C,v]=A.useState(!1),[S,I]=A.useState(!1),{mutateAsync:E}=xe({mutationFn:ye=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsBulkApproveCreate({businessAreaSlug:s,programSlug:t,requestBody:{ids:ye}}),onSuccess:()=>{o(l("Template approved successfully.")),u.invalidateQueries({queryKey:["onlineEditsTemplateDetails",s,t,c]})},onError:ye=>{fe(ye,o)}}),D=async()=>{await E([c])},F=async()=>{v(!0);try{await N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsSendBackCreate({businessAreaSlug:s,programSlug:t,id:c,requestBody:{comment:y}}),o(l("Periodic data update sent back successfully.")),j(!1),b(""),u.invalidateQueries({queryKey:["onlineEditsTemplateDetails",s,t,c]})}catch(ye){fe(ye,o,l("Failed to send back periodic data update."))}finally{v(!1)}},w=async()=>{I(!0);try{await N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsSendForApprovalCreate({businessAreaSlug:s,programSlug:t,id:c}),o(l("Periodic data update sent for approval.")),u.invalidateQueries({queryKey:["onlineEditsTemplateDetails",s,t,c]})}catch(ye){fe(ye,o,l("Failed to send for approval."))}finally{I(!1)}},{mutateAsync:O}=xe({mutationFn:ye=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsBulkMergeCreate({businessAreaSlug:s,programSlug:t,requestBody:{ids:ye}}),onSuccess:()=>{o("Template merged successfully."),u.invalidateQueries({queryKey:["onlineEditsTemplateDetails",s,t,c]})},onError:ye=>{fe(ye,o)}}),k=async()=>{await O([c])},[$,G]=A.useState(!1),{data:W,isLoading:Y}=V({queryKey:["onlineEditsTemplateDetails",s,t,c],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsRetrieve({businessAreaSlug:s,programSlug:t,id:c}),enabled:!!s&&!!t&&!!c}),X=A.useMemo(()=>W?Array.isArray(W.editData)?W.editData:[]:[],[W]),J=A.useMemo(()=>{const ye=[];return X.forEach(as=>{as.pduFields&&Object.entries(as.pduFields).forEach(([he,Re])=>{const Me=Re;ye.some(ps=>ps.key===he)||ye.push({key:he,subtype:Me.subtype,roundNumber:Me.roundNumber,roundName:Me.roundName,fieldName:Me.fieldName,label:Me.label})})}),ye},[X]),[ae,re]=A.useState(()=>X.map(ye=>{const as={};return ye.pduFields&&Object.entries(ye.pduFields).forEach(([he,Re])=>{const Me=Re,ps=Me.fieldName||he;as[ps]={...Me,fieldName:ps}}),{...ye,pduFields:as}})),[se,le]=A.useState(new Set);A.useEffect(()=>{re(X.map(ye=>{const as={};return ye.pduFields&&Object.entries(ye.pduFields).forEach(([he,Re])=>{const Me=Re,ps=Me.fieldName||he;as[ps]={...Me,fieldName:ps}}),{...ye,pduFields:as}})),le(new Set)},[X]);const ce=async ye=>{const as=ae[ye],he={individualUuid:as.individualUuid,pduFields:Object.entries(as.pduFields||{}).reduce((Re,[,Me])=>{const ps=Me,Je=ps.fieldName;return Re[Je]={round_number:ps.roundNumber,value:ps.value,subtype:ps.subtype,is_editable:ps.isEditable,field_name:Je},Re},{})};try{await N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsSaveDataCreate({businessAreaSlug:s,programSlug:t,id:c,requestBody:he}),le(Re=>{const Me=new Set(Re);return Me.delete(ye),Me})}catch(Re){fe(Re,o)}};if(Y)return e.jsx(Ne,{});if(!W)return null;const{status:_e,statusDisplay:ne,name:Ue,createdAt:Te,numberOfRecords:ie,authorizedUsers:Pe,approvedBy:ue,approvedAt:Ge,createdBy:ls,sentBackComment:qe,isCreator:xs,isAuthorized:Oe}=W,es=[{title:`${d?.memberLabelPlural}`,to:`/${a}/population/individuals`}];return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`Online Edits Template Details${Ue?`: ${Ue}`:""}`,breadCrumbs:es,flags:e.jsx(gt,{adminUrl:W.adminUrl}),handleBack:()=>n(`/${a}/population/individuals?tab=periodic-data-updates&subtab=online-edits`),children:e.jsxs(e.Fragment,{children:[_e==="NEW"&&m&&Oe&&e.jsx(P,{px:6,pt:2,pb:2,children:e.jsx(H,{variant:"contained",color:"primary",onClick:w,disabled:S,"data-cy":"send-for-approval","data-perm":R.PDU_ONLINE_SAVE_DATA,children:l("Send for Approval")})}),_e==="READY"&&g&&Oe&&e.jsxs(P,{px:6,pt:2,pb:2,display:"flex",gap:2,children:[e.jsx(H,{variant:"contained",color:"primary",onClick:()=>j(!0),"data-cy":"send-back","data-perm":R.PDU_ONLINE_APPROVE,children:l("Send Back")}),e.jsx(H,{variant:"contained",color:"primary",onClick:D,"data-perm":R.PDU_ONLINE_APPROVE,"data-cy":"approve",children:l("Approve")})]}),_e==="APPROVED"&&x&&Oe&&e.jsx(P,{px:6,pt:2,pb:2,display:"flex",gap:2,children:e.jsx(H,{variant:"contained",color:"primary",onClick:k,"data-cy":"merge","data-perm":R.PDU_ONLINE_MERGE,children:l("Merge")})})]})}),e.jsx(Eu,{open:f,title:l("Send Back Confirmation"),content:l("Are you sure you want to send back this periodic data update? Please provide a comment."),continueText:l("Confirm"),onSubmit:F,onClose:()=>j(!1),disabled:C||!y,extraContent:e.jsx(ks,{label:l("Comment"),multiline:!0,fullWidth:!0,minRows:3,value:y,onChange:ye=>b(ye.target.value),disabled:C}),type:"primary"}),e.jsx(st,{title:"Details",children:e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:l("Status"),children:e.jsx(we,{status:_e,statusToColor:cn,statusDisplay:ne})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:l("Template Name"),value:Ue})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:l("Creation Date"),children:e.jsx(pe,{children:Te})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:l("Number of Records"),value:Qe(ie)})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:l("Created By"),value:ls})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:l("Authorized Users"),children:e.jsx(me,{button:!0,style:{cursor:"pointer",textDecoration:"underline"},onClick:()=>G(!0),children:`${Pe&&Pe.length?Pe.length:0} ${l(Pe&&Pe.length===1?"Authorized User":"Authorized Users")}`})})}),e.jsxs(is,{open:$,onClose:()=>G(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Le,{sx:{pb:0},children:l("Authorized Users for Online Editing")}),e.jsxs(Be,{children:[e.jsx("div",{style:{marginBottom:16},children:l("Users who are allowed to add new values for this template during online updates.")}),e.jsx(Ut,{children:e.jsxs(gs,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{children:l("Name")}),e.jsx(_,{children:l("Role")})]})}),e.jsxs(cs,{children:[(Pe&&Pe.length>0?Pe:[]).map((ye,as)=>e.jsxs(be,{children:[e.jsx(_,{children:ye.firstName&&ye.lastName?`${ye.firstName} ${ye.lastName}`:ye.username||ye.email||ye.id}),e.jsx(_,{children:OT(ye,l)})]},ye.id||ye.username||as)),(!Pe||Pe.length===0)&&e.jsx(be,{children:e.jsx(_,{colSpan:2,align:"center",children:l("No authorized users found.")})})]})]})})]}),e.jsxs(os,{children:[xs&&e.jsx(H,{component:ys,to:`/${a}/population/individuals/online-templates/${c}/edit-authorised-users`,variant:"text",color:"primary",children:l("Edit")}),e.jsx(H,{variant:"contained",color:"primary",onClick:()=>G(!1),children:l("Close")})]})]}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:l("Approval Date"),children:Ge?e.jsx(pe,{children:Ge}):l("-")})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:l("Approved By"),value:ue||l("-")})})]})}),e.jsx(P,{pl:12,pt:6,children:qe&&typeof qe=="object"&&qe.comment&&e.jsx(LT,{comment:qe.comment,date:qe.createdAt,author:qe.createdBy},qe.comment)}),e.jsx(P,{p:3,children:e.jsx(NT,{allPduFields:J,editRows:ae,setEditRows:re,editingRows:se,setEditingRows:le,handleSaveRow:ce,canSave:m,templateStatus:_e,isAuthorized:Oe})})]})},wT=oe(kT,"PeriodicDataUpdatesOnlineEditsTemplateDetailsPage"),MT=({setFieldValue:s,selected:t,setSelected:a})=>{const{t:n}=M(),{businessAreaSlug:i,programSlug:r}=U(),{id:l}=ts(),[o,d]=Js.useState(""),[c,u]=Js.useState([]),{data:h,isLoading:m,error:g}=V({queryKey:["onlineEdit",i,r,l],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsRetrieve({businessAreaSlug:i,programSlug:r,id:l?Number(l):void 0}),enabled:!!(i&&r&&l)}),{data:x,isLoading:f,error:j}=V({queryKey:["availableUsers",i,r],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsUsersAvailableList({businessAreaSlug:i,programSlug:r}),enabled:!!(i&&r)});function y(I){return{...I,canEdit:I.pduPermissions.includes("PDU_ONLINE_SAVE_DATA"),canApprove:I.pduPermissions.includes("PDU_ONLINE_APPROVE"),canMerge:I.pduPermissions.includes("PDU_ONLINE_MERGE"),name:va(I)}}const b=Js.useMemo(()=>x?x.map(y):[],[x]),C=Js.useMemo(()=>h?.authorizedUsers?h.authorizedUsers.map(I=>I.id):[],[h]);Js.useEffect(()=>{b.length>0&&C.length>0&&(a(C),s("authorizedUsers",C))},[b,C,a,s]);const v=b.filter(I=>I.name?.toLowerCase().includes(o.toLowerCase())||I.username?.toLowerCase().includes(o.toLowerCase())||!1?c.length===0?!0:c.some(D=>D==="canEdit"?I.canEdit:D==="canApprove"?I.canApprove:D==="canMerge"?I.canMerge:!1):!1),S=I=>{a(E=>{const D=E.includes(I)?E.filter(F=>F!==I):[...E,I];return s("authorizedUsers",D),D})};return m||f?e.jsx(st,{title:n("Authorized Users Online"),children:e.jsx(P,{children:n("Loading...")})}):g||j?e.jsx(st,{title:n("Authorized Users Online"),children:e.jsx(P,{color:"error.main",children:n("Failed to load authorized users.")})}):e.jsx(st,{description:n("Select users who are allowed to perform actions (edit, approve and merge) for this template during online updates."),title:n("Authorized Users Online"),children:e.jsxs(P,{sx:{display:"flex",flexDirection:"column",height:"100vh",minHeight:0},children:[e.jsx(P,{sx:{mb:2},children:e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{size:{xs:8},children:e.jsx(ks,{label:n("Search"),variant:"outlined",value:o,onChange:I=>d(I.target.value),size:"small",fullWidth:!0})}),e.jsx(p,{size:{xs:4},children:e.jsxs(tt,{size:"small",sx:{minWidth:300},fullWidth:!0,children:[e.jsx(Rt,{children:n("Permission Type")}),e.jsxs(at,{label:n("Permission Type"),multiple:!0,value:c,onChange:I=>{const E=I.target.value;u(typeof E=="string"?E.split(","):E)},input:e.jsx(Tc,{label:n("Permission Type")}),renderValue:I=>e.jsx(P,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:I.length===0?n("All"):I.map(E=>e.jsx(fl,{label:n(E==="canEdit"?"Authorized for Edit":E==="canApprove"?"Authorized for Approve":"Authorized for Merge")},E))}),children:[e.jsx(de,{value:"canEdit",children:n("Authorized for Edit")}),e.jsx(de,{value:"canApprove",children:n("Authorized for Approve")}),e.jsx(de,{value:"canMerge",children:n("Authorized for Merge")})]})]})})]})}),e.jsxs(P,{sx:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:[e.jsx(Ut,{sx:{flex:1,minHeight:0,height:"100%",overflowY:"auto"},children:e.jsxs(gs,{stickyHeader:!0,children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{}),e.jsx(_,{children:n("Users")}),e.jsx(_,{children:n("Authorized for Edit")}),e.jsx(_,{children:n("Authorized for Approve")}),e.jsx(_,{children:n("Authorized for Merge")})]})}),e.jsx(cs,{children:v.map(I=>e.jsxs(be,{children:[e.jsx(_,{children:e.jsx(ns,{checked:t.includes(I.id),onChange:()=>S(I.id)})}),e.jsx(_,{children:I.name}),e.jsx(_,{align:"center",children:I.canEdit?e.jsx(ja,{color:"success"}):e.jsx(Ct,{color:"disabled"})}),e.jsx(_,{align:"center",children:I.canApprove?e.jsx(ja,{color:"success"}):e.jsx(Ct,{color:"disabled"})}),e.jsx(_,{align:"center",children:I.canMerge?e.jsx(ja,{color:"success"}):e.jsx(Ct,{color:"disabled"})})]},I.id))})]})}),v.length===0&&e.jsx(P,{sx:{mt:2},children:n("No authorized users found.")})]})]})})},$T=()=>{const[s,t]=Js.useState([]),{businessAreaSlug:a,programSlug:n}=U(),i=Fe(),{showMessage:r}=Ae(),{selectedProgram:l}=Z(),{t:o}=M(),{baseUrl:d}=U(),{id:c}=ts(),u=ge(),{mutateAsync:h}=xe({mutationFn:x=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsUpdateAuthorizedUsersCreate({businessAreaSlug:a,programSlug:n,id:c?Number(c):void 0,requestBody:{authorizedUsers:x.authorizedUsers}}),onSuccess:()=>{r(o("Authorized users updated successfully.")),i.invalidateQueries({queryKey:["onlineEdit",a,n,c]}),i.invalidateQueries({queryKey:["availableUsers",a,n]});const x=`/${d}/population/individuals/online-templates/${c}`;u(x)},onError:x=>{fe(x,r)}}),g=[{title:l?.beneficiaryGroup?.memberLabelPlural||o("Individuals"),to:`/${d}/population/individuals`},{title:o("Edit Authorized Users")}];return e.jsx(B.Formik,{initialValues:{authorizedUsers:[]},onSubmit:async(x,{setSubmitting:f})=>{await h(x),f(!1)},children:({setFieldValue:x,handleSubmit:f,isSubmitting:j})=>e.jsxs("form",{onSubmit:f,children:[e.jsx(Ze,{title:`${o("Edit Authorized Users")} - Template ID: ${c}`,breadCrumbs:g,children:e.jsx(H,{variant:"contained",color:"primary",type:"submit",disabled:j,children:o("Save")})}),e.jsx(st,{children:e.jsx(MT,{setFieldValue:x,selected:s,setSelected:t})})]})})},UT=oe($T,"EditAuthorizedUsersOnline"),VT=({values:s,setFieldValue:t,checkedFields:a,setCheckedFields:n})=>{const i=A.useRef(!1);A.useEffect(()=>{if(!i.current){const l=s.roundsData.reduce((o,d)=>(o[d.field]=!1,o),{});n(l),i.current=!0}},[s.roundsData,n]);const r=(l,o)=>{const d={...a,[o.field]:l.target.checked};n(d)};return e.jsx(B.FieldArray,{name:"roundsData",render:()=>e.jsx(Ut,{component:P,"data-cy":"table-container",children:e.jsxs(gs,{"data-cy":"table",children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{"data-cy":"table-header-checkbox"}),e.jsx(_,{"data-cy":"table-header-field",children:"Field"}),e.jsx(_,{"data-cy":"table-header-roundNumber",children:"Round Number"})]})}),e.jsx(cs,{children:s.roundsData.map(l=>e.jsxs(be,{"data-cy":`table-row-${l.field}`,children:[e.jsx(_,{children:e.jsx(ns,{"data-cy":`checkbox-${l.field}`,checked:a[l.field]||!1,onChange:o=>r(o,l)})}),e.jsx(_,{"data-cy":`table-cell-field-${l.field}`,children:typeof l.label=="string"?l.label:l.label?.englishEn||Object.values(l.label)[0]||""}),e.jsx(_,{"data-cy":`table-cell-roundNumber-${l.field}`,children:e.jsx(at,{"data-cy":`select-roundNumber-${l.field}`,value:l.roundNumber,onChange:o=>{const d=s.roundsData.findIndex(h=>h.field===l.field),c=Number(o.target.value),u=l.rounds[c-1].round_name;t(`roundsData[${d}].roundNumber`,c),t(`roundsData[${d}].roundName`,u)},children:Array.from({length:l.numberOfRounds},(o,d)=>e.jsx(de,{value:d+1,children:d+1},d+1))})})]},`${l.field}-${l.round}`))})]})})})};function Ei({value:s,onChange:t,level:a=2,parentId:n="",disabled:i=!1,dataCy:r}){const[l,o]=A.useState(""),d=qt(l,400),[c,u]=A.useState([]),{businessArea:h}=U(),[m,g]=A.useState(!1),[x,f]=A.useState({level:a,search:d||void 0,parentId:n||void 0});A.useEffect(()=>{f(E=>({...E,search:d||void 0}))},[d]),A.useEffect(()=>{f(E=>({...E,level:a,parentId:n||void 0}))},[a,n]);const{data:j,isLoading:y,refetch:b}=V({queryKey:["areas",h,x],queryFn:async()=>{try{return N.restBusinessAreasGeoAreasList({businessAreaSlug:h,level:x.level,name:x.search})}catch(E){throw console.error("Error fetching areas:",E),E}},enabled:!!h,refetchOnWindowFocus:!1,staleTime:3e5});A.useEffect(()=>{if(s&&Array.isArray(s))if(s.length>0&&s[0]!==null&&typeof s[0]=="object"&&s[0]&&"value"in s[0])u(s);else if(j){const E=new Map(j.map(F=>[F.id,F])),D=s.map(F=>{if(F==null)return{name:"",value:""};const w=E.get(F);return w?{name:w.name||"",value:w.id}:{name:F,value:F}});u(D)}else{const E=s.map(D=>D==null?{name:"",value:""}:{name:D,value:D});u(E)}else u([])},[j,s]),A.useEffect(()=>{s&&o("")},[s]);const C=j?j.map(E=>!E||!E.id?null:{name:E.name||"",value:E.id}).filter(Boolean):[];A.useEffect(()=>{h&&b()},[h,b]);const v=(E,D)=>{u(D),t(E,D)},S=()=>{h?(b(),g(!0)):console.warn("No businessArea available for data fetching")},I=()=>{g(!1),o("")};return e.jsx(zi,{"data-cy":r,multiple:!0,disableCloseOnSelect:!0,fullWidth:!0,filterOptions:E=>E,onChange:v,value:c,getOptionLabel:E=>E?.name||"",open:m,onOpen:S,onClose:I,disabled:i,options:C,loading:y,noOptionsText:"No options available",isOptionEqualToValue:(E,D)=>E?.value===D?.value,renderOption:(E,D,{selected:F})=>A.createElement("li",{...E,key:D.value},e.jsx(ns,{icon:e.jsx(Dc,{fontSize:"small"}),checkedIcon:e.jsx(qm,{fontSize:"small"}),style:{marginRight:8},checked:F}),D.name),renderInput:E=>e.jsx(qi,{...E,size:"small",label:`Admin Level ${a}`,variant:"outlined",onChange:D=>o(D.target.value),onClick:()=>{m||S()},InputProps:{...E.InputProps}})})}const lr=({value:s,name:t,filter:a,initialFilter:n,appliedFilter:i,setAppliedFilter:r,setFilter:l,disabled:o,dataCy:d="filters-target-population-autocomplete",onChange:c})=>{const{t:u}=M(),{businessArea:h,programId:m}=U(),g=ge(),x=je(),[f,j]=A.useState(!1),[y,b]=A.useState(""),C=qt(y,800),[v,S]=A.useState({name:C||void 0,limit:20});A.useEffect(()=>{S($=>({...$,name:C||void 0}))},[C]);const{data:I,isLoading:E,refetch:D}=V({queryKey:["targetPopulations",h,m,v],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsList({businessAreaSlug:h||"",programSlug:m||"",...v}),enabled:!!h&&!!m}),F=A.useCallback(()=>{h&&m&&D()},[h,m,D]),{handleFilterChange:w}=n&&l&&i&&r?Ss(n,g,x,a,l,i,r):{handleFilterChange:void 0},O=I?.results?I.results.map($=>({name:$.name||"",value:$.id})):[],k=($,G)=>{w&&t&&Qa(t,G?.value,w),c&&c(G?.value)};return e.jsx(un,{value:s||"",disabled:o,label:u("Target Population"),dataCy:d,loadData:F,loading:E,options:O,handleChange:k,handleOpen:()=>j(!0),open:f,handleClose:($,G)=>{j(!1),G!=="select-option"&&b("")},handleOptionSelected:($,G)=>typeof G=="string"?$?.value===G:$?.value===G?.value,handleOptionLabel:$=>{if(typeof $=="string"){const G=O.find(W=>W.value===$);return G?G.name:$}return $?.name||""},data:I,inputValue:y,onInputTextChange:b,debouncedInputText:C})},BT=({filter:s,setFilter:t,isOnPaper:a=!0})=>{const n=(i,r)=>{t(l=>({...l,[i]:r}))};return e.jsx(Ns,{isOnPaper:a,withApplyClearButtons:!1,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:3,children:e.jsx(Gl,{value:s.registrationDataImportId,onChange:i=>n("registrationDataImportId",i)})}),e.jsx(p,{size:3,children:e.jsx(lr,{value:s.targetPopulationId,onChange:i=>n("targetPopulationId",i)})}),e.jsx(p,{size:3,children:e.jsxs(He,{onChange:i=>n("gender",i.target.value),label:Ee("Gender"),value:s.gender,"data-cy":"ind-filters-gender",children:[e.jsx(de,{value:"MALE",children:Ee("Male")},"male"),e.jsx(de,{value:"FEMALE",children:Ee("Female")},"female"),e.jsx(de,{value:"OTHER",children:Ee("Other")},"other"),e.jsx(de,{value:"NOT_COLLECTED",children:Ee("Not Collected")},"not_collected"),e.jsx(de,{value:"NOT_ANSWERED",children:Ee("Not Answered")},"not_answered")]})}),e.jsx(p,{size:3,children:e.jsx(js,{topLabel:Ee("Age"),value:s.ageFrom,placeholder:Ee("From"),fullWidth:!0,onChange:i=>n("ageFrom",i.target.value),"data-cy":"hh-filters-age-from"})}),e.jsx(p,{size:3,children:e.jsx(js,{value:s.ageTo,placeholder:Ee("To"),fullWidth:!0,onChange:i=>n("ageTo",i.target.value),"data-cy":"hh-filters-age-to"})}),e.jsx(p,{size:3,children:e.jsx(ms,{topLabel:Ee("Registration Date"),placeholder:Ee("From"),onChange:i=>n("registrationDateFrom",i),value:s.registrationDateFrom,dataCy:"ind-filters-reg-date-from"})}),e.jsx(p,{size:3,children:e.jsx(ms,{placeholder:Ee("To"),onChange:i=>n("registrationDateTo",i),value:s.registrationDateTo,dataCy:"ind-filters-reg-date-to"})}),e.jsx(p,{size:3,children:e.jsxs(He,{onChange:i=>n("hasGrievanceTicket",i.target.value),label:Ee("Has a Grievance Ticket"),value:s.hasGrievanceTicket,"data-cy":"ind-filters-grievance-ticket",children:[e.jsx(de,{value:"YES",children:Ee("Yes")},"yes"),e.jsx(de,{value:"NO",children:Ee("No")},"no")]})}),e.jsx(p,{size:3,children:e.jsx(Ei,{value:s.admin1||[],onChange:(i,r)=>{n("admin1",r)},level:1,dataCy:"filter-admin1",disabled:s.admin2?.length>0})}),e.jsx(p,{size:3,children:e.jsx(Ei,{value:s.admin2||[],onChange:(i,r)=>{n("admin2",r)},level:2,dataCy:"filter-admin2",disabled:s.admin1?.length>0})}),e.jsx(p,{size:3,children:e.jsxs(He,{onChange:i=>n("receivedAssistance",i.target.value),label:Ee("Received Assistance"),value:s.receivedAssistance,"data-cy":"ind-filters-received-assistance",children:[e.jsx(de,{value:"YES",children:Ee("Yes")},"yes"),e.jsx(de,{value:"NO",children:Ee("No")},"no")]})})]})})},ph=({setFieldValue:s,value:t})=>{const[a,n]=Js.useState(!1),i=r=>{const l=r.target.value;n(l.length>0&&l.length<3),s("name",l)};return e.jsx(ks,{label:"Template Name (optional)",variant:"outlined",fullWidth:!0,size:"medium",margin:"normal",value:t,onChange:i,error:a,helperText:a?"Minimum 3 characters required":"",slotProps:{input:{inputProps:{minLength:3}}}})},GT=()=>{const{selectedProgram:s}=Z(),t=s?.beneficiaryGroup,{t:a}=M(),n=ge(),r=je().pathname.includes("people"),{baseUrl:l,businessArea:o,programId:d}=U(),c=ve(),{showMessage:u}=Ae(),h={registrationDataImportId:null,targetPopulationId:null,gender:"",ageFrom:"",ageTo:"",registrationDateFrom:"",registrationDateTo:"",hasGrievanceTicket:"",admin1:[],admin2:[],receivedAssistance:""},[m,g]=A.useState(h),[x,f]=A.useState({}),j=aD(),[y,b]=A.useState(0),C=[`Filter ${r?"People":t?.memberLabelPlural}`,"Fields to Update","Template Name (optional)"],{data:v,isLoading:S}=V({queryKey:["periodicFields",o,d,d],queryFn:()=>N.restBusinessAreasProgramsPeriodicFieldsList({businessAreaSlug:o,programSlug:d})});if(S)return e.jsx(Ne,{});if(!v)return null;const D={roundsData:(W=>W.results?W.results.map(Y=>{const{name:X,pduData:J,label:ae}=Y,{roundsNames:re}=J;return{field:X,label:ae,rounds:re.map((se,le)=>({round:le+1,roundName:re[le]})),numberOfRounds:re.length,roundNumber:1,roundName:re[0]}}):[])(v)},F=[{title:t?.memberLabelPlural,to:`/${l}/population/${r?"people":"individuals"}`}],w=()=>{b(W=>W+1)},O=()=>{b(W=>W-1)},k=W=>W==="YES"?!0:W==="NO"?!1:null,$=W=>{if(W==null)return!0;if(typeof W=="string")return W.trim()==="";if(Array.isArray(W))return W.length===0;if(typeof W=="object"){if(Object.keys(W).length===0)return!0;if("from"in W||"to"in W)return!W.from&&!W.to}return!1},G=W=>{const Y={registration_data_import_id:m.registrationDataImportId??null,target_population_id:m.targetPopulationId??null,gender:m.gender,age:{from:m.ageFrom?Number(m.ageFrom):null,to:m.ageTo?Number(m.ageTo):null},registration_date:{from:m.registrationDateFrom?fs(m.registrationDateFrom).format("YYYY-MM-DD"):null,to:m.registrationDateTo?fs(m.registrationDateTo).format("YYYY-MM-DD"):null},has_grievance_ticket:k(m.hasGrievanceTicket),admin1:m.admin1?.map(ae=>ae.value),admin2:m.admin2?.map(ae=>ae.value),received_assistance:k(m.receivedAssistance)},X=Object.fromEntries(Object.entries(Y).filter(([,ae])=>!$(ae))),J=W.roundsData.filter(ae=>x[ae.field]).map(ae=>({field:ae.field,round:ae.roundNumber}));j.mutate({businessAreaSlug:o,programSlug:d,requestBody:{rounds_data:J,filters:X,name:W.name||null}},{onSuccess:()=>{u(a("Template created successfully.")),n(`/${l}/population/${r?"people":"individuals"}?tab=periodic-data-updates&subtab=offline-templates`)},onError:ae=>{fe(ae,u,a("Failed to create template."))}})};return e.jsx(B.Formik,{initialValues:D,onSubmit:G,enableReinitialize:!0,children:({values:W,setFieldValue:Y,submitForm:X})=>{const J=Object.values(x).filter(Boolean).length;return e.jsxs("form",{onSubmit:G,children:[e.jsx(Ze,{title:a("New Template Page"),breadCrumbs:K(R.POPULATION_VIEW_HOUSEHOLDS_LIST,c)?F:null}),e.jsxs(st,{children:[e.jsx(Ta,{activeStep:y,alternativeLabel:!0,children:C.map(ae=>e.jsx(Ra,{"data-cy":"label-key",children:e.jsx(qa,{children:ae})},ae))}),y===0&&e.jsx(BT,{isOnPaper:!1,filter:m,setFilter:g}),y===1&&e.jsx(VT,{values:W,setFieldValue:Y,checkedFields:x,setCheckedFields:f}),y===2&&e.jsx(ph,{setFieldValue:Y,value:W.name}),e.jsxs(P,{display:"flex",mt:4,justifyContent:"flex-start",width:"100%",children:[e.jsx(P,{mr:2,children:e.jsx(H,{variant:"outlined",color:"secondary",component:ys,to:`/${l}/population/individuals`,"data-cy":"cancel-button",children:"Cancel"})}),e.jsxs(P,{display:"flex",children:[y===1&&e.jsx(P,{mr:2,children:e.jsx(H,{"data-cy":"back-button",variant:"outlined",onClick:O,children:"Back"})}),e.jsx(P,{children:e.jsx(H,{variant:"contained",color:"primary","data-cy":"submit-button",disabled:y===2&&J===0,onClick:y===2?X:w,children:y===2?"Generate Template":"Next"})})]})]})]})]})}})},Md=oe(GT,"NewOfflineTemplatePage"),zT=({setFieldValue:s,selected:t,setSelected:a})=>{const{t:n}=M(),{businessAreaSlug:i,programSlug:r}=U(),[l,o]=Js.useState(""),[d,c]=Js.useState([]),{data:u,isLoading:h,error:m}=V({queryKey:["availableUsers",i,r],queryFn:()=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsUsersAvailableList({businessAreaSlug:i,programSlug:r}),enabled:!!(i&&r)});function g(y){return{...y,canEdit:y.pduPermissions.includes("PDU_ONLINE_SAVE_DATA"),canApprove:y.pduPermissions.includes("PDU_ONLINE_APPROVE"),canMerge:y.pduPermissions.includes("PDU_ONLINE_MERGE"),name:va(y)}}const f=(u?u.map(g):[]).filter(y=>y.name?.toLowerCase().includes(l.toLowerCase())||y.username?.toLowerCase().includes(l.toLowerCase())||!1?d.length===0?!0:d.some(C=>C==="canEdit"?y.canEdit:C==="canApprove"?y.canApprove:C==="canMerge"?y.canMerge:!1):!1),j=y=>{a(b=>{const C=b.includes(y)?b.filter(v=>v!==y):[...b,y];return s("authorizedUsers",C),C})};return h?e.jsx(st,{title:n("Authorized Users Online"),children:e.jsx(P,{children:n("Loading...")})}):m?e.jsx(st,{title:n("Authorized Users Online"),children:e.jsx(P,{color:"error.main",children:n("Failed to load authorized users.")})}):e.jsx(st,{description:n("Select users who are allowed to perform actions (edit, approve and merge) for this template during online updates."),title:n("Authorized Users Online"),children:e.jsxs(P,{sx:{display:"flex",flexDirection:"column",height:"100vh",minHeight:0},children:[e.jsx(P,{sx:{mb:2},children:e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{size:{xs:8},children:e.jsx(ks,{label:n("Search"),variant:"outlined",value:l,onChange:y=>o(y.target.value),size:"small",fullWidth:!0})}),e.jsx(p,{size:{xs:4},children:e.jsxs(tt,{size:"small",sx:{minWidth:300},fullWidth:!0,children:[e.jsx(Rt,{children:n("Permission Type")}),e.jsxs(at,{label:n("Permission Type"),multiple:!0,value:d,onChange:y=>{const b=y.target.value;c(typeof b=="string"?b.split(","):b)},input:e.jsx(Tc,{label:n("Permission Type")}),renderValue:y=>e.jsx(P,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:y.length===0?n("All"):y.map(b=>e.jsx(fl,{label:n(b==="canEdit"?"Authorized for Edit":b==="canApprove"?"Authorized for Approve":"Authorized for Merge")},b))}),children:[e.jsx(de,{value:"canEdit",children:n("Authorized for Edit")}),e.jsx(de,{value:"canApprove",children:n("Authorized for Approve")}),e.jsx(de,{value:"canMerge",children:n("Authorized for Merge")})]})]})})]})}),e.jsxs(P,{sx:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:[e.jsx(Ut,{sx:{flex:1,minHeight:0,height:"100%",overflowY:"auto"},children:e.jsxs(gs,{stickyHeader:!0,children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{}),e.jsx(_,{children:n("Users")}),e.jsx(_,{children:n("Authorized for Edit")}),e.jsx(_,{children:n("Authorized for Approve")}),e.jsx(_,{children:n("Authorized for Merge")})]})}),e.jsx(cs,{children:f.map(y=>e.jsxs(be,{children:[e.jsx(_,{children:e.jsx(ns,{checked:t.includes(y.id),onChange:()=>j(y.id)})}),e.jsx(_,{children:y.name}),e.jsx(_,{align:"center",children:y.canEdit?e.jsx(ja,{color:"success"}):e.jsx(Ct,{color:"disabled"})}),e.jsx(_,{align:"center",children:y.canApprove?e.jsx(ja,{color:"success"}):e.jsx(Ct,{color:"disabled"})}),e.jsx(_,{align:"center",children:y.canMerge?e.jsx(ja,{color:"success"}):e.jsx(Ct,{color:"disabled"})})]},y.id))})]})}),f.length===0&&e.jsx(P,{sx:{mt:2},children:n("No authorized users found.")})]})]})})},qT=({values:s,setFieldValue:t,checkedFields:a,setCheckedFields:n})=>{const i=A.useRef(!1);A.useEffect(()=>{if(!i.current){const l=s.roundsData.reduce((o,d)=>(o[d.field]=!1,o),{});n(l),i.current=!0}},[s.roundsData,n]);const r=(l,o)=>{const d={...a,[o.field]:l.target.checked};n(d)};return e.jsx(B.FieldArray,{name:"roundsData",render:()=>e.jsx(Ut,{component:P,"data-cy":"table-container",children:e.jsxs(gs,{"data-cy":"table",children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{"data-cy":"table-header-checkbox"}),e.jsx(_,{"data-cy":"table-header-field",children:"Field"}),e.jsx(_,{"data-cy":"table-header-roundNumber",children:"Round Number"})]})}),e.jsx(cs,{children:s.roundsData.map(l=>e.jsxs(be,{"data-cy":`table-row-${l.field}`,children:[e.jsx(_,{children:e.jsx(ns,{"data-cy":`checkbox-${l.field}`,checked:a[l.field]||!1,onChange:o=>r(o,l)})}),e.jsx(_,{"data-cy":`table-cell-field-${l.field}`,children:typeof l.label=="string"?l.label:l.label?.englishEn||Object.values(l.label)[0]||""}),e.jsx(_,{"data-cy":`table-cell-roundNumber-${l.field}`,children:e.jsx(at,{"data-cy":`select-roundNumber-${l.field}`,value:l.roundNumber,onChange:o=>{const d=s.roundsData.findIndex(h=>h.field===l.field),c=Number(o.target.value),u=l.rounds[c-1].round_name;t(`roundsData[${d}].roundNumber`,c),t(`roundsData[${d}].roundName`,u)},children:Array.from({length:l.numberOfRounds},(o,d)=>e.jsx(de,{value:d+1,children:d+1},d+1))})})]},`${l.field}-${l.round}`))})]})})})},HT=({filter:s,setFilter:t,isOnPaper:a=!0})=>{const n=(i,r)=>{t(l=>({...l,[i]:r}))};return e.jsx(Ns,{isOnPaper:a,withApplyClearButtons:!1,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:3,children:e.jsx(Gl,{value:s.registrationDataImportId,onChange:i=>n("registrationDataImportId",i)})}),e.jsx(p,{size:3,children:e.jsx(lr,{value:s.targetPopulationId,onChange:i=>n("targetPopulationId",i)})}),e.jsx(p,{size:3,children:e.jsxs(He,{onChange:i=>n("gender",i.target.value),label:Ee("Gender"),value:s.gender,"data-cy":"ind-filters-gender",children:[e.jsx(de,{value:"MALE",children:Ee("Male")},"male"),e.jsx(de,{value:"FEMALE",children:Ee("Female")},"female"),e.jsx(de,{value:"OTHER",children:Ee("Other")},"other"),e.jsx(de,{value:"NOT_COLLECTED",children:Ee("Not Collected")},"not_collected"),e.jsx(de,{value:"NOT_ANSWERED",children:Ee("Not Answered")},"not_answered")]})}),e.jsx(p,{size:3,children:e.jsx(js,{topLabel:Ee("Age"),value:s.ageFrom,placeholder:Ee("From"),fullWidth:!0,onChange:i=>n("ageFrom",i.target.value),"data-cy":"hh-filters-age-from"})}),e.jsx(p,{size:3,children:e.jsx(js,{value:s.ageTo,placeholder:Ee("To"),fullWidth:!0,onChange:i=>n("ageTo",i.target.value),"data-cy":"hh-filters-age-to"})}),e.jsx(p,{size:3,children:e.jsx(ms,{topLabel:Ee("Registration Date"),placeholder:Ee("From"),onChange:i=>n("registrationDateFrom",i),value:s.registrationDateFrom,dataCy:"ind-filters-reg-date-from"})}),e.jsx(p,{size:3,children:e.jsx(ms,{placeholder:Ee("To"),onChange:i=>n("registrationDateTo",i),value:s.registrationDateTo,dataCy:"ind-filters-reg-date-to"})}),e.jsx(p,{size:3,children:e.jsxs(He,{onChange:i=>n("hasGrievanceTicket",i.target.value),label:Ee("Has a Grievance Ticket"),value:s.hasGrievanceTicket,"data-cy":"ind-filters-grievance-ticket",children:[e.jsx(de,{value:"YES",children:Ee("Yes")},"yes"),e.jsx(de,{value:"NO",children:Ee("No")},"no")]})}),e.jsx(p,{size:3,children:e.jsx(Ei,{value:s.admin1||[],onChange:(i,r)=>{n("admin1",r)},level:1,dataCy:"filter-admin1",disabled:s.admin2?.length>0})}),e.jsx(p,{size:3,children:e.jsx(Ei,{value:s.admin2||[],onChange:(i,r)=>{n("admin2",r)},level:2,dataCy:"filter-admin2",disabled:s.admin1?.length>0})}),e.jsx(p,{size:3,children:e.jsxs(He,{onChange:i=>n("receivedAssistance",i.target.value),label:Ee("Received Assistance"),value:s.receivedAssistance,"data-cy":"ind-filters-received-assistance",children:[e.jsx(de,{value:"YES",children:Ee("Yes")},"yes"),e.jsx(de,{value:"NO",children:Ee("No")},"no")]})})]})})},WT=()=>{const{selectedProgram:s}=Z(),t=ge(),a=je(),[n,i]=A.useState([]),r=a.pathname.includes("people"),{baseUrl:l,businessArea:o,programId:d}=U(),c=ve(),{showMessage:u}=Ae(),h=s?.beneficiaryGroup,{t:m}=M(),g=Fe(),{mutateAsync:x}=xe({mutationFn:J=>N.restBusinessAreasProgramsPeriodicDataUpdateOnlineEditsCreate(J),onSuccess:()=>{g.invalidateQueries({queryKey:["periodicFields",o,d,d]}),u(m("Template created successfully.")),t(`/${l}/population/${r?"people":"individuals"}?tab=periodic-data-updates&subtab=online-edits`)},onError:J=>{fe(J,u,m("Failed to create template."))}}),f={registrationDataImportId:null,targetPopulationId:null,gender:"",ageFrom:"",ageTo:"",registrationDateFrom:"",registrationDateTo:"",hasGrievanceTicket:"",admin1:[],admin2:[],receivedAssistance:""},[j,y]=A.useState(f),[b,C]=A.useState({}),[v,S]=A.useState(0),I=[`Filter ${r?"People":h?.memberLabelPlural}`,"Fields to Update","Authorized Users","Template Name (optional)"],{data:E,isLoading:D}=V({queryKey:["periodicFields",o,d,d],queryFn:()=>N.restBusinessAreasProgramsPeriodicFieldsList({businessAreaSlug:o,programSlug:d})});if(D)return e.jsx(Ne,{});if(!E)return null;const O={roundsData:(J=>J.results?J.results.map(ae=>{const{name:re,pduData:se,label:le}=ae,{roundsNames:ce}=se;return{field:re,label:le,rounds:ce.map((_e,ne)=>({round:ne+1,roundName:ce[ne]})),numberOfRounds:ce.length,roundNumber:1,roundName:ce[0]}}):[])(E),authorizedUsers:[],name:""},k=[{title:h?.memberLabelPlural,to:`/${l}/population/${r?"people":"individuals"}`}],$=()=>{S(J=>J+1)},G=()=>{S(J=>J-1)},W=J=>J==="YES"?!0:J==="NO"?!1:null,Y=J=>{if(J==null)return!0;if(typeof J=="string")return J.trim()==="";if(Array.isArray(J))return J.length===0;if(typeof J=="object"){if(Object.keys(J).length===0)return!0;if("from"in J||"to"in J)return!J.from&&!J.to}return!1},X=async J=>{const ae={registration_data_import_id:j.registrationDataImportId??null,target_population_id:j.targetPopulationId??null,gender:j.gender,age:{from:j.ageFrom?Number(j.ageFrom):null,to:j.ageTo?Number(j.ageTo):null},registration_date:{from:j.registrationDateFrom?fs(j.registrationDateFrom).format("YYYY-MM-DD"):null,to:j.registrationDateTo?fs(j.registrationDateTo).format("YYYY-MM-DD"):null},has_grievance_ticket:W(j.hasGrievanceTicket),admin1:j.admin1?.map(ce=>ce.value),admin2:j.admin2?.map(ce=>ce.value),received_assistance:W(j.receivedAssistance)},re=Object.fromEntries(Object.entries(ae).filter(([,ce])=>!Y(ce))),le={roundsData:J.roundsData.filter(ce=>b[ce.field]).map(ce=>({field:ce.field,round:ce.roundNumber,id:ce.id??void 0})),filters:re,authorizedUsers:J.authorizedUsers,name:J.name||null};try{await x({businessAreaSlug:o,programSlug:d,requestBody:le})}catch(ce){fe(ce,u,m("Failed to create template."))}};return e.jsx(B.Formik,{initialValues:O,onSubmit:X,enableReinitialize:!0,children:({values:J,setFieldValue:ae,handleSubmit:re})=>{const se=J.roundsData.filter(le=>b[le.field]===!0).map(le=>({field:le.field,rounds:le.rounds.filter(ce=>ce.checked).map(ce=>({round:ce.round,round_name:ce.round_name}))}));return e.jsxs("form",{onSubmit:re,children:[e.jsx(Ze,{title:m("New Online Edit Page"),breadCrumbs:K(R.POPULATION_VIEW_HOUSEHOLDS_LIST,c)?k:null}),e.jsxs(st,{children:[e.jsx(Ta,{activeStep:v,alternativeLabel:!0,children:I.map(le=>e.jsx(Ra,{"data-cy":"label-key",children:e.jsx(qa,{children:le})},le))}),v===0&&e.jsx(HT,{isOnPaper:!1,filter:j,setFilter:y}),v===1&&e.jsx(qT,{values:J,setFieldValue:ae,checkedFields:b,setCheckedFields:C}),v===2&&e.jsx(zT,{setFieldValue:ae,selected:n,setSelected:i}),v===3&&e.jsx(ph,{setFieldValue:ae,value:J.name}),e.jsxs(P,{display:"flex",mt:4,justifyContent:"flex-start",width:"100%",children:[e.jsx(P,{mr:2,children:e.jsx(H,{variant:"outlined",color:"secondary",component:ys,to:`/${l}/population/individuals`,"data-cy":"cancel-button",children:"Cancel"})}),e.jsxs(P,{display:"flex",children:[v>0&&v<4&&e.jsx(P,{mr:2,children:e.jsx(H,{"data-cy":"back-button",variant:"outlined",onClick:G,children:"Back"})}),e.jsxs(P,{children:[v===0&&e.jsx(H,{variant:"contained",color:"primary","data-cy":"next-button",onClick:$,children:"Next"}),v===1&&e.jsx(H,{variant:"contained",color:"primary","data-cy":"next-button",disabled:se.length===0,onClick:$,children:"Next"}),v===2&&e.jsx(H,{variant:"contained",color:"primary","data-cy":"next-button",onClick:$,children:"Next"}),v===3&&e.jsx(H,{variant:"contained",color:"primary","data-cy":"submit-button",type:"submit",children:"Generate Template"})]})]})]})]})]})}})},$d=oe(WT,"NewOnlineTemplatePage"),KT=()=>oa([{path:"population/household/:id",element:e.jsx(PT,{})},{path:"population/individuals",element:e.jsx(dh,{})},{path:"population/individuals/:id",element:e.jsx(FT,{})},{path:"population/people",element:e.jsx(KD,{})},{path:"population/people/:id",element:e.jsx(BD,{})},{path:"population/household",element:e.jsx(ST,{})},{path:"population/individuals/new-offline-template",element:e.jsx(Md,{})},{path:"population/people/new-offline-template",element:e.jsx(Md,{})},{path:"population/individuals/new-online-template",element:e.jsx($d,{})},{path:"population/people/new-online-template",element:e.jsx($d,{})},{path:"population/individuals/online-templates/:id",element:e.jsx(wT,{})},{path:"population/individuals/online-templates/:id/edit-authorised-users",element:e.jsx(UT,{})}]),oo=(s,t,a,n=null)=>{const{businessAreaSlug:i,programSlug:r}=U(),l=Fe();return xe({mutationFn:async()=>t({businessAreaSlug:i,programSlug:r,id:s}),...n,onSuccess:async()=>{n?.onSuccess&&await n.onSuccess(),a&&await l.invalidateQueries({queryKey:a})}})};function YT({registration:s}){const{t}=M(),[a,n]=A.useState(!1),{showMessage:i}=Ae(),{isSocialDctType:r,selectedProgram:l}=Z(),o=l?.beneficiaryGroup,{mutateAsync:d,isPending:c}=oo(s.id,N.restBusinessAreasProgramsRegistrationDataImportsMergeCreate,[N.restBusinessAreasProgramsRegistrationDataImportsRetrieve.name]),u=async()=>{const{errors:m}=await d();if(m){i(t("Error while merging Registration Data Import"));return}n(!1),i(t("Registration Data Import Merging started"))};let h=e.jsxs("div",{children:[e.jsxs("strong",{children:[s.numberOfHouseholds," ",o?.groupLabelPlural," ","and ",s.numberOfIndividuals," ",o?.memberLabelPlural," will be merged."," "]}),t("Do you want to proceed?")]});return r&&(h=e.jsxs("div",{children:[e.jsxs("strong",{children:[s.numberOfIndividuals," ",o?.memberLabelPlural," will be merged."]}),t("Do you want to proceed?")]})),e.jsxs("span",{children:[e.jsx(H,{startIcon:e.jsx(Hm,{}),color:"primary",variant:"contained",onClick:()=>n(!0),disabled:!s.canMerge,"data-cy":"button-merge-rdi",children:t("Merge")}),e.jsxs(is,{open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Merge Import")})}),e.jsx(Be,{children:e.jsxs(pt,{children:[e.jsx("div",{children:t("Are your sure you want to merge this data import?")}),h]})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{"data-cy":"button-cancel",onClick:()=>n(!1),children:t("CANCEL")}),e.jsx(ke,{loading:c,type:"submit",color:"primary",variant:"contained",onClick:u,"data-cy":"button-merge",children:t("MERGE")})]})})]})]})}const QT=oe(YT,"MergeRegistrationDataImportDialog"),XT=({registration:s})=>{const{t}=M(),[a,n]=A.useState(!1),{showMessage:i}=Ae(),{isActiveProgram:r}=Z(),{mutateAsync:l,isPending:o}=oo(s.id,N.restBusinessAreasProgramsRegistrationDataImportsDeduplicateCreate,[N.restBusinessAreasProgramsRegistrationDataImportsRetrieve.name]),d=async()=>{try{await l(),i("Rerunning Deduplication started"),n(!1)}catch(c){fe(c,i)}};return e.jsxs("span",{children:[e.jsx(H,{color:"primary",variant:"contained",onClick:()=>n(!0),disabled:!r,"data-cy":"button-rerun-dedupe",children:t("Rerun Deduplication")}),e.jsxs(is,{open:a,onClose:()=>n(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{children:t("Rerun Deduplication")})}),e.jsx(Be,{children:e.jsx(pt,{children:e.jsx("div",{children:t("Are your sure you want to rerun deduplication?")})})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>n(!1),children:t("CANCEL")}),e.jsx(ke,{loading:o,type:"submit",color:"primary",variant:"contained","data-cy":"button-rerun-dedupe-confirm",onClick:d,children:t("Rerun")})]})})]})]})},JT=({registration:s,refuseMutate:t,open:a,onClose:n})=>{const{t:i}=M(),{showMessage:r}=Ae(),{name:l}=s,o={refuseReason:""},d=Q.object().shape({refuseReason:Q.string().min(5,i("Too short")).max(100,i("Too long")).required(i("Refuse reason is required"))});return e.jsx(B.Formik,{initialValues:o,validationSchema:d,onSubmit:async c=>{try{await t({reason:c.refuseReason}),n(),r("RDI refused")}catch(u){fe(u,r,i("Failed to refuse RDI"))}},children:({submitForm:c})=>e.jsx(B.Form,{children:e.jsxs(is,{open:a,onClose:n,style:{minWidth:"750px"},children:[e.jsx(Le,{children:"Refuse RDI"}),e.jsxs(Be,{children:[e.jsxs(dl,{children:["Are you sure, that you want to refuse RDI ",l,"?"]}),e.jsx(B.Field,{name:"refuseReason",fullWidth:!0,multiline:!0,variant:"outlined",label:i("RDI Refuse Reason"),component:Se})]}),e.jsxs(os,{children:[e.jsx(H,{"data-cy":"button-cancel",onClick:n,children:"Cancel"}),e.jsx(H,{"data-cy":"button-save",onClick:c,color:"primary",variant:"contained",children:"Save"})]})]})})})},Nr=T.span`
  margin-left: ${({theme:s})=>s.spacing(4)};
`,ZT=({registration:s,canMerge:t,canRerunDedupe:a,canViewList:n,canRefuse:i})=>{const{t:r}=M(),{baseUrl:l}=U(),{businessAreaSlug:o,programSlug:d}=U(),c=Nt(),u=ge(),h=Fe(),{isActiveProgram:m}=Z(),{mutateAsync:g,isPending:x}=xe({mutationFn:async I=>N.restBusinessAreasProgramsRegistrationDataImportsRefuseCreate({id:s.id,businessAreaSlug:o,programSlug:d,requestBody:I}),onSuccess:()=>{h.invalidateQueries({queryKey:[N.restBusinessAreasProgramsRegistrationDataImportsRetrieve.name]})}}),{mutateAsync:f,isPending:j}=oo(s.id,N.restBusinessAreasProgramsRegistrationDataImportsEraseCreate,[N.restBusinessAreasProgramsRegistrationDataImportsRetrieve.name]),[y,b]=A.useState(!1);let C=null;const v=e.jsx(ke,{loading:j,onClick:()=>c({title:r("Warning"),content:r("Are you sure you want to erase RDI? Erasing RDI causes deletion of all related datahub RDI data")}).then(async()=>{await f()}),variant:"contained",color:"primary",disabled:!m,"data-cy":"button-erase-rdi",children:r("Erase import")});switch(s?.status){case Xs.IMPORT_ERROR:case Xs.MERGE_ERROR:C=e.jsx("div",{children:i&&v});break;case Xs.IN_REVIEW:C=e.jsxs("div",{children:[t&&i&&e.jsx(ke,{loading:x,onClick:()=>b(!0),variant:"contained",color:"primary",disabled:!m,"data-cy":"button-refuse-rdi",children:r("Refuse Import")}),t&&e.jsx(Nr,{children:e.jsx(QT,{registration:s})})]});break;case Xs.DEDUPLICATION_FAILED:C=e.jsxs("div",{children:[i&&v,a&&e.jsx(Nr,{children:e.jsx(XT,{registration:s})})]});break;case Xs.MERGED:C=e.jsx(Nr,{children:e.jsx(H,{variant:"contained",color:"primary",component:ys,"data-cy":"button-view-tickets",to:`/${l}/grievance/rdi/${s.id}`,children:r("View Tickets")})});break}const S=[{title:r("Registration Data import"),to:".."}];return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:s.name,breadCrumbs:n?S:null,handleBack:()=>u(".."),flags:e.jsx(gt,{adminUrl:s.adminUrl}),children:s.erased?null:C}),e.jsx(JT,{open:y,refuseMutate:g,onClose:()=>b(!1),registration:s})]})},gh=oe(ZT,"RegistrationDataImportDetailsPageHeader"),eR=[{disablePadding:!1,label:"Individual ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Individual",id:"full_name",numeric:!1},{disablePadding:!1,label:"Role",id:"role",numeric:!1},{disablePadding:!1,label:"Type",id:"relationship",numeric:!1},{disablePadding:!1,label:"Date of Birth",id:"birthDate",numeric:!1},{disablePadding:!1,label:"Gender",id:"sex",numeric:!1},{disablePadding:!1,label:"Dedupe within Batch",id:"deduplicationBatchStatus",numeric:!1},{disablePadding:!1,label:"Dedupe against Population",id:"deduplicationGoldenRecordStatus",numeric:!1}],Ud=()=>e.jsx(P,{display:"flex",justifyContent:"center",alignItems:"center",width:"45%",height:"200px",border:"1px solid #ccc","data-cy":"placeholder",children:e.jsx(Wa,{color:"primary",style:{fontSize:100}})}),sR=({similarityScore:s,individual1:t,individual2:a,openLinkText:n="View Similarity Details",modalTitle:i="Biometrics Results"})=>{const{t:r}=M(),[l,o]=A.useState(!1),d=ve(),[c,u]=A.useState(t),[h,m]=A.useState(a),g=K(R.GRIEVANCES_VIEW_BIOMETRIC_RESULTS,d),{selectedProgram:x}=Z(),f=x?.beneficiaryGroup,{businessAreaSlug:j,programSlug:y}=U(),b=V({queryKey:["individual",t?.id,j,y],queryFn:()=>N.restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:j,id:t?.id,programSlug:y}),enabled:l&&!!t?.id}),C=V({queryKey:["individual",a?.id,j,y],queryFn:()=>N.restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:j,id:a?.id,programSlug:y}),enabled:l&&!!a?.id});return A.useEffect(()=>{b.data&&u(b.data)},[b.data]),A.useEffect(()=>{C.data&&m(C.data)},[C.data]),e.jsxs(e.Fragment,{children:[e.jsx(P,{p:2,children:g&&e.jsx(H,{onClick:v=>{v.stopPropagation(),o(!0)},"data-cy":"button-open-biometrics-results","data-perm":R.GRIEVANCES_VIEW_BIOMETRIC_RESULTS,children:r(n)})}),e.jsxs(Ks,{open:l,onClose:()=>o(!1),scroll:"paper","aria-labelledby":"form-dialog-title",maxWidth:"md","data-cy":"dialog-biometrics-results",children:[e.jsx(Ye,{children:e.jsx(Le,{"data-cy":"dialog-title",children:r(i)})}),e.jsx(Be,{"data-cy":"dialog-content",children:e.jsxs(zs,{children:[e.jsxs(P,{display:"flex",justifyContent:"space-between",p:5,children:[e.jsxs(P,{display:"flex",flexDirection:"column",children:[c?.photo?e.jsx("img",{src:c?.photo,alt:"Image 1",style:{maxWidth:"100%",maxHeight:"300px",objectFit:"cover"},"data-cy":"image1"}):e.jsx(Ud,{}),e.jsxs(ee,{variant:"subtitle2",children:[f?.memberLabel," ",c?.unicefId,":"," ",c?.fullName]})]}),e.jsxs(P,{display:"flex",flexDirection:"column",children:[h?.photo?e.jsx("img",{src:h?.photo,alt:"Image 2",style:{maxWidth:"100%",maxHeight:"300px",objectFit:"cover"},"data-cy":"image2"}):e.jsx(Ud,{}),e.jsxs(ee,{variant:"subtitle2",children:[f?.memberLabel," ",h?.unicefId,":"," ",h?.fullName]})]})]}),e.jsxs(P,{p:5,"data-cy":"results-info",children:[e.jsx("div",{children:e.jsxs("strong",{children:[r("Algorithm similarity score:")," ",s]})}),e.jsx("div",{children:r("Face images matching suggests: Duplicates")})]})]})}),e.jsx(ss,{children:e.jsx(Gs,{children:e.jsx(H,{onClick:v=>{v.stopPropagation(),o(!1)},"data-cy":"button-close",children:r("CLOSE")})})})]})]})},tR=oe(sR,"BiometricsResultsRdi"),aR=T.span`
  color: ${({theme:s})=>s.hctPalette.red};
  font-weight: bold;
  text-decoration: underline;
  cursor: pointer;
`,nR=T.span`
  font-weight: bold;
  font-size: 16px;
`,Vd=T(gs)`
  min-width: 100;
`;function vi({individual:s,status:t,results:a,biometricResults:n,isInBatch:i=!1}){const{t:r}=M(),[l,o]=A.useState(!1),{baseUrl:d}=U(),{selectedProgram:c}=Z(),u=c?.beneficiaryGroup,h=(b,C,v,S,I,E,D)=>({unicefId:b,fullName:C,age:v,location:S||"N/A",score:I||0,proximityToScore:E||0,hitId:D}),m=(b,C,v,S,I,E)=>({unicefId:b,fullName:C,age:v,location:S||"N/A",similarityScore:I||0,id:E}),g=a.map(b=>h(b.unicefId,b.fullName,b.age,b.location,b.score,b.proximityToScore,b.hitId)),x=n.map(b=>m(b.unicefId,b.fullName,b.age,b.location,b.similarityScore,b.id)),f=b=>`/${d}/population/individuals/${b}`,j=g.sort((b,C)=>C.score-b.score),y=x.sort((b,C)=>C.similarityScore-b.similarityScore);return e.jsxs(e.Fragment,{children:[e.jsxs(aR,{onClick:b=>{b.preventDefault(),b.stopPropagation(),o(!0)},children:[t," (",a.length+n.length,")"]}),e.jsxs(is,{maxWidth:"md",fullWidth:!0,open:l,onClose:()=>o(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{children:r("Duplicates")})}),e.jsxs(Be,{children:[e.jsx(pt,{children:e.jsxs("div",{children:[r("Duplicates of")," ",e.jsxs(nR,{children:[s.fullName," (",s.unicefId,")"]})," ",r(i?"within batch ":"against population "),r("are listed below.")]})}),e.jsxs("div",{children:[e.jsx("h3",{children:r("Biographical")}),e.jsxs(Vd,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{style:{width:100},children:r(`${u?.memberLabel} ID`)}),e.jsx(_,{style:{width:100},children:r("Full Name")}),e.jsx(_,{style:{width:100},children:r("Age")}),e.jsx(_,{style:{width:100},children:r("Administrative Level 2")}),e.jsx(_,{style:{width:100},align:"left",children:r("Similarity Score")}),e.jsx(_,{style:{width:100},align:"left",children:r("Proximity to the Score")})]})}),e.jsxs(cs,{children:[j.map(b=>e.jsxs(be,{children:[e.jsx(_,{children:e.jsx(me,{to:f(b.hitId),children:b.unicefId})}),e.jsx(_,{align:"left",children:b.fullName}),e.jsx(_,{align:"left",children:b.age||r("Not provided")}),e.jsx(_,{align:"left",children:b.location}),e.jsx(_,{align:"left",children:b.score}),e.jsxs(_,{align:"left",children:[b.proximityToScore>0&&"+"," ",b.proximityToScore]})]},b.hitId))," "]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{children:r("Biometric")}),e.jsxs(Vd,{children:[e.jsx(hs,{children:e.jsxs(be,{children:[e.jsx(_,{style:{width:100},children:r(`${u?.memberLabel} ID`)}),e.jsx(_,{style:{width:100},children:r("Full Name")}),e.jsx(_,{style:{width:100},children:r("Age")}),e.jsx(_,{style:{width:100},children:r("Administrative Level 2")}),e.jsx(_,{style:{width:100},align:"left",children:r("Similarity Score")}),e.jsx(_,{style:{width:100},align:"left"})]})}),e.jsx(cs,{children:y.map(b=>e.jsxs(be,{children:[e.jsx(_,{children:e.jsx(me,{to:f(b.id),children:b.unicefId})}),e.jsx(_,{align:"left",children:b.fullName}),e.jsx(_,{align:"left",children:b.age||r("Not provided")}),e.jsx(_,{align:"left",children:b.location}),e.jsx(_,{align:"left",children:b.similarityScore}),e.jsx(_,{align:"left",children:e.jsx(tR,{similarityScore:b.similarityScore,individual1:s,individual2:b})})]},b.id))})]})]})]}),e.jsx(ss,{children:e.jsx(os,{children:e.jsx(H,{onClick:b=>{o(!1),b.preventDefault(),b.stopPropagation()},children:r("CLOSE")})})})]})]})}function Bd({individual:s,choices:t,rdi:a}){const n=ge(),{baseUrl:i,businessArea:r}=U(),l=_s(t.relationshipChoices),o=_s(t.roleChoices),d=_s(t.deduplicationBatchStatusChoices),c=_s(t.deduplicationGoldenRecordStatusChoices),u=`/${i}/population/individuals/${s.id}`,h=()=>{n(u,{state:{breadcrumbTitle:`Registration Data Import: ${a.name}`,breadcrumbUrl:`/${r}/registration-data-import/${a.id}`}})},m=["DUPLICATE","DUPLICATE_IN_BATCH","NEEDS_ADJUDICATION","SIMILAR_IN_BATCH","POSTPONE","UNIQUE","UNIQUE_IN_BATCH","NOT_PROCESSED","NOT_PROCESSED"];function g(x,f,j){const y=[x,f];return y.sort((b,C)=>m.indexOf(b)-m.indexOf(C)),j[y[0]]}return e.jsxs(rs,{hover:!0,onClick:()=>h(),role:"checkbox","data-cy":"imported-individuals-row",children:[e.jsx(_,{align:"left",children:e.jsx(me,{to:u,children:s.unicefId})}),e.jsx(Jt,{children:s.fullName}),e.jsx(_,{align:"left",children:o[s.role]}),e.jsx(_,{align:"left",children:l[s.relationship]}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.birthDate})}),e.jsx(_,{align:"left",children:ga(s.sex)}),e.jsx(_,{align:"left",children:s.biometricDeduplicationBatchResults?.length||s.deduplicationBatchResults?.length?e.jsx(vi,{status:g(s.deduplicationBatchStatus,s.biometricDeduplicationBatchStatus,d),results:s.deduplicationBatchResults,biometricResults:s.biometricDeduplicationBatchResults,individual:s,isInBatch:!0}):g(s.deduplicationBatchStatus,s.biometricDeduplicationBatchStatus,d)}),e.jsx(_,{align:"left",children:s.biometricDeduplicationGoldenRecordResults?.length||s.deduplicationGoldenRecordResults?.length?e.jsx(vi,{status:g(s.deduplicationGoldenRecordStatus,s.biometricDeduplicationGoldenRecordStatus,c),results:s.deduplicationGoldenRecordResults,biometricResults:s.biometricDeduplicationGoldenRecordResults,individual:s}):g(s.deduplicationGoldenRecordResults,s.biometricDeduplicationGoldenRecordResults,c)})]},s.id)}const iR=[{disablePadding:!1,label:"Individual ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Individual",id:"full_name",numeric:!1},{disablePadding:!1,label:"Role",id:"role",numeric:!1},{disablePadding:!1,label:"Type",id:"relationship",numeric:!1},{disablePadding:!1,label:"Date of Birth",id:"birthDate",numeric:!1},{disablePadding:!1,label:"Gender",id:"sex",numeric:!1},{disablePadding:!1,label:"Dedupe within Batch",id:"deduplicationBatchStatus",numeric:!1},{disablePadding:!1,label:"Dedupe against Population",id:"deduplicationGoldenRecordStatus",numeric:!1}];function rR({rdi:s,rdiId:t,isOnPaper:a=!1,title:n,household:i,rowsPerPageOptions:r=[10,15,20],showCheckbox:l,businessArea:o,choicesData:d,isMerged:c}){const[u,h]=A.useState(!1),{programId:m}=U(),[g,x]=A.useState(0),f=A.useMemo(()=>({rdiId:t,household:i,duplicatesOnly:u,businessAreaSlug:o,programSlug:m,page:g}),[t,i,u,o,m,g]),[j,y]=A.useState(f);A.useEffect(()=>{y(f)},[f]);const{data:b,isLoading:C,error:v}=V({queryKey:["businessAreasProgramsIndividualsList",j,o,m],queryFn:()=>N.restBusinessAreasProgramsIndividualsList(Ce({businessAreaSlug:o,programSlug:m},j,{withPagination:!0}))}),{data:S}=V({queryKey:["businessAreasProgramsIndividualsCount",j,o,m],queryFn:()=>N.restBusinessAreasProgramsIndividualsCountRetrieve(Ce({businessAreaSlug:o,programSlug:m},j)),enabled:g===0}),I=vs(g,S);return e.jsxs("div",{"data-cy":"imported-individuals-table",children:[l&&e.jsx(p,{container:!0,justifyContent:"flex-end",spacing:3,children:e.jsx(p,{children:e.jsx(P,{p:3,children:e.jsx(sa,{control:e.jsx(ns,{color:"primary",checked:u,onChange:()=>h(!u)}),label:"Show duplicates only"})})})}),c?e.jsx(ds,{title:n,headCells:iR,queryVariables:j,setQueryVariables:y,data:b,error:v,isLoading:C,rowsPerPageOptions:r,isOnPaper:a,itemsCount:I,page:g,setPage:x,renderRow:E=>e.jsx(Bd,{choices:d,individual:E,rdi:s},E.id)}):e.jsx(ds,{title:n,headCells:eR,queryVariables:j,setQueryVariables:y,rowsPerPageOptions:r,isOnPaper:a,data:b,error:v,isLoading:C,itemsCount:I,page:g,setPage:x,renderRow:E=>e.jsx(Bd,{choices:d,individual:E,rdi:s},E.id)})]})}const lR=T.div`
  && {
    display: flex;
    flex-direction: column;
    min-width: 100%;
  }
`,oR=T(La)`
  && {
    max-width: 500px;
  }
`,dR=T.div`
  border-bottom: 1px solid #e8e8e8;
`,cR=({children:s,index:t,value:a})=>e.jsx("div",{style:{display:t!==a?"none":"block"},children:s}),xh=()=>{const{t:s}=M(),{id:t}=ts(),a=ve(),{businessArea:n,programSlug:i}=U(),{isSocialDctType:r}=Z(),{data:l,isLoading:o,error:d}=V({queryKey:["registrationDataImport",n,i,t],queryFn:()=>N.restBusinessAreasProgramsRegistrationDataImportsRetrieve({businessAreaSlug:n,programSlug:i,id:t}),refetchInterval:j=>{const y=j.state.data?.status;return[Xs.LOADING,Xs.DEDUPLICATION,Xs.IMPORT_SCHEDULED,Xs.IMPORTING,Xs.MERGE_SCHEDULED,Xs.MERGING].includes(y)?3e4:!1},refetchIntervalInBackground:!0}),{data:c,isLoading:u}=V({queryKey:["individualChoices",n],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:n})}),[h,m]=A.useState(0),g=Xs.MERGED===l?.status;if(o||u)return e.jsx(Ne,{});if(rt(d))return e.jsx(Xe,{permission:R.RDI_VIEW_DETAILS});if(!l||!c||a===null)return null;const x=K(R.RDI_MERGE_IMPORT,a);function f({isErased:j}){return e.jsxs(lR,{children:[e.jsx(Xu,{registration:l,isSocialWorkerProgram:r}),j?null:e.jsx(Es,{children:e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:s(g?"Population Preview":"Import Preview")})}),e.jsx(dR,{children:e.jsx(oR,{value:h,onChange:(y,b)=>m(b),indicatorColor:"primary",textColor:"primary",variant:"fullWidth","aria-label":"full width tabs example",children:e.jsx(Tt,{"data-cy":"tab-Individuals",label:s("People")})})}),e.jsx(cR,{value:h,index:0,children:e.jsx(rR,{showCheckbox:!0,isOnPaper:!1,rdiId:t,rdi:l,isMerged:g,businessArea:n,choicesData:c},`${l.status}-individual`)})]})})]})}return e.jsxs(e.Fragment,{children:[e.jsx(gh,{registration:l,canMerge:x,canRerunDedupe:K(R.RDI_RERUN_DEDUPE,a),canViewList:K(R.RDI_VIEW_LIST,a),canRefuse:K(R.RDI_REFUSE_IMPORT,a)}),e.jsx(f,{isErased:l.erased})]})};oe(xh,"PeopleRegistrationDataImportDetailsPage");const fh=async(s,t)=>{try{return(await qn.post(`business-areas/${s}/programs/${t}/registration-data-imports/run-deduplication/`,{})).data}catch(a){Ji(a,"run deduplication data imports")}};function uR(){const[s,t]=A.useState();return[s,n=>{t(()=>()=>n())}]}function co(){const{t:s}=M(),{programSlug:t,businessAreaSlug:a}=U(),{data:n,isLoading:i}=V({queryKey:["program",a,t],queryFn:()=>N.restBusinessAreasProgramsRetrieve({businessAreaSlug:a,slug:t})});return i||!n?.screenBeneficiary?null:e.jsx(B.Field,{name:"screenBeneficiary",label:s("Screen Beneficiary"),color:"primary",component:ws})}function yh({numberOfHouseholds:s,numberOfIndividuals:t}){const{t:a}=M(),{selectedProgram:n,isSocialDctType:i}=Z(),r=n?.beneficiaryGroup;return i?e.jsx(e.Fragment,{children:e.jsxs("div",{"data-cy":"number-of-households",children:[t," ",a(" people available to import")]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{"data-cy":"number-of-households",children:[s," ",a(`${r?.groupLabel}`.concat(s>1?"s":"").concat(" available to import"))]}),e.jsxs("div",{"data-cy":"number-of-individuals",children:[t," ",a(`${r?.memberLabel}`.concat(t>1?"s":"").concat(" available to import"))]})]})}const Gd=T.div`
  color: ${({theme:s})=>s.palette.error.dark};
`,hR=T.div`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
`;function mR({errors:s}){const[t,a]=A.useState(!1);return!s||!s.length?null:e.jsxs(e.Fragment,{children:[e.jsxs(hR,{children:[e.jsx(Gd,{children:"Errors"}),e.jsx(Ve,{onClick:()=>a(!t),"aria-expanded":t,"aria-label":"show more",children:t?e.jsx(Di,{}):e.jsx(za,{})})]}),e.jsx(yt,{in:t,timeout:"auto",unmountOnExit:!0,children:s.map(n=>e.jsxs(Gd,{children:[e.jsxs("strong",{children:["Field:",n.header]})," ",n.message]},n.message))})]})}function pR({koboImportData:s,loading:t}){return!s||t?null:e.jsxs(e.Fragment,{children:[e.jsx(mR,{errors:s.koboValidationErrors}),e.jsx(yh,{numberOfHouseholds:s.numberOfHouseholds,numberOfIndividuals:s.numberOfIndividuals})]})}const gR=T(at)`
  & {
    min-width: 200px;
  }
`,xR=T.div`
  margin-right: 40px;
`,fR=T(Rt)`
  background-color: #fff;
`;function yR(){const{t:s}=M(),{businessArea:t}=U(),[a]=B.useField("koboAssetId"),{data:n,isLoading:i,error:r}=V({queryKey:["koboProjects",t],queryFn:async()=>N.restBusinessAreasAllKoboProjectsCreate({slug:t}),enabled:!!t}),l=n||[],o=d=>d?d.message||"Error loading projects":null;return e.jsxs(e.Fragment,{children:[e.jsxs(tt,{variant:"outlined",children:[e.jsx(fR,{size:"small",children:s("Select Project")}),e.jsx(gR,{...a,variant:"outlined",size:"small",label:s("Kobo Project"),disabled:i,fullWidth:!0,endAdornment:e.jsx(e.Fragment,{children:i?e.jsxs(xR,{children:[e.jsx(la,{color:"inherit",size:20})," "]}):null}),"data-cy":"kobo-project-select",children:l.map(d=>e.jsx(de,{value:d.id,children:d.name},d.id))})]}),e.jsx(Ls,{error:!0,children:o(r)})]})}function bR(){const[s,t]=A.useState(null),{businessAreaSlug:a}=U(),n=xe({mutationFn:async l=>N.restBusinessAreasProgramsKoboImportDataUploadSaveKoboImportDataCreate({businessAreaSlug:l.businessAreaSlug,programSlug:l.programSlug,requestBody:{uid:l.koboAssetId,onlyActiveSubmissions:l.onlyActiveSubmissions,pullPictures:l.pullPictures}}),onSuccess:l=>{t(l.id)}}),{data:i}=V({queryKey:["koboImportData",s,a],queryFn:async()=>!s||!a?null:N.restBusinessAreasKoboImportDataRetrieve({businessAreaSlug:a,id:s}),enabled:!!s,refetchInterval:l=>l&&["ERROR","VALIDATION_ERROR","FINISHED"].includes(l?.state?.data?.status)?!1:3e3});return{saveAndStartPolling:l=>{n.mutateAsync(l)},loading:n.isPending||["PENDING","RUNNING"].includes(i?.status),koboImportData:i||null}}const jR=T.div`
  display: flex;
  justify-content: center;
  align-content: center;
  width: 100%;
  height: 50px;
`,AR=Q.object().shape({name:Q.string().required("Title is required").min(4,"Too short").max(255,"Too long")});function _R({setSubmitForm:s,setSubmitDisabled:t}){const{saveAndStartPolling:a,loading:n,koboImportData:i}=bR(),{showMessage:r}=Ae(),{t:l}=M(),o=ge(),{baseUrl:d,businessArea:c,programId:u}=U(),h=xe({mutationFn:async f=>N.restBusinessAreasProgramsRegistrationDataImportsRegistrationKoboImportCreate({businessAreaSlug:c,programSlug:u,requestBody:f}),onSuccess:f=>{o(`/${d}/registration-data-import/${f.id}`)},onError:f=>{fe(f,r)}}),m=f=>{i?.id&&h.mutate({importDataId:i.id,name:f.name,screenBeneficiary:f.screenBeneficiary,pullPictures:f.pullPictures})},g=B.useFormik({initialValues:{name:"",koboAssetId:"",onlyActiveSubmissions:!0,screenBeneficiary:!1,pullPictures:!0},validationSchema:AR,onSubmit:m}),x=()=>{g.values.koboAssetId&&(t(!0),a({businessAreaSlug:c,programSlug:u,onlyActiveSubmissions:g.values.onlyActiveSubmissions,koboAssetId:g.values.koboAssetId,pullPictures:g.values.pullPictures}))};return A.useEffect(()=>{x()},[g.values.koboAssetId,g.values.onlyActiveSubmissions,g.values.pullPictures]),A.useEffect(()=>{s(g.submitForm)},[g.submitForm]),A.useEffect(()=>{i?.status==="FINISHED"?t(!1):t(!0)},[i]),e.jsx("div",{children:e.jsxs(B.FormikProvider,{value:g,children:[e.jsx(B.Field,{name:"onlyActiveSubmissions",label:l("Only approved submissions"),color:"primary",component:ws}),e.jsx(B.Field,{name:"pullPictures",label:l("Pull pictures"),color:"primary",component:ws}),e.jsx(yR,{}),e.jsx(B.Field,{name:"name",fullWidth:!0,label:l("Title"),required:!0,variant:"outlined",component:Se}),e.jsx(co,{}),n?e.jsx(jR,{children:e.jsx(la,{})}):e.jsx(pR,{koboImportData:i,loading:n})]})})}const PR=T.div`
  width: 100%;
  height: 100px;
  background-color: rgba(2, 62, 144, 0.1);
  color: #023e90;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: 0.5px;
  line-height: 16px;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: ${({theme:s})=>s.spacing(5)};
  cursor: pointer;
  ${({disabled:s})=>s?"filter: grayscale(100%);":""}
`,CR=({loading:s})=>{const[,,t]=B.useField("file"),{t:a}=M(),{showMessage:n}=Ae(),i=A.useCallback(c=>{c.forEach(u=>{if(u.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"){n(`${a("Invalid file type. Please upload a spreadsheet.")}`);return}const h=u.size/(1024*1024);if(h>200){n(`${a("File size is too big. It should be under 200MB")}, ${a("File size is")} ${h}MB`);return}t.setValue(u)})},[t,n,a]),{getRootProps:r,getInputProps:l,acceptedFiles:o}=Ec({disabled:s,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},onDrop:i}),d=o.length>0?o[0].name:null;return e.jsx("div",{children:e.jsxs(PR,{...r(),disabled:s,children:[e.jsx("input",{...l(),accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","data-cy":"file-input"}),d||"UPLOAD FILE"]})})},zd=T.div`
  color: ${({theme:s})=>s.palette.error.dark};
`,ER=T.div`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
`;function vR({errors:s}){const[t,a]=A.useState(!1);return!s||!s.length?null:e.jsxs(e.Fragment,{children:[e.jsxs(ER,{"data-cy":"errors-container",children:[e.jsx(zd,{children:"Errors"}),e.jsx(Ve,{onClick:()=>a(!t),"aria-expanded":t,"aria-label":"show more",children:t?e.jsx(Di,{}):e.jsx(za,{})})]}),e.jsx(yt,{in:t,timeout:"auto",unmountOnExit:!0,children:s.map(n=>e.jsxs(zd,{children:[e.jsxs("strong",{children:["Row:",n.rowNumber]})," ",n.message]},n.message))})]})}function SR({xlsxImportData:s,loading:t}){return!s||t?null:e.jsxs(e.Fragment,{children:[e.jsx(vR,{errors:s.xlsxValidationErrors}),e.jsx(yh,{numberOfHouseholds:s.numberOfHouseholds,numberOfIndividuals:s.numberOfIndividuals})]})}function IR(){const[s,t]=A.useState(null),{businessAreaSlug:a}=U(),n=xe({mutationFn:async l=>{const o={file:l.file};return N.restBusinessAreasProgramsImportDataUploadUploadXlsxFileCreate({businessAreaSlug:l.businessAreaSlug,programSlug:l.programSlug,formData:o})},onSuccess:l=>{t(l.id)}}),{data:i}=V({queryKey:["importData",s,a],queryFn:async()=>!s||!a?null:N.restBusinessAreasImportDataRetrieve({businessAreaSlug:a,id:s}),enabled:!!s,refetchInterval:l=>l&&["ERROR","VALIDATION_ERROR","FINISHED"].includes(l?.state?.data?.status)?!1:3e3});return{saveAndStartPolling:async l=>{await n.mutateAsync(l)},loading:n.isPending||["PENDING","RUNNING"].includes(i?.status),xlsxImportData:i||null}}const DR=T.div`
  display: flex;
  justify-content: center;
  align-content: center;
  height: 50px;
  width: 100%;
`,TR=Q.object().shape({name:Q.string().required("Title is required").min(4,"Too short").max(255,"Too long")});function RR({setSubmitForm:s,setSubmitDisabled:t}){const{saveAndStartPolling:a,loading:n,xlsxImportData:i}=IR(),{baseUrl:r,businessArea:l,programId:o}=U(),{showMessage:d}=Ae(),{t:c}=M(),u=ge(),h=xe({mutationFn:async f=>N.restBusinessAreasProgramsRegistrationDataImportsRegistrationXlsxImportCreate({businessAreaSlug:l,programSlug:o,requestBody:f}),onSuccess:f=>{u(`/${r}/registration-data-import/${f.id}`)},onError:f=>{fe(f,d),t(!1)}}),m=f=>{if(t(!0),!i?.id){t(!1);return}h.mutate({importDataId:i.id,name:f.name,screenBeneficiary:f.screenBeneficiary})},g=B.useFormik({initialValues:{name:"",screenBeneficiary:!1,file:null},validationSchema:TR,onSubmit:m}),x=async()=>{g.values.file&&(t(!0),await a({businessAreaSlug:l,programSlug:o,file:g.values.file}))};return A.useEffect(()=>{x()},[g.values.file]),A.useEffect(()=>{s(g.submitForm)},[g.submitForm]),A.useEffect(()=>{i?.status==="FINISHED"?t(!1):t(!0)},[i]),e.jsxs(B.FormikProvider,{value:g,children:[e.jsx(CR,{loading:n}),e.jsx(P,{mt:2,children:e.jsx(B.Field,{name:"name",fullWidth:!0,label:c("Title"),required:!0,variant:"outlined",component:Se})}),e.jsx(co,{}),n?e.jsx(DR,{children:e.jsx(la,{})}):e.jsx(SR,{xlsxImportData:i,loading:n})]})}const FR=({setSubmitForm:s,setSubmitDisabled:t})=>{const{baseUrl:a,businessArea:n,programId:i}=U(),{showMessage:r}=Ae(),{t:l}=M(),o=ge(),{selectedProgram:d,isSocialDctType:c}=Z(),u=d?.beneficiaryGroup,h=c?/^\s*(IND)-\d{2}-\d{4}\.\d{4}\s*$/:/^\s*(HH)-\d{2}-\d{4}\.\d{4}\s*$/,m=Q.object().shape({name:Q.string().required("Title is required").min(4,"Too short").max(255,"Too long"),importFromProgramId:Q.string().required("Programme is required"),importType:Q.string(),importFromIds:Q.string().when("importType",([I],E)=>I==="usingIds"?E.required("IDs are required").test("testName","ID is not in the correct format",D=>D?.length?D.split(",").every(w=>h.test(w)):!0):E)}),g={businessAreaSlug:n,beneficiaryGroupMatch:i,compatibleDct:i,limit:100},{data:x,isLoading:f}=V({queryKey:["businessAreasProgramsList",g,n,i],queryFn:()=>N.restBusinessAreasProgramsList(Ce({businessAreaSlug:n,programSlug:i},g,{withPagination:!0}))}),j=async I=>{t(!0);try{const E=await N.restBusinessAreasProgramsRegistrationDataImportsCreate({businessAreaSlug:n,programSlug:i,requestBody:{name:I.name,screenBeneficiary:I.screenBeneficiary,importFromProgramId:I.importFromProgramId,importFromIds:I.importFromIds,excludeExternalCollectors:I.importType==="excludeAlternateCollectors"}});o(`/${a}/registration-data-import/${E.id}`)}catch(E){fe(E,r),t(!1)}},y=B.useFormik({initialValues:{name:"",screenBeneficiary:!1,importFromIds:"",importType:"all",importFromProgramId:""},validationSchema:m,onSubmit:j}),{values:b}=y;A.useEffect(()=>{s(y.submitForm)},[y.submitForm]),A.useEffect(()=>{y.values.importType!=="usingIds"&&y.setFieldValue("importFromIds","")},[y.values.importType]);const[C,v]=A.useState("");if(f)return e.jsx(Ne,{});if(!x)return null;const S=x.results.filter(I=>I.name.toLowerCase().includes(C.toLowerCase())).map(I=>({labelEn:I.name,value:I.id}));return e.jsxs(B.FormikProvider,{value:y,children:[e.jsx(P,{mt:2,children:e.jsx(B.Field,{name:"name",fullWidth:!0,label:l("Title"),required:!0,variant:"outlined",component:Se})}),e.jsx(co,{}),e.jsx(P,{mt:2,children:e.jsx(B.Field,{name:"importFromProgramId",label:l("Programme Name"),fullWidth:!0,required:!0,choices:S,component:Ki,onInputChange:(I,E)=>v(E)})}),e.jsx(P,{mt:2,children:e.jsx(B.Field,{name:"importType","data-cy":"checkbox-verification-channel",choices:[{value:"all",name:"All Programme Population",dataCy:"radio-all"},{value:"excludeAlternateCollectors",name:"Exclude Alternate Collectors",dataCy:"radio-exclude-alternate-collectors"},{value:"usingIds",name:"Using Ids",dataCy:"radio-ids"}],component:ea,alignItems:"center"})}),b.importType==="usingIds"&&e.jsx(P,{mt:2,children:e.jsx(B.Field,{"data-cy":"input-import-from-ids",name:"importFromIds",fullWidth:!0,multiline:!0,variant:"outlined",label:l(c?`${u?.groupLabelPlural} or ${u?.memberLabelPlural} IDs`:`${u?.groupLabelPlural} IDs`),component:Se})})]})},NR=T(at)`
  & {
    min-width: 200px;
  }
`,LR=T(Rt)`
  background-color: #fff;
`,OR=T(ss)`
  && {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
  }
`,bh=()=>{const{t:s}=M(),[t,a]=A.useState(!1),[n,i]=A.useState(""),[r,l]=A.useState(!0),[o,d]=uR(),{isActiveProgram:c,selectedProgram:u}=Z();A.useEffect(()=>{t||l(!0)},[t]),A.useEffect(()=>{n==="programPopulation"&&l(!1)},[n]);const h=e.jsx(Vs,{variant:"contained",color:"primary",startIcon:e.jsx(Wm,{}),onClick:()=>a(!0),dataCy:"button-import",dataPerm:R.RDI_IMPORT_DATA,title:s("Program has to be active to create a new RegistrationDataImport"),disabled:!c||!u.canImportRdi,children:s("IMPORT")});let m;switch(n){case"kobo":m=e.jsx(_R,{setSubmitForm:d,setSubmitDisabled:l});break;case"excel":m=e.jsx(RR,{setSubmitForm:d,setSubmitDisabled:l});break;case"programPopulation":m=e.jsx(FR,{setSubmitForm:d,setSubmitDisabled:l});break;default:m=null}return t?e.jsxs("span",{children:[h,e.jsxs(Ks,{open:t,onClose:()=>a(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{children:s("Select File to Import")})}),e.jsxs(Be,{children:[e.jsxs(tt,{variant:"outlined",children:[e.jsx(LR,{size:"small",htmlFor:"import-type-select",children:s("Import From")}),e.jsxs(NR,{id:"import-type-select",value:n,size:"small",defaultValue:"",variant:"outlined",label:"",onChange:g=>i(g.target.value),fullWidth:!0,"data-cy":"import-type-select",children:[e.jsx(de,{"data-cy":"excel-menu-item",value:"excel",children:"Excel"},"excel"),e.jsx(de,{"data-cy":"kobo-menu-item",value:"kobo",children:"Kobo"},"kobo"),e.jsx(de,{"data-cy":"program-population-menu-item",value:"programPopulation",children:"Program Population"},"program-population")]})]}),e.jsx(P,{mt:2,children:m})]}),e.jsxs(OR,{"data-cy":"dialog-actions-container",children:[e.jsx(H,{variant:"text",color:"primary",component:"a",href:`/api/program/${u?.id}/download-template`,"data-cy":"a-download-template",children:s("DOWNLOAD TEMPLATE")}),e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>a(!1),children:s("CANCEL")}),e.jsx(H,{color:"primary",variant:"contained",disabled:r,"data-cy":"button-import-rdi",onClick:o,children:s("IMPORT")})]})]})]})]}):h},kR=({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})=>{const r=ge(),l=je(),{handleFilterChange:o,applyFilterChanges:d,clearFilter:c}=Ss(a,r,l,s,t,n,i),u=()=>{d()},h=()=>{c()},{t:m}=M(),{businessAreaSlug:g,programSlug:x}=U(),{data:f}=V({queryKey:[N.restBusinessAreasProgramsRegistrationDataImportsStatusChoicesList.name,g,x],queryFn:()=>N.restBusinessAreasProgramsRegistrationDataImportsStatusChoicesList({businessAreaSlug:g,programSlug:x})});return f?e.jsx(Ns,{clearHandler:h,applyHandler:u,children:e.jsxs(p,{container:!0,spacing:3,sx:{alignItems:"flex-end"},children:[e.jsx(p,{size:{xs:4},children:e.jsx(Cs,{label:m("Search"),value:s.search,onChange:j=>o("search",j.target.value),"data-cy":"filter-search"})}),e.jsx(p,{size:{xs:4},children:e.jsx(Bn,{name:"importedBy",label:m("Imported By"),filter:s,value:s.importedBy,"data-cy":"filter-imported-by",setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})}),e.jsx(p,{size:{xs:4},children:e.jsx(He,{value:s.status,label:m("Status"),onChange:j=>o("status",j.target.value),"data-cy":"filter-status",children:f.map(j=>e.jsx(de,{value:j.value,children:j.name},j.value))})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{id:"minFilter",topLabel:m("Num. of People"),value:s.sizeMin,placeholder:"From",icon:e.jsx(ct,{}),onChange:j=>o("sizeMin",j.target.value),"data-cy":"filter-size-min"})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{id:"maxFilter",value:s.sizeMax,placeholder:"To",icon:e.jsx(ct,{}),onChange:j=>o("sizeMax",j.target.value),"data-cy":"filter-size-max"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{topLabel:m("Import Date"),placeholder:m("From"),onChange:j=>o("importDateRangeMin",j),value:s.importDateRangeMin,dataCy:"filter-import-date-range-min"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{placeholder:m("To"),onChange:j=>o("importDateRangeMax",j),value:s.importDateRangeMax,dataCy:"filter-import-date-range-max"})})]})}):null},wR=oe(kR,"RegistrationPeopleFilters"),qd=[{disablePadding:!1,label:"",id:"radio",numeric:!1,dataCy:"radio-id"},{disablePadding:!1,label:"Title",id:"name",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Import Date",id:"importDate",numeric:!1},{disablePadding:!1,label:"Biometric Deduplicated",id:"biometricDeduplicated",numeric:!1,disableSort:!0},{disablePadding:!0,label:"Num. of People",id:"numberOfIndividuals",numeric:!0},{disablePadding:!1,label:"Imported by",id:"imported_by__first_name",numeric:!1},{disablePadding:!1,label:"Data Source",id:"data_source",numeric:!1}];function MR({registrationDataImport:s,canViewDetails:t,selectedRDI:a,radioChangeHandler:n}){const i=ge(),{baseUrl:r}=U(),l=`/${r}/registration-data-import/${s.id}`,o=()=>{i(l)},d=()=>s?.importedBy||"-";return e.jsxs(rs,{hover:!0,onClick:t?o:void 0,role:"checkbox",children:[n&&e.jsx(_,{padding:"checkbox",children:e.jsx(kt,{color:"primary",checked:a===s.id,onChange:()=>{n(s.id)},value:s.id,name:"radio-button-household",slotProps:{input:{"aria-label":s.id}}})}),e.jsx(_,{align:"left",children:t?e.jsx(me,{to:l,children:s.name}):s.name}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:ki})}),e.jsx(_,{align:"left",children:e.jsx(pe,{withTime:!0,children:s.importDate})}),e.jsx(_,{align:"center",children:s.biometricDeduplicated}),e.jsx(_,{align:"right",children:s.numberOfIndividuals}),e.jsx(_,{align:"left",children:d()}),e.jsx(_,{align:"left",children:s.dataSource})]},s.id)}const $R=T.div`
  .MuiPaper-elevation1 {
    box-shadow: none;
    padding: 0 !important;
  }
`;function UR({filter:s,canViewDetails:t,enableRadioButton:a,selectedRDI:n,handleChange:i,noTableStyling:r,noTitle:l}){const{t:o}=M(),{businessArea:d,programSlug:c}=U(),[u,h]=A.useState(0),m=A.useMemo(()=>({search:s.search,importedById:s.importedBy?Ea(s.importedBy):void 0,status:s.status!==""?s.status:void 0,importDateRange:JSON.stringify({min:Yt(s.importDateRangeMin,"startOfDay"),max:Yt(s.importDateRangeMax,"endOfDay")}),size:JSON.stringify({min:s.sizeMin,max:s.sizeMax}),page:u}),[s.search,s.importedBy,s.status,s.importDateRangeMin,s.importDateRangeMax,s.sizeMin,s.sizeMax,u]),[g,x]=A.useState(m);A.useEffect(()=>{x(m)},[m]);const{data:f,isLoading:j,error:y}=V({queryKey:["businessAreasProgramsRegistrationDataImportsList",d,c,g],queryFn:()=>N.restBusinessAreasProgramsRegistrationDataImportsList(Ce({businessAreaSlug:d,programSlug:c},g,{withPagination:!0}))}),{data:b,isLoading:C,error:v}=V({queryKey:["businessAreasProgramsRegistrationDataImportsCount",d,c,g],queryFn:async()=>{const D=Ce({businessAreaSlug:d,programSlug:c},g,{withPagination:!1});return N.restBusinessAreasProgramsRegistrationDataImportsCountRetrieve(D)},enabled:u===0}),S=vs(u,b),I=D=>{i(D)},E=()=>e.jsx(Es,{children:e.jsx(ds,{title:l?null:`${o("List of Imports")} (${S??f?.count??0})`,headCells:a?qd:qd.slice(1),defaultOrderBy:"importDate",defaultOrderDirection:"desc",rowsPerPageOptions:[10,15,20],data:f,isLoading:j||C,error:y||v,queryVariables:g,setQueryVariables:x,itemsCount:S,page:u,setPage:h,renderRow:D=>e.jsx(MR,{radioChangeHandler:a&&I,selectedRDI:n,registrationDataImport:D,canViewDetails:t},D.id)})});return r?e.jsx($R,{children:E()}):E()}const Lr={search:"",importedBy:"",status:"",sizeMin:"",sizeMax:"",importDateRangeMin:"",importDateRangeMax:""};function VR(){const s=je(),t=ve(),{t:a}=M(),{businessArea:n,programId:i,businessAreaSlug:r,programSlug:l}=U(),{showMessage:o}=Ae(),{data:d,isLoading:c}=V({queryKey:["deduplicationFlags",r,l],queryFn:()=>N.restBusinessAreasProgramsDeduplicationFlagsRetrieve({businessAreaSlug:r,slug:l})}),[u,h]=A.useState(Ke(s,Lr)),[m,g]=A.useState(Ke(s,Lr)),[x,f]=A.useState(!1),j=A.useRef(null);et(j,x,m,()=>f(!1));const{mutateAsync:y}=xe({mutationFn:async()=>fh(n,i),onSuccess:()=>{o("Deduplication process started")}}),b=async()=>{try{await y()}catch(v){fe(v,o)}};if(t===null||c)return null;if(!K(R.RDI_VIEW_LIST,t))return e.jsx(Xe,{permission:R.RDI_VIEW_LIST});const C=e.jsx(Ze,{title:a("Registration Data Import"),children:e.jsxs(P,{display:"flex",alignItems:"center",children:[d?.canRunDeduplication&&e.jsx(P,{mr:3,children:e.jsx(Vs,{variant:"contained",color:"primary",onClick:b,disabled:d?.isDeduplicationDisabled,title:a("Deduplication engine already in progress"),children:a("START DEDUPLICATION ENGINE")})}),K(R.RDI_IMPORT_DATA,t)&&e.jsx(P,{children:e.jsx(bh,{})})]})});return e.jsxs(e.Fragment,{children:[C,e.jsx(wR,{filter:u,setFilter:h,initialFilter:Lr,appliedFilter:m,setAppliedFilter:v=>{g(v),f(!0)}}),e.jsx(P,{ref:j,children:e.jsx(UR,{filter:m,canViewDetails:K(R.RDI_VIEW_DETAILS,t)})})]})}const BR=oe(VR,"PeopleRegistrationDataImportPage");function GR({field:s}){const{id:t}=ts(),{businessArea:a,programId:n}=U(),{data:i}=V({queryKey:["individual",a,n,t],queryFn:()=>N.restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:a,programSlug:n,id:t}),enabled:!!a&&!!n&&!!t});if(!i)return null;const r=i.flexFields?.[s.name];return e.jsx(nt,{src:r})}const zR=T(us)`
  padding: ${({theme:s})=>s.spacing(8)}
    ${({theme:s})=>s.spacing(11)};
  margin-top: ${({theme:s})=>s.spacing(6)};
  margin-bottom: ${({theme:s})=>s.spacing(6)};
`,qR=({individual:s,flexFieldsData:t})=>{const{t:a}=M(),n=Hs(t?.allIndividualsFlexFieldsAttributes,"name","*"),i=(l,o)=>l.find(d=>d.value===o)?.labelEn||"-",r=Object.entries(s.flexFields||{}).map(([l,o])=>{if(!(l in n))return e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:l,value:o,children:o})},l);const{type:d,choices:c}=n[l],u=l.replaceAll("_i_f","").replace(/_/g," ");let h,m;return d==="IMAGE"?m=e.jsx(GR,{field:n[l]}):d==="SELECT_MANY"||d==="SELECT_ONE"?(h=i(c,o),o instanceof Array&&(h=o.map(g=>i(c,g)).join(", "))):h=o,e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:u,value:h,children:m})},l)});return e.jsxs(zR,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Additional Registration information")})}),e.jsx(p,{container:!0,spacing:6,children:r})]})};function HR({individual:s,documentNumber:t,documentId:a}){const{businessArea:n}=U(),{selectedProgram:i}=Z(),{data:r}=V({queryKey:["individualPhotos",n,i?.slug,s?.id],queryFn:()=>N.restBusinessAreasProgramsIndividualsPhotosRetrieve({businessAreaSlug:n,programSlug:i?.slug||"",id:s?.id}),enabled:!!n&&!!i?.slug&&!!s?.id}),l=r?.documents?.find(o=>o.id===a);return e.jsx(nt,{src:l?.photo,linkText:t,variant:"link",title:"Document's Photo"})}const WR=T(us)`
  padding: ${({theme:s})=>s.spacing(8)}
    ${({theme:s})=>s.spacing(11)};
`,Or=T.div`
  border-bottom: 1px solid #e1e1e1;
`;function KR({individual:s,choicesData:t}){const{t:a}=M(),{selectedProgram:n}=Z(),{baseUrl:i}=U(),r=n?.beneficiaryGroup,l=_s(t.relationshipChoices),o=_s(t.maritalStatusChoices),d=_s(t.workStatusChoices),c=_s(t.severityOfDisabilityChoices),u=_s(t.observedDisabilityChoices),h=_s(t.roleChoices),m=s.documents?.map(x=>e.jsx(p,{size:3,children:e.jsxs(P,{flexDirection:"column",children:[e.jsx(P,{mb:1,children:e.jsx(L,{label:x.type.label,children:x.photo?e.jsx(HR,{documentNumber:x.documentNumber,documentId:x.id,individual:s}):x.documentNumber})}),e.jsx(L,{label:a("issued"),children:x.country.name})]})},x.id)),g=s.identities?.map(x=>e.jsx(p,{size:3,children:e.jsxs(P,{flexDirection:"column",children:[e.jsx(P,{mb:1,children:e.jsx(L,{label:`${x.partner} ID`,children:x.number})}),e.jsx(L,{label:a("issued"),children:x.country.name})]})},x.id));return e.jsxs(WR,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:a("Bio Data")})}),e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:3,children:e.jsx(L,{label:a("Full Name"),children:s.fullName})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Given Name"),children:s.givenName})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Middle Name"),children:s.middleName})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Family Name"),children:s.familyName})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Gender"),children:ga(s.sex)})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Age"),children:Sl(s.age)})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Date of Birth"),children:e.jsx(pe,{children:s.birthDate})})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Estimated Date of Birth"),children:Va(s.estimatedBirthDate)})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Marital Status"),children:o[s.maritalStatus]})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Work Status"),children:d[s.workStatus]})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Pregnant"),children:Va(s.pregnant)})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a(`${r?.groupLabel} ID`),children:s?.household?.id?e.jsx(Us,{href:`/${i}/registration-data-import/household/${s?.household?.id}`,children:s?.household.importId}):"-"})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Role"),children:h[s.role]})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Relationship to HOH"),children:l[s.relationship]})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:a("Preferred language"),children:s.preferredLanguage})}),e.jsx(p,{size:12,children:e.jsx(Or,{})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Observed disabilities"),children:u[s?.observedDisability]})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Seeing disability severity"),children:c[s.seeingDisability]})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Hearing disability severity"),children:c[s.hearingDisability]})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Physical disability severity"),children:c[s.physicalDisability]})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Remembering or concentrating disability severity"),children:c[s.memoryDisability]})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Self-care disability severity"),children:c[s.selfcareDisability]})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Communicating disability severity"),children:c[s.commsDisability]})}),!m?.length&&!g.length?null:e.jsx(p,{size:{xs:12},children:e.jsx(Or,{})}),m,g,e.jsx(p,{size:12,children:e.jsx(Or,{})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Email"),children:s?.email})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Phone Number"),children:Kt(s.phoneNo,s.phoneNoValid)})}),e.jsx(p,{size:3,children:e.jsx(L,{label:a("Alternate Phone Number"),children:Kt(s.phoneNoAlternative,s.phoneNoAlternativeValid)})})]})]})}const YR=T.div`
  padding: 20px;
  && {
    display: flex;
    flex-direction: column;
    width: 100%;
  }
`,QR=()=>{const{t:s}=M(),{id:t}=ts(),a=ve(),{businessArea:n,programId:i}=U(),{data:r,isLoading:l,error:o}=V({queryKey:["fieldsAttributes"],queryFn:async()=>({allIndividualsFlexFieldsAttributes:await qc.fieldsAttributesRetrieve()})}),{data:d,isLoading:c}=V({queryKey:["businessAreaProgramIndividual",n,i,t],queryFn:()=>N.restBusinessAreasProgramsIndividualsRetrieve({businessAreaSlug:n,programSlug:i,id:t})}),{data:u,isLoading:h}=V({queryKey:["individualChoices",n],queryFn:()=>N.restBusinessAreasIndividualsChoicesRetrieve({businessAreaSlug:n})});if(c||h||l)return e.jsx(Ne,{});if(rt(o))return e.jsx(Xe,{permission:R.RDI_VIEW_DETAILS});if(!d||!u||!r||a===null)return null;const m=[...K(R.RDI_VIEW_LIST,a)?[{title:s("Registration Data import"),to:"../.."}]:[],{title:d.registrationDataImport.name,to:".."}];return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`${s("Individual ID")}: ${d.importId}`,breadCrumbs:m,children:d.photo?e.jsx(lo,{individual:d}):null}),e.jsxs(YR,{children:[e.jsx(KR,{individual:d,choicesData:u}),e.jsx(qR,{individual:d,flexFieldsData:r})]})]})},XR=oe(QR,"PeopleRegistrationDetailsPage"),JR=[{disablePadding:!1,label:"",id:"",numeric:!1},{disablePadding:!1,label:"Household ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Head of Household",id:"head_of_household__full_name",numeric:!1},{disablePadding:!1,label:"Household Size",id:"size",numeric:!0},{disablePadding:!1,label:"Administrative Level 2",id:"admin2_title",numeric:!1},{disablePadding:!1,label:"Data Collected",id:"first_registration_date",numeric:!1}],ZR=T.div`
  color: #000;
  text-decoration: underline;
  cursor: pointer;
  display: flex;
  align-content: center;
`;function eF({household:s,rdi:t}){const{baseUrl:a,businessArea:n}=U(),{t:i}=M(),r=ge(),l=`/${a}/population/household/${s.id}`,o=()=>{r(l,{state:{breadcrumbTitle:`Registration Data Import: ${t.name}`,breadcrumbUrl:`/${n}/registration-data-import/${t.id}`}})};return e.jsxs(rs,{hover:!0,onClick:o,role:"checkbox","data-cy":"imported-households-row",children:[e.jsx(_,{align:"left",children:s.hasDuplicates&&e.jsx(Sa,{confirmed:!0,message:i("Household has Duplicates")})}),e.jsx(_,{align:"left",children:e.jsx(ZR,{onClick:()=>o(),children:s.unicefId})}),e.jsx(Jt,{children:s?.headOfHousehold}),e.jsx(_,{align:"right",children:s.size}),e.jsx(_,{align:"left",children:s?.admin2?.name}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.firstRegistrationDate})})]},s.id)}const sF=[{disablePadding:!1,label:"",id:"",numeric:!1},{disablePadding:!1,label:"Household ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Head of Household",id:"head_of_household__full_name",numeric:!1},{disablePadding:!1,label:"Household Size",id:"size",numeric:!0},{disablePadding:!1,label:"Administrative Level 2",id:"admin2__name",numeric:!1},{disablePadding:!1,label:"Data Collected",id:"first_registration_date",numeric:!1}],uo=s=>{const{query:t,page:a,setPage:n,customEnabled:i=!0,...r}=s,{businessArea:l,programSlug:o}=U(),{queryVariables:d}=s,c=mt.omitBy(d,mt.isUndefined),{data:u,isLoading:h,error:m}=V({queryKey:[t.name,c,o,l],queryFn:()=>t({businessAreaSlug:l,programSlug:o,...c}),enabled:i&&!!l&&!!o});return e.jsx(ds,{...r,page:a,setPage:n,data:u,isLoading:h,error:m})};function tF({rdi:s,businessArea:t,isMerged:a}){const{selectedProgram:n}=Z(),{programId:i}=U(),[r,l]=A.useState(0),o=[Xs.LOADING,Xs.IMPORTING,Xs.IMPORT_SCHEDULED,Xs.IMPORT_ERROR],d=A.useMemo(()=>({rdiId:s.id,businessAreaSlug:t,programSlug:i,rdiMergeStatus:a?"MERGED":"PENDING"}),[s.id,t,i,a]),[c,u]=A.useState(d);A.useEffect(()=>{u(d)},[d]);const{data:h}=V({queryKey:["businessAreasProgramsHouseholdsCount",i,t,c],queryFn:()=>N.restBusinessAreasProgramsHouseholdsCountRetrieve(Ce({businessAreaSlug:t,programSlug:i},c)),enabled:r===0&&!o.includes(s.status)}),m=n?.beneficiaryGroup,x=$s(sF,m,{unicefId:b=>`${b?.groupLabel} ID`,head_of_household__full_name:b=>`Head of ${b?.groupLabel}`,size:b=>`${b?.groupLabel} Size`}),f=vs(r,h),y=$s(JR,m,{unicefId:b=>`${b?.groupLabel} ID`,head_of_household__full_name:b=>`Head of ${b?.groupLabel}`,size:b=>`${b?.groupLabel} Size`});return e.jsx(uo,{isOnPaper:!1,renderRow:b=>e.jsx(eF,{rdi:s,household:b},b.id),query:N.restBusinessAreasProgramsHouseholdsList,headCells:a?x:y,queryVariables:c,setQueryVariables:u,page:r,setPage:l,itemsCount:f,customEnabled:!o.includes(s.status)})}const aF=oe(tF,"ImportedHouseholdTable"),nF=[{disablePadding:!1,label:"Individual ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Individual",id:"full_name",numeric:!1},{disablePadding:!1,label:"Role",id:"role",numeric:!1},{disablePadding:!1,label:"Relationship to HoH",id:"relationship",numeric:!1},{disablePadding:!1,label:"Date of Birth",id:"birthDate",numeric:!1},{disablePadding:!1,label:"Gender",id:"sex",numeric:!1},{disablePadding:!1,label:"Dedupe within Batch",id:"deduplicationBatchStatus",numeric:!1},{disablePadding:!1,label:"Dedupe against Population",id:"deduplicationGoldenRecordStatus",numeric:!1}];function iF({individual:s,rdi:t}){const a=ge(),{baseUrl:n,businessArea:i}=U(),r=`/${n}/population/individuals/${s.id}`,l=()=>{a(r,{state:{breadcrumbTitle:`Registration Data Import: ${t.name}`,breadcrumbUrl:`/${i}/registration-data-import/${t.id}`}})},o=[en.DUPLICATE,En.DUPLICATE_IN_BATCH,en.NEEDS_ADJUDICATION,En.SIMILAR_IN_BATCH,en.NOT_PROCESSED,En.NOT_PROCESSED,en.POSTPONE,en.UNIQUE,En.UNIQUE_IN_BATCH];function d(c,u,h){const m=o.indexOf(c),g=o.indexOf(u);return m===-1&&g===-1?"":m===-1?h[u]:g===-1||m<g?h[c]:h[u]}return e.jsxs(rs,{hover:!0,onClick:()=>l(),role:"checkbox","data-cy":"imported-individuals-row",children:[e.jsx(_,{align:"left",children:e.jsx(me,{to:r,children:s.unicefId})}),e.jsx(Jt,{children:s.fullName}),e.jsx(_,{align:"left",children:s.role}),e.jsx(_,{align:"left",children:s.relationshipDisplay}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.birthDate})}),e.jsx(_,{align:"left",children:ga(s.sex)}),e.jsx(_,{align:"left",children:s.biometricDeduplicationBatchResults?.length||s.deduplicationBatchResults?.length?e.jsx(vi,{status:d(s.deduplicationBatchStatus,s.biometricDeduplicationBatchStatus,{[s.deduplicationBatchStatus]:s.deduplicationBatchStatusDisplay,[s.biometricDeduplicationBatchStatus]:s.biometricDeduplicationBatchStatusDisplay}),results:s.deduplicationBatchResults,biometricResults:s.biometricDeduplicationBatchResults,individual:s,isInBatch:!0}):d(s.deduplicationBatchStatus,s.biometricDeduplicationBatchStatus,{[s.deduplicationBatchStatus]:s.deduplicationBatchStatusDisplay,[s.biometricDeduplicationBatchStatus]:s.biometricDeduplicationBatchStatusDisplay})}),e.jsx(_,{align:"left",children:s.biometricDeduplicationGoldenRecordResults?.length||s.deduplicationGoldenRecordResults?.length?e.jsx(vi,{status:d(s.deduplicationGoldenRecordStatus,s.biometricDeduplicationGoldenRecordStatus,{[s.deduplicationGoldenRecordStatus]:s.deduplicationGoldenRecordStatusDisplay,[s.biometricDeduplicationGoldenRecordStatus]:s.biometricDeduplicationGoldenRecordStatusDisplay}),results:s.deduplicationGoldenRecordResults,biometricResults:s.biometricDeduplicationGoldenRecordResults,individual:s}):d(s.deduplicationGoldenRecordStatus,s.biometricDeduplicationGoldenRecordStatus,{[s.deduplicationGoldenRecordStatus]:s.deduplicationGoldenRecordStatusDisplay,[s.biometricDeduplicationGoldenRecordStatus]:s.biometricDeduplicationGoldenRecordStatusDisplay})})]},s.id)}const rF=[{disablePadding:!1,label:"Individual ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Individual",id:"full_name",numeric:!1},{disablePadding:!1,label:"Role",id:"role",numeric:!1},{disablePadding:!1,label:"Relationship to HoH",id:"relationship",numeric:!1},{disablePadding:!1,label:"Date of Birth",id:"birthDate",numeric:!1},{disablePadding:!1,label:"Gender",id:"sex",numeric:!1},{disablePadding:!1,label:"Dedupe within Batch",id:"deduplicationBatchStatus",numeric:!1},{disablePadding:!1,label:"Dedupe against Population",id:"deduplicationGoldenRecordStatus",numeric:!1}];function lF({rdi:s,rdiId:t,title:a,household:n,showCheckbox:i,businessArea:r,isMerged:l}){const[o,d]=A.useState(!1),{selectedProgram:c}=Z(),{programId:u}=U(),h=c?.beneficiaryGroup,[m,g]=A.useState(0),x=[Xs.LOADING,Xs.IMPORTING,Xs.IMPORT_SCHEDULED,Xs.IMPORT_ERROR],f=A.useMemo(()=>({rdiId:t,household:n,duplicatesOnly:o,businessArea:r,rdiMergeStatus:l?"MERGED":"PENDING"}),[t,n,o,r,l]),[j,y]=A.useState(f);A.useEffect(()=>{y(f)},[f]);const b={unicefId:E=>`${E?.memberLabel} ID`,full_name:E=>E?.memberLabel,relationship:E=>`Relationship to Head of ${E?.groupLabel}`},C=$s(rF,h,b),v=$s(nF,h,b),{data:S}=V({queryKey:["businessAreasProgramsHouseholdsCount",u,r,j],queryFn:()=>N.restBusinessAreasProgramsIndividualsCountRetrieve(Ce({businessAreaSlug:r,programSlug:u},j)),enabled:m===0&&!x.includes(s.status)}),I=vs(m,S);return e.jsxs("div",{"data-cy":"imported-individuals-table",children:[i&&e.jsx(p,{container:!0,spacing:3,sx:{justifyContent:"flex-end"},children:e.jsx(p,{children:e.jsx(P,{sx:{p:3},children:e.jsx(sa,{control:e.jsx(ns,{color:"primary",checked:o,onChange:()=>d(!o)}),label:"Show duplicates only"})})})}),e.jsx(uo,{title:a,isOnPaper:!1,headCells:l?C:v,query:N.restBusinessAreasProgramsIndividualsList,queryVariables:j,setQueryVariables:y,itemsCount:I,page:m,setPage:g,renderRow:E=>e.jsx(iF,{individual:E,rdi:s},E.id),customEnabled:!x.includes(s.status)})]})}const oF=oe(lF,"ImportedIndividualsTable"),dF=T.div`
  && {
    display: flex;
    flex-direction: column;
    min-width: 100%;
  }
`,cF=T(La)`
  && {
    max-width: 500px;
  }
`,uF=T.div`
  border-bottom: 1px solid #e8e8e8;
`,Hd=({children:s,index:t,value:a})=>e.jsx("div",{style:{display:t!==a?"none":"block"},children:s}),hF=()=>{const{t:s}=M(),{id:t}=ts(),a=ve(),{selectedProgram:n}=Z(),{businessArea:i}=U(),r=n?.beneficiaryGroup,l=x=>{if(["Loading","Deduplication","Import Scheduled","Importing","Merge Scheduled","Merging"].includes(x?.state?.data?.status))return 3e4},{data:o,isLoading:d,error:c}=mn(t,N.restBusinessAreasProgramsRegistrationDataImportsRetrieve,{refetchInterval:l}),[u,h]=A.useState(0);if(d)return e.jsx(Ne,{});if(rt(c))return e.jsx(Xe,{permission:R.RDI_VIEW_DETAILS});if(!o||a===null)return null;const m=o.status==="MERGED";function g({isErased:x}){return e.jsxs(dF,{children:[e.jsx(Xu,{registration:o}),x?null:e.jsx(Es,{children:e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:s(m?"Population Preview":"Import Preview")})}),e.jsx(uF,{children:e.jsxs(cF,{value:u,onChange:(f,j)=>h(j),indicatorColor:"primary",textColor:"primary",variant:"fullWidth","aria-label":"full width tabs example",children:[e.jsx(Tt,{"data-cy":"tab-Households",label:r?.groupLabelPlural}),e.jsx(Tt,{"data-cy":"tab-Individuals",label:r?.memberLabelPlural})]})}),e.jsx(Hd,{value:u,index:0,children:e.jsx(aF,{isMerged:m,rdi:o,businessArea:i},`${o.status}-household`)}),e.jsx(Hd,{value:u,index:1,children:e.jsx(oF,{isOnPaper:!1,showCheckbox:!0,rdiId:t,isMerged:m,businessArea:i,rdi:o},`${o.status}-individual`)})]})})]})}return e.jsxs(e.Fragment,{children:[e.jsx(gh,{registration:o,canMerge:K(R.RDI_MERGE_IMPORT,a),canRerunDedupe:K(R.RDI_RERUN_DEDUPE,a),canViewList:K(R.RDI_VIEW_LIST,a),canRefuse:K(R.RDI_REFUSE_IMPORT,a)}),e.jsx(g,{isErased:o.erased})]})},mF=oe(hF,"RegistrationDataImportDetailsPage"),pF=({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})=>{const r=ge(),l=je(),{selectedProgram:o}=Z(),d=o?.beneficiaryGroup,{businessAreaSlug:c,programSlug:u}=U(),{handleFilterChange:h,applyFilterChanges:m,clearFilter:g}=Ss(a,r,l,s,t,n,i),x=()=>{m()},f=()=>{g()},{t:j}=M(),{data:y}=V({queryKey:[N.restBusinessAreasProgramsRegistrationDataImportsStatusChoicesList.name,c,u],queryFn:()=>N.restBusinessAreasProgramsRegistrationDataImportsStatusChoicesList({businessAreaSlug:c,programSlug:u})});return y?e.jsx(Ns,{clearHandler:f,applyHandler:x,children:e.jsxs(p,{container:!0,spacing:3,sx:{alignItems:"flex-end"},children:[e.jsx(p,{size:{xs:4},children:e.jsx(Cs,{label:j("Search"),value:s.search,onChange:b=>h("search",b.target.value),"data-cy":"filter-search"})}),e.jsx(p,{size:{xs:4},children:e.jsx(Bn,{name:"importedBy",label:j("Imported By"),filter:s,value:s.importedBy,"data-cy":"filter-imported-by",setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})}),e.jsx(p,{size:{xs:4},children:e.jsx(He,{value:s.status,label:j("Status"),onChange:b=>h("status",b.target.value),"data-cy":"filter-status",children:y.map(b=>e.jsx(de,{value:b.value,children:b.name},b.value))})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{id:"minFilter",topLabel:`Num. of ${d?.groupLabelPlural}`,value:s.sizeMin,placeholder:"From",icon:e.jsx(ct,{}),onChange:b=>h("sizeMin",b.target.value),"data-cy":"filter-size-min"})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{id:"maxFilter",value:s.sizeMax,placeholder:"To",icon:e.jsx(ct,{}),onChange:b=>h("sizeMax",b.target.value),"data-cy":"filter-size-max"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{topLabel:j("Import Date"),placeholder:j("From"),onChange:b=>h("importDateRangeMin",b),value:s.importDateRangeMin,dataCy:"filter-import-date-range-min"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{placeholder:j("To"),onChange:b=>h("importDateRangeMax",b),value:s.importDateRangeMax,dataCy:"filter-import-date-range-max"})})]})}):null},gF=oe(pF,"RegistrationFilters"),xF=[{disablePadding:!1,label:"",id:"radio",numeric:!1,dataCy:"radio-id"},{disablePadding:!1,label:"Title",id:"name",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Import Date",id:"importDate",numeric:!1},{disablePadding:!0,label:"Num. of Individuals",id:"numberOfIndividuals",numeric:!0},{disablePadding:!0,label:"Num. of Households",id:"numberOfHouseholds",numeric:!0},{disablePadding:!1,label:"Imported by",id:"imported_by__first_name",numeric:!1},{disablePadding:!1,label:"Data Source",id:"data_source",numeric:!1}];function fF({registrationDataImport:s,canViewDetails:t,selectedRDI:a,radioChangeHandler:n,biometricDeduplicationEnabled:i}){const r=ge(),{baseUrl:l}=U(),o=`/${l}/registration-data-import/${s.id}`,d=()=>{n!==void 0?n(s.id):r(o)},c=()=>s?.importedBy?s.importedBy:"-";return e.jsxs(rs,{hover:!0,onClick:t?d:void 0,role:"checkbox",children:[n&&e.jsx(_,{padding:"checkbox",children:e.jsx(kt,{color:"primary",checked:a===s.id,onChange:()=>{n(s.id)},value:s.id,name:"radio-button-household",slotProps:{input:{"aria-label":s.id}}})}),e.jsx(_,{align:"left",children:t?e.jsx(me,{to:o,children:s.name}):s.name}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:ki})}),e.jsx(_,{align:"left",children:e.jsx(pe,{withTime:!0,children:s.importDate})}),i&&e.jsx(_,{align:"center",children:s.biometricDeduplicated}),e.jsx(_,{align:"right",children:s.numberOfIndividuals}),e.jsx(_,{align:"right",children:s.numberOfHouseholds}),e.jsx(_,{align:"left",children:c()}),e.jsx(_,{align:"left",children:s.dataSource})]},s.id)}const yF=T.div`
  .MuiPaper-elevation1 {
    box-shadow: none;
    padding: 0 !important;
  }
`;function bF({filter:s,canViewDetails:t,enableRadioButton:a,selectedRDI:n,handleChange:i,noTableStyling:r,noTitle:l}){const{t:o}=M(),{selectedProgram:d}=Z(),c=d?.beneficiaryGroup,{businessAreaSlug:u,programSlug:h,businessArea:m,programId:g}=U(),{data:x}=V({queryKey:["deduplicationFlags",u,h],queryFn:()=>N.restBusinessAreasProgramsDeduplicationFlagsRetrieve({businessAreaSlug:u,slug:h})}),f=A.useMemo(()=>({search:s.search,importedById:s.importedBy||void 0,status:s.status!==""?s.status:void 0,businessArea:m,program:g,importDateAfter:s.importDateRangeMin,importDateBefore:s.importDateRangeMax,sizeMin:s.sizeMin,sizeMax:s.sizeMax}),[s.importDateRangeMax,s.importDateRangeMin,s.importedBy,s.search,s.sizeMax,s.sizeMin,s.status,m,g]),[j,y]=A.useState(f);A.useEffect(()=>{y(f)},[f]);const b=O=>{i(O)},v=$s(xF,c,{numberOfIndividuals:O=>`Num. of ${O?.memberLabelPlural}`,numberOfHouseholds:O=>`Num. of ${O?.groupLabelPlural}`,household__unicef_id:O=>`${O?.groupLabel} ID`}),S=()=>{let O=v.slice();return x?.canRunDeduplication&&O.splice(4,0,{disablePadding:!1,label:"Biometric Deduplicated",id:"biometricDeduplicated",numeric:!1,disableSort:!0}),a||(O=O.slice(1)),O},[I,E]=A.useState(0),{data:D}=V({queryKey:["businessAreasProgramsRegistrationDataImportsCount",m,h,j],queryFn:async()=>{const O=Ce({businessAreaSlug:m,programSlug:h},j,{withPagination:!1});return N.restBusinessAreasProgramsRegistrationDataImportsCountRetrieve(O)},enabled:I===0}),F=vs(I,D),w=()=>e.jsx(Es,{children:e.jsx(uo,{renderRow:O=>e.jsx(fF,{radioChangeHandler:a&&b,selectedRDI:n,registrationDataImport:O,canViewDetails:t,biometricDeduplicationEnabled:x?.canRunDeduplication},O.id),title:l?null:`${o("List of Imports")} (${F||0})`,itemsCount:F||0,headCells:S(),queryVariables:j,setQueryVariables:y,query:N.restBusinessAreasProgramsRegistrationDataImportsList,page:I,setPage:E})});return e.jsx(e.Fragment,{children:r?e.jsx(yF,{children:w()}):w()})}const jF=oe(bF,"RegistrationDataImportTable"),kr={search:"",importedBy:"",status:"",sizeMin:"",sizeMax:"",importDateRangeMin:"",importDateRangeMax:""};function AF(){const s=je(),t=ve(),{t:a}=M(),{businessArea:n,programId:i}=U(),{showMessage:r}=Ae(),{data:l,isLoading:o}=V({queryKey:["deduplicationFlags",n,i],queryFn:()=>N.restBusinessAreasProgramsDeduplicationFlagsRetrieve({businessAreaSlug:n,slug:i})}),{data:d}=V({queryKey:["businessArea",n],queryFn:()=>N.restBusinessAreasRetrieve({slug:n})}),[c,u]=A.useState(Ke(s,kr)),[h,m]=A.useState(Ke(s,kr)),[g,x]=A.useState(!1),f=A.useRef(null);et(f,g,h,()=>x(!1));const{mutateAsync:j}=xe({mutationFn:async()=>fh(n,i),onSuccess:()=>{r("Deduplication process started")}}),y=async()=>{try{await j()}catch(C){fe(C,r)}};if(t===null||o)return null;if(!K(R.RDI_VIEW_LIST,t))return e.jsx(Xe,{permission:R.RDI_VIEW_LIST});const b=e.jsx(Ze,{title:a("Registration Data Import"),children:e.jsxs(P,{display:"flex",alignItems:"center",children:[l?.canRunDeduplication&&e.jsx(P,{mr:3,children:e.jsx(Vs,{variant:"contained",color:"primary",onClick:y,disabled:l?.isDeduplicationDisabled,title:a("Deduplication engine already in progress"),children:a("START DEDUPLICATION ENGINE")})}),K(R.RDI_IMPORT_DATA,t)&&!d?.rdiImportXlsxDisabled&&e.jsx(P,{children:e.jsx(bh,{})})]})});return e.jsxs(e.Fragment,{children:[b,e.jsx(gF,{filter:c,setFilter:u,initialFilter:kr,appliedFilter:h,setAppliedFilter:C=>{m(C),x(!0)}}),e.jsx(P,{ref:f,children:e.jsx(jF,{filter:h,canViewDetails:K(R.RDI_VIEW_DETAILS,t)})})]})}const _F=oe(AF,"RegistrationDataImportPage"),PF=()=>{const{isSocialDctType:s}=Z();let t=[];return s?t=[{path:"",element:e.jsx(BR,{})},{path:"people/:id",element:e.jsx(XR,{})},{path:":id",element:e.jsx(xh,{})}]:t=[{path:"",element:e.jsx(_F,{})},{path:":id",element:e.jsx(mF,{})}],oa([{path:"registration-data-import",children:t}])},CF=({handleSubmit:s,values:t,baseUrl:a,permissions:n,loading:i})=>{const{t:r}=M(),l=d=>d?.some(c=>{const u=c.householdsFiltersBlocks||[],h=c.individualsFiltersBlocks||[],m=c.individualIds||[],g=c.householdIds||[];return u.length===0&&h.length===0&&m.length===0&&g.length===0}),o=[{title:r("Targeting"),to:`/${a}/target-population/`}];return e.jsx(Ze,{title:r("New Target Population"),breadCrumbs:K(R.TARGETING_VIEW_LIST,n)?o:null,children:e.jsxs(e.Fragment,{children:[e.jsx(P,{m:2,children:e.jsx(H,{"data-cy":"button-cancel",component:ys,to:`/${a}/target-population`,children:r("Cancel")})}),e.jsx(P,{m:2,children:e.jsx(ke,{variant:"contained",color:"primary",onClick:s,disabled:l(t.criterias),loading:i,"data-cy":"button-target-population-create",children:r("Save")})})]})})},EF=oe(CF,"CreateTargetPopulationHeader");function vF({initialOpen:s=!1}){const[t,a]=A.useState(s),{t:n}=M(),{isSocialDctType:i}=Z(),{selectedProgram:r}=Z(),l=r?.beneficiaryGroup;return e.jsxs(ft,{children:[e.jsxs(P,{display:"flex",justifyContent:"space-between",children:[e.jsx(ee,{"data-cy":"title-excluded-entries",variant:"h6",children:i?n("Excluded Target Population Entries"):`Excluded Target Population Entries (${l?.groupLabelPlural} or ${l?.memberLabelPlural})`}),e.jsx(H,{variant:"outlined",color:"primary","data-cy":"button-show-hide-exclusions",onClick:()=>a(!t),endIcon:t?e.jsx(Dn,{}):e.jsx(Tn,{}),children:n(t?"HIDE":"SHOW")})]}),e.jsxs(yt,{in:t,children:[e.jsx(P,{mt:2,children:e.jsx(p,{container:!0,children:e.jsx(p,{size:6,children:e.jsx(B.Field,{"data-cy":"input-excluded-ids",name:"excludedIds",fullWidth:!0,variant:"outlined",label:n(i?`${l?.memberLabel} IDs to exclude`:`${l?.groupLabel} or ${l?.memberLabel} IDs to exclude`),component:Se})})})}),e.jsx(P,{mt:2,children:e.jsx(p,{container:!0,children:e.jsx(p,{size:6,children:e.jsx(B.Field,{"data-cy":"input-exclusion-reason",name:"exclusionReason",fullWidth:!0,multiline:!0,variant:"outlined",label:n("Exclusion Reason"),component:Se})})})})]})]})}const jh=oe(vF,"Exclusions"),ci=T.div`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 500;
  color: #253b46;
  text-transform: uppercase;
  padding: 5px;
  border: 1px solid #b1b1b5;
  border-radius: 50%;
  background-color: #fff;
`,ui=T.div`
  border-top: 1px solid #b1b1b5;
  margin: ${({theme:s})=>s.spacing(10)} 0;
  position: relative;
`,Wd=s=>!s.isNull&&(s.value===null||s.value===""||s?.fieldAttribute?.type==="SELECT_MANY"&&s.value&&s.value.length===0),Kd=s=>!s.isNull&&typeof s.value=="object"&&s.value!==null&&Object.prototype.hasOwnProperty.call(s.value,"from")&&Object.prototype.hasOwnProperty.call(s.value,"to")&&!s.value.from&&!s.value.to,SF=(s,t)=>{const a=s.householdsFiltersBlocks.some(Wd)||s.householdsFiltersBlocks.some(Kd),i=(l=>!l||!Array.isArray(l)?!1:l.some(o=>{if(!o.blockFilters||!Array.isArray(o.blockFilters))return!1;const d=o.blockFilters.some(Wd),c=o.blockFilters.some(Kd);return d||c}))(s.individualsFiltersBlocks),r={};return(a||i)&&(r.nonFieldErrors=["You need to fill out missing values."]),s.householdsFiltersBlocks.length+s.individualsFiltersBlocks.length===0&&(!s.householdIds||s.householdIds.length===0)&&(!s.individualIds||s.individualIds.length===0)?r.nonFieldErrors=[`You need to add at least one ${t?.groupLabel} filter or an ${t?.memberLabel} block filter.`]:s.individualsFiltersBlocks.filter(l=>l.blockFilters&&l.blockFilters.length===0).length>0&&(r.nonFieldErrors=[`You need to add at least one ${t?.groupLabel} filter or an ${t?.memberLabel} block filter.`]),r},Ah=Q.string().test("testName","ID is not in the correct format",s=>s?.length?s.split(",").every(a=>/^\s*(IND|HH)-\d{2}-\d{4}\.\d{4}\s*$/.test(a)):!0),ho=Q.string().test("testName","Household ID is not in the correct format",s=>s?.length?s.split(",").every(a=>/^\s*(HH)-\d{2}-\d{4}\.\d{4}\s*$/.test(a)):!0),mo=Q.string().test("testName","Individual ID is not in the correct format",s=>s?.length?s.split(",").every(a=>/^\s*(IND)-\d{2}-\d{4}\.\d{4}\s*$/.test(a)):!0),_h=(s,t,a)=>{let n;s.isFlexField===!1?n="NOT_FLEX_FIELD":s.isFlexField===!0&&s.type!=="PDU"?n="FLEX_FIELD_BASIC":s.isFlexField===!0&&s.type==="PDU"&&(n="FLEX_FIELD_PDU");const i={flexFieldClassification:n,associatedWith:s.associatedWith,fieldAttribute:{labelEn:s.labelEn,type:s.type,choices:null},value:null,pduData:s.pduData};switch(s.type){case"INTEGER":i.value={from:"",to:""};break;case"DATE":i.value={from:void 0,to:void 0};break;case"SELECT_ONE":i.fieldAttribute.choices=s.choices;break;case"SELECT_MANY":i.value=[],i.fieldAttribute.choices=s.choices;break;default:i.value=null;break}t.replace(a,{...i,fieldName:s.name,type:s.type})},Ph=(s,t)=>s.replace(t,{});function Ch(s){const t=[];return s?s.map(a=>{switch(a.comparisonMethod){case"RANGE":return t.push({...a,value:{from:a.arguments[0],to:a.arguments[1]}});case"LESS_THAN":return t.push({...a,value:{from:"",to:a.arguments[0]}});case"GREATER_THAN":return t.push({...a,value:{from:a.arguments[0],to:""}});case"EQUALS":return t.push({...a,value:a.fieldAttribute?.type==="BOOL"||a?.type==="BOOL"||a?.fieldAttribute?.pduData?.subtype==="BOOL"||a.fieldAttribute?.pduData?.subtype?a.arguments[0]?"Yes":"No":a.arguments[0]});case"CONTAINS":let n;return a?.fieldAttribute?.type==="SELECT_MANY"?n=a.arguments:n=typeof a.arguments=="string"?a.arguments:a.arguments[0],t.push({...a,value:n});default:return t.push({...a})}}):t.push({fieldName:""}),t}function IF(s,t){return s.map(a=>({[`${t}BlockFilters`]:Ch(a[`${t}BlockFilters`]).map(n=>({...n,isNull:n.comparisonMethod==="IS_NULL"||n.isNull}))}))}function DF(s){const t=s.individualIds||"",a=s.householdIds||"",n=s.deliveryMechanism||"",i=s.fsp||"",r=s.householdsFiltersBlocks||[],l=s.individualsFiltersBlocks||[];return{deliveryMechanism:n,fsp:i,individualIds:t,householdIds:a,householdsFiltersBlocks:Ch(r),individualsFiltersBlocks:IF(l,"individual")}}function Eh(s){return s.map(t=>{let a,n;switch(t?.fieldAttribute?.type||t?.type){case"SELECT_ONE":a="EQUALS",n=[t.value];break;case"SELECT_MANY":a="CONTAINS",n=[...t.value];break;case"STRING":a="CONTAINS",t.associatedWith==="Account"&&(a="EQUALS"),n=[t.value];break;case"DECIMAL":case"INTEGER":case"DATE":t.value.from&&t.value.to?(a="RANGE",n=[t.value.from,t.value.to]):t.value.from&&!t.value.to?(a="GREATER_THAN",n=[t.value.from]):(a="LESS_THAN",n=[t.value.to]);break;case"BOOL":a="EQUALS",n=[t.value];break;case"PDU":switch(t.pduData?.subtype||t.fieldAttribute?.pduData?.subtype){case"SELECT_ONE":a="EQUALS",n=[t.value];break;case"SELECT_MANY":a="CONTAINS",n=[...t.value];break;case"STRING":a="CONTAINS",n=[t.value];break;case"DECIMAL":case"INTEGER":case"DATE":t.value.from&&t.value.to?(a="RANGE",n=[t.value.from,t.value.to]):t.value.from&&!t.value.to?(a="GREATER_THAN",n=[t.value.from]):(a="LESS_THAN",n=[t.value.to]);break;case"BOOL":a="EQUALS",n=[t.value==="Yes"];break;default:a="CONTAINS",n=[t.value]}break;default:a="CONTAINS",n=[t.value]}return{...t,comparisonMethod:a,arguments:n,fieldName:t.fieldName,fieldAttribute:t.fieldAttribute,flexFieldClassification:t.flexFieldClassification}})}function TF(s){return s.map(t=>({individualBlockFilters:Eh(t.individualBlockFilters)}))}function Yd(s){let t=[];s?.associatedWith==="Account"?t=s.isNull?[null]:s.arguments:t=s.isNull?[null]:s.arguments.map(n=>n==="Yes"?!0:n==="No"?!1:n);const a={comparisonMethod:s.isNull?"IS_NULL":s.comparisonMethod,arguments:t,fieldName:s.fieldName,flexFieldClassification:s.flexFieldClassification};return s.flexFieldClassification==="FLEX_FIELD_PDU"&&(a.roundNumber=s.roundNumber),a}function vh(s){return{rules:s.criterias.map(t=>({individualIds:t.individualIds,householdIds:t.householdIds,householdsFiltersBlocks:t.householdsFiltersBlocks.map(Yd),individualsFiltersBlocks:t.individualsFiltersBlocks.map(a=>({individualBlockFilters:a.individualBlockFilters.map(Yd)}))}))}}const RF=T(ha)`
  width: 100%;
`;function FF({field:s,...t}){const[a,n]=A.useState(!1),[i,r]=A.useState(null),[l,o]=A.useState();A.useEffect(()=>{const c=t.choices.find(u=>u.name===s.value)||null;r(c)},[s.value,t.choices]),A.useEffect(()=>{const c=t.choices.filter((u,h,m)=>h===m.findIndex(g=>g.name===u.name));o(c)},[t.choices]);const d=Os(t.form.errors,s.name)&&Os(t.form.touched,s.name);return e.jsx(RF,{...s,...t,open:a,onOpen:()=>{n(!0)},onClose:()=>{n(!1)},options:l||[],value:i,getOptionLabel:c=>c?typeof c.labelEn=="string"?c.labelEn:c.labelEn?.englishEn?String(c.labelEn.englishEn):c.label?.englishEn?String(c.label.englishEn):"":"",renderInput:c=>e.jsx(ks,{...c,...t,size:"small",variant:"outlined",fullWidth:!0,helperText:d&&Os(t.form.errors,s.name),error:d,InputProps:{...c.InputProps},inputProps:{...c.inputProps,"data-cy":`autocomplete-target-criteria-option-${t.index}`}}),"data-cy":"autocomplete-target-criteria",component:A.forwardRef(function(u,h){return e.jsx(us,{...u,ref:h,"data-cy":"autocomplete-target-criteria-options"})})})}const NF=oe(FF,"CriteriaAutocomplete"),Sh=({onChange:s,fieldName:t,onDelete:a,index:n,choices:i,baseName:r,showDelete:l})=>{const{t:o}=M();return e.jsxs(P,{mb:2,display:"flex",justifyContent:"space-between",children:[e.jsx(B.Field,{name:`${r}.fieldName`,label:o("Select Field"),required:!0,choices:i,index:n,value:t||null,onChange:s,component:NF,"data-cy":`field-chooser-${r}`}),l&&e.jsx(Ve,{onClick:a,children:e.jsx(Rs,{})})]})},wr=T.div`
  display: flex;
  justify-content: space-between;
`,Ja=T.div`
  width: 48%;
`,LF=({baseName:s,blockIndex:t,index:a,field:n,choicesDict:i,fieldTypeProp:r})=>{const{t:l}=M(),{values:o,setFieldValue:d}=B.useFormikContext();if(t===void 0){const g=s.match(/block\[(\d+)\]/);g&&(t=parseInt(g[1],10))}const u=((g,x,f)=>x!==void 0&&f!==void 0?g?.[x]?.blockFilters?.[f]?.isNull??!1:!1)(o?.individualsFiltersBlocks,t,a)||(o.householdsFiltersBlocks?.some(g=>g.isNull)??!1);if(A.useEffect(()=>{u&&(d(`${s}.value.from`,""),d(`${s}.value.to`,""),d(`${s}.value`,""))},[u,d,s]),!n)return null;const h=()=>{const g=n.fieldAttribute?.labelEn;return typeof g=="string"?g:g&&typeof g.englishEn=="string"?g.englishEn:""},m=g=>{switch(r||g){case"DECIMAL":return e.jsxs(wr,{children:[e.jsx(Ja,{children:e.jsx(B.Field,{name:`${s}.value.from`,label:`${h()} from`,variant:"outlined",fullWidth:!0,component:Ln,"data-cy":"decimal-from",disabled:u},u?`${s}-cleared-from`:`${s}-from`)}),e.jsx(Ja,{children:e.jsx(B.Field,{name:`${s}.value.to`,label:`${h()} to`,variant:"outlined",fullWidth:!0,component:Ln,"data-cy":"decimal-to",disabled:u},u?`${s}-cleared-to`:`${s}-to`)})]});case"DATE":return e.jsxs(wr,{children:[e.jsx(Ja,{children:e.jsx(B.Field,{name:`${s}.value.from`,label:`${h()} from`,fullWidth:!0,component:jt,decoratorEnd:e.jsx(bt,{color:"disabled"}),"data-cy":"date-from",disabled:u})}),e.jsx(Ja,{children:e.jsx(B.Field,{name:`${s}.value.to`,label:`${h()} to`,fullWidth:!0,component:jt,decoratorEnd:e.jsx(bt,{color:"disabled"}),"data-cy":"date-to",disabled:u})})]});case"INTEGER":return e.jsxs(wr,{children:[e.jsx(Ja,{children:e.jsx(B.Field,{name:`${s}.value.from`,label:`${h()} from`,type:"number",integer:!0,variant:"outlined",fullWidth:!0,component:Se,"data-cy":"integer-from",disabled:u})}),e.jsx(Ja,{children:e.jsx(B.Field,{name:`${s}.value.to`,label:`${h()} to`,type:"number",integer:!0,variant:"outlined",fullWidth:!0,component:Se,"data-cy":"integer-to",disabled:u})})]});case"SELECT_ONE":return n.fieldName.includes("admin")?e.jsx(B.Field,{name:`${s}.value`,label:h(),choices:i[n.fieldName],index:a,component:Ki,"data-cy":"select-one-autocomplete"}):e.jsx(B.Field,{name:`${s}.value`,label:h(),choices:i[n.fieldName],index:a,component:We,"data-cy":"select-one-select",disabled:u});case"SELECT_MANY":return e.jsx(B.Field,{name:`${s}.value`,label:h(),choices:i[n.fieldName],index:a,multiple:!0,component:We,"data-cy":"select-many",disabled:u});case"STRING":return e.jsx(B.Field,{name:`${s}.value`,label:h(),fullWidth:!0,variant:"outlined",component:Se,"data-cy":"string-textfield",disabled:u});case"BOOL":return e.jsx(B.Field,{name:`${s}.value`,label:h(),choices:[{admin:null,labelEn:l("Yes"),labels:[{label:l("Yes"),language:"English(EN)"}],listName:null,value:"Yes"},{admin:null,labelEn:l("No"),labels:[{label:l("No"),language:"English(EN)"}],listName:null,value:"No"}],index:a,component:We,"data-cy":"bool-field",disabled:u});case"PDU":return e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{size:12,children:e.jsx(B.Field,{name:`${s}.roundNumber`,required:!0,component:We,choices:n.pduData?.numberOfRounds||n.fieldAttribute?.pduData?.numberOfRounds?[...Array(n.pduData?.numberOfRounds||n.fieldAttribute?.pduData?.numberOfRounds).keys()].map(f=>({value:f+1,name:`${f+1}`})):[],label:"Round","data-cy":"input-round-number"})}),e.jsx(p,{size:12,children:e.jsx(B.Field,{name:`${s}.isNull`,label:l("Only Empty Values"),color:"primary",component:ws,"data-cy":"input-include-null-round"})}),e.jsx(p,{size:12,children:m(n.pduData?.subtype||n.fieldAttribute?.pduData?.subtype)})]});default:return e.jsx(e.Fragment,{})}};return m(n.fieldAttribute?.type)},Ih=oe(LF,"SubField"),OF=T.div`
  border-top: 1px solid #b1b1b5;
  margin: ${({theme:s})=>s.spacing(10)} 0;
  position: relative;
`,kF=T.div`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 500;
  color: #253b46;
  text-transform: uppercase;
  padding: 5px;
  border: 1px solid #b1b1b5;
  border-radius: 50%;
  background-color: #fff;
`;function wF({index:s,data:t,each:a,onChange:n,values:i,onClick:r,choicesDict:l}){const{t:o}=M();if(!t||!t.length)return e.jsx("div",{children:o("No data available")});const d=s+1<i.householdsFiltersBlocks.length;return e.jsxs("div",{children:[e.jsx(Sh,{index:s,choices:t,fieldName:a.fieldName,onChange:n,showDelete:!0,onDelete:r,baseName:`householdsFiltersBlocks[${s}]`}),a.fieldName&&e.jsx("div",{"data-cy":"autocomplete-target-criteria-values",children:e.jsx(Ih,{field:a,index:s,baseName:`householdsFiltersBlocks[${s}]`,choicesDict:l})}),d&&e.jsx(OF,{children:e.jsx(kF,{children:o("And")})})]})}function MF({blockIndex:s,index:t,data:a,each:n,onChange:i,onDelete:r,choicesDict:l}){return e.jsxs("div",{children:[e.jsx(Sh,{index:t,choices:a.allFieldsAttributes,fieldName:n.fieldName,onChange:i,onDelete:r,showDelete:!0,baseName:`individualsFiltersBlocks[${s}].individualBlockFilters[${t}]`}),n.fieldName&&e.jsx("div",{"data-cy":"autocomplete-target-criteria-values",children:e.jsx(Ih,{field:n,blockIndex:s,index:t,choicesDict:l,baseName:`individualsFiltersBlocks[${s}].individualBlockFilters[${t}]`})})]})}const $F=T.div`
  border-top: 1px solid #e2e2e2;
  margin: ${({theme:s})=>s.spacing(5)} 0;
  position: relative;
`,UF=T.div`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 500;
  color: #253b46;
  text-transform: uppercase;
  padding: 5px;
  border: 1px solid #b1b1b5;
  border-radius: 50%;
  background-color: #fff;
  text-align: center;
`,VF=T.div`
  border-top: 1px solid #b1b1b5;
  margin: ${({theme:s})=>s.spacing(10)} 0;
  position: relative;
`,BF=T.div`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 500;
  color: #253b46;
  text-transform: uppercase;
  padding: 5px;
  border: 1px solid #b1b1b5;
  border-radius: 50%;
  background-color: #fff;
`,GF=T.div`
  border: 1px solid #e0e0e0;
  border-radius: 3px;
  margin-bottom: 20px;
  padding-top: 20px;
`,zF=T.div`
  padding: ${({theme:s})=>s.spacing(3)} ${({theme:s})=>s.spacing(5)};
`;function qF({blockIndex:s,data:t,values:a,choicesToDict:n,onDelete:i}){const{t:r}=M(),l=s+1<a.individualsFiltersBlocks.length,{selectedProgram:o}=Z(),d=o?.beneficiaryGroup;return e.jsxs("div",{children:[`Set ${d?.memberLabel} Criteria`,e.jsx(B.FieldArray,{name:`individualsFiltersBlocks[${s}].individualBlockFilters`,render:c=>e.jsx("div",{children:e.jsxs(GF,{children:[a.individualsFiltersBlocks[s].individualBlockFilters.map((u,h)=>{const m=h+1<a.individualsFiltersBlocks[s].individualBlockFilters.length;return e.jsxs(A.Fragment,{children:[e.jsx(zF,{children:e.jsx(MF,{blockIndex:s,index:h,data:t,each:u,choicesDict:n,onChange:(g,x)=>x?_h(x,c,h):Ph(c,h),onDelete:()=>{if(a.individualsFiltersBlocks[s].individualBlockFilters.length===1){i();return}c.remove(h)}})}),m&&e.jsx($F,{children:e.jsx(UF,{children:"+"})})]},s+h.toString())}),e.jsx(P,{display:"flex",justifyContent:"center",children:e.jsx(H,{color:"primary",variant:"outlined",startIcon:e.jsx(Et,{}),onClick:()=>c.push({fieldName:""}),style:{position:"relative",top:18,backgroundColor:"#fff"},children:r("Add Next Rule")})})]})})}),l&&e.jsx(VF,{children:e.jsx(BF,{children:r("And")})})]})}const Mr=T.div`
  width: 300px;
`,HF=T.div`
  margin: 20px 0;
  font-size: 14px;
  color: ${({theme:s})=>s.palette.error.dark};
`,WF=T(P)`
  width: 100%;
`,KF=Q.object().shape({deliveryMechanism:Q.string().required("Delivery Mechanism is required"),fsp:Q.string().required("FSP is required"),householdIds:ho,individualIds:mo,filters:Q.array().of(Q.object().shape({fieldName:Q.string().required("Field Type is required")})),householdsFiltersBlocks:Q.array().of(Q.object().shape({fieldName:Q.string().required("Field Type is required")})),individualsFiltersBlocks:Q.array().of(Q.object().shape({individualBlockFilters:Q.array().of(Q.object().shape({fieldName:Q.string().required("Field Type is required"),fieldAttribute:Q.object().shape({type:Q.string().required()}),roundNumber:Q.string().nullable().when(["fieldName","fieldAttribute"],(s,t,a)=>{const n=a.parent;return n&&n.fieldAttribute&&n.fieldAttribute?.type==="PDU"?Q.string().required("Round Number is required"):Q.string().notRequired()})}))}))}),YF=Q.object().shape({deliveryMechanism:Q.string(),fsp:Q.string(),householdIds:ho,individualIds:mo,filters:Q.array().of(Q.object().shape({fieldName:Q.string().required("Field Type is required")})),householdsFiltersBlocks:Q.array().of(Q.object().shape({fieldName:Q.string().required("Field Type is required")})),individualsFiltersBlocks:Q.array().of(Q.object().shape({individualBlockFilters:Q.array().of(Q.object().shape({fieldName:Q.string().required("Field Type is required"),fieldAttribute:Q.object().shape({type:Q.string().required()}),roundNumber:Q.string().nullable().when(["fieldName","fieldAttribute"],(s,t,a)=>{const n=a.parent;return n&&n.fieldAttribute&&n.fieldAttribute?.type==="PDU"?Q.string().required("Round Number is required"):Q.string().notRequired()})}))}))});class Qd extends A.Component{getArrayHelpers(){const{arrayHelpers:t}=this.props;return t}render(){const{children:t}=this.props;return t}}const Xd=s=>t=>t.associatedWith===s,QF=s=>t=>t?.type!==s,XF=({criteria:s,addCriteria:t,open:a,onClose:n,individualFiltersAvailable:i,householdFiltersAvailable:r,criteriaIndex:l})=>{const{t:o}=M(),{businessArea:d,isAllPrograms:c}=U(),{isSocialDctType:u}=Z(),h=Nt(),m=o("Are you sure you want to ‘Lock’ TP without validating FSP and Delivery Mechanism requirements? This might result in individuals’ exclusion at later stages."),{selectedProgram:g}=Z(),x=g?.beneficiaryGroup,{data:f}=V({queryKey:["businessAreasAvailableFspsForDeliveryMechanismsList",d],queryFn:()=>N.restBusinessAreasAvailableFspsForDeliveryMechanismsList({businessAreaSlug:d})}),{data:j,isLoading:y}=V({queryKey:["businessAreasAllFieldsAttributesList",d,g?.id],queryFn:()=>N.restBusinessAreasAllFieldsAttributesList({slug:d,programId:g?.id}),staleTime:300*1e3,enabled:!!d&&!!g?.id&&!c}),b=A.useRef(null),C=A.useRef(null),v=DF(s),[S,I]=A.useState(null),[E,D]=A.useState(null),[F,w]=A.useState(null),[O,k]=A.useState(!!v.deliveryMechanism);A.useEffect(()=>{k(!!v.deliveryMechanism)},[v.deliveryMechanism]);const $=()=>{k(!O)},G=A.useMemo(()=>({allFieldsAttributes:j?.filter(Xd("Individual")).filter(QF("IMAGE"))}),[j]),W=A.useMemo(()=>({allFieldsAttributes:j?.filter(Xd("Household"))}),[j]),Y=A.useMemo(()=>j?.reduce((ae,re)=>(ae[re.name]=re.choices,ae),{}),[j]);if(A.useEffect(()=>{I(G),D(W),w(Y)},[G,W,Y]),!j)return null;const X=(ae,re)=>{const se=Eh(ae.householdsFiltersBlocks),le=ae.individualIds,ce=ae.householdIds,_e=ae.deliveryMechanism,ne=ae.fsp,Ue=TF(ae.individualsFiltersBlocks);return t({householdsFiltersBlocks:se,individualsFiltersBlocks:Ue,individualIds:le,householdIds:ce,deliveryMechanism:_e,fsp:ne}),re.resetForm()},J=l===0&&O?KF:YF;return y||!a||!f?null:e.jsx(zs,{children:e.jsx(B.Formik,{initialValues:v,onSubmit:X,validate:ae=>SF(ae,x),validationSchema:J,enableReinitialize:!0,children:({submitForm:ae,values:re,resetForm:se,setFieldValue:le,errors:ce})=>{const _e=f||[],ne=_e.map(ie=>({name:ie.deliveryMechanism.name,value:ie.deliveryMechanism.code,accountType:ie.deliveryMechanism.accountType})),Ue=_e.find(ie=>ie.deliveryMechanism.code===re.deliveryMechanism)?.fsps.map(ie=>({name:ie.name,value:ie.id}))||[],Te=()=>l===0&&!re.deliveryMechanism&&!re.fsp?h({title:o("Warning"),content:m}).then(()=>{ae()}):ae();return e.jsxs(is,{open:a,onClose:n,scroll:"paper","aria-labelledby":"form-dialog-title",fullWidth:!0,maxWidth:"md",children:[a&&e.jsx(Bs,{}),e.jsx(Ye,{children:e.jsx(Le,{component:"div",children:e.jsx(ee,{"data-cy":"title-add-filter",variant:"h6",children:o("Add Filter")})})}),e.jsxs(Be,{children:[ce.nonFieldErrors&&e.jsx(HF,{children:e.jsx("ul",{children:ce.nonFieldErrors.map(ie=>e.jsx("li",{children:ie},ie))})}),e.jsxs(pt,{children:[u?"":`All rules defined below have to be true for the entire ${x?.groupLabelPlural}.`," "]}),e.jsxs(p,{container:!0,spacing:3,children:[r&&e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{"data-cy":"input-included-household-ids",name:"householdIds",fullWidth:!0,multiline:!0,variant:"outlined",label:o(`${x?.groupLabelPlural} IDs`),component:Se})}),r&&i&&e.jsx(p,{size:{xs:12},children:e.jsx(ui,{children:e.jsx(ci,{children:"AND"})})})]}),e.jsx(B.FieldArray,{name:"householdsFiltersBlocks",render:ie=>e.jsx(Qd,{arrayHelpers:ie,ref:b,children:re.householdsFiltersBlocks.map((Pe,ue)=>e.jsx(wF,{index:ue,data:u?j:E.allFieldsAttributes,choicesDict:F,each:Pe,onChange:(Ge,ls)=>ls?_h(ls,ie,ue):Ph(ie,ue),values:re,onClick:()=>ie.remove(ue)},ue))})}),r||u?e.jsx(P,{display:"flex",flexDirection:"column",children:e.jsx(Mr,{children:e.jsxs(H,{onClick:()=>b.current.getArrayHelpers().push({fieldName:""}),color:"primary",startIcon:e.jsx(Et,{}),"data-cy":"button-household-rule",children:["ADD"," ",u?"PEOPLE":x?.groupLabel.toUpperCase()," ","RULE"]})})}):null,i?e.jsxs(e.Fragment,{children:[i?e.jsx(ui,{children:e.jsx(ci,{children:"And"})}):null,e.jsx(p,{container:!0,spacing:3,children:e.jsxs(e.Fragment,{children:[e.jsx(p,{size:{xs:12},children:e.jsx(P,{pb:3,children:e.jsx(B.Field,{"data-cy":"input-included-individual-ids",name:"individualIds",fullWidth:!0,variant:"outlined",label:o(`${x?.memberLabelPlural} IDs`),component:Se})})}),e.jsx(p,{size:{xs:12},children:e.jsx(ui,{children:e.jsx(ci,{children:"AND"})})})]})}),e.jsx(B.FieldArray,{name:"individualsFiltersBlocks",render:ie=>e.jsx(Qd,{arrayHelpers:ie,ref:C,children:re.individualsFiltersBlocks.map((Pe,ue)=>e.jsx(qF,{blockIndex:ue,data:S,values:re,choicesToDict:F,onDelete:()=>ie.remove(ue)},ue))})}),e.jsx(P,{display:"flex",flexDirection:"column",children:e.jsx(Mr,{children:e.jsx(H,{"data-cy":"button-individual-rule",onClick:()=>C.current.getArrayHelpers().push({individualBlockFilters:[{fieldName:""}]}),color:"primary",startIcon:e.jsx(Et,{}),children:`ADD ${x?.memberLabel.toUpperCase()}
                          RULE GROUP`})})})]}):null,e.jsxs(e.Fragment,{children:[e.jsx(ui,{children:e.jsx(ci,{children:"And"})}),l===0&&e.jsxs(P,{mt:2,display:"flex",flexDirection:"column",children:[e.jsx(Mr,{style:{width:"600px"},children:e.jsx(H,{"data-cy":"button-payment-channel-rule",onClick:()=>$(),color:"primary",startIcon:e.jsx(Et,{}),children:e.jsxs(P,{style:{textAlign:"left"},display:"flex",flexDirection:"column",children:[e.jsx(P,{children:"PAYMENT CHANNEL VALIDATION"}),e.jsx(P,{children:"(Delivery mechanism and FSP requirements)"})]})})}),e.jsx(yt,{in:O,children:e.jsx(P,{mt:4,children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"deliveryMechanism",label:"Select Delivery Mechanism",type:"text",fullWidth:!0,required:O,variant:"outlined",choices:ne,component:We,onChange:()=>{le("fsp","")},onClear:()=>{le("fsp","")},"data-cy":"input-delivery-mechanism"})}),e.jsx(p,{size:{xs:12},children:e.jsx(Ms,{title:re.deliveryMechanism?"":"Select delivery mechanism first",children:e.jsx("div",{children:e.jsx(B.Field,{name:"fsp",label:"Select FSP",type:"text",fullWidth:!0,disabled:!re.deliveryMechanism,required:O,variant:"outlined",component:We,choices:Ue,"data-cy":"input-fsp"})})})})]})})})]})]})]}),e.jsx(ss,{children:e.jsx(os,{children:e.jsx(WF,{display:"flex",justifyContent:"flex-end",children:e.jsxs("div",{children:[e.jsx(H,{onClick:()=>{se(),n()},children:"Cancel"}),e.jsx(H,{onClick:()=>Te(),type:"submit",color:"primary",variant:"contained","data-cy":"button-target-population-add-criteria",children:"Save"})]})})})})]})}})})},JF="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M7.1447%204.48188C6.85855%204.95425%207.00951%205.56915%207.48189%205.8553L14.0699%209.84615L7.48189%2013.837C7.00951%2014.1231%206.85855%2014.738%207.1447%2015.2104C7.43085%2015.6828%208.04575%2015.8338%208.51812%2015.5476L16.5181%2010.7015C16.8173%2010.5202%2017%2010.1959%2017%209.84615C17%209.49639%2016.8173%209.17206%2016.5181%208.99084L8.51812%204.14469C8.04575%203.85854%207.43085%204.0095%207.1447%204.48188ZM16.8553%2013.6357C16.5692%2013.1633%2015.9543%2013.0124%2015.4819%2013.2985L7.48189%2018.1447C7.00951%2018.4308%206.85855%2019.0457%207.1447%2019.5181C7.43085%2019.9905%208.04575%2020.1415%208.51812%2019.8553L16.5181%2015.0091C16.9905%2014.723%2017.1415%2014.1081%2016.8553%2013.6357Z'%20fill='black'/%3e%3c/svg%3e",ZF="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M16.8553%204.48188C17.1415%204.95425%2016.9905%205.56915%2016.5181%205.8553L9.93008%209.84615L16.5181%2013.837C16.9905%2014.1231%2017.1415%2014.738%2016.8553%2015.2104C16.5692%2015.6828%2015.9543%2015.8338%2015.4819%2015.5476L7.48191%2010.7015C7.18276%2010.5202%207.00003%2010.1959%207.00003%209.84615C7.00003%209.49639%207.18276%209.17206%207.48191%208.99084L15.4819%204.14469C15.9543%203.85854%2016.5692%204.0095%2016.8553%204.48188ZM7.14472%2013.6357C7.43087%2013.1633%208.04577%2013.0124%208.51814%2013.2985L16.5181%2018.1447C16.9905%2018.4308%2017.1415%2019.0457%2016.8553%2019.5181C16.5692%2019.9905%2015.9543%2020.1415%2015.4819%2019.8553L7.48191%2015.0091C7.00953%2014.723%206.85857%2014.1081%207.14472%2013.6357Z'%20fill='black'/%3e%3c/svg%3e",eN=T.div`
  width: auto;
  max-width: 380px;
  position: relative;
  border: ${s=>s.alternative?"0":"2px solid #033f91"};
  border-radius: 3px;
  font-size: 16px;
  background-color: ${s=>s.alternative?"transparent":"#f7faff"};
  padding: ${({theme:s})=>s.spacing(1)}
    ${({theme:s,alternative:t})=>t?s.spacing(1):s.spacing(17)}
    ${({theme:s})=>s.spacing(1)} ${({theme:s})=>s.spacing(4)};
  margin: ${({theme:s})=>s.spacing(2)} 0;
  p {
    margin: ${({theme:s})=>s.spacing(2)} 0;
    span {
      color: ${s=>s.alternative?"#000":"#003c8f"};
      font-weight: bold;
    }
  }
`,sN=T.div`
  position: absolute;
  right: 0;
  top: 0;
  button {
    color: #949494;
    padding: 12px 8px;
    svg {
      width: 20px;
      height: 20px;
    }
  }
`,tN=T.img`
  width: 20px;
  height: 20px;
  vertical-align: middle;
`,aN=T.div`
  border: '1px solid #607cab';
  border-radius: 3px;
  padding: 0 ${({theme:s})=>s.spacing(2)};
  margin: ${({theme:s})=>s.spacing(2)} 0;
`,nN=T(Ot)`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: #fff;
  border: 1px solid #ccc;
  border-radius: 3px;
  padding: ${({theme:s})=>s.spacing(3)};
  margin: ${({theme:s})=>s.spacing(3)};
`;function Za(s){if(s.fieldAttribute?.labelEn){if(typeof s.fieldAttribute.labelEn=="string")return s.fieldAttribute.labelEn;if(s.fieldAttribute.labelEn&&typeof s.fieldAttribute.labelEn.englishEn=="string")return s.fieldAttribute.labelEn.englishEn}const t=s.labelEn;return typeof t=="string"?t:t&&typeof t.englishEn=="string"?t.englishEn:Up(s.fieldName)}const Jd=({field:s,choicesDict:t,dataCy:a})=>{const n=(l,o)=>{const d=t?.[l.fieldName]||l?.choices||l?.fieldAttribute?.choices;return d?.length?d.find(c=>c.value===o)?.labelEn:o},i=l=>l||"Empty";let r;switch(s.comparisonMethod){case"NOT_EQUALS":r=e.jsxs("p",{children:[Za(s),":"," ",e.jsx("span",{children:i(s.arguments?.[0])})]});break;case"RANGE":r=e.jsxs("p",{children:[Za(s),":"," ",e.jsxs("span",{children:[i(s.arguments?.[0])," -"," ",i(s.arguments?.[1])]})]});break;case"EQUALS":r=e.jsxs("p",{children:[Za(s),":"," ",s.isNull===!0||s.comparisonMethod==="IS_NULL"?e.jsx(ot,{children:Ee("Empty")}):typeof s.arguments?.[0]=="boolean"?s.arguments[0]?e.jsx(ot,{children:Ee("Yes")}):e.jsx(ot,{children:Ee("No")}):e.jsx(e.Fragment,{children:s.arguments?.[0]!=null?s.arguments[0]==="Yes"?e.jsx(ot,{children:Ee("Yes")}):s.arguments[0]==="No"?e.jsx(ot,{children:Ee("No")}):e.jsx("span",{children:n(s,s.arguments[0])}):e.jsx(ot,{children:Ee("Empty")})})]});break;case"LESS_THAN":case"GREATER_THAN":{const l=s?.comparisonMethod==="LESS_THAN",o=l?ZF:JF,d=l?"less_than":"greater_than",c=s.arguments?.[0];r=e.jsxs("p",{children:[Za(s),":"," ",c&&e.jsx(tN,{src:o,alt:d}),e.jsx("span",{children:i(c)})]});break}case"CONTAINS":r=e.jsxs("p",{children:[Za(s),":"," ",s.arguments?.map((l,o)=>e.jsxs(e.Fragment,{children:[e.jsx("span",{children:i(n(s,l))}),o!==s.arguments.length-1&&", "]},o))]});break;default:r=e.jsxs("p",{children:[Za(s),":"," ",e.jsx("span",{children:i(s.arguments?.[0])})]});break}return e.jsxs(e.Fragment,{children:[e.jsx("div",{"data-cy":a,children:r}),(s.type==="PDU"||s.fieldAttribute?.type==="PDU")&&(s.pduData||s.fieldAttribute?.pduData)&&e.jsxs(nN,{"data-cy":"round-number-round-name-display",children:["Round ",s.roundNumber,(s.pduData?.roundsNames?.[s.roundNumber-1]||s.fieldAttribute?.pduData?.roundsNames?.[s.roundNumber-1])&&e.jsxs(e.Fragment,{children:[" ","(",s.pduData?.roundsNames?.[s.roundNumber-1]||s.fieldAttribute?.pduData?.roundsNames?.[s.roundNumber-1],")"]})]})]})};function Dh({rules:s,removeFunction:t=()=>null,editFunction:a=()=>null,isEdit:n,canRemove:i,allDataFieldsChoicesDict:r,alternative:l=null,individualsFiltersBlocks:o,householdIds:d,individualIds:c,deliveryMechanism:u,financialServiceProvider:h,criteriaIndex:m,criteria:g}){const{businessArea:x}=U(),{selectedProgram:f}=Z(),[j,y]=A.useState(""),[b,C]=A.useState(""),{data:v}=V({queryKey:["businessAreasAvailableFspsForDeliveryMechanismsList",x],queryFn:()=>N.restBusinessAreasAvailableFspsForDeliveryMechanismsList({businessAreaSlug:x})}),S=f?.beneficiaryGroup,[I,E]=A.useState(!1),[D,F]=A.useState(!1),[w,O]=A.useState([]),[k,$]=A.useState([]),[G,W]=A.useState(0),[Y,X]=A.useState(5),[J,ae]=A.useState(0),[re,se]=A.useState(5);if(A.useEffect(()=>{const Pe=v?.map(qe=>({name:qe.deliveryMechanism.name,value:qe.deliveryMechanism.code})),ue=u?.name||Pe?.find(qe=>qe.value===g.deliveryMechanism)?.name,Ge=v?.find(qe=>qe.deliveryMechanism.code===u||qe.deliveryMechanism.code===Pe?.find(xs=>xs.value===g.deliveryMechanism)?.value)?.fsps.map(qe=>({name:qe.name,value:qe.id}))||[],ls=h?.name||Ge?.find(qe=>qe.value===g.fsp)?.name;y(ue),C(ls)},[u,h,v,g]),!v)return null;const le=(Pe,ue)=>{W(ue)},ce=Pe=>{X(parseInt(Pe.target.value,10)),W(0)},_e=(Pe,ue)=>{ae(ue)},ne=Pe=>{se(parseInt(Pe.target.value,10)),ae(0)},Ue=Pe=>{O(Pe.split(",")),E(!0)},Te=Pe=>{$(Pe.split(",")),F(!0)},ie=()=>{E(!1),F(!1)};return e.jsxs(eN,{alternative:l,"data-cy":"criteria-container",children:[j&&m===0&&e.jsxs(p,{container:!0,children:[e.jsx(p,{size:6,children:e.jsx(L,{label:Ee("Delivery Mechanism"),value:j})}),e.jsx(p,{size:6,children:e.jsx(L,{label:Ee("FSP"),value:b})})]}),d&&e.jsxs("div",{children:[e.jsxs(ee,{"data-cy":"household-ids-modal-title",variant:"body1",children:[Ee(`${S?.groupLabel} IDs selected`),":"]}),e.jsx(ot,{onClick:()=>Ue(d),style:{textDecoration:"underline",cursor:"pointer"},"data-cy":"button-household-ids-open",children:d.split(",").length})]}),c&&e.jsxs("div",{children:[e.jsxs(ee,{"data-cy":"individual-ids-modal-title",variant:"body1",children:[Ee(`${S?.memberLabel} IDs selected`),":"]}),e.jsx(ot,{onClick:()=>Te(c),style:{textDecoration:"underline",cursor:"pointer"},"data-cy":"button-individual-ids-open",children:c.split(",").length})]}),(s||[]).map((Pe,ue)=>e.jsx(Jd,{choicesDict:r,field:Pe,dataCy:`criteria-field-${ue}`},ue)),o.map((Pe,ue)=>Pe.individualBlockFilters.length>0&&e.jsx(aN,{"data-cy":`individuals-criteria-set-box-${ue}`,children:Pe.individualBlockFilters.map((Ge,ls)=>e.jsx(Jd,{choicesDict:r,field:Ge,dataCy:`individuals-criteria-field-${ls}`},ls))},ue)),n&&e.jsxs(sN,{children:[e.jsx(Ve,{"data-cy":"button-edit",onClick:a,children:e.jsx(ma,{})}),i&&e.jsx(Ve,{"data-cy":"button-remove",onClick:t,children:e.jsx(Rs,{})})]}),e.jsxs(is,{open:I,onClose:ie,maxWidth:"sm",fullWidth:!0,children:[e.jsx(Le,{children:Ee(`Selected ${S?.groupLabelPlural}`)}),e.jsxs(Be,{children:[e.jsxs(gs,{children:[e.jsx(hs,{children:e.jsx(be,{children:e.jsx(_,{children:"ID"})})}),e.jsx(cs,{children:w.slice(G*Y,G*Y+Y).map((Pe,ue)=>e.jsx(be,{children:e.jsx(_,{"data-cy":`table-cell-hh-${Pe}`,children:Pe})},ue))})]}),e.jsx(Ua,{rowsPerPageOptions:[5,10,25],component:"div",count:w.length,rowsPerPage:Y,page:G,onPageChange:le,onRowsPerPageChange:ce})]}),e.jsx(os,{children:e.jsx(H,{"data-cy":"button-close",color:"primary",onClick:ie,children:"Close"})})]}),e.jsxs(is,{open:D,onClose:ie,maxWidth:"sm",fullWidth:!0,children:[e.jsx(Le,{children:Ee("Selected Individuals")}),e.jsxs(Be,{children:[e.jsxs(gs,{children:[e.jsx(hs,{children:e.jsx(be,{children:e.jsx(_,{children:"ID"})})}),e.jsx(cs,{children:k.slice(J*re,J*re+re).map((Pe,ue)=>e.jsx(be,{children:e.jsx(_,{"data-cy":`table-cell-ind-${Pe}`,children:Pe})},ue))})]}),e.jsx(Ua,{rowsPerPageOptions:[5,10,25],component:"div",count:k.length,rowsPerPage:re,page:J,onPageChange:_e,onRowsPerPageChange:ne})]}),e.jsx(os,{children:e.jsx(H,{"data-cy":"button-close",color:"primary",onClick:ie,children:"Close"})})]})]})}oe(Dh,"Criteria");const hi=T(sa)`
  white-space: nowrap;
`,iN=({isStandardDctType:s,isSocialDctType:t,screenBeneficiary:a,isDetailsPage:n,targetPopulation:i})=>{const{t:r}=M(),{selectedProgram:l}=Z(),o=l?.beneficiaryGroup;return e.jsx(P,{mt:3,p:3,children:n?e.jsx(P,{mt:3,p:3,children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsxs(p,{size:6,children:[s&&e.jsx(hi,{disabled:!0,control:e.jsx(ns,{name:"flagExcludeIfActiveAdjudicationTicket",color:"primary","data-cy":"checkbox-exclude-if-active-adjudication-ticket",checked:!!i?.flagExcludeIfActiveAdjudicationTicket}),label:r(`Exclude ${o?.groupLabelPlural} with Active Adjudication Ticket`)}),t&&e.jsx(hi,{disabled:!0,control:e.jsx(ns,{name:"flagExcludeIfActiveAdjudicationTicket",color:"primary","data-cy":"checkbox-exclude-people-if-active-adjudication-ticket",checked:!!i?.flagExcludeIfActiveAdjudicationTicket}),label:r("Exclude People with Active Adjudication Ticket")})]}),e.jsxs(p,{size:6,children:[a&&t&&e.jsx(hi,{disabled:!0,control:e.jsx(ns,{name:"flagExcludeIfOnSanctionList",color:"primary","data-cy":"checkbox-exclude-if-on-sanction-list"}),checked:!!i?.flagExcludeIfOnSanctionList,label:r(`Exclude ${o?.memberLabelPlural} with an Active Sanction Screen Flag`)}),a&&s&&e.jsx(hi,{disabled:!0,control:e.jsx(ns,{name:"flagExcludeIfOnSanctionList",color:"primary","data-cy":"checkbox-exclude-if-on-sanction-list"}),checked:!!i?.flagExcludeIfOnSanctionList,label:r(`Exclude ${o?.groupLabelPlural} with an Active Sanction Screen Flag`)})]})]})}):e.jsx(P,{mt:3,p:3,children:e.jsxs(p,{container:!0,spacing:3,children:[s&&e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"flagExcludeIfActiveAdjudicationTicket",label:r(`Exclude ${o?.groupLabelPlural} with Active Adjudication Ticket`),color:"primary",component:ws,"data-cy":"input-active-adjudication-ticket"})}),t&&e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"flagExcludeIfActiveAdjudicationTicket",label:r(`Exclude ${o?.memberLabelPlural} with Active Adjudication Ticket`),color:"primary",component:ws,"data-cy":"input-active-adjudication-ticket"})}),a&&s&&e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"flagExcludeIfOnSanctionList",label:r(`Exclude ${o?.groupLabelPlural} with an Active Sanction Screen Flag`),color:"primary",component:ws,"data-cy":"input-active-sanction-flag"})}),a&&t&&e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"flagExcludeIfOnSanctionList",label:r(`Exclude ${o?.memberLabelPlural} with an Active Sanction Screen Flag`),color:"primary",component:ws,"data-cy":"input-active-sanction-flag"})})]})})})},rN=oe(iN,"ExcludeCheckboxes"),il=T(P)`
  display: flex;
  flex-wrap: wrap;
`,Zd=T.div`
  display: flex;
  color: #a0b6d6;
`,ec=T.div`
  display: flex;
  align-items: center;
  justify-content: center;
  color: #003c8f;
  border: 2px solid #a0b6d6;
  border-radius: 3px;
  font-size: 16px;
  padding: ${({theme:s})=>s.spacing(6)}
    ${({theme:s})=>s.spacing(28)};
  cursor: pointer;
  p {
    font-weight: 500;
    margin: 0 0 0 ${({theme:s})=>s.spacing(2)};
  }
`;function lN({showTooltip:s=!1}){const{t}=M();return e.jsx(e.Fragment,{children:s?e.jsx(il,{children:e.jsx(Ms,{title:"Make sure program has checked household filter flag or individual filter flag",children:e.jsx("div",{children:e.jsx(ec,{onClick:()=>null,"data-cy":"button-target-population-disabled-add-criteria",children:e.jsxs(Zd,{children:[e.jsx(Et,{}),e.jsx("p",{children:t("Add Filter")})]})})})})}):e.jsx(il,{children:e.jsx(ec,{onClick:()=>null,"data-cy":"button-target-population-disabled-add-criteria",children:e.jsxs(Zd,{children:[e.jsx(Et,{}),e.jsx("p",{children:t("Add Filter")})]})})})})}const oN=oe(lN,"TargetingCriteriaDisplayDisabled");function dN({message:s,show:t}){const{t:a}=M(),[n,i]=A.useState(!1),[r,l]=A.useState(!1);A.useEffect(()=>{!r&&t&&i(!0),l(t)},[t]);const o=()=>{i(!1)};return e.jsx("div",{children:e.jsxs(is,{open:n,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(Le,{id:"alert-dialog-title",children:a("Error")}),e.jsx(Be,{children:e.jsx(dl,{id:"alert-dialog-description",children:s})}),e.jsx(os,{children:e.jsx(H,{onClick:o,color:"primary",autoFocus:!0,children:"OK"})})]})})}const cN=T.div`
  display: flex;
  flex-wrap: wrap;
  padding: ${({theme:s})=>s.spacing(4)} ${({theme:s})=>s.spacing(4)};
`,uN=T.div`
  width: 100%;
  height: 1px;
  background-color: #e0e0e0;
`,hN=T.div`
  display: flex;
  flex-direction: row;
  width: 100%;
  align-items: center;
`,mN=T.div`
  width: auto;
  max-width: 380px;
  position: relative;
  border: ${s=>s.alternative?"0":"2px solid #033f91"};
  border-radius: 3px;
  font-size: 16px;
  background-color: ${s=>s.alternative?"transparent":"#f7faff"};
  padding: ${({theme:s})=>s.spacing(1)}
    ${({theme:s,alternative:t})=>t?s.spacing(1):s.spacing(17)}
    ${({theme:s})=>s.spacing(1)} ${({theme:s})=>s.spacing(4)};
  margin: ${({theme:s})=>s.spacing(2)} 0;
  p {
    margin: ${({theme:s})=>s.spacing(2)} 0;
    span {
      color: ${s=>s.alternative?"#000":"#003c8f"};
      font-weight: bold;
    }
  }
`,pN=T(H)`
  && {
    margin-top: 4px;
    margin-left: ${({theme:s})=>s.spacing(4)};
    height: 40px;
  }
`,sc=T(ks)`
  input[type='number']::-webkit-inner-spin-button,
  input[type='number']::-webkit-outer-spin-button {
    -webkit-appearance: none;
  }
  input[type='number'] {
    -moz-appearance: textfield;
  }
  && {
    margin: 0 ${({theme:s})=>s.spacing(2)};
  }
`,gN=T.div`
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  margin: ${({theme:s})=>s.spacing(2)};
`;function xN({targetPopulation:s}){const{t}=M(),{showMessage:a}=Ae(),{isActiveProgram:n}=Z(),i=Fe(),{businessArea:r,programId:l}=U(),{mutateAsync:o,isPending:d,error:c}=xe({mutationFn:({businessAreaSlug:E,id:D,programSlug:F,requestBody:w})=>N.restBusinessAreasProgramsTargetPopulationsApplyEngineFormulaCreate({businessAreaSlug:E,id:D,programSlug:F,requestBody:w}),onSuccess:()=>{a(t("Formula is executing, please wait until completed")),i.invalidateQueries({queryKey:["targetPopulation",r,s.id,l]})},onError:E=>{fe(E,a)}}),{mutateAsync:u,error:h}=xe({mutationFn:({businessAreaSlug:E,id:D,programSlug:F,requestBody:w})=>N.restBusinessAreasProgramsTargetPopulationsPartialUpdate({businessAreaSlug:E,id:D,programSlug:F,requestBody:w}),onSuccess:()=>{i.invalidateQueries({queryKey:["targetPopulation",r,s.id,l]})}}),[m,g]=A.useState(s?.vulnerabilityScoreMin?.toString()),[x,f]=A.useState(s?.vulnerabilityScoreMax?.toString()),[j,y]=A.useState(s.steficonRuleTargeting?.rule?.id?String(s.steficonRuleTargeting.rule.id):""),{data:b,isLoading:C}=V({queryKey:["engineRules",r,{enabled:!0,deprecated:!1,type:"TARGETING"}],queryFn:()=>N.restEngineRulesList({enabled:!0,deprecated:!1,type:"TARGETING",businessArea:r})});if(C)return e.jsx(Ne,{});if(!s||!b)return null;const v=s.status===te.FINISHED;if(![te.TP_LOCKED,te.LOCKED,te.PROCESSING,te.STEFICON_WAIT,te.STEFICON_RUN,te.STEFICON_COMPLETED,te.STEFICON_ERROR].includes(s?.status))return null;let S=[];C||(S=b?.results?.map(E=>e.jsx(de,{value:E.id,children:E.name},E.id)));let I=null;return s?.steficonRuleTargeting?.rule?.id&&(I=e.jsxs(mN,{children:[e.jsxs("p",{children:[t("Score"),":"]}),e.jsxs(P,{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",children:[t("From")," ",e.jsx(sc,{"data-cy":"input-vulnerability-score-min-value",variant:"outlined",type:"number",value:m,disabled:v,label:t("From"),onChange:E=>g(E.target.value)})," ",t("To")," ",e.jsx(sc,{"data-cy":"input-vulnerability-score-max-value",variant:"outlined",type:"number",disabled:v,value:x,label:t("To"),onChange:E=>f(E.target.value)})]}),e.jsx(gN,{children:e.jsx(H,{variant:"contained",color:"primary","data-cy":"button-apply-vulnerability-score",disabled:d||m===s?.vulnerabilityScoreMin?.toString()&&x===s?.vulnerabilityScoreMax?.toString()||m===""&&x!==""||m!==""&&x===""||v||!n,onClick:async()=>{try{await u({id:s.id,programSlug:l,businessAreaSlug:r,requestBody:{vulnerabilityScoreMin:m,vulnerabilityScoreMax:x}}),a(t("Formula is executing, please wait until completed"))}catch(E){fe(E,a)}},children:t("Apply")})})]})),e.jsxs(e.Fragment,{children:[e.jsx(uN,{}),e.jsxs(cN,{children:[e.jsxs(hN,{children:[e.jsxs(tt,{variant:"outlined",fullWidth:!0,children:[e.jsx(Rt,{size:"small",shrink:!0,children:t("Apply Additional Formula")}),e.jsx(at,{"data-cy":"select-steficon-rule",size:"small",value:j,disabled:v,onChange:E=>y(E.target.value),MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},children:S})]}),e.jsx(pN,{"data-cy":"button-apply-steficon-rule",variant:"contained",color:"primary",disabled:v||!j,onClick:async()=>{try{await o({programSlug:l,businessAreaSlug:r,id:s.id,requestBody:{engineFormulaRuleId:j,version:s.version}}),a(t("Formula is executing, please wait until completed"))}catch(E){fe(E,a)}},children:t("Apply")})]}),I]}),e.jsx(dN,{message:h?.message,show:!!c})]})}const fN=T.div`
  padding: ${({theme:s})=>s.spacing(3)} ${({theme:s})=>s.spacing(4)};
  display: flex;
  justify-content: space-between;
  align-items: center;
`,yN=T.div`
  border-left: 1px solid #b1b1b5;
  margin: 0 ${({theme:s})=>s.spacing(10)};
  position: relative;
  transform: scale(0.9);
`,bN=T.div`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 500;
  color: #253b46;
  text-transform: uppercase;
  padding: 5px;
  border: 1px solid #b1b1b5;
  border-radius: 50%;
  background-color: #fff;
`,jN=T.div`
  display: flex;
  align-items: center;
  justify-content: center;
  color: #003c8f;
  border: 2px solid #033f91;
  border-radius: 3px;
  font-size: 16px;
  padding: ${({theme:s})=>s.spacing(6)}
    ${({theme:s})=>s.spacing(28)};
  cursor: pointer;
  p {
    font-weight: 500;
    margin: 0 0 0 ${({theme:s})=>s.spacing(2)};
  }
`,AN=({rules:s,helpers:t,targetPopulation:a,isEdit:n,screenBeneficiary:i,isSocialDctType:r,isStandardDctType:l})=>{const{t:o}=M(),d=je(),{selectedProgram:c}=Z(),{businessArea:u,isAllPrograms:h}=U(),{data:m,isLoading:g}=V({queryKey:["allFieldsAttributes",u,c?.id],queryFn:()=>N.restBusinessAreasAllFieldsAttributesList({slug:u,programId:c?.id}),staleTime:300*1e3,enabled:!!c?.id&&!h}),[x,f]=A.useState(!1),[j,y]=A.useState(0),[b,C]=A.useState({}),[v,S]=A.useState(null);A.useEffect(()=>{if(g)return;const Y=m?.results?.reduce((X,J)=>(X[J.name]=J.choices,X),{});S(Y)},[m,g]);const E=!/(create|edit-tp)/.test(d.pathname),D=Y=>{C(Y),f(!0)},F=()=>(C({}),y(null),f(!1)),w=(Y,X)=>(y(X),D(Y)),O=Y=>{if(!t)return console.error("AddFilterTargetingCriteriaDisplay: helpers not available in read-only mode"),F();const X={householdsFiltersBlocks:[...Y.householdsFiltersBlocks],individualsFiltersBlocks:[...Y.individualsFiltersBlocks],householdIds:Y.householdIds,individualIds:Y.individualIds,deliveryMechanism:Y.deliveryMechanism,fsp:Y.fsp};return j!==null?t.replace(j,X):t.push(X),F()},k=()=>{y(0),f(!0)},$=()=>{y(null),f(!0)};let G=c?.dataCollectingType?.individualFiltersAvailable,W=c?.dataCollectingType?.householdFiltersAvailable;return G===void 0&&(G=!0),W===void 0&&(W=!0),r&&(W=!1),W||G?e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsxs(fN,{children:[e.jsx("div",{}),n&&t&&e.jsx(e.Fragment,{children:!!s.length&&e.jsxs(H,{variant:"outlined",color:"primary",onClick:$,"data-cy":"button-target-population-add-criteria",children:[o("Add")," 'Or' ",o("Filter")]})})]}),e.jsx(XF,{criteria:b,open:x,onClose:()=>F(),addCriteria:O,individualFiltersAvailable:G,householdFiltersAvailable:W,criteriaIndex:j}),e.jsx(il,{children:e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsxs(P,{display:"flex",flexWrap:"wrap",children:[s.length?s?.map((Y,X)=>e.jsxs(A.Fragment,{children:[e.jsx(Dh,{criteriaIndex:X,isEdit:n,allDataFieldsChoicesDict:v,canRemove:s.length>1,rules:Y.householdsFiltersBlocks||[],individualsFiltersBlocks:Y.individualsFiltersBlocks||[],householdIds:Y.householdIds,individualIds:Y.individualIds,deliveryMechanism:a?.deliveryMechanism,financialServiceProvider:a?.financialServiceProvider,criteria:Y,editFunction:()=>w(Y,X),removeFunction:()=>t?.remove(X)}),X===s.length-1||s.length===1&&X===0?null:e.jsx(yN,{children:e.jsx(bN,{children:"Or"})})]},Y.id||X)):null,!s.length&&e.jsx(e.Fragment,{children:n&&t?e.jsxs(jN,{onClick:k,"data-cy":"button-target-population-add-criteria",children:[e.jsx(Et,{}),e.jsx("p",{children:o("Add Filter")})]}):e.jsx(P,{display:"flex",justifyContent:"center",alignItems:"center",py:4,sx:{color:"text.secondary",fontStyle:"italic"},children:o("No targeting criteria defined")})})]}),e.jsx(rN,{isStandardDctType:l,isSocialDctType:r,screenBeneficiary:i,isDetailsPage:E,targetPopulation:a})]})}),a&&e.jsx(xN,{targetPopulation:a})]}):e.jsx(oN,{showTooltip:!0})},po=oe(AN,"AddFilterTargetingCriteriaDisplay");function _N({value:s,disabled:t,label:a,dataCy:n,fetchFunction:i,businessArea:r,programId:l,queryParams:o,handleChange:d,handleOptionSelected:c,handleOptionLabel:u,startAdornment:h=null,mapOptions:m=b=>b,autocompleteProps:g={},textFieldProps:x={},onDebouncedInputTextChanges:f,required:j=!1,error:y=null}){const[b,C]=A.useState([]),[v,S]=A.useState(""),I=qt(v,800),[E,D]=A.useState(!1),{data:F,isLoading:w}=V({queryKey:[a,r,l,o],queryFn:()=>i(r,l,{...o})});return A.useEffect(()=>f(I),[I]),A.useEffect(()=>{s===""&&v!==""&&S("")},[s,S,v]),A.useEffect(()=>{C(m(F?.results||[]))},[F,m]),e.jsx(zi,{freeSolo:!1,filterOptions:O=>O,value:s,"data-cy":n,open:E,options:b,onChange:d,onOpen:()=>D(!0),onClose:()=>{D(!1),s===null&&S("")},isOptionEqualToValue:(O,k)=>c(O,k),getOptionLabel:u,disabled:t,loading:w,...g,renderInput:O=>e.jsxs(e.Fragment,{children:[e.jsx(qi,{...O,label:a,required:j,error:!!y,"aria-errormessage":y,variant:"outlined",size:"small","data-cy":`${a}-input`,value:v,onChange:k=>S(k.target.value),slotProps:{input:{...O.InputProps,startAdornment:h,endAdornment:e.jsxs(e.Fragment,{children:[w?e.jsx(la,{color:"inherit",size:20}):null,O.InputProps.endAdornment]})}},...x}),!!y&&e.jsx(Ls,{error:!0,children:y})]})})}const go=({value:s,onChange:t,required:a=!1,error:n=null})=>{const{t:i}=M(),[r,l]=A.useState({offset:0,limit:10,ordering:"title",status:["ACTIVE","DRAFT"]}),{businessArea:o,programId:d}=U(),c=u=>u.map(h=>({name:h.title,value:h.id}));return e.jsx(_N,{value:s,label:i("Programme Cycle"),dataCy:"filters-program-cycle-autocomplete",fetchFunction:()=>N.restBusinessAreasProgramsCyclesList({businessAreaSlug:o,programSlug:d}),businessArea:o,programId:d,handleChange:(u,h)=>{t(h)},handleOptionSelected:(u,h)=>$p(u?.value,h),handleOptionLabel:u=>u===""?"":u.name,onDebouncedInputTextChanges:u=>{l(h=>({...h,title:u}))},startAdornment:null,mapOptions:c,queryParams:r,required:a,error:n})},PN=()=>{const{t:s}=M(),{programSlug:t,businessAreaSlug:a,baseUrl:n}=U(),{isSocialDctType:i,isStandardDctType:r}=Z(),l={name:"",criterias:[],program:t,programCycleId:{value:"",name:""},excludedIds:"",exclusionReason:"",flagExcludeIfActiveAdjudicationTicket:!1,flagExcludeIfOnSanctionList:!1,householdIds:"",individualIds:"",deliveryMechanism:"",fsp:""},o=Fe(),{mutateAsync:d,isPending:c}=xe({mutationFn:({requestBody:b})=>N.restBusinessAreasProgramsTargetPopulationsCreate({businessAreaSlug:a,programSlug:t,requestBody:b}),onSuccess:()=>{o.invalidateQueries({queryKey:["targetPopulations",a,t]}),o.invalidateQueries({queryKey:["program",a,t]})}}),{showMessage:u}=Ae(),h=ve(),m=ge(),{data:g}=V({queryKey:["businessArea",a],queryFn:()=>N.restBusinessAreasRetrieve({slug:a})}),{data:x}=V({queryKey:["program",a,t],queryFn:()=>N.restBusinessAreasProgramsRetrieve({businessAreaSlug:a,slug:t})});if(h===null||!g||!x)return null;if(!K(R.TARGETING_CREATE,h))return e.jsx(Xe,{permission:R.TARGETING_CREATE});const f=x?.screenBeneficiary,j=Q.object().shape({name:Q.string().required(s("Targeting Name is required")).min(3,s("Targeting Name should have at least 3 characters.")).max(255,s("Targeting Name should have at most 255 characters.")),excludedIds:Ah,exclusionReason:Q.string().max(500,s("Too long")),programCycleId:Q.object().shape({value:Q.string().required("Programme Cycle is required")})}),y=async b=>{const C=b.criterias[0]?.fsp||null,v=b.criterias[0]?.deliveryMechanism||null,S={programCycleId:b.programCycleId.value,name:b.name,excludedIds:b.excludedIds,exclusionReason:b.exclusionReason,fspId:C,deliveryMechanismCode:v,flagExcludeIfActiveAdjudicationTicket:b.flagExcludeIfActiveAdjudicationTicket,flagExcludeIfOnSanctionList:b.flagExcludeIfOnSanctionList,...vh(b)};try{const I=await d({requestBody:S});u(s("Target Population Created")),m(`/${n}/target-population/${I.id}`)}catch(I){fe(I,u)}};return e.jsx(B.Formik,{initialValues:l,validationSchema:j,onSubmit:y,children:({submitForm:b,values:C,setFieldValue:v,errors:S})=>e.jsxs(B.Form,{children:[e.jsx(Bs,{}),e.jsx(EF,{handleSubmit:b,loading:c,values:C,baseUrl:n,permissions:h}),e.jsxs(ft,{children:[e.jsx(P,{pt:3,pb:3,children:e.jsx(ee,{variant:"h6",children:s("Targeting Criteria")})}),e.jsx(p,{container:!0,mb:5,children:e.jsx(p,{size:6,children:e.jsx(go,{value:C.programCycleId,onChange:async I=>{await v("programCycleId",I)},required:!0,error:S.programCycleId?.value})})}),e.jsx(p,{container:!0,children:e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"name",label:s("Target Population Name"),type:"text",fullWidth:!0,required:!0,component:Se,variant:"outlined","data-cy":"input-name"})})}),e.jsx(P,{pt:6,pb:6,children:e.jsx(In,{})}),C.program?e.jsx(B.FieldArray,{name:"criterias",render:I=>e.jsx(po,{helpers:I,rules:C.criterias,screenBeneficiary:f,isStandardDctType:r,isSocialDctType:i,isEdit:!0})}):null]}),e.jsx(jh,{}),e.jsxs(P,{pt:3,pb:3,display:"flex",flexDirection:"column",alignItems:"center",children:[e.jsx(ee,{style:{color:"#b1b1b5"},variant:"h6",children:s("Save to see the list of households")}),e.jsx(ee,{style:{color:"#b1b1b5"},variant:"subtitle1",children:s("List of households will be available after saving")})]})]})})},CN=oe(PN,"CreateTargetPopulationPage"),EN=({handleSubmit:s,values:t,baseUrl:a,targetPopulation:n,loading:i})=>{const{t:r}=M(),l=c=>c?.some(u=>{const h=u.householdsFiltersBlocks||[],m=u.individualsFiltersBlocks||[],g=u.individualIds||[],x=u.householdIds||[];return h.length===0&&m.length===0&&g.length===0&&x.length===0}),{id:o}=ts(),d=[{title:r("Targeting"),to:`/${a}/target-population/${o}`}];return e.jsx(Ze,{title:r("Edit Target Population"),breadCrumbs:d,hasInputComponent:!0,children:e.jsxs(e.Fragment,{children:[e.jsx(P,{m:2,children:e.jsx(H,{variant:"outlined",color:"primary",component:ys,"data-cy":"button-cancel",to:`/${a}/target-population/${n.id}`,children:r("Cancel")})}),e.jsx(P,{m:2,children:e.jsx(ke,{variant:"contained",color:"primary",onClick:s,disabled:l(t.criterias),loading:i,"data-cy":"button-save",children:r("Save")})})]})})},vN=oe(EN,"EditTargetPopulationHeader"),SN=({paymentPlan:s,screenBeneficiary:t})=>{const a=ge(),{t:n}=M(),{showMessage:i}=Ae(),{id:r}=ts(),{baseUrl:l,programSlug:o,businessArea:d}=U(),{selectedProgram:c,isSocialDctType:u,isStandardDctType:h}=Z(),m=c?.beneficiaryGroup,g=s.rules.map(S=>({...S,fsp:void 0,deliveryMechanism:void 0}))||[];g.length>0&&(g[0].deliveryMechanism=s.deliveryMechanism?.code,g[0].fsp=s.financialServiceProvider?.id);const x={id:s.id,name:s.name||"",program:s.program?.id||"",targetingCriteria:g||[],excludedIds:s.excludedIds||"",exclusionReason:s.exclusionReason||"",flagExcludeIfActiveAdjudicationTicket:s.flagExcludeIfActiveAdjudicationTicket||!1,flagExcludeIfOnSanctionList:s.flagExcludeIfOnSanctionList||!1,programCycleId:{value:s.programCycle.id,name:s.programCycle.title}},f=Fe(),{mutateAsync:j,isPending:y}=xe({mutationFn:({businessAreaSlug:S,tpId:I,slug:E,requestBody:D})=>N.restBusinessAreasProgramsTargetPopulationsPartialUpdate({businessAreaSlug:S,id:I,programSlug:E,requestBody:D}),onSuccess:()=>{f.invalidateQueries({queryKey:["targetPopulation",d,r,o]})}}),b=S=>{const{targetingCriteria:I,householdIds:E,individualIds:D}=S,F={};return!I.length&&!E&&!D&&(F.targetingCriteria=n(`You need to select at least one targeting criteria or ${m?.memberLabel} ID or ${m?.groupLabel} ID`)),F},C=Q.object().shape({name:Q.string().min(3,"Targeting name should have at least 3 characters.").max(255,"Targeting name should have at most 255 characters."),excludedIds:Ah,householdIds:ho,individualIds:mo,exclusionReason:Q.string().max(500,n("Too long")),programCycleId:Q.object().shape({value:Q.string().required("Program Cycle is required")})}),v=async S=>{try{const I={excludedIds:S.excludedIds,exclusionReason:S.exclusionReason,fspId:S.targetingCriteria[0]?.fsp||null,deliveryMechanismCode:S.targetingCriteria[0]?.deliveryMechanism,programCycleId:S.programCycleId.value,...s.status===te.TP_OPEN&&{name:S.name},...vh({flagExcludeIfActiveAdjudicationTicket:S.flagExcludeIfActiveAdjudicationTicket,flagExcludeIfOnSanctionList:S.flagExcludeIfOnSanctionList,criterias:S.targetingCriteria})};await j({businessAreaSlug:d,tpId:r,slug:o,requestBody:I},{onSuccess:()=>{i(n("Target Population Updated")),a(`/${l}/target-population/${S.id}`)}})}catch(I){fe(I,i)}};return e.jsx(B.Formik,{initialValues:x,validate:b,validationSchema:C,onSubmit:v,children:({values:S,submitForm:I,errors:E,setFieldValue:D})=>e.jsxs(B.Form,{"data-cy":"edit-target-population-form",children:[e.jsx(Bs,{}),e.jsx(vN,{handleSubmit:I,values:S,loading:y,baseUrl:l,targetPopulation:s,"data-cy":"edit-target-population-header"}),e.jsxs(ft,{"data-cy":"paper-container",children:[e.jsx(P,{pt:3,pb:3,children:e.jsx(ee,{variant:"h6",children:n("Targeting Criteria")})}),e.jsx(p,{container:!0,mb:5,children:e.jsx(p,{size:6,children:e.jsx(go,{value:S.programCycleId,onChange:async F=>{await D("programCycleId",F)},required:!0,error:E.programCycleId?.value,"data-cy":"program-cycle-autocomplete"})})}),e.jsx(p,{container:!0,children:e.jsx(p,{size:6,children:e.jsx(B.Field,{name:"name",label:n("Target Population Name"),type:"text",fullWidth:!0,required:!0,component:Se,variant:"outlined",disabled:s.status==="LOCKED"})})}),e.jsx(P,{pt:6,pb:6,children:e.jsx(In,{})}),e.jsx(B.FieldArray,{name:"targetingCriteria",render:F=>e.jsx(po,{helpers:F,rules:S.targetingCriteria,isEdit:!0,screenBeneficiary:t,isStandardDctType:h,isSocialDctType:u,targetPopulation:s,"data-cy":"add-filter-targeting-criteria-display"})})]}),e.jsx(jh,{initialOpen:!!S.excludedIds,"data-cy":"exclusions"}),e.jsxs(P,{pt:3,pb:3,display:"flex",flexDirection:"column",alignItems:"center","data-cy":"save-message-box",children:[e.jsx(ee,{style:{color:"#b1b1b5"},variant:"h6",children:n(`Save to see the list of ${m?.groupLabelPlural}`)}),e.jsxs(ee,{style:{color:"#b1b1b5"},variant:"subtitle1",children:[n(`List of ${m?.groupLabelPlural} will be available after saving`)," "]})]})]})})},IN=oe(SN,"EditTargetPopulation"),DN=()=>{const{id:s}=ts(),t=ve(),{businessArea:a,programSlug:n}=U(),{data:i,isLoading:r,error:l}=V({queryKey:["targetPopulation",a,s,n],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsRetrieve({businessAreaSlug:a,id:s,programSlug:n})});return r&&!i?e.jsx(Ne,{}):rt(l)?e.jsx(Xe,{permission:R.TARGETING_UPDATE}):!i||t===null?null:e.jsx(IN,{paymentPlan:i,screenBeneficiary:i?.program?.screenBeneficiary})},TN=oe(DN,"EditTargetPopulationPage"),RN=T.span`
  cursor: pointer;
`;function Th({children:s}){return e.jsx(RN,{children:s})}const mi={femaleChildren:"#5F02CF",maleChildren:"#1D6A64",femaleAdult:"#DFCCF5",maleAdult:"#B1E3E0"},FN=T.div`
  padding-bottom: ${({theme:s})=>s.spacing(2)};
`,NN=T.div`
  display: flex;
`,$r=T.div`
  padding: ${({theme:s})=>s.spacing(4)};
  border-color: #b1b1b5;
  border-left-width: 1px;
  border-left-style: solid;
`,Ur=T.div`
  font-family: ${({theme:s})=>s.hctTypography.fontFamily};
  color: #253b46;
  font-size: 36px;
  line-height: 32px;
  margin-top: ${({theme:s})=>s.spacing(2)};
`;function LN({targetPopulation:s}){const{t}=M(),{selectedProgram:a}=Z(),n=a?.beneficiaryGroup,[i,r]=A.useState(!1),l=()=>{s?.failedWalletValidationCollectorsIds?.length>0&&r(!0)},o=()=>r(!1);return s.backgroundActionStatus!==null?null:e.jsx("div",{children:e.jsxs(ft,{children:[e.jsx(FN,{children:e.jsx(ee,{variant:"h6",children:t("Results")})}),e.jsx(NN,{children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:4},children:e.jsxs(p,{container:!0,spacing:0,justifyContent:"flex-start",children:[e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:mi.femaleChildren,children:e.jsx(L,{label:t("Female Children"),value:s.femaleChildrenCount})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:mi.femaleAdult,children:e.jsx(L,{label:t("Female Adults"),value:s.femaleAdultsCount})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:mi.maleChildren,children:e.jsx(L,{label:t("Male Children"),value:s.maleChildrenCount})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:mi.maleAdult,children:e.jsx(L,{label:t("Male Adults"),value:s.maleAdultsCount})})})]})}),e.jsx(p,{size:{xs:4},children:e.jsx(p,{container:!0,spacing:0,justifyContent:"flex-start",alignItems:"center",children:e.jsx(p,{size:{xs:6},children:e.jsx($r,{children:e.jsxs(e.Fragment,{children:[e.jsx(L,{label:t("Collectors failed payment channel validation"),children:e.jsx(Ur,{onClick:()=>l(),"data-cy":"total-collectors-failed-count",children:e.jsx(Th,{children:s?.failedWalletValidationCollectorsIds?.length||"-"})})}),e.jsxs(is,{open:i,onClose:o,children:[e.jsx(Le,{children:"View IDs"}),e.jsx(Be,{children:e.jsx(Fi,{children:s?.failedWalletValidationCollectorsIds?.map((d,c)=>e.jsx(pl,{children:d},c))})}),e.jsx(os,{children:e.jsx(H,{onClick:o,color:"primary",children:"Close"})})]})]})})})})}),e.jsx(p,{size:{xs:4},children:e.jsxs(p,{container:!0,spacing:0,justifyContent:"flex-end",children:[e.jsx(p,{size:{xs:6},children:e.jsx($r,{children:e.jsx(L,{label:`Total Number of ${n?.groupLabelPlural}`,children:e.jsx(Ur,{"data-cy":"total-number-of-households-count",children:Qe(s.totalHouseholdsCount)||"0"})})})}),e.jsx(p,{size:{xs:6},children:e.jsx($r,{children:e.jsx(L,{label:`Targeted ${n?.memberLabelPlural}`,children:e.jsx(Ur,{children:Qe(s.totalIndividualsCount)||"0"})})})})]})})]})})]})})}const ON=oe(LN,"ResultsForHouseholds"),kN=[{disablePadding:!1,label:"ID",id:"household_unicef_id",numeric:!1},{disablePadding:!1,label:"Head of Household",id:"head_of_household",numeric:!1},{disablePadding:!1,label:"Household Size",id:"household_size",numeric:!1},{disablePadding:!1,label:"Administrative Level 2",id:"household_admin2",numeric:!1},{disablePadding:!1,label:"Score",id:"vulnerability_score",numeric:!1}];function wN({payment:s,canViewDetails:t}){const{baseUrl:a}=U(),n=`/${a}/population/household/${s.householdId}`,i=()=>{const r=window.open(n,"_blank");r?.focus()};return e.jsxs(rs,{hover:!0,onClick:t?i:void 0,role:"checkbox","data-cy":"target-population-household-row",children:[e.jsx(_,{align:"left",children:t?e.jsx(me,{to:n,children:s.householdUnicefId}):s.householdUnicefId}),e.jsx(Jt,{children:s.headOfHousehold.fullName||"-"}),e.jsx(_,{align:"left",children:s.householdSize}),e.jsx(_,{align:"left",children:s.householdAdmin2||"-"}),e.jsx(_,{align:"left",children:s.vulnerabilityScore==null?"-":s.vulnerabilityScore})]},s.id)}function MN({id:s,variables:t,canViewDetails:a}){const{t:n}=M(),{businessAreaSlug:i,programSlug:r}=U(),[l,o]=A.useState(0),d=A.useMemo(()=>({...t,businessAreaSlug:i,programSlug:r,id:s}),[t,i,r,s]),[c,u]=A.useState(d);A.useEffect(()=>{u(d)},[d]);const{data:h,isLoading:m,error:g}=V({queryKey:["businessAreasProgramsPaymentPlansPaymentsList",i,r,c,s],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsPendingPaymentsList(Ce({businessAreaSlug:i,programSlug:r,id:s},c,{withPagination:!0}))}),{data:x}=V({queryKey:["businessAreasProgramsTargetPopulationsPendingPaymentsCount",i,r,s,c],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsPendingPaymentsCountRetrieve({businessAreaSlug:i,programSlug:r,id:s}),enabled:l===0}),f=vs(l,x),{selectedProgram:j}=Z(),y=j?.beneficiaryGroup,C=$s(kN,y,{household_unicef_id:v=>`${v?.groupLabel} ID`,head_of_household:v=>`Head of ${v?.groupLabel}`,household_size:v=>`${v?.groupLabel} Size`});return e.jsx(Es,{children:e.jsx(ds,{title:n(`${y?.groupLabelPlural}`),headCells:C,rowsPerPageOptions:[10,15,20],isLoading:m,data:h,error:g,queryVariables:c,setQueryVariables:u,itemsCount:f,page:l,setPage:o,renderRow:v=>e.jsx(wN,{payment:v,canViewDetails:a},v.id)})})}function $N({id:s,canViewDetails:t}){const{businessArea:a}=U();return e.jsx(MN,{id:s,canViewDetails:t,variables:{businessArea:a}})}const UN=oe($N,"TargetingHouseholds"),VN=[{disablePadding:!1,label:"ID",id:"unicef_id",numeric:!1},{disablePadding:!1,label:"Full Name",id:"head_of_household__full_name",numeric:!1},{disablePadding:!1,label:"Administrative Level 2",id:"admin_area__name",numeric:!1},{disablePadding:!1,label:"Size",id:"household_size",numeric:!1},{disablePadding:!1,label:"Score",id:"household_selection__vulnerability_score",numeric:!1}];function BN({payment:s,canViewDetails:t}){const{baseUrl:a}=U(),n=`/${a}/population/people/${s.headOfHousehold.id}`,i=()=>{const r=window.open(n,"_blank");r?.focus()};return e.jsxs(rs,{hover:!0,onClick:t?i:void 0,role:"checkbox","data-cy":"target-population-people-row",children:[e.jsx(_,{align:"left",children:t?e.jsx(me,{to:n,children:s?.headOfHousehold.unicefId}):s?.headOfHousehold.unicefId}),e.jsx(Jt,{children:s?.headOfHousehold?.fullName||"-"}),e.jsx(_,{align:"left",children:s?.householdAdmin2||"-"}),e.jsx(_,{align:"left",children:s?.householdSize!=null?s.householdSize:"-"}),e.jsx(_,{align:"left",children:s?.vulnerabilityScore==null?"-":s?.vulnerabilityScore})]},s?.householdId)}function GN({id:s,variables:t,canViewDetails:a}){const{t:n}=M(),{businessArea:i,programId:r}=U(),l=A.useMemo(()=>({...t,businessAreaSlug:i,programSlug:r,targetPopulationId:s}),[t,i,r,s]),[o,d]=A.useState(l);A.useEffect(()=>{d(l)},[l]);const{data:c,isLoading:u,error:h}=V({queryKey:["businessAreasProgramsPaymentPlansPaymentsList",i,r,o,s],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsPendingPaymentsList(Ce({businessAreaSlug:i,programSlug:r,id:s},o,{withPagination:!0}))});return e.jsx(Es,{children:e.jsx(ds,{title:n("People"),headCells:VN,rowsPerPageOptions:[10,15,20],isLoading:u,error:h,queryVariables:o,setQueryVariables:d,data:c,renderRow:m=>e.jsx(BN,{payment:m,canViewDetails:a},m.id)})})}const pi={femaleChildren:"#5F02CF",maleChildren:"#1D6A64",femaleAdult:"#DFCCF5",maleAdult:"#B1E3E0"},zN=T.div`
  padding-bottom: ${({theme:s})=>s.spacing(2)};
`,qN=T.div`
  display: flex;
`,tc=T.div`
  padding: ${({theme:s})=>s.spacing(4)};
  border-color: #b1b1b5;
  border-left-width: 1px;
  border-left-style: solid;
`,ac=T.div`
  font-family: ${({theme:s})=>s.hctTypography.fontFamily};
  color: #253b46;
  font-size: 36px;
  line-height: 32px;
  margin-top: ${({theme:s})=>s.spacing(2)};
`;function HN({targetPopulation:s}){const{t}=M(),[a,n]=A.useState(!1),i=()=>{s?.failedWalletValidationCollectorsIds?.length>0&&n(!0)},r=()=>n(!1);return s.backgroundActionStatus!=null?null:e.jsx("div",{children:e.jsxs(ft,{children:[e.jsx(zN,{children:e.jsx(ee,{variant:"h6",children:t("Results")})}),e.jsx(qN,{children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:4},children:e.jsxs(p,{container:!0,spacing:0,justifyContent:"flex-start",children:[e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:pi.femaleChildren,children:e.jsx(L,{label:t("Female Children"),value:s.femaleChildrenCount})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:pi.femaleAdult,children:e.jsx(L,{label:t("Female Adults"),value:s.femaleAdultsCount})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:pi.maleChildren,children:e.jsx(L,{label:t("Male Children"),value:s.maleChildrenCount})})}),e.jsx(p,{size:{xs:6},children:e.jsx(Ws,{color:pi.maleAdult,children:e.jsx(L,{label:t("Male Adults"),value:s.maleAdultsCount})})})]})}),e.jsx(p,{size:{xs:4},children:e.jsx(p,{container:!0,spacing:0,justifyContent:"flex-start",alignItems:"center",children:e.jsx(p,{size:{xs:6},children:e.jsx(tc,{children:e.jsxs(e.Fragment,{children:[e.jsx(L,{label:t("Collectors failed payment channel validation"),children:e.jsx(ac,{onClick:()=>i(),"data-cy":"total-collectors-failed-count",children:e.jsx(Th,{children:s?.failedWalletValidationCollectorsIds?.length||"-"})})}),e.jsxs(is,{open:a,onClose:r,children:[e.jsx(Le,{children:"View IDs"}),e.jsx(Be,{children:e.jsx(Fi,{children:s?.failedWalletValidationCollectorsIds?.map((l,o)=>e.jsx(pl,{children:l},o))})}),e.jsx(os,{children:e.jsx(H,{onClick:r,color:"primary",children:"Close"})})]})]})})})})}),e.jsx(p,{size:{xs:4},children:e.jsx(p,{container:!0,spacing:0,justifyContent:"flex-end",children:e.jsx(p,{size:{xs:12},children:e.jsx(tc,{children:e.jsx(L,{label:t("Total Number of People"),children:e.jsx(ac,{children:Qe(s.totalHouseholdsCount)||"0"})})})})})})]})})]})})}const WN=oe(HN,"ResultsForPeople"),KN=T.p`
  color: #b1b1b5;
`,YN=({id:s,targetPopulation:t,permissions:a,screenBeneficiary:n})=>{const{t:i}=M(),{selectedProgram:r,isSocialDctType:l,isStandardDctType:o}=Z(),d=r?.beneficiaryGroup;if(!t)return null;const c=l?WN:ON,u=l?e.jsx(GN,{id:s,canViewDetails:K(R.POPULATION_VIEW_HOUSEHOLDS_DETAILS,a)}):e.jsx(UN,{id:s,canViewDetails:K(R.POPULATION_VIEW_HOUSEHOLDS_DETAILS,a)}),h=t.buildStatus==="OK"?u:e.jsxs(ft,{children:[e.jsx(ee,{"data-cy":"target-population-building",variant:"h6",children:i("Target Population is building")}),e.jsx(KN,{children:`Target population is processing, the list of ${d?.groupLabelPlural} will be
         available when the process is finished`})]});return e.jsxs(e.Fragment,{children:[t.rules?.length?e.jsxs(ft,{children:[e.jsx(P,{pt:3,pb:3,children:e.jsx(ee,{variant:"h6",children:i("Targeting Criteria")})}),e.jsx(po,{rules:t.rules||[],targetPopulation:t,screenBeneficiary:n,isStandardDctType:o,isSocialDctType:l})]}):null,t?.excludedIds?e.jsxs(ft,{children:[e.jsx(ee,{"data-cy":"title-excluded-entries",variant:"h6",children:i(l?"Excluded Target Population Entries":`Excluded Target Population Entries (${d?.groupLabelPlural} or ${d?.memberLabelPlural})`)}),e.jsx(P,{mt:2,children:e.jsx(p,{container:!0,children:e.jsx(p,{size:6,children:t?.excludedIds})})}),e.jsx(P,{mt:2,children:e.jsx(p,{container:!0,children:e.jsx(p,{size:6,children:t?.exclusionReason})})})]}):null,e.jsx(c,{targetPopulation:t}),h,K(R.ACTIVITY_LOG_VIEW,a)&&e.jsx(Lt,{objectId:t.id})]})};function QN({targetPopulation:s}){const{createdBy:t,program:a,programCycle:n}=s,{t:i}=M(),r=a?.name?a.name:"-";return e.jsxs(Fs,{"data-cy":"target-population-details-container",children:[e.jsx(Ie,{"data-cy":"details-title",children:e.jsx(ee,{variant:"h6",children:i("Details")})}),e.jsx(vt,{children:e.jsxs(p,{"data-cy":"details-grid",container:!0,spacing:6,children:[e.jsx(p,{size:4,children:e.jsx(L,{label:i("Status"),children:e.jsx(we,{dataCy:"target-population-status",status:s.status,statusToColor:Vt,statusNameMapping:Cl})})}),e.jsx(p,{size:4,children:e.jsx(L,{dataCy:"created-by",label:i("created by"),value:t})}),e.jsx(p,{size:4,children:e.jsx(L,{dataCy:"program-name",label:i("Programme"),value:r})}),e.jsx(p,{size:4,children:e.jsx(L,{dataCy:"programme-cycle-title",label:i("Programme Cycle"),value:n?.title??"-"})})]})})]})}const XN=oe(QN,"TargetPopulationDetails"),JN=Q.object().shape({name:Q.string().required("Name is required"),programCycleId:Q.object().shape({value:Q.string().required("Programme Cycle is required")})}),xo=({open:s,setOpen:t,targetPopulationId:a})=>{const n=ge(),{t:i}=M(),{showMessage:r}=Ae(),{baseUrl:l,businessArea:o,programId:d}=U(),{mutateAsync:c,isPending:u}=xe({mutationFn:({businessAreaSlug:m,programSlug:g,id:x,requestBody:f})=>N.restBusinessAreasProgramsTargetPopulationsCopyCreate({businessAreaSlug:m,programSlug:g,id:x,requestBody:f})}),h={name:"",id:a,programCycleId:{value:"",name:""}};return e.jsx(Ks,{open:s,onClose:()=>t(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:e.jsx(B.Formik,{validationSchema:JN,initialValues:h,onSubmit:async m=>{try{const g=m.programCycleId.value,x=await c({id:a,businessAreaSlug:o,programSlug:d,requestBody:{name:m.name,targetPopulationId:a,programCycleId:g}});t(!1),r(i("Target Population Duplicated")),n(`/${l}/target-population/${x.id}`)}catch(g){fe(g,r,i("Failed to finish programme."))}},children:({submitForm:m,setFieldValue:g,values:x,errors:f})=>e.jsxs(e.Fragment,{children:[s&&e.jsx(Bs,{}),e.jsx(Ye,{children:e.jsx(Le,{children:"Duplicate Target Population?"})}),e.jsxs(Be,{children:[e.jsxs(pt,{children:[i("Please use a unique name for the copy of this Target Population."),e.jsx("br",{})," ",e.jsx("strong",{children:i("Note")}),":"," ",i("This duplicate will copy the Target Criteria of the Programme Population and update to the latest results from the system.")]}),e.jsxs(p,{container:!0,spacing:4,children:[e.jsx(p,{size:{xs:12},children:e.jsx(B.Field,{name:"name",fullWidth:!0,label:i("Name Copy of Target Population"),required:!0,variant:"outlined",component:Se})}),e.jsx(p,{size:{xs:12},children:e.jsx(go,{value:x.programCycleId,onChange:async j=>{await g("programCycleId",j)},required:!0,error:f.programCycleId?.value})})]})]}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{"data-cy":"button-cancel",onClick:()=>t(!1),children:i("CANCEL")}),e.jsx(ke,{loading:u,type:"submit",color:"primary",variant:"contained",onClick:m,"data-cy":"button-target-population-duplicate",children:i("Save")})]})})]})})})},ZN=T.span`
  button {
    color: #949494;
    min-width: 40px;
    svg {
      width: 20px;
      height: 20px;
    }
  }
`;function eL({targetPopulation:s,canDuplicate:t}){const[a,n]=A.useState(!1);return e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(ZN,{children:e.jsx(H,{"data-perm":R.TARGETING_DUPLICATE,onClick:()=>n(!0),children:e.jsx(Ri,{})})}),e.jsx(xo,{open:a,setOpen:n,targetPopulationId:s.id})]})}const sL=({open:s,setOpen:t,totalHouseholds:a,targetPopulationId:n})=>{const i=ge(),{t:r}=M(),{showMessage:l}=Ae(),{baseUrl:o,businessArea:d,programId:c}=U(),u=Fe(),{mutateAsync:h,isPending:m}=xe({mutationFn:()=>N.restBusinessAreasProgramsTargetPopulationsMarkReadyRetrieve({businessAreaSlug:d,id:n,programSlug:c}),onSuccess:()=>{l(r("Target Population Finalized")),t(!1),u.invalidateQueries({queryKey:["targetPopulation",d,n,c]}),i(`/${o}/target-population/${n}`)},onError:f=>{fe(f,l)}}),{isSocialDctType:g}=Z(),x=()=>{h()};return e.jsxs(Ks,{open:s,onClose:()=>t(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsx(Ye,{children:e.jsx(Le,{children:e.jsx(ee,{variant:"h6",children:r("Mark Ready")})})}),e.jsx(Be,{children:e.jsxs(pt,{children:[r("Are you sure you want to send")," ",a," ",r((g?"individuals":"households")+" to HOPE? They will be accessible in Payment Module. Target population will not be editable further.")]})}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>t(!1),children:r("CANCEL")}),e.jsx(ke,{onClick:()=>x(),color:"primary",variant:"contained",loading:m,disabled:m||!a,"data-cy":"button-target-population-modal-send-to-hope",children:r("Mark Ready")})]})})]})},tL=T.span`
  button {
    color: #949494;
    min-width: 40px;

    svg {
      width: 20px;
      height: 20px;
    }
  }
`;function aL({targetPopulation:s,canSend:t,canDuplicate:a,canUnlock:n}){const{t:i}=M(),[r,l]=A.useState(!1),[o,d]=A.useState(!1),{showMessage:c}=Ae(),{isActiveProgram:u}=Z(),{businessArea:h,programId:m}=U(),g=Fe(),{mutateAsync:x,isPending:f}=xe({mutationFn:()=>N.restBusinessAreasProgramsTargetPopulationsUnlockRetrieve({businessAreaSlug:h,programSlug:m,id:s.id}),onSuccess:()=>{g.invalidateQueries({queryKey:["targetPopulation",h,s.id,m]}),g.invalidateQueries({queryKey:["businessAreasProgramsTargetPopulationsList"]}),c(i("Target Population Unlocked"))},onError:j=>{fe(j,c)}});return e.jsxs(P,{display:"flex",alignItems:"center",children:[a&&e.jsx(tL,{children:e.jsx(H,{onClick:()=>l(!0),disabled:!u,children:e.jsx(Ri,{})})}),n&&e.jsx(P,{m:2,children:e.jsx(ke,{loading:f,color:"primary",variant:"outlined",onClick:()=>x(),"data-cy":"button-target-population-unlocked",disabled:!u,children:"Unlock"})}),t&&e.jsx(P,{m:2,children:e.jsx(Ms,{title:s.program.status!==ht.ACTIVE?i("Assigned programme is not ACTIVE"):"",children:e.jsx("span",{children:e.jsx(H,{variant:"contained",color:"primary",disabled:!u,onClick:()=>d(!0),"data-cy":"button-target-population-send-to-hope",children:i("Mark Ready")})})})}),e.jsx(xo,{open:r,setOpen:l,targetPopulationId:s.id}),e.jsx(sL,{open:o,setOpen:d,targetPopulationId:s.id,totalHouseholds:s.totalHouseholdsCount})]})}const nL=({open:s,setOpen:t,targetPopulationId:a})=>{const n=ge(),{t:i}=M(),{baseUrl:r,businessArea:l,programId:o}=U(),{showMessage:d}=Ae(),{mutateAsync:c,isPending:u}=xe({mutationFn:({businessAreaSlug:m,programSlug:g,id:x})=>N.restBusinessAreasProgramsTargetPopulationsDestroy({businessAreaSlug:m,programSlug:g,id:x})}),h=async()=>{try{await c({businessAreaSlug:l,programSlug:o,id:a}),d(i("Target Population Deleted")),n(`/${r}/payment-module/payment-plans`)}catch(m){m.message&&m.message.includes("Unexpected end of JSON input")?(d(i("Target Population Deleted")),n(`/${r}/target-population`)):d(m.message)}};return e.jsx(is,{open:s,onClose:()=>t(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:e.jsxs(e.Fragment,{children:[e.jsx(Ye,{children:e.jsx(Le,{children:i("Delete Target Population")})}),e.jsx(Be,{children:e.jsx(pt,{children:i("Are you sure you want to remove this Target Population?")})}),e.jsx(ss,{children:e.jsxs(os,{children:[e.jsx(H,{onClick:()=>t(!1),children:i("CANCEL")}),e.jsx(ke,{color:"primary",variant:"contained",loading:u,onClick:()=>h(),"data-cy":"button-delete",children:i("Delete")})]})})]})})},iL=({open:s,setOpen:t,targetPopulationId:a})=>{const n=ge(),{t:i}=M(),{baseUrl:r,businessArea:l,programId:o}=U(),{showMessage:d}=Ae(),c=Fe(),{mutateAsync:u,isPending:h}=xe({mutationFn:({businessAreaSlug:m,programSlug:g,id:x})=>N.restBusinessAreasProgramsTargetPopulationsLockRetrieve({businessAreaSlug:m,programSlug:g,id:x}),onSuccess:()=>{c.invalidateQueries({queryKey:["targetPopulation",l,a,o]}),d(i("Payment Plan has been locked."))},onError:m=>{fe(m,d)}});return e.jsx(Ks,{open:s,onClose:()=>t(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:e.jsxs(e.Fragment,{children:[e.jsx(Ye,{children:e.jsx(Le,{children:i("Lock Target Population")})}),e.jsxs(Be,{children:[e.jsx(pt,{children:i("After you lock this Target Population, the selected criteria will no longer accept new households that may get merged to Population in the future.")}),e.jsx(pt,{children:i("Note: You may duplicate the Programme Population target criteria at any time.")})]}),e.jsx(ss,{children:e.jsxs(Gs,{children:[e.jsx(H,{onClick:()=>t(!1),children:i("CANCEL")}),e.jsx(ke,{color:"primary",variant:"contained",loading:h,onClick:()=>{u({businessAreaSlug:l,programSlug:o,id:a}).then(()=>{t(!1),d(i("Target Population Locked")),n(`/${r}/target-population/${a}`)}).catch(m=>d(m.message))},"data-cy":"button-target-population-modal-lock",children:i("Lock")})]})})]})})};function rL({targetPopulation:s,canDuplicate:t,canEdit:a,canLock:n,canRemove:i}){const[r,l]=A.useState(!1),{showMessage:o}=Ae(),[d,c]=A.useState(!1),[u,h]=A.useState(!1),{baseUrl:m,businessArea:g,programId:x}=U(),{isActiveProgram:f}=Z(),j=Fe(),{mutateAsync:y,isPending:b}=xe({mutationFn:({businessAreaSlug:C,programSlug:v,id:S})=>N.restBusinessAreasProgramsTargetPopulationsRebuildRetrieve({businessAreaSlug:C,programSlug:v,id:S}),onSuccess:()=>{o(Ee("Payment Plan has been rebuilt.")),j.invalidateQueries({queryKey:["targetPopulation",g,s.id,x]}),j.invalidateQueries({queryKey:["businessAreasProgramsTargetPopulationsList"]})},onError:C=>fe(C,o)});return e.jsxs(P,{display:"flex",alignItems:"center",children:[t&&e.jsx(Ve,{onClick:()=>c(!0),"data-cy":"button-target-population-duplicate",disabled:!f,"data-perm":R.TARGETING_DUPLICATE,children:e.jsx(Ri,{})}),i&&e.jsx(Ve,{"data-cy":"button-delete",onClick:()=>h(!0),disabled:!f,"data-perm":R.TARGETING_REMOVE,children:e.jsx(Rs,{})}),a&&e.jsx(P,{m:2,children:e.jsx(H,{"data-cy":"button-edit",variant:"outlined",color:"primary",startIcon:e.jsx(Ha,{}),component:ys,to:`/${m}/target-population/edit-tp/${s.id}`,disabled:!f,"data-perm":R.TARGETING_UPDATE,children:"Edit"})}),a&&e.jsx(P,{m:2,children:e.jsx(H,{"data-cy":"button-rebuild",variant:"outlined",color:"primary",disabled:b||!f,startIcon:e.jsx(Km,{}),"data-perm":R.TARGETING_UPDATE,onClick:()=>y({businessAreaSlug:g,programSlug:x,id:s.id}),children:"Rebuild"})}),n&&e.jsx(P,{m:2,children:e.jsx(H,{variant:"contained",color:"primary",onClick:()=>l(!0),"data-cy":"button-target-population-lock",disabled:!f,"data-perm":R.TARGETING_LOCK,children:"Lock"})}),e.jsx(xo,{open:d,setOpen:c,targetPopulationId:s.id}),e.jsx(nL,{open:u,setOpen:h,targetPopulationId:s.id}),e.jsx(iL,{open:r,setOpen:l,targetPopulationId:s.id})]})}const lL=T.div`
  display: flex;
  align-items: center;
  justify-content: center;

  div {
    margin: 0 0 0 ${({theme:s})=>s.spacing(3)};
  }
`,oL=T.div`
  display: flex;
  flex-direction: row;
`;function dL({paymentPlan:s,canEdit:t,canRemove:a,canDuplicate:n,canLock:i,canUnlock:r,canSend:l}){const{t:o}=M(),{baseUrl:d,businessArea:c}=U(),{data:u,isLoading:h}=V({queryKey:["businessArea",c],queryFn:()=>N.restBusinessAreasRetrieve({slug:c})}),m=[{title:"Targeting",to:`/${d}/target-population/`}];if(!u)return null;if(h)return e.jsx(Ne,{});let g;switch(s.status){case te.TP_OPEN:g=e.jsx(rL,{targetPopulation:s,canDuplicate:n,canRemove:a,canEdit:t,canLock:i});break;case te.TP_LOCKED:case te.STEFICON_COMPLETED:case te.STEFICON_ERROR:case te.STEFICON_RUN:g=e.jsx(aL,{targetPopulation:s,canDuplicate:n,canUnlock:r,canSend:l,businessAreaData:u});break;default:g=e.jsx(eL,{targetPopulation:s,canDuplicate:n});break}return e.jsx(Ze,{title:e.jsxs(lL,{children:[o(`${s.name}`),s.buildStatus!=="OK"&&e.jsx(oL,{children:e.jsx(we,{status:s.buildStatus,statusToColor:Sp})})]}),breadCrumbs:m,flags:e.jsx(gt,{adminUrl:s.adminUrl}),children:g})}const cL=()=>{const{id:s}=ts(),t=ve(),{businessAreaSlug:a,programSlug:n}=U(),{data:i,isLoading:r,error:l}=V({queryKey:["targetPopulation",a,s,n],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsRetrieve({businessAreaSlug:a,id:s,programSlug:n}),refetchInterval:d=>{const c=d.state.data;return["BUILDING","PENDING"].includes(c?.backgroundActionStatus)?3e3:!1},refetchIntervalInBackground:!0});if(r&&!i)return e.jsx(Ne,{});if(rt(l))return e.jsx(Xe,{permission:R.TARGETING_VIEW_DETAILS});const o=K(R.TARGETING_DUPLICATE,t)&&!!i.rules;return e.jsxs(e.Fragment,{children:[e.jsx(dL,{paymentPlan:i,canEdit:K(R.TARGETING_UPDATE,t),canRemove:K(R.TARGETING_REMOVE,t),canDuplicate:o,canLock:K(R.TARGETING_LOCK,t),canUnlock:K(R.TARGETING_UNLOCK,t),canSend:K(R.TARGETING_SEND,t)}),e.jsx(XN,{targetPopulation:i}),e.jsx(YN,{id:i?.id,targetPopulation:i,permissions:t,screenBeneficiary:i?.program?.screenBeneficiary})]})},uL=oe(cL,"TargetPopulationDetailsPage"),hL=({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})=>{const{t:r}=M(),l=ge(),o=je(),{selectedProgram:d}=Z(),c=d?.beneficiaryGroup,{handleFilterChange:u,applyFilterChanges:h,clearFilter:m}=Ss(a,l,o,s,t,n,i),g=()=>{h()},x=()=>{m()},f=["ASSIGNED",te.DRAFT,te.TP_OPEN,te.TP_LOCKED,te.PROCESSING,te.STEFICON_RUN,te.STEFICON_WAIT,te.STEFICON_COMPLETED,te.STEFICON_ERROR],{data:j}=V({queryKey:["choicesPaymentPlanStatusList"],queryFn:()=>N.restChoicesPaymentPlanStatusList()}),y=[{name:"Assigned",value:"ASSIGNED"},{name:"Ready for Payment Module",value:te.DRAFT},...j||[]].filter(b=>f.includes(b.value))?.filter(b=>b.name!=="Draft")||[];return e.jsx(Ns,{clearHandler:x,applyHandler:g,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:3,children:e.jsx(Cs,{label:r("Search"),value:s.name,onChange:b=>u("name",b.target.value),"data-cy":"filters-search",fullWidth:!0})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:b=>u("status",b.target.value),value:s.status,label:r("Status"),icon:e.jsx(Wa,{}),fullWidth:!0,"data-cy":"filters-status",children:y.map(b=>e.jsx(de,{value:b.value,children:b.name},b.value))})}),e.jsx(p,{size:3,children:e.jsx(js,{topLabel:r(`Number of ${c?.groupLabelPlural}`),value:s.totalHouseholdsCountGte,placeholder:r("From"),onChange:b=>u("totalHouseholdsCountGte",b.target.value),icon:e.jsx(ct,{}),"data-cy":"filters-total-households-count-min"})}),e.jsx(p,{size:3,children:e.jsx(js,{value:s.totalHouseholdsCountLte,placeholder:r("To"),onChange:b=>u("totalHouseholdsCountLte",b.target.value),icon:e.jsx(ct,{}),"data-cy":"filters-total-households-count-max"})}),e.jsx(p,{size:3,children:e.jsx(ms,{topLabel:r("Date Created"),placeholder:r("From"),onChange:b=>u("createdAtGte",b),value:s.createdAtGte})}),e.jsx(p,{size:3,children:e.jsx(ms,{placeholder:r("To"),onChange:b=>u("createdAtLte",b),value:s.createdAtLte})})]})})},mL=""+new URL("TargetingDiagramImage-D9W5CCm5.png",import.meta.url).href,pL=[{disablePadding:!1,label:"Name",id:"labelEn",numeric:!1},{disablePadding:!1,label:"Type",id:"associatedWith",numeric:!1},{disablePadding:!1,label:"Field Type",id:"isFlexField",numeric:!1}],gL=T(_)`
  width: 70%;
`;function xL({fields:s,selectedOption:t,searchValue:a,selectedFieldType:n}){const[i,r]=A.useState("asc"),[l,o]=A.useState(""),d=(h,m)=>{r(l===m&&i==="asc"?"desc":"asc"),o(m)},c=()=>{const h={labelEn:a,associatedWith:t==="All"?"":t};let m=[];return n==="All"?m=s:n==="Flex field"?m=s.filter(g=>g.isFlexField===!0):n==="Core field"&&(m=s.filter(g=>g.isFlexField===!1)),m.filter(g=>{for(const x in h)if(g[x]===void 0||g[x]!==h[x]&&!g[x].toLowerCase().includes(h[x].toLowerCase()))return!1;return!0})},u=()=>Lp(c(),Op(i,l));return e.jsxs(gs,{"aria-label":"simple table",children:[e.jsx(wl,{order:i,headCells:pL,orderBy:l,onRequestSort:d,rowCount:s.length-1}),e.jsx(cs,{children:u().map(h=>e.jsxs(be,{children:[e.jsx(gL,{children:h.labelEn}),e.jsx(_,{children:h.associatedWith}),e.jsx(_,{children:h?.isFlexField?"Flex field":"Core field"})]},h.id))})]})}function fL(){const{t:s}=M(),{businessArea:t,isAllPrograms:a}=U(),{selectedProgram:n}=Z(),{data:i}=V({queryKey:["allFieldsAttributes",t,n?.id],queryFn:()=>N.restBusinessAreasAllFieldsAttributesList({slug:t,programId:n?.id}),enabled:!!n?.id&&!a}),[r,l]=A.useState(""),[o,d]=A.useState([]),[c,u]=A.useState("All"),[h,m]=A.useState("All");return A.useEffect(()=>{if(i?.results&&!o.length){const g=i.results.map(f=>f.associatedWith),x=g.filter((f,j)=>g.indexOf(f)===j);d(x)}},[i,o]),i?e.jsxs(P,{sx:{p:3},children:[e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{label:s("Search"),value:r,onChange:g=>l(g.target.value),"data-cy":"filters-search",fullWidth:!0})}),e.jsx(p,{size:{xs:3},children:o.length&&e.jsxs(He,{onChange:g=>u(g.target.value),variant:"outlined",label:s("Type"),value:c,fullWidth:!0,disableClearable:!0,children:[e.jsx(de,{value:"All",children:e.jsx("em",{children:s("All")})}),o.map(g=>e.jsx(de,{value:g,children:g},g))]})}),e.jsx(p,{size:{xs:3},children:e.jsxs(He,{onChange:g=>m(g.target.value),label:s("Field Type"),value:h,fullWidth:!0,disableClearable:!0,children:[e.jsx(de,{value:"All",children:e.jsx("em",{children:s("All")})}),[{name:"Flex field",value:"Flex field"},{name:"Core field",value:"Core field"}].map(g=>e.jsx(de,{value:g.value,children:g.name},g.name))]})})]}),e.jsx(xL,{selectedOption:c,searchValue:r,selectedFieldType:h,fields:i.results})]}):null}const yL=T(is)`
  && {
    .MuiPaper-root {
      max-width: fit-content;
    }
    .MuiDialogContent-root {
      padding: 0;
    }
  }
`,bL=T.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
`,jL=T(Be)`
  width: 900px;
  height: 600px;
`,AL=T.img`
  width: 754px;
  height: 525px;
  margin: 0 auto;
  background-color: #f8f8f8;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
`,_L=T(Qt)`
  && {
    height: 100%;
  }
`,PL=({open:s,setOpen:t})=>{const{t:a}=M(),[n,i]=A.useState(0),r=(o,d)=>{i(d)},l=e.jsxs(La,{value:n,onChange:r,"aria-label":"tabs",indicatorColor:"primary",textColor:"primary",children:[e.jsx(Tt,{"data-cy":"tab-field-list",label:a("Field List")}),e.jsx(Tt,{"data-cy":"tab-targeting-diagram",label:a("Targeting Diagram")})]});return e.jsxs(yL,{open:s,onClose:()=>t(!1),scroll:"paper","aria-labelledby":"form-dialog-title",children:[e.jsxs(bL,{children:[l,e.jsx(Ve,{onClick:()=>t(!1),color:"primary","aria-label":"Close Information Modal","data-cy":"button-close",children:e.jsx(Ct,{})})]}),e.jsxs(jL,{children:[e.jsx(_L,{value:n,index:0,children:e.jsx(fL,{})}),e.jsx(Qt,{value:n,index:1,children:e.jsx(AL,{src:mL,alt:"diagram"})})]})]})},CL=[{disablePadding:!1,label:"",id:"radio",numeric:!1,dataCy:"radio-id"},{disablePadding:!1,label:"Name",id:"name",numeric:!1,dataCy:"name"},{disablePadding:!1,label:"Status",id:"status",numeric:!1,dataCy:"status"},{disablePadding:!1,label:"Num. of Households",id:"total_households_count",numeric:!1,dataCy:"num-of-households"},{disablePadding:!1,label:"Date Created",id:"created_at",numeric:!1,dataCy:"date-created"},{disablePadding:!1,label:"Last Edited",id:"updated_at",numeric:!1,dataCy:"last-edited"},{disablePadding:!1,label:"Created by",id:"created_by",numeric:!1,dataCy:"created-by"}];function EL({targetPopulation:s,canViewDetails:t,radioChangeHandler:a,selectedTargetPopulation:n}){const i=ge(),{baseUrl:r}=U(),l=`/${r}/target-population/${s.id}`,o=()=>{a!==void 0?a(s.id):i(l)};return e.jsxs(rs,{hover:!0,onClick:t?o:void 0,role:"checkbox",children:[a&&e.jsx(_,{padding:"checkbox",children:e.jsx(kt,{color:"primary",checked:n===s.id,onChange:()=>{a(s.id)},value:s.id,name:"radio-button-household",slotProps:{input:{"aria-label":s.id}}})}),e.jsx(_,{align:"left",children:t?e.jsx(me,{to:l,children:s.name}):s.name}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Vt,statusNameMapping:Cl})}),e.jsx(_,{align:"left",children:s.totalHouseholdsCount||"0"}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.createdAt})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.updatedAt})}),e.jsx(_,{align:"left",children:s.createdBy})]},s.id)}const vL=T.div`
  .MuiPaper-elevation1 {
    box-shadow: none;
    padding: 0 !important;
  }
`;function SL({filter:s,canViewDetails:t,enableRadioButton:a,selectedTargetPopulation:n,handleChange:i,noTableStyling:r,noTitle:l}){const{t:o}=M(),{selectedProgram:d}=Z(),c=d?.beneficiaryGroup,{businessArea:u,programId:h}=U(),m=A.useMemo(()=>({name:s.name,status:s.status,totalHouseholdsCountGte:s.totalHouseholdsCountGte,totalHouseholdsCountLte:s.totalHouseholdsCountLte,createdAtGte:s.createdAtGte,createdAtLte:s.createdAtLte}),[s.name,s.status,s.totalHouseholdsCountGte,s.totalHouseholdsCountLte,s.createdAtGte,s.createdAtLte]),[g,x]=A.useState(0),[f,j]=A.useState(m);A.useEffect(()=>{j(m)},[m]);const{data:y}=V({queryKey:["businessAreasProgramsTargetPopulationsCount",u,h,f],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsCountRetrieve(Ce({businessAreaSlug:u,programSlug:h},f)),enabled:g===0}),b=vs(g,y),{data:C,isLoading:v,error:S}=V({queryKey:["businessAreasProgramsTargetPopulationsList",u,h,f,g],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsList(Ce({businessAreaSlug:u,programSlug:h},f,{withPagination:!0}))}),I=w=>{i(w)},D=$s(CL,c,{total_households_count:w=>`Num. of ${w?.groupLabelPlural}`}),F=()=>e.jsx(Es,{children:e.jsx(ds,{title:l?null:o("Target Populations"),headCells:a?D:D.slice(1),rowsPerPageOptions:[10,15,20],defaultOrderBy:"createdAt",defaultOrderDirection:"desc",queryVariables:f,setQueryVariables:j,data:C,isLoading:v,error:S,renderRow:w=>e.jsx(EL,{radioChangeHandler:a&&I,selectedTargetPopulation:n,targetPopulation:w,canViewDetails:t},w.id),page:g,setPage:x,itemsCount:b})});return r?e.jsx(vL,{children:F()}):F()}const IL=()=>{const{t:s}=M(),{baseUrl:t}=U(),{isActiveProgram:a}=Z();return e.jsx(e.Fragment,{children:a?e.jsx(H,{variant:"contained",color:"primary",component:ys,to:`/${t}/target-population/create`,"data-cy":"button-new-tp","data-perm":R.TARGETING_CREATE,children:s("Create New")}):e.jsx(Vs,{variant:"contained",color:"primary",title:s("Program has to be active to create a new Target Population"),component:ys,to:`/${t}/target-population/create`,dataCy:"button-new-tp-disabled",dataPerm:R.TARGETING_CREATE,disabled:!a,children:s("Create New")})})},DL=[{disablePadding:!1,label:"",id:"radio",numeric:!1,dataCy:"radio-id"},{disablePadding:!1,label:"Name",id:"name",numeric:!1,dataCy:"name"},{disablePadding:!1,label:"Status",id:"status",numeric:!1,dataCy:"status"},{disablePadding:!1,label:"Num. of People",id:"total_households_count",numeric:!1,dataCy:"num-of-households"},{disablePadding:!1,label:"Date Created",id:"created_at",numeric:!1,dataCy:"date-created"},{disablePadding:!1,label:"Last Edited",id:"updated_at",numeric:!1,dataCy:"last-edited"},{disablePadding:!1,label:"Created by",id:"created_by",numeric:!1,dataCy:"created-by"}];function TL({targetPopulation:s,canViewDetails:t,radioChangeHandler:a,selectedTargetPopulation:n}){const i=ge(),{baseUrl:r}=U(),l=`/${r}/target-population/${s.id}`,o=()=>{a!==void 0?a(s.id):i(l)};return e.jsxs(rs,{hover:!0,onClick:t?o:void 0,role:"checkbox",children:[a&&e.jsx(_,{padding:"checkbox",children:e.jsx(kt,{color:"primary",checked:n===s.id,onChange:()=>{a(s.id)},value:s.id,name:"radio-button-household",slotProps:{input:{"aria-label":s.id}}})}),e.jsx(_,{align:"left",children:t?e.jsx(me,{to:l,children:s.name}):s.name}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Vt,statusNameMapping:Cl})}),e.jsx(_,{align:"left",children:s.totalHouseholdsCount||"0"}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.createdAt})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.updatedAt})}),e.jsx(_,{align:"left",children:s.createdBy})]},s.id)}const RL=T.div`
  .MuiPaper-elevation1 {
    box-shadow: none;
    padding: 0 !important;
  }
`;function FL({filter:s,canViewDetails:t,enableRadioButton:a,selectedTargetPopulation:n,handleChange:i,noTableStyling:r,noTitle:l}){const{t:o}=M(),{selectedProgram:d}=Z(),c=d?.beneficiaryGroup,{businessArea:u,programId:h}=U(),m=A.useMemo(()=>({businessAreaSlug:u,programSlug:h,name:s.name,totalHouseholdsCountMin:s.totalHouseholdsCountMin||null,totalHouseholdsCountMax:s.totalHouseholdsCountMax||null,status:s.status,businessArea:u,program:h,createdAtRange:JSON.stringify({min:Yt(s.createdAtRangeMin,"startOfDay"),max:Yt(s.createdAtRangeMax,"endOfDay")})}),[u,h,s.name,s.totalHouseholdsCountMin,s.totalHouseholdsCountMax,s.status,s.createdAtRangeMin,s.createdAtRangeMax]),g=w=>{i(w)},[x,f]=A.useState(0),[j,y]=A.useState(m);A.useEffect(()=>{y(m)},[m]);const{data:b}=V({queryKey:["businessAreasProgramsTargetPopulationsCount",j,u,h],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsCountRetrieve(Ce({businessAreaSlug:u,programSlug:h},j)),enabled:x===0}),C=vs(x,b),{data:v,isLoading:S,error:I}=V({queryKey:["businessAreasProgramsTargetPopulationsList",j,u,h,x],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsList(Ce({businessAreaSlug:u,programSlug:h},{...j,offset:x*10},{withPagination:!0}))}),D=$s(DL,c,{total_households_count:w=>`Num. of ${w?.groupLabelPlural}`}),F=()=>e.jsx(Es,{children:e.jsx(ds,{title:l?null:o("Target Populations"),headCells:a?D:D.slice(1),rowsPerPageOptions:[10,15,20],defaultOrderBy:"createdAt",defaultOrderDirection:"desc",queryVariables:j,setQueryVariables:y,data:v,isLoading:S,error:I,renderRow:w=>e.jsx(TL,{radioChangeHandler:a&&g,selectedTargetPopulation:n,targetPopulation:w,canViewDetails:t},w.id),page:x,setPage:f,itemsCount:C})});return r?e.jsx(RL,{children:F()}):F()}const NL=({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})=>{const{t:r}=M(),l=ge(),o=je(),d=o.pathname.includes("accountability"),{handleFilterChange:c,applyFilterChanges:u,clearFilter:h}=Ss(a,l,o,s,t,n,i),m=()=>{u()},g=()=>{h()},x=["ASSIGNED",te.TP_OPEN,te.TP_LOCKED,te.PROCESSING,te.STEFICON_RUN,te.STEFICON_WAIT,te.STEFICON_COMPLETED,te.STEFICON_ERROR],{data:f}=V({queryKey:["choicesPaymentPlanStatusList"],queryFn:()=>N.restChoicesPaymentPlanStatusList()}),j=[{name:"Assigned",value:"ASSIGNED"},...f||[]].filter(y=>x.includes(y.value)).filter(y=>!d||y.value!=="OPEN");return e.jsx(Ns,{clearHandler:g,applyHandler:m,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:3,children:e.jsx(Cs,{label:r("Search"),value:s.name,onChange:y=>c("name",y.target.value),"data-cy":"filters-search",fullWidth:!0})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:y=>c("status",y.target.value),value:s.status,label:r("Status"),icon:e.jsx(Wa,{}),fullWidth:!0,"data-cy":"filters-status",children:j.map(y=>e.jsx(de,{value:y.value,children:y.name},y.value))})}),e.jsx(p,{size:3,children:e.jsx(js,{topLabel:r("Number of People"),value:s.totalHouseholdsCountMin,placeholder:r("From"),onChange:y=>c("totalHouseholdsCountMin",y.target.value),icon:e.jsx(ct,{}),"data-cy":"filters-total-households-count-min"})}),e.jsx(p,{size:3,children:e.jsx(js,{value:s.totalHouseholdsCountMax,placeholder:r("To"),onChange:y=>c("totalHouseholdsCountMax",y.target.value),icon:e.jsx(ct,{}),"data-cy":"filters-total-households-count-max"})}),e.jsx(p,{size:3,children:e.jsx(ms,{topLabel:r("Date Created"),placeholder:r("From"),onChange:y=>c("createdAtRangeMin",y),value:s.createdAtRangeMin})}),e.jsx(p,{size:3,children:e.jsx(ms,{placeholder:r("To"),onChange:y=>c("createdAtRangeMax",y),value:s.createdAtRangeMax})})]})})},Vr={name:"",status:"",totalHouseholdsCountGte:"",totalHouseholdsCountLte:"",createdAtGte:"",createdAtLte:""},LL=()=>{const s=je(),{t}=M(),a=ve(),{isSocialDctType:n}=Z(),[i,r]=A.useState(Ke(s,Vr)),[l,o]=A.useState(Ke(s,Vr)),[d,c]=A.useState(!1),u=A.useRef(null);et(u,d,l,()=>c(!1));const[h,m]=A.useState(!1),g=K(R.TARGETING_CREATE,a);if(!a)return null;if(!K(R.TARGETING_VIEW_LIST,a))return e.jsx(Xe,{permission:R.TARGETING_VIEW_LIST});let x=SL,f=hL;return n&&(x=FL,f=NL),e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:t("Targeting"),children:e.jsxs(e.Fragment,{children:[e.jsx(Ve,{onClick:()=>m(!0),color:"primary","aria-label":"Targeting Information","data-cy":"button-target-population-info",children:e.jsx(dn,{})}),e.jsx(PL,{open:h,setOpen:m}),g&&e.jsx(IL,{})]})}),e.jsx(f,{filter:i,setFilter:r,initialFilter:Vr,appliedFilter:l,setAppliedFilter:j=>{o(j),c(!0)}}),e.jsx(P,{ref:u,children:e.jsx(x,{filter:l,canViewDetails:K(R.TARGETING_VIEW_DETAILS,a)})})]})},OL=oe(LL,"TargetPopulationsPage"),kL=()=>oa([{path:"target-population",element:e.jsx(OL,{})},{path:"target-population/create",element:e.jsx(CN,{})},{path:"target-population/edit-tp/:id",element:e.jsx(TN,{})},{path:"target-population/:id",element:e.jsx(uL,{})}]),nc=[{disablePadding:!1,label:"",id:"radio",numeric:!1,dataCy:"radio-id"},{disablePadding:!1,label:"Name",id:"name",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Num. of Households",id:"final_list_total_households",numeric:!1},{disablePadding:!1,label:"Date Created",id:"created_at",numeric:!1},{disablePadding:!1,label:"Last Edited",id:"updated_at",numeric:!1},{disablePadding:!1,label:"Created by",id:"created_by",numeric:!1}];function wL({targetPopulation:s,canViewDetails:t,radioChangeHandler:a,selectedTargetPopulation:n}){const i=ge(),{baseUrl:r}=U(),l=`/${r}/target-population/${s.id}`,o=()=>{a!==void 0?a(s.id):i(l)};return e.jsxs(rs,{hover:!0,onClick:t?o:void 0,role:"checkbox",children:[a&&e.jsx(_,{padding:"checkbox",children:e.jsx(kt,{color:"primary",checked:n===s.id,onChange:()=>{a(s.id)},value:s.id,name:"radio-button-household",slotProps:{input:{"aria-label":s.id}}})}),e.jsx(_,{align:"left",children:t?e.jsx(me,{to:l,children:s.name}):s.name}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Vt,statusNameMapping:$i})}),e.jsx(_,{align:"left",children:s.totalHouseholdsCount||"-"}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.createdAt})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.updatedAt})}),e.jsx(_,{align:"left",children:s.createdBy})]},s.id)}const ML=T.div`
  .MuiPaper-elevation1 {
    box-shadow: none;
    padding: 0 !important;
  }
`;function $L({filter:s,canViewDetails:t,enableRadioButton:a,selectedTargetPopulation:n,handleChange:i,noTableStyling:r,noTitle:l}){const{t:o}=M(),{businessArea:d,programId:c}=U(),[u,h]=A.useState(0),m=A.useMemo(()=>({totalHouseholdsCountWithValidPhoneNoMin:s.totalHouseholdsCountMin||0,totalHouseholdsCountWithValidPhoneNoMax:s.totalHouseholdsCountMax||null,status:s.status,businessArea:d,createdAtRange:JSON.stringify({min:s.createdAtRangeMin||null,max:s.createdAtRangeMax||null}),statusNot:te.OPEN,isTargetPopulation:!0,businessAreaSlug:d,programSlug:c,page:u}),[s.totalHouseholdsCountMin,s.totalHouseholdsCountMax,s.status,d,s.createdAtRangeMin,s.createdAtRangeMax,c,u]),[g,x]=A.useState(m);A.useEffect(()=>{x(m)},[m]);const{data:f,isLoading:j,error:y}=V({queryKey:["businessAreasProgramsTargetPopulationsList",g,d,c],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsList(Ce({businessAreaSlug:d,programSlug:c},g,{withPagination:!0}))}),{data:b}=V({queryKey:["businessAreasProgramsTargetPopulationsCount",g,d,c],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsCountRetrieve(Ce({businessAreaSlug:d,programSlug:c},g)),enabled:u===0}),C=vs(u,b),v=I=>{i(I)},S=()=>e.jsx(Es,{children:e.jsx(ds,{title:l?null:o("Target Populations"),headCells:a?nc:nc.slice(1),rowsPerPageOptions:[10,15,20],defaultOrderBy:"createdAt",defaultOrderDirection:"desc",data:f,isLoading:j,error:y,queryVariables:g,setQueryVariables:x,itemsCount:C,page:u,setPage:h,renderRow:I=>e.jsx(wL,{radioChangeHandler:a&&v,selectedTargetPopulation:n,targetPopulation:I,canViewDetails:t},I.id)})});return r?e.jsx(ML,{children:S()}):S()}const UL=({selectedTab:s,values:t,filtersTargetPopulationApplied:a,handleChange:n})=>{const i=ve();return e.jsx(e.Fragment,{children:s===nn.TARGET_POPULATION&&e.jsx($L,{filter:a,canViewDetails:K(R.TARGETING_VIEW_DETAILS,i),enableRadioButton:!0,selectedTargetPopulation:t.targetPopulation,handleChange:r=>{n(nn.TARGET_POPULATION,r)},noTableStyling:!0,noTitle:!0})})},VL=oe(UL,"LookUpSelectionTablesSurveys");function BL({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i}){const{t:r}=M(),l=ge(),o=je(),d=o.pathname.includes("accountability"),{selectedProgram:c}=Z(),u=c?.beneficiaryGroup,{handleFilterChange:h,applyFilterChanges:m,clearFilter:g}=Ss(a,l,o,s,t,n,i),x=()=>{m()},f=()=>{g()},j=d?Object.values(te).filter(y=>y!=="OPEN"):Object.values(te);return e.jsx(Ns,{clearHandler:f,applyHandler:x,isOnPaper:!1,children:e.jsxs(p,{container:!0,spacing:3,sx:{alignItems:"flex-end"},children:[e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{label:r("Search"),value:s.name,onChange:y=>h("name",y.target.value),"data-cy":"filters-search",fullWidth:!0})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:y=>h("status",y.target.value),value:s.status,label:r("Status"),icon:e.jsx(Wa,{}),fullWidth:!0,"data-cy":"filters-status",children:j.sort().map(y=>e.jsx(de,{value:y,children:$i(y)},y))})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{topLabel:r(`Number of ${u?.groupLabelPlural}`),value:s.totalHouseholdsCountMin,placeholder:r("From"),onChange:y=>h("totalHouseholdsCountMin",y.target.value),icon:e.jsx(ct,{}),"data-cy":"filters-total-households-count-min"})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{value:s.totalHouseholdsCountMax,placeholder:r("To"),onChange:y=>h("totalHouseholdsCountMax",y.target.value),icon:e.jsx(ct,{}),"data-cy":"filters-total-households-count-max"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{topLabel:r("Date Created"),placeholder:r("From"),onChange:y=>h("createdAtRangeMin",y),value:s.createdAtRangeMin,dataCy:"filters-creation-date-from"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{placeholder:r("To"),onChange:y=>h("createdAtRangeMax",y),value:s.createdAtRangeMax,dataCy:"filters-creation-date-to"})})]})})}const GL=oe(BL,"LookUpTargetPopulationFiltersSurveys"),zL=["Whole Program Population","Target Population"],qL=T(P)`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
  padding: 15px 0;
`;function Rh({setValues:s,values:t,selectedTab:a,setSelectedTab:n}){const i=je(),r={name:"",status:"",totalHouseholdsCountMin:"",totalHouseholdsCountMax:"",createdAtRangeMin:void 0,createdAtRangeMax:void 0},[l,o]=A.useState(Ke(i,r)),[d,c]=A.useState(Ke(i,r)),{t:u}=M(),h=(m,g)=>{s({...t,targetPopulation:m===nn.TARGET_POPULATION&&typeof g=="string"?g:""})};return e.jsxs(P,{children:[e.jsxs(qL,{p:4,m:4,display:"flex",alignItems:"center",bgcolor:"#F5F5F5",children:[e.jsx(P,{pl:5,pr:5,fontWeight:"500",fontSize:"medium",children:u("Look up for")}),e.jsx(wn,{"aria-labelledby":"selection-radio-buttons-group",value:a??0,onChange:m=>{n(Number(m.target.value))},row:!0,name:"radio-buttons-group",children:zL.map((m,g)=>e.jsx(sa,{value:g,control:e.jsx(kt,{color:"primary"}),label:m},m))})]}),e.jsx(P,{p:4,mt:4,children:e.jsxs(P,{children:[a===nn.WHOLE_PROGRAM_POPULATION&&e.jsx(P,{children:u("Using whole program population for survey recipients")}),a===nn.TARGET_POPULATION&&e.jsx(GL,{filter:l,setFilter:o,initialFilter:r,appliedFilter:d,setAppliedFilter:c})]})}),e.jsx(VL,{selectedTab:a,filtersTargetPopulationApplied:d,values:t,handleChange:h})]})}oe(Rh,"LookUpSelectionSurveys");var Mt=(s=>(s.MANUAL="MANUAL",s.RAPID_PRO="RAPID_PRO",s.SMS="SMS",s))(Mt||{});const Br=["Recipients Look up","Sample Size","Details"],HL=["Full List","Random Sampling"],WL=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
`;function KL(s,t){return{value:t.program,paymentPlan:t.targetPopulation,samplingType:s===0?Yr.FULL_LIST:Yr.RANDOM,fullListArguments:s===0?{excludedAdminAreas:t.excludedAdminAreasFull||[]}:void 0,randomSamplingArguments:s===1?{confidenceInterval:t.confidenceInterval*.01,marginOfError:t.marginOfError*.01,excludedAdminAreas:t.adminCheckbox?t.excludedAdminAreasRandom:[],age:t.ageCheckbox?{min:t.filterAgeMin,max:t.filterAgeMax}:null,sex:t.sexCheckbox?t.filterSex:null}:void 0}}const YL=()=>{const{t:s}=M(),t=ge(),{mutateAsync:a,isPending:n}=xe({mutationFn:({businessAreaSlug:he,programSlug:Re,requestBody:Me})=>N.restBusinessAreasProgramsSurveysCreate({businessAreaSlug:he,programSlug:Re,requestBody:Me})}),{showMessage:i}=Ae(),{baseUrl:r,businessArea:l,programId:o}=U(),d=ve(),c=Nt(),{pathname:u}=location,h=u.split("/"),m=h.indexOf("create")+1,g=h[m],[x,f]=A.useState(g);A.useEffect(()=>{f(g)},[x,u,g]);const j={category:x,message:"",program:o,targetPopulation:"",confidenceInterval:95,marginOfError:5,filterAgeMin:null,filterAgeMax:null,filterSex:"",excludedAdminAreasFull:[],excludedAdminAreasRandom:[],adminCheckbox:!1,ageCheckbox:!1,sexCheckbox:!1,title:"",samplingType:"FULL_LIST"},[y,b]=A.useState(wa.LookUp),[C,v]=A.useState(nn.WHOLE_PROGRAM_POPULATION),[S,I]=A.useState(0),[E,D]=A.useState(j),[F,w]=A.useState(!1),{data:O,isLoading:k}=V({queryKey:["adminAreas",l,{level:2}],queryFn:async()=>N.restBusinessAreasGeoAreasList({businessAreaSlug:l,level:2}),enabled:!!l}),[$,G]=A.useState(null),[W,Y]=A.useState(!1),[X,J]=A.useState(null),ae=A.useCallback(async()=>{if(!(!l||!o))try{Y(!0),J(null);const he=KL(S,E),Re=await N.restBusinessAreasProgramsSurveysSampleSizeCreate({businessAreaSlug:l,programSlug:o,requestBody:he});G(Re)}catch(he){console.error("Error loading sample size data:",he),J(he)}finally{Y(!1)}},[l,o,S,E]),[re,se]=A.useState(null),[le,ce]=A.useState(!1),[_e,ne]=A.useState(null),Ue=A.useCallback(async()=>{if(!(!l||!o))try{ce(!0);const he=await N.restBusinessAreasProgramsSurveysAvailableFlowsList({businessAreaSlug:l,programSlug:o});se({surveyAvailableFlows:he})}catch(he){console.error("Error loading available flows:",he),ne(he)}finally{ce(!1)}},[l,o]);A.useEffect(()=>{x===Mt.RAPID_PRO&&Ue()},[x,Ue]),A.useEffect(()=>{y===wa.SampleSize&&ae()},[y,E,ae]);const Te=A.useCallback(()=>{const he={title:Q.string(),body:Q.string()};return y===wa.Details&&(he.title=Q.string().min(4,s("Too short")).max(255,s("Too long")).required(s("Title is required")),x==="SMS"&&(he.body=Q.string().min(4,s("Too short")).max(255,s("Too long")).required(s("Message is required")))),w(!0),Q.object().shape(he)},[y,s,x]);if(A.useEffect(()=>{(re?.surveyAvailableFlows===null||_e)&&!le&&t(`/error/${l}`,{state:{errorMessage:s("RapidPro is not set up in your country, please contact your Roll Out Focal Point"),lastSuccessfulPage:`/${r}/accountability/surveys`}})},[re,x,l,t,s,r,_e,le]),d===null||!O)return null;if(!K(R.ACCOUNTABILITY_SURVEY_VIEW_CREATE,d))return e.jsx(Xe,{permission:R.ACCOUNTABILITY_SURVEY_VIEW_CREATE});if(k||le)return e.jsx(Ne,{});const ie=he=>{const{program:Re,targetPopulation:Me}=he,ps={};return!Me&&!Re&&(ps.error=s("Field Selection is required")),ps},Pe=O?.length?O.map(he=>({value:he.id,name:he.name||""})):[],ue=re?.surveyAvailableFlows?.length?re.surveyAvailableFlows.map(he=>({value:he.id,name:he.name})):[],Ge=()=>{if(!$)return"(0%)";const he=$.sample_size||$.sampleSize||$.numberOfSamples||0,Re=$.number_of_recipients||$.numberOfRecipients||$.total||0;return`(${Mi(he,Re)})`},ls=[{title:s("Surveys"),to:`/${r}/accountability/surveys`}],qe=()=>{b(he=>he+1),w(!1)},xs=()=>{b(he=>he-1)},Oe=he=>x===Mt.SMS||x===Mt.MANUAL?he.title:re?.surveyAvailableFlows.find(Re=>he.title===Re.id).id,es=he=>({input:{title:Oe(he),body:he.body,category:he.category,paymentPlan:he.targetPopulation,program:he.program,samplingType:S===0?"FULL_LIST":"RANDOM",fullListArguments:S===0?{excludedAdminAreas:he.excludedAdminAreasFull}:null,randomSamplingArguments:S===1?{excludedAdminAreas:he.excludedAdminAreasRandom,confidenceInterval:he.confidenceInterval*.01,marginOfError:he.marginOfError*.01,age:he.ageCheckbox?{min:he.filterAgeMin,max:he.filterAgeMax}:null,sex:he.sexCheckbox?he.filterSex:null}:null,flow:he.title}}),ye=he=>["error"].map(Re=>e.jsx(Ls,{error:!0,children:he[Re]},Re)),as=he=>{switch(he){case Mt.SMS:return s("SMS");case Mt.RAPID_PRO:return s("Rapid Pro");case Mt.MANUAL:return s("Manual");default:return""}};return e.jsx(e.Fragment,{children:e.jsx(B.Formik,{initialValues:j,validationSchema:Te,validate:he=>ie(he),validateOnBlur:F,validateOnChange:F,onSubmit:he=>{y===Br.length-1?c({title:s("Confirmation"),content:x===Mt.MANUAL?s("Are you sure you want to save this survey?"):s("Are you sure you want to send this survey?"),continueText:x===Mt.MANUAL?s("Save"):s("Send")}).then(async()=>{let Re;try{const Me=es(he),ps={title:Me.input.title,body:Me.input.body,category:Me.input.category,paymentPlan:Me.input.paymentPlan,program:Me.input.program,samplingType:Me.input.samplingType,fullListArguments:Me.input.fullListArguments,randomSamplingArguments:Me.input.randomSamplingArguments,flow:Me.input.flow};Re=await a({businessAreaSlug:l,programSlug:o,requestBody:ps}),i(s("Survey created."))}catch(Me){fe(Me,i)}finally{Re&&Re.id&&t(`/${r}/accountability/surveys/${Re.id}`)}}):(D(he),qe())},children:({submitForm:he,setValues:Re,values:Me,errors:ps})=>e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`New Survey > ${as(x)}`,breadCrumbs:K(R.ACCOUNTABILITY_SURVEY_VIEW_CREATE,d)?ls:null}),e.jsxs(ft,{children:[e.jsx(p,{size:12,children:e.jsx(Ta,{activeStep:y,children:Br.map(Je=>{const Ts={},It={};return e.jsx(Ra,{...Ts,children:e.jsx(qa,{...It,children:Je})},Je)})})}),e.jsxs(B.Form,{children:[e.jsx(ir,{values:Me,onChange:()=>D(Me)}),y===wa.LookUp&&e.jsx(P,{display:"flex",flexDirection:"column",children:e.jsx(Rh,{values:Me,setValues:Re,selectedTab:C,setSelectedTab:v})}),y===wa.SampleSize&&e.jsxs(P,{px:8,children:[X&&e.jsx(P,{mb:3,children:e.jsxs(ee,{color:"error",children:[s("Error loading sample size data"),":"," ",X.message]})}),e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsxs(P,{pl:5,pr:5,fontWeight:"500",fontSize:"medium",children:[s("Sample Size"),":"]}),e.jsx(wn,{"aria-labelledby":"selection-radio-buttons-group",value:S,row:!0,name:"radio-buttons-group",children:HL.map((Je,Ts)=>e.jsx(sa,{value:Ts,"data-cy":`radio-button-${Je}`,onChange:()=>{D(Me),I(Ts)},control:e.jsx(kt,{color:"primary"}),label:Je},Je))})]}),e.jsx(Qt,{value:S,index:0,children:e.jsxs(P,{pt:6,children:[Pe&&e.jsx(B.Field,{name:"excludedAdminAreasFull",choices:Pe,variant:"outlined",label:s("Filter Out Administrative Level Areas"),component:Ia}),e.jsx(P,{pt:3,children:e.jsxs(P,{pb:3,pt:3,fontSize:16,fontWeight:"fontWeightBold",children:["Sample size:"," ",W?e.jsx("span",{children:s("Loading...")}):e.jsxs(e.Fragment,{children:[$?.sample_size||$?.sampleSize||$?.numberOfSamples||0," ","out of"," ",$?.number_of_recipients||$?.numberOfRecipients||$?.total||0," ",Ge()]})]})})]})}),e.jsx(Qt,{value:S,index:1,children:e.jsxs(P,{pt:3,children:[e.jsx(B.Field,{name:"confidenceInterval",label:s("Confidence Interval"),min:90,max:99,component:Da,suffix:"%"}),e.jsx(B.Field,{name:"marginOfError",label:s("Margin of Error"),min:0,max:9,component:Da,suffix:"%"}),e.jsx(ee,{variant:"caption",children:s("Cluster Filters")}),e.jsxs(P,{flexDirection:"column",display:"flex",children:[e.jsxs(P,{display:"flex",children:[e.jsx(B.Field,{name:"adminCheckbox",label:s("Administrative Level"),component:ws}),e.jsx(B.Field,{name:"ageCheckbox",label:s("Age of HoH"),component:ws}),e.jsx(B.Field,{name:"sexCheckbox",label:s("Gender of HoH"),component:ws})]}),Me.adminCheckbox&&e.jsx(B.Field,{name:"excludedAdminAreasRandom",choices:Pe,variant:"outlined",label:s("Filter Out Administrative Level Areas"),component:Ia}),e.jsxs(p,{container:!0,children:[Me.ageCheckbox&&e.jsx(p,{size:{xs:12},children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:4},children:e.jsx(B.Field,{name:"filterAgeMin",label:s("Minimum Age"),type:"number",color:"primary",component:Se})}),e.jsx(p,{size:{xs:4},children:e.jsx(B.Field,{name:"filterAgeMax",label:s("Maximum Age"),type:"number",color:"primary",component:Se})})]})}),Me.sexCheckbox&&e.jsx(p,{size:{xs:5},children:e.jsx(B.Field,{name:"filterSex",label:s("Gender"),color:"primary",choices:[{value:"FEMALE",name:s("Female")},{value:"MALE",name:s("Male")},{value:"OTHER",name:s("Other")},{value:"NOT_COLLECTED",name:s("Not Collected")},{value:"NOT_ANSWERED",name:s("Not Answered")}],component:We})})]})]}),e.jsxs(P,{pb:3,pt:3,fontSize:16,fontWeight:"fontWeightBold",children:["Sample size:"," ",W?e.jsx("span",{children:s("Loading...")}):e.jsxs(e.Fragment,{children:[$?.sample_size||$?.sampleSize||$?.numberOfSamples||0," ","out of"," ",$?.number_of_recipients||$?.numberOfRecipients||$?.total||0," ",Ge()]})]})]})})]}),y===wa.Details&&e.jsxs(e.Fragment,{children:[e.jsx(WL,{}),e.jsx(P,{my:3,children:e.jsx(p,{size:12,children:x===Mt.RAPID_PRO?e.jsx(B.Field,{name:"title",label:s("Title"),color:"primary",choices:ue,component:We,required:!0,"data-cy":"input-title"}):e.jsx(B.Field,{name:"title",label:s("Title"),fullWidth:!0,required:!0,variant:"outlined",component:Se,"data-cy":"input-title"})})}),x===Mt.SMS&&e.jsx(P,{my:3,children:e.jsx(p,{size:12,children:e.jsx(B.Field,{name:"body",required:!0,multiline:!0,fullWidth:!0,variant:"outlined",label:s("Message"),component:Se,"data-cy":"input-message"})})}),e.jsxs(p,{size:12,children:[e.jsxs(P,{pb:3,pt:3,fontSize:16,fontWeight:"fontWeightBold",children:[s("Number of selected recipients"),":"," ",W?e.jsx("span",{children:s("Loading...")}):$?.sample_size||$?.sampleSize||$?.numberOfSamples||0]}),!W&&($?.excluded_recipients_count||$?.excludedRecipientsCount)&&($.excluded_recipients_count>0||$.excludedRecipientsCount>0)&&e.jsx(P,{mt:1,color:"text.secondary",children:e.jsxs(ee,{variant:"body2",children:[s("Excluded due to missing/invalid phone number"),":"," ",$.excluded_recipients_count||$.excludedRecipientsCount]})})]})]}),ye(ps)]}),e.jsxs(P,{pt:3,display:"flex",flexDirection:"row",children:[e.jsx(P,{mr:3,children:e.jsx(H,{component:ys,"data-cy":"button-cancel",to:`/${r}/accountability/surveys`,children:s("Cancel")})}),e.jsxs(P,{display:"flex",ml:"auto",children:[e.jsx(H,{disabled:y===wa.LookUp,onClick:xs,"data-cy":"button-back",children:s("Back")}),e.jsx(ke,{loading:n,color:"primary",variant:"contained",onClick:he,"data-cy":"button-submit",children:s(y===Br.length-1?s(x===Mt.MANUAL?"Save":"Send"):"Next")})]})]})]})]})})})},QL=oe(YL,"CreateSurveyPage");function XL({survey:s}){const{t}=M(),{baseUrl:a,programId:n}=U(),{selectedProgram:{name:i}}=Z(),{category:r,title:l,createdBy:o,createdAt:d,body:c}=s;return e.jsxs(Fs,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:t("Details")})}),e.jsx(vt,{children:e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("Category"),value:r})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("Survey Title"),value:l})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("Created By"),value:o})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("Date Created"),children:e.jsx(pe,{children:d})})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("Target Population"),children:s?.paymentPlan?e.jsx(me,{to:`/${a}/target-population/${s?.paymentPlan}`,children:s?.paymentPlanName}):"-"})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("Programme"),children:e.jsx(me,{to:`/${a}/programmes/${n}`,children:i})})}),c&&e.jsx(p,{size:{xs:8},children:e.jsx(L,{label:t("Message"),value:c})})]})})]})}const JL=oe(XL,"SurveyDetails"),ZL=[{disablePadding:!1,label:"Household Id",id:"unicefId",numeric:!1,dataCy:"household-id"},{disablePadding:!1,label:"Status",id:"withdrawn",numeric:!1,dataCy:"status"},{disablePadding:!1,label:"Head of Household",id:"head_of_household__full_name",numeric:!1,dataCy:"household-head-name"},{disablePadding:!1,label:"Household Size",id:"size",numeric:!1,dataCy:"household-size"},{disablePadding:!1,label:"Administrative Level 2",id:"admin_area__name",numeric:!1,dataCy:"household-location"},{disablePadding:!1,label:"Residence Status",id:"residenceStatus",numeric:!1,dataCy:"household-residence-status"},{disablePadding:!1,label:"Registration Date",id:"head_of_household__first_registration_date",numeric:!0,dataCy:"household-registration-date"}],eO=({household:s,headOfHousehold:t,canViewDetails:a})=>{const n=ge(),{baseUrl:i}=U(),r=`/${i}/population/household/${s.id}`,l=()=>{n(r)};return e.jsxs(rs,{hover:!0,onClick:a?l:void 0,role:"checkbox",children:[e.jsx(_,{align:"left",children:e.jsx(me,{to:r,children:s.unicefId})}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Un})}),e.jsx(Jt,{children:t.fullName}),e.jsx(_,{align:"left",children:s.size}),e.jsx(_,{align:"left",children:s.admin2?.name||"-"}),e.jsx(_,{align:"left",children:s.residenceStatus}),e.jsx(_,{align:"right",children:e.jsx(pe,{children:s.lastRegistrationDate})})]},s.unicefId)};function sO({id:s,canViewDetails:t}){const{t:a}=M(),{selectedProgram:n}=Z(),i=n?.beneficiaryGroup,{businessAreaSlug:r,programSlug:l}=U(),o=A.useMemo(()=>({businessAreaSlug:r,programSlug:l,surveyId:s}),[r,l,s]),[d,c]=A.useState(o);A.useEffect(()=>{c(o)},[o]);const{data:u,isLoading:h,error:m}=V({queryKey:["businessAreasProgramsHouseholdsAllAccountabilityCommunicationMessageRecipientsList",d],queryFn:()=>N.restBusinessAreasProgramsHouseholdsAllAccountabilityCommunicationMessageRecipientsList(d)}),x=$s(ZL,i,{unicefId:f=>`${f?.groupLabel} ID`,head_of_household__full_name:f=>`Head of ${f?.groupLabel}`,size:f=>`${f?.groupLabel} Size`});return e.jsx(Es,{children:e.jsx(ds,{title:a("Recipients"),headCells:x,data:u,error:m,isLoading:h,queryVariables:d,setQueryVariables:c,rowsPerPageOptions:[10,15,20],itemsCount:u?.results?.length||0,renderRow:f=>e.jsx(eO,{household:f,headOfHousehold:f.headOfHousehold,canViewDetails:t},f.id)})})}const tO=oe(sO,"RecipientsTable");function aO(){const{showMessage:s}=Ae(),{t}=M(),{id:a}=ts(),{baseUrl:n,businessArea:i,programId:r}=U(),{isActiveProgram:l}=Z(),{data:o,isLoading:d,error:c}=mn(a,N.restBusinessAreasProgramsSurveysRetrieve,{}),u=xe({mutationFn:()=>N.restBusinessAreasProgramsSurveysExportSampleRetrieve({businessAreaSlug:i,programSlug:r,id:a})}),h=ve();if(d)return e.jsx(Ne,{});if(rt(c))return e.jsx(Xe,{permission:R.ACCOUNTABILITY_SURVEY_VIEW_DETAILS});if(!o||h===null)return null;const m=o,g=[{title:t("Surveys"),to:`/${n}/accountability/surveys`}],x=async()=>{try{await u.mutateAsync(),s(t("Survey sample exported."))}catch(j){s(j instanceof Error?j.message:"An error occurred")}},f=()=>m.category===Mt.RAPID_PRO?e.jsx(Vs,{variant:"contained",color:"primary",component:ys,to:{pathname:m?.rapidProUrl},target:"_blank",title:t("Programme has to be active to export Survey sample"),disabled:!l,children:t("Check Answers")}):m.category===Mt.MANUAL?m.hasValidSampleFile?e.jsx(H,{download:!0,variant:"contained",color:"primary",href:m.sampleFilePath,children:t("Download Survey Sample")}):e.jsx(H,{variant:"contained",color:"primary",onClick:x,children:t("Export Survey Sample")}):null;return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`${m.unicefId}`,breadCrumbs:K(R.ACCOUNTABILITY_SURVEY_VIEW_DETAILS,h)?g:null,children:f()}),e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(JL,{survey:m}),e.jsx(tO,{canViewDetails:K(R.ACCOUNTABILITY_SURVEY_VIEW_DETAILS,h),id:a}),K(R.ACCOUNTABILITY_SURVEY_VIEW_DETAILS,h)&&e.jsx(Lt,{objectId:a})]})]})}const nO=oe(aO,"SurveyDetailsPage"),iO=ut(bc)(()=>({".MuiPaper-root":{border:"1px solid #d3d4d5"}})),Gr=ut(de)(({theme:s})=>({"&:focus":{backgroundColor:s.palette.primary.main,"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:s.palette.common.white}}}));function rO(){const{t:s}=M(),t=ge(),{baseUrl:a}=U(),[n,i]=A.useState(null),{isActiveProgram:r}=Z(),l=c=>{i(c.currentTarget)},o=()=>{i(null)},d=c=>{t({pathname:`/${a}/accountability/surveys/create/${c}`})};return e.jsxs(e.Fragment,{children:[r?e.jsx(H,{"aria-controls":"customized-menu","aria-haspopup":"true",variant:"contained",color:"primary",onClick:l,endIcon:n?e.jsx(Dn,{}):e.jsx(Tn,{}),"data-cy":"button-new-survey","data-perm":R.ACCOUNTABILITY_SURVEY_VIEW_CREATE,children:s("New Survey")}):e.jsx(Ms,{title:s("Programme has to be active to create a Survey"),children:e.jsx("span",{children:e.jsx(H,{"aria-controls":"customized-menu","aria-haspopup":"true",variant:"contained",color:"primary",onClick:l,endIcon:n?e.jsx(Dn,{}):e.jsx(Tn,{}),"data-cy":"button-new-survey",disabled:!r,"data-perm":`${R.ACCOUNTABILITY_SURVEY_VIEW_CREATE}, ${R.ACCOUNTABILITY_SURVEY_VIEW_LIST}`,children:s("New Survey")})})}),e.jsxs(iO,{id:"customized-menu",anchorEl:n,keepMounted:!0,open:!!n,onClose:o,children:[e.jsx(Gr,{"data-cy":"menu-item-rapid-pro",children:e.jsx(ia,{"data-cy":"menu-item-rapid-pro-text",onClick:()=>d("RAPID_PRO"),primary:s("New Survey with Rapid Pro")})}),e.jsx(Gr,{"data-cy":"menu-item-sms-text",children:e.jsx(ia,{"data-cy":"menu-item-sms-text",onClick:()=>d("SMS"),primary:s("New Survey with SMS")})}),e.jsx(Gr,{"data-cy":"menu-item-manual",children:e.jsx(ia,{"data-cy":"menu-item-manual-text",onClick:()=>d("MANUAL"),primary:s("New Survey with Manual Process")})})]})]})}function lO({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i}){const r=ge(),l=je(),{t:o}=M(),{handleFilterChange:d,applyFilterChanges:c,clearFilter:u}=Ss(a,r,l,s,t,n,i),h=()=>{c()},m=()=>{u()};return e.jsx(Ns,{applyHandler:h,clearHandler:m,children:e.jsxs(p,{container:!0,spacing:3,sx:{alignItems:"center"},children:[e.jsx(p,{size:{xs:4},children:e.jsx(Cs,{value:s.search,label:"Search",onChange:g=>d("search",g.target.value),"data-cy":"filters-search",fullWidth:!0})}),e.jsx(p,{size:{xs:4},children:e.jsx(lr,{name:"targetPopulation",value:s.targetPopulation,filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})}),e.jsx(p,{size:{xs:4},children:e.jsx(Yi,{name:"createdBy",label:o("Created by"),value:s.createdBy,filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i,additionalVariables:{isSurveyCreator:!0}})}),e.jsxs(p,{container:!0,size:{xs:12},spacing:3,sx:{alignItems:"flex-end"},children:[e.jsx(p,{size:{xs:3},children:e.jsx(ms,{topLabel:o("Creation Date"),label:"From",onChange:g=>d("createdAtRangeMin",g),value:s.createdAtRangeMin,dataCy:"filters-creation-date-from"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{label:o("To"),onChange:g=>d("createdAtRangeMax",g),value:s.createdAtRangeMax,dataCy:"filters-creation-date-to"})})]})]})})}const oO=[{disablePadding:!1,label:"Survey ID",id:"unicef_id",numeric:!1},{disablePadding:!1,label:"Survey Title",id:"title",numeric:!1},{disablePadding:!1,label:"Category",id:"category",numeric:!1},{disablePadding:!1,label:"Number of Recipients",id:"number_of_recipients",numeric:!1},{disablePadding:!1,label:"Created by",id:"created_by",numeric:!1},{disablePadding:!1,label:"Creation Date",id:"created_at",numeric:!1}];function dO({survey:s,canViewDetails:t}){const a=ge(),{baseUrl:n}=U(),i=`/${n}/accountability/surveys/${s.id}`,r=()=>{a(i)};return e.jsxs(rs,{hover:!0,onClick:t?r:void 0,role:"checkbox",children:[e.jsx(_,{align:"left",children:t?e.jsx(me,{to:i,children:s.unicefId}):s.unicefId}),e.jsx(_,{align:"left",children:s.title}),e.jsx(_,{align:"left",children:s.category}),e.jsx(_,{align:"left",children:s.numberOfRecipients||"N/A"}),e.jsx(_,{align:"left",children:s.createdBy}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.createdAt})})]},s.unicefId)}function cO({filter:s,canViewDetails:t}){const{programId:a,baseUrl:n}=U(),{t:i}=M(),r=n.split("/")[0],[l,o]=A.useState(0),d=A.useMemo(()=>({businessAreaSlug:r,programSlug:a,search:s.search,paymentPlan:s.targetPopulation||"",createdBy:s.createdBy||"",createdAtRange:JSON.stringify({min:Yt(s.createdAtRangeMin,"startOfDay"),max:Yt(s.createdAtRangeMax,"endOfDay")}),ordering:"-created_at",page:l}),[r,a,s.search,s.targetPopulation,s.createdBy,s.createdAtRangeMin,s.createdAtRangeMax,l]),[c,u]=A.useState(d);A.useEffect(()=>{u(d)},[d]);const{data:h,isLoading:m,error:g}=V({queryKey:["businessAreasProgramsSurveysList",c],queryFn:()=>N.restBusinessAreasProgramsSurveysList(Ce({businessAreaSlug:c.businessAreaSlug,programSlug:c.programSlug},c,{withPagination:!0})),enabled:!!c.businessAreaSlug&&!!c.programSlug}),{data:x}=V({queryKey:["businessAreasProgramsSurveysCount",r,a,c],queryFn:()=>N.restBusinessAreasProgramsSurveysCountRetrieve(Ce({businessAreaSlug:c.businessAreaSlug,programSlug:c.programSlug},c)),enabled:l===0}),f=vs(l,x);return e.jsx(Es,{children:e.jsx(ds,{headCells:oO,title:i("Surveys List"),data:h,isLoading:m,error:g,queryVariables:c,setQueryVariables:u,defaultOrderBy:"created_at",defaultOrderDirection:"desc",itemsCount:f,initialRowsPerPage:10,page:l,setPage:o,renderRow:j=>e.jsx(dO,{survey:j,canViewDetails:t},j.id)})})}const uO=oe(cO,"SurveysTable");function hO(){const s=ve(),t=je(),{t:a}=M(),n={search:"",targetPopulation:"",createdBy:"",createdAtRangeMin:"",createdAtRangeMax:""},[i,r]=A.useState(Ke(t,n)),[l,o]=A.useState(Ke(t,n)),[d,c]=A.useState(!1),u=A.useRef(null);if(et(u,d,l,()=>c(!1)),s===null)return null;if(!K(R.ACCOUNTABILITY_SURVEY_VIEW_LIST,s))return e.jsx(Xe,{permission:R.ACCOUNTABILITY_SURVEY_VIEW_LIST});const h=K(R.ACCOUNTABILITY_SURVEY_VIEW_DETAILS,s);return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:a("Surveys"),children:e.jsx(rO,{})}),e.jsx(lO,{filter:i,setFilter:r,initialFilter:n,appliedFilter:l,setAppliedFilter:m=>{o(m),c(!0)}}),e.jsx("div",{ref:u,children:e.jsx(uO,{filter:l,canViewDetails:h})})]})}const mO=oe(hO,"SurveysPage");function pO({filter:s,choicesData:t,setFilter:a,initialFilter:n,appliedFilter:i,setAppliedFilter:r}){const{t:l}=M(),o=ge(),d=je(),{selectedProgram:c}=Z(),u=c?.beneficiaryGroup,{handleFilterChange:h,applyFilterChanges:m,clearFilter:g}=Ss(n,o,d,s,a,i,r),x=()=>{m()},f=()=>{g()},j=Oc(u);return e.jsx(Ns,{applyHandler:x,clearHandler:f,isOnPaper:!1,children:e.jsxs(p,{container:!0,spacing:3,sx:{alignItems:"flex-end"},children:[e.jsx(p,{size:3,children:e.jsx(Cs,{label:l("Search"),value:s.search,fullWidth:!0,onChange:y=>h("search",y.target.value),"data-cy":"hh-filters-search"})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:y=>h("residenceStatus",y.target.value),label:l("Residence Status"),fullWidth:!0,value:s.residenceStatus,icon:e.jsx(gc,{}),"data-cy":"hh-filters-residence-status",children:t.residenceStatusChoices?.map(y=>e.jsx(de,{value:y.value,children:y.name},y.value))})}),e.jsx(p,{size:3,children:e.jsx(ua,{name:"admin2",level:2,value:s.admin2,filter:s,setFilter:a,initialFilter:n,appliedFilter:i,setAppliedFilter:r,dataCy:"hh-filters-admin2"})}),e.jsx(p,{size:3,children:e.jsx(js,{topLabel:`${u?.groupLabel} Size`,value:s.householdSizeMin,placeholder:l("From"),icon:e.jsx(ct,{}),fullWidth:!0,onChange:y=>h("householdSizeMin",y.target.value),"data-cy":"hh-filters-household-size-from"})}),e.jsx(p,{size:3,children:e.jsx(js,{value:s.householdSizeMax,placeholder:l("To"),icon:e.jsx(ct,{}),fullWidth:!0,onChange:y=>h("householdSizeMax",y.target.value),"data-cy":"hh-filters-household-size-to"})}),e.jsx(p,{size:3,children:e.jsx(He,{onChange:y=>h("orderBy",y.target.value),label:l("Sort by"),value:s.orderBy,"data-cy":"hh-filters-order-by",children:j.map(y=>e.jsx(de,{value:y.value,children:y.name},y.value))})}),e.jsx(p,{size:3,children:e.jsxs(He,{onChange:y=>h("withdrawn",y.target.value),label:l("Status"),value:s.withdrawn,"data-cy":"hh-filters-status",children:[e.jsx(de,{value:"null",children:"All"},"all"),e.jsx(de,{value:"false",children:"Active"},"active"),e.jsx(de,{value:"true",children:"Withdrawn"},"inactive")]})})]})})}function gO({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i}){const r=ge(),l=je(),{handleFilterChange:o,applyFilterChanges:d,clearFilter:c}=Ss(a,r,l,s,t,n,i),u=()=>{d()},h=()=>{c()},{t:m}=M();return e.jsx(Ns,{clearHandler:h,applyHandler:u,isOnPaper:!1,children:e.jsxs(p,{container:!0,spacing:3,sx:{alignItems:"flex-end"},children:[e.jsx(p,{size:{xs:4},children:e.jsx(Cs,{label:m("Search"),value:s.search,onChange:g=>o("search",g.target.value),"data-cy":"filter-search"})}),e.jsx(p,{size:{xs:4},children:e.jsx(Bn,{name:"importedBy",label:m("Imported By"),filter:s,value:s.importedBy,"data-cy":"filter-imported-by",setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{topLabel:m("Num. of Recipients"),value:s.totalHouseholdsCountWithValidPhoneNoMin,placeholder:"From",icon:e.jsx(ct,{}),onChange:g=>o("totalHouseholdsCountWithValidPhoneNoMin",g.target.value),"data-cy":"filter-size-min"})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{value:s.totalHouseholdsCountWithValidPhoneNoMax,placeholder:"To",icon:e.jsx(ct,{}),onChange:g=>o("totalHouseholdsCountWithValidPhoneNoMax",g.target.value),"data-cy":"filter-size-max"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{topLabel:m("Import Date"),placeholder:m("From"),onChange:g=>o("importDateRangeMin",g),value:s.importDateRangeMin,dataCy:"filter-import-date-range-min"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{placeholder:m("To"),onChange:g=>o("importDateRangeMax",g),value:s.importDateRangeMax,dataCy:"filter-import-date-range-max"})})]})})}const xO=[{disablePadding:!1,label:"",id:"radio",numeric:!1,dataCy:"radio-id"},{disablePadding:!1,label:"Household ID",id:"unicefId",numeric:!1,dataCy:"household-id"},{disablePadding:!1,label:"Head of Household",id:"head_of_household__full_name",numeric:!1,dataCy:"household-full-name"},{disablePadding:!1,label:"Household Size",id:"size",numeric:!1,dataCy:"household-size"},{disablePadding:!1,label:"Administrative Level 2",id:"admin_area__name",numeric:!1,dataCy:"household-admin-level-2"},{disablePadding:!1,label:"Registration Date",id:"last_registration_date",numeric:!1,dataCy:"household-last-registration-date"}];function fO({household:s,radioChangeHandler:t,selectedHousehold:a,checkboxClickHandler:n,selected:i,householdMultiSelect:r,redirectedFromRelatedTicket:l,isFeedbackWithHouseholdOnly:o}){const d=Bi(),u=(g=>i.includes(g))(s.id),h=g=>{g.preventDefault(),r?n(g,s.id):t(s)},m=l||o||!1;return e.jsxs(rs,{onClick:g=>{l||o||h(g)},hover:!0,role:"checkbox","data-cy":"household-table-row",children:[e.jsx(_,{padding:"checkbox",children:r?e.jsx(ns,{color:"primary",onClick:g=>n(g,s.id),checked:u,"data-cy":"input-checkbox-household",slotProps:{input:{"aria-labelledby":s.id}},disabled:m}):e.jsx(kt,{color:"primary",checked:a?.id===s.id,onChange:()=>{t(s)},value:s.id,name:"radio-button-household",slotProps:{input:{"aria-label":s.id}},"data-cy":"input-radio-household",disabled:m})}),e.jsx(_,{align:"left",children:e.jsx(me,{to:`/${d}/population/household/${s.id}`,children:s.unicefId})}),e.jsx(_,{align:"left",children:s.headOfHousehold}),e.jsx(_,{align:"left",children:s.size}),e.jsx(_,{align:"left",children:s?.admin2?.name||"-"}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.lastRegistrationDate})})]},s.id)}const yO=T.div`
  .MuiPaper-elevation1 {
    box-shadow: none;
    padding: 0 !important;
  }
`;function bO({businessArea:s,filter:t,choicesData:a,setFieldValue:n,selectedHousehold:i,setSelectedIndividual:r,setSelectedHousehold:l,noTableStyling:o=!1,householdMultiSelect:d,redirectedFromRelatedTicket:c,isFeedbackWithHouseholdOnly:u}){const{programId:h}=U(),{selectedProgram:m}=Z(),g=m?.beneficiaryGroup,x=A.useMemo(()=>{const G=()=>{if(t.withdrawn==="true")return!0;if(t.withdrawn==="false")return!1};return{businessAreaSlug:s,programSlug:h,familySize:JSON.stringify({before:t.householdSizeMin,after:t.householdSizeMax}),search:t.search.trim(),documentType:t.documentType,documentNumber:t.documentNumber.trim(),admin2:t.admin2,residenceStatus:t.residenceStatus,withdrawn:G(),orderBy:t.orderBy,headOfHouseholdPhoneNoValid:!0}},[s,h,t.householdSizeMin,t.householdSizeMax,t.search,t.documentType,t.documentNumber,t.admin2,t.residenceStatus,t.withdrawn,t.orderBy]),[f,j]=A.useState(x);A.useEffect(()=>{j(x)},[x]);const[y,b]=A.useState(0),{data:C,isLoading:v,error:S}=V({queryKey:["businessAreasProgramsHouseholdsList",f,s,h],queryFn:()=>N.restBusinessAreasProgramsHouseholdsList(Ce({businessAreaSlug:s,programSlug:h},f,{withPagination:!0}))}),[I,E]=A.useState(d?[...i]:[i]),D=(G,W)=>{const Y=I.indexOf(W),X=[...I];Y===-1?X.push(W):X.splice(Y,1),r===void 0&&d&&l(X),E(X)},F=(G,W)=>{G.preventDefault();let Y=[];I.length?E([]):(Y=W.map(X=>X.id),E(Y)),r===void 0&&d&&l(Y)},w=G=>{l(G),n("selectedHousehold",G),n("selectedIndividual",null),r!==void 0&&r(null),n("identityVerified",!1)},k=$s(xO,g,{unicefId:G=>`${G?.groupLabel} ID`,head_of_household__full_name:G=>`Head of ${G?.groupLabel}`,size:G=>`${G?.groupLabel} Size`}),$=()=>e.jsx(ds,{renderRow:G=>e.jsx(fO,{household:G,radioChangeHandler:w,selectedHousehold:i,choicesData:a,checkboxClickHandler:D,selected:I,householdMultiSelect:d,redirectedFromRelatedTicket:c,isFeedbackWithHouseholdOnly:u},G.id),headCells:d?k.slice(1):k,allowSort:!1,onSelectAllClick:d&&F,numSelected:d&&I.length,queryVariables:f,setQueryVariables:j,data:C,isLoading:v,error:S,page:y,setPage:b});return o?e.jsx(yO,{children:$()}):e.jsx(Es,{children:$()})}const jO=oe(bO,"LookUpHouseholdTableCommunication"),ic=[{disablePadding:!1,label:"",id:"radio",numeric:!1,dataCy:"radio-id"},{disablePadding:!1,label:"Name",id:"name",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Programme",id:"program__id",numeric:!1},{disablePadding:!1,label:"Num. of Recipients",id:"final_list_total_households",numeric:!1},{disablePadding:!1,label:"Date Created",id:"created_at",numeric:!1},{disablePadding:!1,label:"Last Edited",id:"updated_at",numeric:!1},{disablePadding:!1,label:"Created by",id:"created_by",numeric:!1}];function AO({targetPopulation:s,canViewDetails:t,radioChangeHandler:a,selectedTargetPopulation:n}){const i=ge(),{businessArea:r}=U(),l=`/${r}/target-population/${s.id}`,o=()=>{a!==void 0?a(s.id):i(l)};return e.jsxs(rs,{hover:!0,onClick:t?o:void 0,role:"checkbox",children:[a&&e.jsx(_,{padding:"checkbox",children:e.jsx(kt,{color:"primary",checked:n===s.id,onChange:()=>{a(s.id)},value:s.id,name:"radio-button-household",slotProps:{input:{"aria-label":s.id}}})}),e.jsx(_,{align:"left",children:t?e.jsx(me,{to:l,children:s.name}):s.name}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Vt,statusNameMapping:$i})}),e.jsx(_,{align:"left",children:"-"}),e.jsx(_,{align:"left",children:s.totalHouseholdsCount||0}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.createdAt})}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.updatedAt})}),e.jsx(_,{align:"left",children:s.createdBy||"-"})]},s.id)}const _O=T.div`
  .MuiPaper-elevation1 {
    box-shadow: none;
    padding: 0 !important;
  }
`,PO=({filter:s,canViewDetails:t,enableRadioButton:a,selectedTargetPopulation:n,handleChange:i,noTableStyling:r,noTitle:l})=>{const{t:o}=M(),{businessArea:d,programId:c}=U(),u=A.useMemo(()=>({totalHouseholdsCountWithValidPhoneNoMin:s.totalHouseholdsCountWithValidPhoneNoMin||0,totalHouseholdsCountWithValidPhoneNoMax:s.totalHouseholdsCountWithValidPhoneNoMax||null,status:s.status,businessArea:d,createdAtRange:JSON.stringify({min:s.createdAtRangeMin||null,max:s.createdAtRangeMax||null}),statusNot:te.OPEN,isTargetPopulation:!0,businessAreaSlug:d,programSlug:c}),[s.totalHouseholdsCountWithValidPhoneNoMin,s.totalHouseholdsCountWithValidPhoneNoMax,s.status,d,s.createdAtRangeMin,s.createdAtRangeMax,c]),[h,m]=A.useState(u);A.useEffect(()=>{m(u)},[u]);const[g,x]=A.useState(0),{data:f,isLoading:j,error:y}=V({queryKey:["businessAreasProgramsTargetPopulationsList",h,d,c],queryFn:()=>N.restBusinessAreasProgramsTargetPopulationsList(Ce({businessAreaSlug:d,programSlug:c},h,{withPagination:!0}))}),b=v=>{i(v)},C=()=>e.jsx(Es,{children:e.jsx(ds,{title:l?null:o("Target Populations"),headCells:a?ic:ic.slice(1),rowsPerPageOptions:[10,15,20],defaultOrderBy:"createdAt",defaultOrderDirection:"desc",data:f,isLoading:j,error:y,queryVariables:h,setQueryVariables:m,page:g,setPage:x,renderRow:v=>e.jsx(AO,{radioChangeHandler:a&&b,selectedTargetPopulation:n,targetPopulation:v,canViewDetails:t},v.id)})});return r?e.jsx(_O,{children:C()}):C()},CO=oe(PO,"LookUpTargetPopulationTableCommunication"),rc=[{disablePadding:!1,label:"",id:"radio",numeric:!1,dataCy:"radio-id"},{disablePadding:!1,label:"Title",id:"name",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Import Date",id:"importDate",numeric:!1},{disablePadding:!0,label:"Num. of Households",id:"numberOfHouseholds",numeric:!0},{disablePadding:!1,label:"Imported by",id:"importedBy",numeric:!1},{disablePadding:!1,label:"Data Source",id:"dataSource",numeric:!1}];function EO({registrationDataImport:s,canViewDetails:t,selectedRDI:a,radioChangeHandler:n}){const i=ge(),l=`/${Bi()}/registration-data-import/${s.id}`,o=()=>{n!==void 0?n(s.id):i(l)},d=()=>s?.importedBy&&s.importedBy||"-";return e.jsxs(rs,{hover:!0,onClick:t?o:void 0,role:"checkbox",children:[n&&e.jsx(_,{padding:"checkbox",children:e.jsx(kt,{color:"primary",checked:a===s.id,onChange:()=>{n(s.id)},value:s.id,name:"radio-button-household",slotProps:{input:{"aria-label":s.id}}})}),e.jsx(_,{align:"left",children:t?e.jsx(me,{to:l,children:s.name}):s.name}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:ki})}),e.jsx(_,{align:"left",children:e.jsx(pe,{withTime:!0,children:s.importDate})}),e.jsx(_,{align:"right",children:s.numberOfHouseholds||0}),e.jsx(_,{align:"left",children:d()}),e.jsx(_,{align:"left",children:s.dataSource})]},s.id)}const vO=T.div`
  .MuiPaper-elevation1 {
    box-shadow: none;
    padding: 0 !important;
  }
`;function SO({filter:s,canViewDetails:t,enableRadioButton:a,selectedRDI:n,handleChange:i,noTableStyling:r,noTitle:l}){const{t:o}=M(),{businessArea:d,programId:c}=U(),u=A.useMemo(()=>({businessAreaSlug:d,programSlug:c,search:s.search,importedById:s.importedBy?Ea(s.importedBy):void 0,status:s.status!==""?s.status:void 0,importDateRange:JSON.stringify({min:s.importDateRangeMin||null,max:s.importDateRangeMax||null}),totalHouseholdsCountWithValidPhoneNoMin:s.totalHouseholdsCountWithValidPhoneNoMin||void 0,totalHouseholdsCountWithValidPhoneNoMax:s.totalHouseholdsCountWithValidPhoneNoMax||void 0}),[d,c,s.search,s.importedBy,s.status,s.importDateRangeMin,s.importDateRangeMax,s.totalHouseholdsCountWithValidPhoneNoMin,s.totalHouseholdsCountWithValidPhoneNoMax]),[h,m]=A.useState(u);A.useEffect(()=>{m(u)},[u]);const[g,x]=A.useState(0),{data:f,isLoading:j,error:y}=V({queryKey:["businessAreasProgramsRegistrationDataImportsList",h,c,d],queryFn:()=>N.restBusinessAreasProgramsRegistrationDataImportsList(Ce({businessAreaSlug:d,programSlug:c},h,{withPagination:!0}))}),{data:b}=V({queryKey:["businessAreasProgramsRegistrationDataImportsCount",c,d,h],queryFn:()=>N.restBusinessAreasProgramsRegistrationDataImportsCountRetrieve(Ce({businessAreaSlug:d,programSlug:c},h)),enabled:!!d&&!!c&&g===0}),C=E=>{i(E)},v=E=>e.jsx(EO,{radioChangeHandler:a&&C,selectedRDI:n,registrationDataImport:E,canViewDetails:t},E.id),S=vs(g,b),I=()=>e.jsx(Es,{children:e.jsx(ds,{title:l?null:o("List of Imports"),headCells:a?rc:rc.slice(1),renderRow:v,data:f,error:y,isLoading:j,queryVariables:h,setQueryVariables:m,itemsCount:S,page:g,setPage:x})});return r?e.jsx(vO,{children:I()}):I()}const IO=oe(SO,"LookUpRegistrationDataImportTableCommunication");function DO({selectedTab:s,choicesData:t,values:a,filtersHouseholdApplied:n,filtersTargetPopulationApplied:i,filtersRDIApplied:r,businessArea:l,onValueChange:o,handleChange:d}){const c=ve();return e.jsxs(e.Fragment,{children:[s===Bt.HOUSEHOLD&&e.jsx(jO,{filter:n,businessArea:l,choicesData:t,noTableStyling:!0,setFieldValue:o,selectedHousehold:a.households,setSelectedHousehold:u=>{d(Bt.HOUSEHOLD,u)},householdMultiSelect:!0}),s===Bt.TARGET_POPULATION&&e.jsx(CO,{filter:i,canViewDetails:K(R.TARGETING_VIEW_DETAILS,c),enableRadioButton:!0,selectedTargetPopulation:a.targetPopulation,handleChange:u=>{d(Bt.TARGET_POPULATION,u)},noTableStyling:!0,noTitle:!0}),s===Bt.RDI&&e.jsx(IO,{filter:r,canViewDetails:K(R.RDI_VIEW_DETAILS,c),enableRadioButton:!0,selectedRDI:a.registrationDataImport,handleChange:u=>{d(Bt.RDI,u)},noTableStyling:!0,noTitle:!0})]})}function TO({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i}){const{t:r}=M(),l=ge(),o=je(),d=o.pathname.includes("accountability"),{handleFilterChange:c,applyFilterChanges:u,clearFilter:h}=Ss(a,l,o,s,t,n,i),m=()=>{u()},g=()=>{h()},x=d?Object.values(te).filter(f=>f!=="OPEN"):Object.values(te);return e.jsx(Ns,{clearHandler:g,applyHandler:m,isOnPaper:!1,children:e.jsxs(p,{container:!0,spacing:3,sx:{alignItems:"flex-end"},children:[e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{label:r("Search"),value:s.name,onChange:f=>c("name",f.target.value),"data-cy":"filters-search",fullWidth:!0})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:f=>c("status",f.target.value),value:s.status,label:r("Status"),icon:e.jsx(Wa,{}),fullWidth:!0,"data-cy":"filters-status",children:x.sort().map(f=>e.jsx(de,{value:f,children:$i(f)},f))})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{topLabel:r("Num. of Recipients"),value:s.totalHouseholdsCountWithValidPhoneNoMin,placeholder:r("From"),onChange:f=>c("totalHouseholdsCountWithValidPhoneNoMin",f.target.value),icon:e.jsx(ct,{}),"data-cy":"filters-total-households-count-min"})}),e.jsx(p,{size:{xs:3},children:e.jsx(js,{value:s.totalHouseholdsCountWithValidPhoneNoMax,placeholder:r("To"),onChange:f=>c("totalHouseholdsCountWithValidPhoneNoMax",f.target.value),icon:e.jsx(ct,{}),"data-cy":"filters-total-households-count-max"})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{topLabel:r("Date Created"),placeholder:r("From"),onChange:f=>c("createdAtRangeMin",f),value:s.createdAtRangeMin})}),e.jsx(p,{size:{xs:3},children:e.jsx(ms,{placeholder:r("To"),onChange:f=>c("createdAtRangeMax",f),value:s.createdAtRangeMax})})]})})}const RO=T(P)`
  border-bottom: 1px solid #e4e4e4;
  padding: 15px 0;
`;function FO({businessArea:s,onValueChange:t,setValues:a,values:n,selectedTab:i,setSelectedTab:r}){const l=je(),{selectedProgram:o}=Z(),c=[`${o?.beneficiaryGroup?.groupLabel}`,"Target Population","RDI"],u={search:"",importedBy:"",status:Xs.MERGED,totalHouseholdsCountWithValidPhoneNoMin:"",totalHouseholdsCountWithValidPhoneNoMax:"",importDateRangeMin:"",importDateRangeMax:""},[h,m]=A.useState(Ke(l,u)),[g,x]=A.useState(Ke(l,u)),f={name:"",status:"",totalHouseholdsCountWithValidPhoneNoMin:"",totalHouseholdsCountWithValidPhoneNoMax:"",createdAtRangeMin:"",createdAtRangeMax:""},[j,y]=A.useState(Ke(l,f)),[b,C]=A.useState(Ke(l,f)),{data:v,isLoading:S}=V({queryKey:["householdChoices",s],queryFn:()=>N.restBusinessAreasHouseholdsChoicesRetrieve({businessAreaSlug:s})}),I={search:"",documentType:v?.documentTypeChoices?.[0]?.value,documentNumber:"",residenceStatus:"",admin2:"",householdSizeMin:"",householdSizeMax:"",orderBy:"unicef_id",withdrawn:""},[E,D]=A.useState(Ke(l,I)),[F,w]=A.useState(Ke(l,I)),{t:O}=M(),k=($,G)=>{a({...n,households:$===Bt.HOUSEHOLD&&typeof G!="string"?G:[],targetPopulation:$===Bt.TARGET_POPULATION&&typeof G=="string"?G:"",registrationDataImport:$===Bt.RDI&&typeof G=="string"?G:""})};return S?null:e.jsxs(P,{children:[e.jsxs(RO,{p:4,m:4,display:"flex",alignItems:"center",bgcolor:"#F5F5F5",children:[e.jsx(P,{pl:5,pr:5,fontWeight:"500",fontSize:"medium",children:O("Look up for")}),e.jsx(wn,{"aria-labelledby":"selection-radio-buttons-group",value:i,row:!0,name:"radio-buttons-group",children:c.map(($,G)=>e.jsx(sa,{value:G,onChange:()=>{r(G)},control:e.jsx(kt,{color:"primary"}),label:$},$))})]}),e.jsxs(P,{p:4,mt:4,children:[i===Bt.HOUSEHOLD&&e.jsx(pO,{filter:E,choicesData:v,setFilter:D,initialFilter:I,appliedFilter:F,setAppliedFilter:w}),i===Bt.TARGET_POPULATION&&e.jsx(TO,{filter:j,setFilter:y,initialFilter:f,appliedFilter:b,setAppliedFilter:C}),i===Bt.RDI&&e.jsx(gO,{filter:h,setFilter:m,initialFilter:u,appliedFilter:g,setAppliedFilter:x})]}),e.jsx(DO,{selectedTab:i,choicesData:v,filtersHouseholdApplied:F,filtersTargetPopulationApplied:b,filtersRDIApplied:g,onValueChange:t,values:n,handleChange:k,businessArea:s})]})}const zr=["Recipients Look up","Sample Size","Details"],NO=["Full List","Random Sampling"],LO=T.div`
  border-bottom: 1px solid ${({theme:s})=>s.hctPalette.lighterGray};
`,lc={households:[],targetPopulation:"",registrationDataImport:"",confidenceInterval:95,marginOfError:5,filterAgeMin:null,filterAgeMax:null,filterSex:"",excludedAdminAreasFull:[],excludedAdminAreasRandom:[],adminCheckbox:!1,ageCheckbox:!1,sexCheckbox:!1,title:"",body:"",samplingType:Ht.FULL_LIST};function OO(s,t){const a=s===0?Ht.FULL_LIST:Ht.RANDOM,n={excludedAdminAreas:t.excludedAdminAreasFull||[]},i={confidenceInterval:t.confidenceInterval*.01,marginOfError:t.marginOfError*.01,excludedAdminAreas:t.adminCheckbox?t.excludedAdminAreasRandom:[],age:t.ageCheckbox?{min:t.filterAgeMin,max:t.filterAgeMax}:null,sex:t.sexCheckbox?t.filterSex:null};return{households:t.households,paymentPlan:t.targetPopulation,registrationDataImport:t.registrationDataImport,samplingType:a,fullListArguments:a===Ht.FULL_LIST?n:null,randomSamplingArguments:a===Ht.RANDOM?i:null}}const kO=()=>{const{t:s}=M(),{baseUrl:t,businessArea:a,programId:n}=U(),{mutateAsync:i,isPending:r}=xe({mutationFn:ie=>N.restBusinessAreasProgramsMessagesCreate({businessAreaSlug:a,programSlug:n,requestBody:ie})}),{showMessage:l}=Ae(),o=ge(),d=ve(),c=Nt(),[u,h]=A.useState(ka.LookUp),[m,g]=A.useState(Bt.HOUSEHOLD),[x,f]=A.useState(0),[j,y]=A.useState(lc),[b,C]=A.useState(!1),[v,S]=A.useState(null),[I,E]=A.useState(!1),[D,F]=A.useState(null),{data:w}=V({queryKey:["adminAreas",a,{level:2}],queryFn:async()=>N.restBusinessAreasGeoAreasList({businessAreaSlug:a,level:2}),enabled:!!a}),O=A.useCallback(async()=>{if(a)try{E(!0),F(null);const ie=OO(x,j),ue=await N.restBusinessAreasProgramsMessagesSampleSizeCreate({businessAreaSlug:a,programSlug:n,requestBody:ie});S({accountabilityCommunicationMessageSampleSize:{sampleSize:ue.sampleSize||0,numberOfRecipients:ue.numberOfRecipients||0}})}catch(ie){console.error("Error loading sample size data:",ie),F(ie)}finally{E(!1)}},[a,x,j,n]);A.useEffect(()=>{u===ka.SampleSize&&O()},[u,j,O]);const[k,$]=A.useState(null),[G,W]=A.useState(!1),[Y,X]=A.useState(null),J=A.useCallback(async()=>{if(!(!a||!n))try{W(!0);const ie=await N.restBusinessAreasProgramsSurveysAvailableFlowsList({businessAreaSlug:a,programSlug:n});$({surveyAvailableFlows:ie})}catch(ie){console.error("Error loading available flows:",ie),X(ie)}finally{W(!1)}},[a,n]);A.useEffect(()=>{J()},[J]),A.useEffect(()=>{(k?.surveyAvailableFlows===null||Y)&&!G&&o(`/error/${a}`,{state:{errorMessage:s("RapidPro is not set up in your country, please contact your Roll Out Focal Point"),lastSuccessfulPage:`/${t}/accountability/communication`}})},[k,Y,G,a,t,o,s]);const ae=A.useCallback(()=>{const ie={title:Q.string(),body:Q.string()};return u===ka.Details&&(ie.title=Q.string().min(4,s("Too short")).max(60,s("Too long")).required(s("Title is required")),ie.body=Q.string().min(4,s("Too short")).max(1e3,s("Too long")).required(s("Message is required"))),C(!0),Q.object().shape(ie)},[u,s]),re=ie=>{const{households:Pe,targetPopulation:ue,registrationDataImport:Ge}=ie,ls={};return Pe.length===0&&!ue&&!Ge&&(ls.error=s("Field Selection is required")),ls},se=w?.length?w.map(ie=>({value:ie.id,name:ie.name||""})):[];if(d===null||d.length===0)return null;if(!K(R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_CREATE,d))return e.jsx(Xe,{permission:R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_CREATE});const le=()=>`(${Mi(v?.accountabilityCommunicationMessageSampleSize?.sampleSize,v?.accountabilityCommunicationMessageSampleSize?.numberOfRecipients)})`,ce=[{title:s("Communication"),to:`/${t}/accountability/communication`}],_e=()=>{h(ie=>ie+1),C(!1)},ne=ie=>{ie.households.length&&u===2?h(0):h(Pe=>Pe-1)},Ue=ie=>({title:ie.title,body:ie.body,households:ie.households,paymentPlan:ie.targetPopulation,registrationDataImport:ie.registrationDataImport,samplingType:x===0?Ht.FULL_LIST:Ht.RANDOM,fullListArguments:x===0?{excludedAdminAreas:ie.excludedAdminAreasFull||[]}:null,randomSamplingArguments:x===1?{excludedAdminAreas:ie.excludedAdminAreasRandom||[],confidenceInterval:ie.confidenceInterval*.01,marginOfError:ie.marginOfError*.01,age:ie.ageCheckbox?{min:ie.filterAgeMin,max:ie.filterAgeMax}:null,sex:ie.sexCheckbox?ie.filterSex:null}:null}),Te=ie=>["error"].map(Pe=>e.jsx(Ls,{error:!0,children:ie[Pe]},Pe));return e.jsx(B.Formik,{initialValues:lc,validationSchema:ae,validate:ie=>re(ie),validateOnBlur:b,validateOnChange:b,onSubmit:ie=>{u===zr.length-1?c({title:s("Confirmation"),content:s("Are you sure you want to send this message?")}).then(async()=>{try{const Pe=await i(Ue(ie));l(s("Communication Ticket created.")),o(`/${t}/accountability/communication/${Pe.id}`)}catch(Pe){fe(Pe,l)}}):_e()},children:({submitForm:ie,setValues:Pe,values:ue,setFieldValue:Ge,errors:ls})=>e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:"New Message",breadCrumbs:K(R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_CREATE,d)?ce:null}),e.jsxs(ft,{children:[e.jsx(p,{size:9,children:e.jsx(Ta,{activeStep:u,children:zr.map(qe=>{const xs={},Oe={};return e.jsx(Ra,{...xs,children:e.jsx(qa,{...Oe,children:qe})},qe)})})}),e.jsxs(B.Form,{children:[e.jsx(ir,{values:ue,onChange:()=>y(ue)}),u===ka.LookUp&&e.jsx(P,{display:"flex",flexDirection:"column",children:e.jsx(FO,{businessArea:a,values:ue,onValueChange:Ge,setValues:Pe,selectedTab:m,setSelectedTab:g})}),u===ka.SampleSize&&(ue.households.length?e.jsx(P,{px:8,children:e.jsxs(P,{pt:3,children:[e.jsx(P,{fontSize:12,color:"#797979",children:s("You have selected households as the recipients group")}),e.jsxs(P,{pb:3,pt:3,fontSize:16,fontWeight:"fontWeightBold",children:[s("Message will be sent to all households selected"),": (",ue.households.length,")"]})]})}):e.jsxs(P,{px:8,children:[e.jsxs(P,{display:"flex",alignItems:"center",children:[e.jsxs(P,{pl:5,pr:5,fontWeight:"500",fontSize:"medium",children:[s("Sample Size"),":"]}),e.jsx(wn,{"aria-labelledby":"selection-radio-buttons-group",value:x,row:!0,name:"radio-buttons-group",children:NO.map((qe,xs)=>e.jsx(sa,{value:xs,onChange:()=>{y(ue),f(xs)},control:e.jsx(kt,{color:"primary"}),label:qe},qe))})]}),e.jsxs(Qt,{value:x,index:0,children:[D&&e.jsx(P,{mb:3,children:e.jsxs(ee,{color:"error",children:[s("Error loading sample size data"),":"," ",D.message]})}),se&&e.jsx(B.Field,{name:"excludedAdminAreasFull",choices:se,variant:"outlined",label:s("Filter Out Administrative Level Areas"),component:Ia}),e.jsx(P,{pt:3,children:e.jsxs(P,{pb:3,pt:3,fontSize:16,fontWeight:"fontWeightBold",children:["Sample size:"," ",I?e.jsx("span",{children:s("Loading...")}):e.jsxs(e.Fragment,{children:[v?.accountabilityCommunicationMessageSampleSize?.sampleSize," ","out of"," ",v?.accountabilityCommunicationMessageSampleSize?.numberOfRecipients," ",le()]})]})})]}),e.jsx(Qt,{value:x,index:1,children:e.jsxs(P,{pt:3,children:[e.jsx(B.Field,{name:"confidenceInterval",label:s("Confidence Interval"),min:90,max:99,component:Da,suffix:"%"}),e.jsx(B.Field,{name:"marginOfError",label:s("Margin of Error"),min:0,max:9,component:Da,suffix:"%"}),e.jsx(ee,{variant:"caption",children:s("Cluster Filters")}),e.jsxs(P,{flexDirection:"column",display:"flex",children:[e.jsxs(P,{display:"flex",children:[e.jsx(B.Field,{name:"adminCheckbox",label:s("Administrative Level"),component:ws}),e.jsx(B.Field,{name:"ageCheckbox",label:s("Age of HoH"),component:ws}),e.jsx(B.Field,{name:"sexCheckbox",label:s("Gender of HoH"),component:ws})]}),ue.adminCheckbox&&e.jsx(B.Field,{name:"excludedAdminAreasRandom",choices:se,variant:"outlined",label:s("Filter Out Administrative Level Areas"),component:Ia}),e.jsxs(p,{container:!0,children:[ue.ageCheckbox&&e.jsx(p,{size:{xs:12},children:e.jsxs(p,{container:!0,children:[e.jsx(p,{size:{xs:4},children:e.jsx(B.Field,{name:"filterAgeMin",label:s("Minimum Age"),type:"number",color:"primary",component:Se})}),e.jsx(p,{size:{xs:4},children:e.jsx(B.Field,{name:"filterAgeMax",label:s("Maximum Age"),type:"number",color:"primary",component:Se})})]})}),ue.sexCheckbox&&e.jsx(p,{size:{xs:5},children:e.jsx(B.Field,{name:"filterSex",label:s("Gender"),color:"primary",choices:[{value:"FEMALE",name:s("Female")},{value:"MALE",name:s("Male")},{value:"OTHER",name:s("Other")},{value:"NOT_COLLECTED",name:s("Not Collected")},{value:"NOT_ANSWERED",name:s("Not Answered")}],component:We})})]})]}),e.jsxs(P,{pb:3,pt:3,fontSize:16,fontWeight:"fontWeightBold",children:["Sample size:"," ",I?e.jsx("span",{children:s("Loading...")}):e.jsxs(e.Fragment,{children:[v?.accountabilityCommunicationMessageSampleSize?.sampleSize," ","out of"," ",v?.accountabilityCommunicationMessageSampleSize?.numberOfRecipients," ",le()]})]})]})})]})),u===ka.Details&&e.jsxs(e.Fragment,{children:[e.jsx(LO,{}),e.jsx(P,{my:3,children:e.jsx(p,{size:12,children:e.jsx(B.Field,{name:"title",required:!0,fullWidth:!0,variant:"outlined",label:s("Title"),component:Se,"data-cy":"input-title"})})}),e.jsx(p,{size:12,children:e.jsx(B.Field,{name:"body",required:!0,multiline:!0,fullWidth:!0,variant:"outlined",label:s("Message"),component:Se,"data-cy":"input-body"})})]}),Te(ls)]}),e.jsxs(P,{pt:3,display:"flex",flexDirection:"row",children:[e.jsx(P,{mr:3,children:e.jsx(H,{component:ys,to:`/${t}/accountability/communication`,"data-cy":"button-cancel",children:s("Cancel")})}),e.jsxs(P,{display:"flex",ml:"auto",children:[e.jsx(H,{disabled:u===ka.LookUp,onClick:()=>ne(ue),"data-cy":"button-back",children:s("Back")}),e.jsx(ke,{loading:r,color:"primary",variant:"contained",onClick:ie,"data-cy":"button-submit",children:u===zr.length-1?s("Save"):s("Next")})]})]})]})]})})},wO=oe(kO,"CreateCommunicationPage"),MO=[{disablePadding:!1,label:"Household Id",id:"unicefId",numeric:!1,dataCy:"household-id"},{disablePadding:!1,label:"Status",id:"withdrawn",numeric:!1,dataCy:"status"},{disablePadding:!1,label:"Head of Household",id:"head_of_household__full_name",numeric:!1,dataCy:"household-head-name"},{disablePadding:!1,label:"Household Size",id:"size",numeric:!1,dataCy:"household-size"},{disablePadding:!1,label:"Administrative Level 2",id:"admin_area__name",numeric:!1,dataCy:"household-location"},{disablePadding:!1,label:"Residence Status",id:"residenceStatus",numeric:!1,dataCy:"household-residence-status"},{disablePadding:!1,label:"Registration Date",id:"head_of_household__first_registration_date",numeric:!0,dataCy:"household-registration-date"}],$O=({household:s,headOfHousehold:t,canViewDetails:a})=>{const n=ge(),{baseUrl:i}=U(),r=`/${i}/population/household/${s.id}`,l=()=>{n(r)};return e.jsxs(rs,{hover:!0,onClick:a?l:void 0,role:"checkbox",children:[e.jsx(_,{align:"left",children:e.jsx(me,{to:r,children:s.unicefId})}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Un})}),e.jsx(Jt,{children:t.fullName}),e.jsx(_,{align:"left",children:s.size}),e.jsx(_,{align:"left",children:s.admin2?.name||"-"}),e.jsx(_,{align:"left",children:s.residenceStatus}),e.jsx(_,{align:"right",children:e.jsx(pe,{children:s.lastRegistrationDate})})]},s.unicefId)};function UO({id:s,canViewDetails:t}){const{t:a}=M(),{selectedProgram:n}=Z(),i=n?.beneficiaryGroup,{businessAreaSlug:r,programSlug:l}=U(),o=A.useMemo(()=>({businessAreaSlug:r,programSlug:l,messageId:s}),[r,l,s]),[d,c]=A.useState(o);A.useEffect(()=>{c(o)},[o]);const[u,h]=A.useState(0),{data:m,isLoading:g,error:x}=V({queryKey:["businessAreasProgramsHouseholdsAllAccountabilityCommunicationMessageRecipientsList",d],queryFn:()=>N.restBusinessAreasProgramsHouseholdsAllAccountabilityCommunicationMessageRecipientsList(d)}),j=$s(MO,i,{unicefId:y=>`${y?.groupLabel} ID`,head_of_household__full_name:y=>`Head of ${y?.groupLabel}`,size:y=>`${y?.groupLabel} Size`});return e.jsx(Es,{children:e.jsx(ds,{title:a("Recipients"),headCells:j,data:m,error:x,isLoading:g,queryVariables:d,setQueryVariables:c,rowsPerPageOptions:[10,15,20],itemsCount:m?.results?.length||0,page:u,setPage:h,renderRow:y=>e.jsx($O,{household:y,headOfHousehold:y.headOfHousehold,canViewDetails:t},y.id)})})}const VO=oe(UO,"RecipientsTable"),BO=T(us)`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 26px 22px;
`,GO=({message:s})=>{const{t}=M();return e.jsx(p,{size:{xs:8},"data-cy":"communication-message-details",children:e.jsx(P,{p:5,children:e.jsxs(BO,{children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6","data-cy":"message-title",children:t("Message")})}),e.jsx(vt,{children:e.jsxs(p,{container:!0,spacing:6,children:[e.jsxs(p,{container:!0,justifyContent:"space-between",size:{xs:12},children:[e.jsx(P,{ml:2,children:e.jsx(ee,{variant:"subtitle2","data-cy":"message-created-by",children:s.createdBy})}),e.jsx(ee,{color:"textSecondary","data-cy":"message-created-at",children:e.jsx(pe,{withTime:!0,children:s.createdAt})})]}),e.jsxs(P,{ml:6,p:3,children:[e.jsx(P,{"data-cy":"message-title-content",children:s.title}),e.jsx(P,{"data-cy":"message-body-content",children:s.body})]})]})})]})})})},zO=oe(GO,"CommunicationMessageDetails");function qO({message:s}){const{t}=M(),{baseUrl:a}=U();return e.jsxs(Fs,{"data-cy":"communication-details-container",children:[e.jsx(Ie,{children:e.jsx(ee,{variant:"h6",children:t("Details")})}),e.jsx(vt,{children:e.jsxs(p,{container:!0,spacing:6,children:[e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("Created By"),value:s.createdBy})}),e.jsx(p,{size:{xs:3},children:e.jsx(L,{label:t("Date Created"),children:e.jsx(pe,{children:s.createdAt})})}),s.paymentPlan?e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:t("Target Population"),children:e.jsx(me,{to:`/${a}/target-population/${s?.paymentPlan.id}`,children:s?.paymentPlan.name})})}):e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:t("Target Population"),children:"-"})}),s.registrationDataImport&&e.jsx(p,{size:{xs:4},children:e.jsx(L,{label:t("Registration Data Import"),children:e.jsx(me,{to:`/${a}/registration-data-import/${s.registrationDataImport.id}`,children:s.registrationDataImport.name})})})]})})]})}const HO=oe(qO,"CommunicationDetails");function WO(){const{t:s}=M(),{id:t}=ts(),{businessArea:a,baseUrl:n,programSlug:i}=U(),{data:r,isLoading:l,error:o}=V({queryKey:["accountabilityCommunicationMessage",a,t,i],queryFn:()=>N.restBusinessAreasProgramsMessagesRetrieve({businessAreaSlug:a,id:t,programSlug:i}),enabled:!!t&&!!a}),d=ve();if(l)return e.jsx(Ne,{});if(rt(o))return e.jsx(Xe,{permission:R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_DETAILS});if(!r||d===null)return null;const c=[{title:s("Communication"),to:`/${n}/accountability/communication`}];return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:`${r.unicefId}`,breadCrumbs:K(R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_DETAILS,d)?c:null,flags:e.jsx(gt,{adminUrl:r.adminUrl})}),e.jsxs(P,{display:"flex",flexDirection:"column",children:[e.jsx(HO,{message:r}),e.jsx(zO,{message:r}),e.jsx(VO,{canViewDetails:K(R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_DETAILS,d),id:t}),K(R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_DETAILS,d)&&e.jsx(Lt,{objectId:t})]})]})}const KO=oe(WO,"CommunicationDetailsPage");function YO({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i}){const{t:r}=M(),l=ge(),o=je(),{handleFilterChange:d,applyFilterChanges:c,clearFilter:u}=Ss(a,l,o,s,t,n,i),h=()=>{c()},m=()=>{u()};return e.jsx(Ns,{applyHandler:h,clearHandler:m,children:e.jsxs(p,{container:!0,alignItems:"flex-end",spacing:3,children:[e.jsx(p,{size:{xs:4},children:e.jsx(lr,{name:"targetPopulation",value:s.targetPopulation,filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i})}),e.jsx(p,{size:{xs:2},children:e.jsx(Yi,{label:r("Created by"),filter:s,name:"createdBy",value:s.createdBy,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i,additionalVariables:{isMessageCreator:!0}})}),e.jsxs(p,{container:!0,size:{xs:6},spacing:3,alignItems:"flex-end",children:[e.jsx(p,{size:{xs:6},children:e.jsx(ms,{topLabel:r("Creation Date"),label:"From",onChange:g=>d("createdAtRangeMin",g),value:s.createdAtRangeMin,dataCy:"filters-creation-date-from"})}),e.jsx(p,{size:{xs:6},children:e.jsx(ms,{label:r("To"),onChange:g=>d("createdAtRangeMax",g),value:s.createdAtRangeMax,dataCy:"filters-creation-date-to"})})]})]})})}const QO=[{disablePadding:!1,label:"Message ID",id:"unicefId",numeric:!1},{disablePadding:!1,label:"Title",id:"title",numeric:!1},{disablePadding:!1,label:"Number of Recipients",id:"numberOfRecipients",numeric:!1},{disablePadding:!1,label:"Created by",id:"created_by",numeric:!1},{disablePadding:!1,label:"Creation Date",id:"created_at",numeric:!1}];function XO({message:s,canViewDetails:t}){const a=ge(),{baseUrl:n}=U(),i=`/${n}/accountability/communication/${s.id}`,r=()=>{a(i)};return e.jsxs(rs,{hover:!0,onClick:t?r:void 0,role:"checkbox",children:[e.jsx(_,{align:"left",children:t?e.jsx(me,{to:i,children:s.unicefId}):s.unicefId}),e.jsx(_,{align:"left",children:s.title}),e.jsx(_,{align:"left",children:s.numberOfRecipients}),e.jsx(_,{align:"left",children:s.createdBy}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.createdAt})})]},s.unicefId)}function JO({filter:s,canViewDetails:t}){const{programId:a,businessArea:n}=U(),{t:i}=M(),r=A.useMemo(()=>({businessAreaSlug:n,programSlug:a,createdAtRange:JSON.stringify({min:Yt(s.createdAtRangeMin,"startOfDay"),max:Yt(s.createdAtRangeMax,"endOfDay")}),paymentPlan:s.targetPopulation,createdBy:s.createdBy||void 0}),[n,a,s.createdAtRangeMin,s.createdAtRangeMax,s.targetPopulation,s.createdBy]),[l,o]=A.useState(r);A.useEffect(()=>{o(r)},[r]);const[d,c]=A.useState(0),{data:u,isLoading:h,error:m}=V({queryKey:["businessAreasProgramsMessagesList",l,a,n],queryFn:()=>N.restBusinessAreasProgramsMessagesList(Ce({businessAreaSlug:n,programSlug:a},l,{withPagination:!0}))}),{data:g}=V({queryKey:["businessAreasProgramsMessagesCount",a,n,l],queryFn:()=>N.restBusinessAreasProgramsMessagesCountRetrieve(Ce({businessAreaSlug:n,programSlug:a},l)),enabled:!!n&&!!a&&d===0}),x=j=>e.jsx(XO,{message:j,canViewDetails:t},j.id),f=vs(d,g);return e.jsx(Es,{children:e.jsx(ds,{title:i("Messages List"),renderRow:x,headCells:QO,data:u,error:m,isLoading:h,queryVariables:l,setQueryVariables:o,itemsCount:f,initialRowsPerPage:10,page:d,setPage:c})})}const ZO=oe(JO,"CommunicationTable"),e0=()=>{const{baseUrl:s}=U(),t=ve(),a=je(),{t:n}=M(),{isActiveProgram:i}=Z(),r={createdBy:"",createdAtRangeMin:null,createdAtRangeMax:null,targetPopulation:""},[l,o]=A.useState(Ke(a,r)),[d,c]=A.useState(Ke(a,r)),[u,h]=A.useState(!1),m=A.useRef(null);return et(m,u,d,()=>h(!1)),t===null?null:K(R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_LIST,t)?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:n("Communication"),children:e.jsx(Vs,{variant:"contained",color:"primary",component:ys,to:`/${s}/accountability/communication/create`,"data-cy":"button-communication-create-new",dataPerm:`${R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_LIST}, ${R.POPULATION_VIEW_HOUSEHOLDS_LIST}, ${R.TARGETING_VIEW_LIST}, ${R.RDI_VIEW_LIST}`,title:n("Programme has to be active to create new Message"),disabled:!i,children:n("New message")})}),e.jsx(YO,{filter:l,setFilter:o,initialFilter:r,appliedFilter:d,setAppliedFilter:g=>{c(g),h(!0)}}),e.jsx("div",{ref:m,children:e.jsx(ZO,{filter:d,canViewDetails:K(R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_LIST,t)})})]}):e.jsx(Xe,{permission:R.ACCOUNTABILITY_COMMUNICATION_MESSAGE_VIEW_LIST})},s0=oe(e0,"CommunicationPage"),t0=()=>oa([{path:"accountability/surveys/create/*",element:e.jsx(QL,{})},{path:"accountability/surveys/:id",element:e.jsx(nO,{})},{path:"accountability/surveys",element:e.jsx(mO,{})},{path:"accountability/communication/create",element:e.jsx(wO,{})},{path:"accountability/communication/:id",element:e.jsx(KO,{})},{path:"accountability/communication",element:e.jsx(s0,{})}]);function a0({filter:s,setFilter:t,initialFilter:a,appliedFilter:n,setAppliedFilter:i}){const{t:r}=M(),l=ge(),o=je(),{businessArea:d}=U(),{handleFilterChange:c,applyFilterChanges:u,clearFilter:h}=Ss(a,l,o,s,t,n,i),m=()=>{u()},g=()=>{h()},{data:x,isLoading:f}=V({queryKey:["userChoices",d],queryFn:()=>N.restBusinessAreasUsersChoicesRetrieve({businessAreaSlug:d})});if(f||!x)return null;const j={userPartnerChoices:x.partnerChoicesTemp,userRolesChoices:x.roleChoices,userStatusChoices:x.statusChoices};return e.jsx(Ns,{clearHandler:g,applyHandler:m,children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:3},children:e.jsx(Cs,{label:r("Search"),value:s.search,onChange:y=>c("search",y.target.value)})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:y=>c("partner",y.target.value),label:r("Partner"),value:s.partner,"data-cy":"partner-filter",children:j.userPartnerChoices.map(y=>e.jsx(de,{value:y.value,children:y.name},y.value))})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:y=>c("roles",y.target.value),label:r("Role"),value:s.roles,dataCy:"role-filter",children:j.userRolesChoices.map(y=>e.jsx(de,{value:y.value,children:`${y.name} (${y.subsystem==="CA"?"Cash Assist":y.subsystem})`},y.value))})}),e.jsx(p,{size:{xs:3},children:e.jsx(He,{onChange:y=>c("status",y.target.value),label:r("Status"),value:s.status,dataCy:"status-filter",children:j.userStatusChoices.map(y=>e.jsx(de,{value:y.value,children:y.name},y.value))})})]})})}const n0=[{disablePadding:!1,label:"",id:"arrow",numeric:!1},{disablePadding:!1,label:"Name",id:"lastName",numeric:!1},{disablePadding:!1,label:"Status",id:"status",numeric:!1},{disablePadding:!1,label:"Partner",id:"partner",numeric:!1},{disablePadding:!1,label:"Email",id:"email",numeric:!1},{disablePadding:!1,label:"Last Login",id:"lastLogin",numeric:!1}],oc=T.p`
  color: #959698;
`,i0=({user:s})=>{const[t,a]=A.useState(!1),n=s?.userRoles?.map(r=>e.jsxs("p",{children:[Eo(r.businessArea)," / ",r.program||"All"," / ",r.role?.name]},r.role?.name)),i=s?.partnerRoles?.map(r=>e.jsxs("p",{children:[Eo(r.businessArea)," / ",r.program||"All"," / ",r.role?.name]},r.role?.name));return e.jsxs(e.Fragment,{children:[e.jsxs(be,{children:[e.jsx(_,{children:e.jsx(Ve,{"data-cy":"arrow-down","aria-label":"expand row",size:"medium",onClick:()=>a(!t),children:t?e.jsx(Dn,{}):e.jsx(Tn,{})})}),e.jsx(_,{style:{width:"300px"},align:"left",children:`${s.firstName} ${s.lastName}`}),e.jsx(_,{align:"left",children:e.jsx(we,{status:s.status,statusToColor:Tp})}),e.jsx(_,{align:"left",children:s.partner?.name||"-"}),e.jsx(_,{align:"left",children:s.email}),e.jsx(_,{align:"left",children:e.jsx(pe,{children:s.lastLogin})})]},s.id),e.jsxs(be,{children:[e.jsx(_,{style:{paddingBottom:0,paddingTop:0},colSpan:1,children:e.jsx(yt,{in:t,timeout:"auto",unmountOnExit:!0})}),e.jsx(_,{style:{paddingBottom:0,paddingTop:0},colSpan:2,children:e.jsxs(yt,{in:t,timeout:"auto",unmountOnExit:!0,children:[e.jsx(P,{margin:1,"data-cy":"country-role",children:e.jsx(oc,{children:"Country / Program / Role"})}),e.jsx(P,{margin:1,"data-cy":"mapped-country-role",children:n?.length?n:"No roles assigned."}),i?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(P,{margin:1,"data-cy":"partner-role",children:e.jsx(oc,{children:"Partner Roles"})}),e.jsx(P,{margin:1,"data-cy":"mapped-partner-role",children:i})]})]})})]})]})},r0=({filter:s})=>{const{t}=M(),{businessArea:a,programId:n}=U(),i=A.useMemo(()=>({search:s.search,partner:s.partner,roles:s.roles,status:s.status,businessAreaSlug:a,program:n,limit:10,offset:0,serializer:"program_users"}),[s.search,s.partner,s.roles,s.status,a,n]),[r,l]=A.useState(0),[o,d]=A.useState(i);A.useEffect(()=>{d(i)},[i]);const c=A.useMemo(()=>({...Il(i),businessAreaSlug:a,offset:r*10,limit:10}),[i,a,r]),{data:u,isLoading:h,error:m}=V({queryKey:["businessAreasUsersList",c],queryFn:()=>N.restBusinessAreasUsersList(c)}),{data:g}=V({queryKey:["businessAreasUsersCount",a,c],queryFn:()=>N.restBusinessAreasUsersCountRetrieve(c),enabled:r===0}),x=vs(r,g);return e.jsx(Es,{children:e.jsx(ds,{title:t("Users List"),headCells:n0,queryVariables:o,setQueryVariables:d,data:u,isLoading:h,error:m,itemsCount:x,rowsPerPageOptions:[10,15,20],defaultOrderBy:"status",defaultOrderDirection:"desc",renderRow:f=>e.jsx(i0,{user:f},f.id),page:r,setPage:l})})},qr={search:"",partner:"",roles:"",status:""};function l0(){const{businessArea:s}=U(),t=ve(),{t:a}=M(),n=je(),[i,r]=A.useState(Ke(n,qr)),[l,o]=A.useState(Ke(n,qr)),[d,c]=A.useState(!1),u=A.useRef(null);return et(u,d,l,()=>c(!1)),t===null?null:K(R.USER_MANAGEMENT_VIEW_LIST,t)?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:a("Programme Users"),children:e.jsx(e.Fragment,{children:e.jsx(H,{variant:"contained",color:"primary",onClick:()=>null,component:"a",href:`/api/download-exported-users/${s}`,"data-cy":"button-target-population-create-new",children:"Export"})})}),e.jsx(a0,{filter:i,setFilter:r,initialFilter:qr,appliedFilter:l,setAppliedFilter:h=>{o(h),c(!0)}}),e.jsx("div",{ref:u,children:e.jsx(r0,{filter:l})})]}):e.jsx(Xe,{permission:R.USER_MANAGEMENT_VIEW_LIST})}const o0=oe(l0,"UsersPage"),d0=()=>{const s=oa([{path:"country-dashboard",element:e.jsx(Gu,{})},{path:"users-list",element:e.jsx(o0,{})},{path:"activity-log",element:e.jsx(Yc,{})}]);return e.jsxs(e.Fragment,{children:[s,e.jsx(t0,{}),e.jsx(PF,{}),e.jsx(KT,{}),e.jsx(Vu,{}),e.jsx(kL,{}),e.jsx(LS,{}),e.jsx(QI,{}),e.jsx(Tu,{})]})};function c0(){const s=()=>{localStorage.getItem("AUTHENTICATED")&&(window.location.assign("/api/logout"),localStorage.removeItem("AUTHENTICATED"))},{reset:t}=Ym({timeout:vg,onIdle:s,debounce:500}),a=A.useCallback(()=>{t()},[t]);return A.useEffect(()=>(window.addEventListener("click",a),window.addEventListener("mousemove",a),()=>{window.removeEventListener("click",a),window.removeEventListener("mousemove",a)}),[a]),e.jsx(e.Fragment,{})}const u0=new Qm,h0=({children:s})=>e.jsxs(Xm,{client:u0,children:[e.jsx(Jm,{theme:wt,children:e.jsx(on.ThemeProvider,{theme:wt,children:e.jsx(Rb,{children:e.jsxs(Wr.LocalizationProvider,{dateAdapter:Ic.AdapterDateFns,children:[e.jsx(Cc,{}),e.jsx(lx,{children:e.jsx(Hx,{children:s})})]})})})}),e.jsx(Zm,{initialIsOpen:!1})]}),m0=()=>{const s=je(),t=ge();return A.useEffect(()=>{const a=s.pathname;a.startsWith("/global")&&a!=="/global/programs/all/country-dashboard"&&t("/global/programs/all/country-dashboard",{replace:!0})},[s,t]),null},p0=()=>{const s=ge(),{businessArea:t}=ts();return A.useEffect(()=>{s(`/${t}/programs/all/list`)},[s,t]),null},g0=()=>e.jsxs(e.Fragment,{children:[e.jsx(m0,{}),e.jsxs(sp,{children:[e.jsx(Zt,{path:"/login/*",element:e.jsx(Fg,{})}),e.jsx(Zt,{path:"/maintenance/*",element:e.jsx(Gg,{})}),e.jsx(Zt,{path:"/404/*",element:e.jsx(dg,{})}),e.jsx(Zt,{path:"/access-denied/*",element:e.jsx(yg,{})}),e.jsx(Zt,{path:"/error/*",element:e.jsx(Gi,{})}),e.jsx(Zt,{path:"/sentry-check",element:e.jsx("button",{type:"button",onClick:()=>{throw new Error("Am I working?")},children:"Throw new error"})}),e.jsxs(Zt,{element:e.jsx(UC,{}),children:[e.jsx(Zt,{path:"/:businessArea/programs/all/*",element:e.jsx(sC,{})}),e.jsx(Zt,{path:"/:businessArea/programs/:programId/*",element:e.jsx(d0,{})})]}),e.jsx(Zt,{path:"/",element:e.jsx(eg,{})}),e.jsx(Zt,{path:"/:businessArea",element:e.jsx(p0,{})})]})]}),x0=ep(ap),f0=x0([{path:"*",Component:g0,future:{v7_fetcherPersist:!0,v7_relativeSplatPath:!0}}]),y0=()=>e.jsxs(h0,{children:[e.jsx(c0,{}),e.jsx(tp,{router:f0})]}),b0="HIDE",j0="Household",A0="Programme",_0="CANCEL",P0="Export",C0="Status",E0="Assignee",v0="None",S0="SAVE",I0="Search",D0="From",T0="To",R0="Clear",F0="Apply",N0="Gender",L0="Male",O0="Female",k0="FSP",w0="GENDER",M0="Disapprove",$0="Approve",U0="Country",V0="Agency",B0="Cancel",G0="Save",z0="Warning",q0="Type",H0="Field",W0="Yes",K0="No",Y0="Documents",Q0="Identities",X0="REMOVED",J0="Source",Z0="STATUS",ek="Category",sk="CONSENT",tk="DESCRIPTION",ak="Details",nk="Edit",ik="Confirmation",rk="Village",lk="Tickets",ok="ROLE",dk="EDIT",ck="Previous",uk="Current",hk="Value",mk="CLOSE",pk="ACTIVATE",gk="Continue",xk="DISCARD",fk="Finish",yk="Only",bk="FINISH",jk="CURRENCY",Ak="Verify",_k="Received",Pk="Address",Ck="Geolocation",Ek="Benefits",vk="Vulnerabilities",Sk="Pregnant",Ik="Role",Dk="Individual",Tk="Photo",Rk="TIMEFRAME",Fk="status",Nk="SECTOR",Lk="Sector",Ok="Scope",kk="Description",wk="GENERATE",Mk="Add",$k="Filter",Uk="Score",Vk="Partner",Bk="Module",Gk="REMOVE",zk="Reactivate",qk="REACTIVATE",Hk="All",Wk="Lock",Kk="Delete",Yk="Note",Qk="And",Xk="Targeting",Jk="Dashboard",Zk="SUCCESSFUL",ew="ERRONEOUS",sw="SAMPLING",tw="RESPONDED",aw="RECEIVED",nw="PENDING",iw="Individuals",rw="Reporting",lw="Timeframe",ow="issued",dw="Duplicates",cw="Merge",uw="MERGE",hw="Rerun",mw="IMPORT",pw="Title",gw="Households",xw="DOWNLOAD",fw="Filters",yw="SHOW",bw="EXPORT",jw="Females",Aw="Males",_w="Flags",Pw="Resources",Cw="Reason",Ew="Currency",vw="Transfer",Sw="Cash",Iw="Wallet",Dw="Missing",Tw="Unlock",Rw="Reject",Fw="Authorize",Nw="Name",Lw="Preview",Ow="Comment",kw="FSPs",ww="Approval",Mw="Authorization",$w="Rejected",Uw="Back",Vw="Confirm",Bw="Priority",Gw="Urgency",zw="Next",qw="Comments",Hw="Message",Ww="Feedback",Kw="Messages",Yw="Documentation",Qw="Communication",Xw="Additional Registration Information",Jw="Uniqueness",Zw={"Programme Management":"Programme Management","Activity Log":"Activity Log",HIDE:b0,"SHOW ALL COUNTRIES":"SHOW ALL COUNTRIES","TOTAL NUMBER OF GRIEVANCES":"TOTAL NUMBER OF GRIEVANCES","TOTAL NUMBER OF FEEDBACK":"TOTAL NUMBER OF FEEDBACK","NUMBER OF OPEN SENSITIVE GRIEVANCES":"NUMBER OF OPEN SENSITIVE GRIEVANCES","Payment Verification":"Payment Verification",Household:j0,"Households contacted":"Households contacted","average sampling":"average sampling","Total Transferred by Administrative Area":"Total Transferred by Administrative Area","IN USD":"IN USD","Total Transferred by Country":"Total Transferred by Country","TOTAL AMOUNT TRANSFERRED":"TOTAL AMOUNT TRANSFERRED","TOTAL NUMBER OF CHILDREN REACHED":"TOTAL NUMBER OF CHILDREN REACHED","TOTAL NUMBER OF HOUSEHOLDS REACHED":"TOTAL NUMBER OF HOUSEHOLDS REACHED","TOTAL NUMBER OF INDIVIDUALS REACHED":"TOTAL NUMBER OF INDIVIDUALS REACHED","Individuals Reached by Age and Gender Groups":"Individuals Reached by Age and Gender Groups","Individuals with Disability Reached by Age Groups":"Individuals with Disability Reached by Age Groups",Programme:A0,"Report was created.":"Report was created.","Report create action failed.":"Report create action failed.","Export Data":"Export Data","The filters applied on the dashboard will be used for the reports.":"The filters applied on the dashboard will be used for the reports.","Select types of reports to be exported":"Select types of reports to be exported","Report Type":"Report Type","Upon clicking export button, report will be generated and send to your email address when ready.":"Upon clicking export button, report will be generated and send to your email address when ready.",CANCEL:_0,Export:P0,"Administrative Area 2":"Administrative Area 2","Total Transferred":"Total Transferred","Households Reached":"Households Reached","Version mismatch, please refresh page":"Version mismatch, please refresh page",Status:C0,"Creation Date":"Creation Date",Assignee:E0,None:v0,"Grievance Tickets List":"Grievance Tickets List","Look up Household / Individual":"Look up Household / Individual","Household ID":"Household ID","Individual ID":"Individual ID","LOOK UP HOUSEHOLD":"LOOK UP HOUSEHOLD","LOOK UP INDIVIDUAL":"LOOK UP INDIVIDUAL","Look up for":"Look up for:","Identity Verified*":"Identity Verified*",SAVE:S0,Search:I0,"Registration Date":"Registration Date",From:D0,To:T0,"Household Size":"Household Size",Clear:R0,Apply:F0,Gender:N0,Male:L0,Female:O0,"Look up Payment Record":"Look up Payment Record","Payment ID":"Payment ID","Reassign Role":"Reassign Role","Role Reassigned":"Role Reassigned","Reassign To Unique Individual":"Reassign To Unique Individual","Look up Linked Ticket":"Look up Linked Ticket","Ticket ID":"Ticket ID",FSP:k0,"Individual Data":"Individual Data","Core Fields":"Core Fields","Flex Fields":"Flex Fields","Add Document":"Add Document","Add documentation":"Add documentation","Add Identity":"Add Identity",GENDER:w0,"You did not approve the following add individual data. Are you sure you want to continue?":"You did not approve the following add individual data. Are you sure you want to continue?","You are approving the following Add individual data. Are you sure you want to continue?":"You are approving the following Add individual data. Are you sure you want to continue?","Changes Disapproved":"Changes Disapproved","Changes Approved":"Changes Approved",Disapprove:M0,Approve:$0,Country:U0,Agency:V0,"Identity Number":"Identity Number","Do you give your consent to UNICEF and its partners to view, edit and update your personal details and, if applicable, that of your household and dependants the purpose of the integrity UNICEFs beneficiary management system? Do you declare that the information you have provided is true and correct to the best of your knowledge?":"Do you give your consent to UNICEF and its partners to view, edit and update your personal details and, if applicable, that of your household and dependants the purpose of the integrity UNICEFs beneficiary management system? Do you declare that the information you have provided is true and correct to the best of your knowledge?","Grievance and Feedback":"Grievance and Feedback","Grievance Tickets created":"Grievance Tickets created","Grievance Ticket created.":"Grievance Ticket created.","Received Consent*":"Received Consent*","Assigned to*":"Assigned to*","Administrative Level 2":"Administrative Level 2","Area / Village / Pay point":"Area / Village / Pay point","Languages Spoken":"Languages Spoken",Cancel:B0,Save:G0,"You did not approve the following individual to be withdrawn. Are you sure you want to continue?":"You did not approve the following individual to be withdrawn. Are you sure you want to continue?","You are approving the following individual to be withdrawn. Are you sure you want to continue?":"You are approving the following individual to be withdrawn. Are you sure you want to continue?","Individual to be withdrawn":"Individual to be withdrawn",Warning:z0,Type:q0,"Document Number":"Document Number","Grievance Ticket edited.":"Grievance Ticket edited.","Edit Ticket":"Edit Ticket","Category*":"Category*","Sub Category":"Sub Category","Issue Type*":"Issue Type*","Current Value":"Current Value",Field:H0,"You have to select a household earlier":"You have to select a household earlier","Add new field":"Add new field","Household Data":"Household Data",Yes:W0,No:K0,"You have to select an individual earlier":"You have to select an individual earlier",Documents:Y0,Identities:Q0,"ID TYPE1":"ID TYPE1","ID Number":"ID Number",REMOVED:X0,"ID AGENCY1":"ID AGENCY1","Are you sure you want to confirm flag (sanction list match) ?":"Are you sure you want to confirm flag (sanction list match) ?","Are you sure you want to remove the flag ?":"Are you sure you want to remove the flag ?","Flag Details":"Flag Details","REMOVE FLAG":"REMOVE FLAG","CONFIRM FLAG":"CONFIRM FLAG","Ref. No. on Sanction List":"Ref. No. on Sanction List","Full Name":"Full Name","Date of Birth":"Date of Birth","National Ids":"National Ids",Source:J0,"Golden Record":"Golden Record","Sanction List":"Sanction List",STATUS:Z0,Category:ek,"Issue Type":"Issue Type","HOUSEHOLD ID":"HOUSEHOLD ID","INDIVIDUAL ID":"INDIVIDUAL ID","PAYMENT ID":"PAYMENT ID",CONSENT:sk,"CREATED BY":"CREATED BY","Date Created":"Date Created","Last Modified Date":"Last Modified Date",DESCRIPTION:tk,"Assigned to":"Assigned to","ADMINISTRATIVE LEVEL 2":"ADMINISTRATIVE LEVEL 2","AREA / VILLAGE / PAY POINT":"AREA / VILLAGE / PAY POINT","LANGUAGES SPOKEN":"LANGUAGES SPOKEN",Details:ak,"You approved 0 changes, remaining proposed changes will be automatically rejected upon ticket closure.":"You approved 0 changes, remaining proposed changes will be automatically rejected upon ticket closure.","You did not approve any changes. Are you sure you want to close the ticket?":"You did not approve any changes. Are you sure you want to close the ticket?","You did not approve any changes.":"You did not approve any changes.","By continuing you acknowledge that individuals in this ticket were reviewed and all were deemed unique to the system. No duplicates were found":"By continuing you acknowledge that individuals in this ticket were reviewed and all were deemed unique to the system. No duplicates were found","Are you sure you want to close the ticket?":"Are you sure you want to close the ticket?","This ticket will be closed without running the deduplication process.":"This ticket will be closed without running the deduplication process."," By continuing you acknowledge that individuals in this ticket was compared with sanction list. No matches were found":" By continuing you acknowledge that individuals in this ticket was compared with sanction list. No matches were found","Close Ticket":"Close Ticket","Duplicate Document Conflict":"Duplicate Document Conflict","The individuals have matching document numbers. HOPE requires that document numbers are unique. Please resolve before closing the ticket.":"The individuals have matching document numbers. HOPE requires that document numbers are unique. Please resolve before closing the ticket.",Edit:nk,"ASSIGN TO ME":"ASSIGN TO ME","Set to in progress":"Set to in progress","Set On Hold":"Set On Hold","Send For Approval":"Send For Approval","Send Back":"Send Back","NEW TICKET":"NEW TICKET","Are you sure you want to mark this record as duplicate? It will be removed from Golden Records upon ticket closure.":"Are you sure you want to mark this record as duplicate? It will be removed from Golden Records upon ticket closure.","Needs Adjudication Details":"Needs Adjudication Details","Are you sure you want to mark these records as duplicates? They will be removed from Golden Records upon ticket closure.":"Are you sure you want to mark these records as duplicates? They will be removed from Golden Records upon ticket closure.","Create Linked Ticket":"Create Linked Ticket",Confirmation:ik,"Mark as Duplicate":"Mark as Duplicate","Similarity Score":"Similarity Score","Last Registration Date":"Last Registration Date","Doc Type":"Doc Type","Doc #":"Doc #","Admin Level 2":"Admin Level 2",Village:rk,"Note cannot be empty":"Note cannot be empty","Add New Note":"Add New Note","Other Related Tickets":"Other Related Tickets","Closed Tickets":"Closed Tickets","SHOW CLOSED TICKETS":"SHOW CLOSED TICKETS","For Household":"For Household",Tickets:lk,"HIDE CLOSED TICKETS":"HIDE CLOSED TICKETS","Past tickets":"Past tickets","No past tickets":"No past tickets","TICKET ID":"TICKET ID","Payment Ids":"Payment Ids",ROLE:ok,"Individual is the HOH or the collector for the household":"Individual is the HOH or the collector for the household","Upon removing you will need to select new individual(s) for this role.":"Upon removing you will need to select new individual(s) for this role.","Head of Household":"Head of Household","Requested Data Change":"Requested Data Change",EDIT:dk,"Type of Data":"Type of Data","New Value":"New Value",Previous:ck,Current:uk,Value:hk,"ID Type":"ID Type",Number:"Number","Documents to be added":"Documents to be added","Identities to be added":"Identities to be added","Documents to be removed":"Documents to be removed","Identities to be removed":"Identities to be removed","There is an open ticket(s) in the same category for the related entity. Please review them before proceeding.":"There is an open ticket(s) in the same category for the related entity. Please review them before proceeding.","VIEW SANCTION LIST":"VIEW SANCTION LIST","Sanction List View":"Sanction List View","Reference Number":"Reference Number",CLOSE:mk,"Error during activating.":"Error during activating.","Verification plan has been activated.":"Verification plan has been activated.",ACTIVATE:pk,"Activate Verification Plan":"Activate Verification Plan","Are you sure you want to activate the Verification Plan for this Payment Plan?":"Are you sure you want to activate the Verification Plan for this Payment Plan?","CREATE GRIEVANCE TICKETS":"CREATE GRIEVANCE TICKETS","Create Grievance Tickets":"Create Grievance Tickets",Continue:gk,"You will generate":"You will generate","grievance ticket":"grievance ticket","Are you sure you want to continue?":"Are you sure you want to continue?","Error while submitting":"Error while submitting","New verification plan created.":"New verification plan created.","CREATE VERIFICATION PLAN":"CREATE VERIFICATION PLAN","Create Verification Plan":"Create Verification Plan","FULL LIST":"FULL LIST","RANDOM SAMPLING":"RANDOM SAMPLING","Filter Out Administrative Level Areas":"Filter Out Administrative Level Areas","This option is recommended for RapidPro":"This option is recommended for RapidPro","Verification Channel":"Verification Channel","RapidPro Flow":"RapidPro Flow","Confidence Interval":"Confidence Interval","Margin of Error":"Margin of Error","Cluster Filters":"Cluster Filters","Administrative Level":"Administrative Level","Age of HoH":"Age of HoH","Gender of HoH":"Gender of HoH","Minimum Age":"Minimum Age","Maximum Age":"Maximum Age","Verification plan has been discarded.":"Verification plan has been discarded.","Discard Verification Plan":"Discard Verification Plan","Are you sure you would like to remove payment verification records":"Are you sure you would like to remove payment verification records","and restart the verification process?":"and restart the verification process?",DISCARD:xk,"Verification plan edited.":"Verification plan edited.","EDIT VERIFICATION PLAN":"EDIT VERIFICATION PLAN","Edit Verification Plan":"Edit Verification Plan","Verification plan has been finished":"Verification plan has been finished",Finish:fk,"Finish Verification Plan":"Finish Verification Plan",Only:yk,"of the beneficiaries have responded to this payment verification.":"of the beneficiaries have responded to this payment verification.","Are you sure that you want to finish?":"Are you sure that you want to finish?","Closing this verification will generate":"Closing this verification will generate","grievance tickets":"grievance tickets",FINISH:bk,"Payment Record Details":"Payment Record Details","STATUS DATE":"STATUS DATE","REGISTRATION GROUP":"REGISTRATION GROUP","TARGET POPULATION":"TARGET POPULATION","DISTRIBUTION MODALITY":"DISTRIBUTION MODALITY","Verification Details":"Verification Details","AMOUNT RECEIVED":"AMOUNT RECEIVED","HEAD OF HOUSEHOLD":"HEAD OF HOUSEHOLD","TOTAL PERSON COVERED":"TOTAL PERSON COVERED","PHONE NUMBER":"PHONE NUMBER","ALT. PHONE NUMBER":"ALT. PHONE NUMBER","Entitlement Details":"Entitlement Details","ENTITLEMENT QUANTITY":"ENTITLEMENT QUANTITY","DELIVERED QUANTITY":"DELIVERED QUANTITY",CURRENCY:jk,"DELIVERY TYPE":"DELIVERY TYPE","DELIVERY DATE":"DELIVERY DATE","ENTITLEMENT CARD ID":"ENTITLEMENT CARD ID","TRANSACTION REFERENCE ID":"TRANSACTION REFERENCE ID","ENTITLEMENT CARD ISSUE DATE":"ENTITLEMENT CARD ISSUE DATE","Payment has been verified.":"Payment has been verified.",Verify:Ak,"Verify Payment":"Verify Payment",Received:_k,"Not Received":"Not Received","Amount Received":"Amount Received","Cash+":"Cash+","Enrolled in nutrition programme":"Enrolled in nutrition programme","Administratiion of rutf":"Administratiion of rutf","Residence Status":"Residence Status","FEMALE CHILD HEADED HOUSEHOLD":"FEMALE CHILD HEADED HOUSEHOLD","CHILD HEADED HOUSEHOLD":"CHILD HEADED HOUSEHOLD","Country of Origin":"Country of Origin",Address:Pk,"Administrative Level 1":"Administrative Level 1",Geolocation:Ck,"UNHCR CASE ID":"UNHCR CASE ID","LENGTH OF TIME SINCE ARRIVAL":"LENGTH OF TIME SINCE ARRIVAL","NUMBER OF TIMES DISPLACED":"NUMBER OF TIMES DISPLACED","IS THIS A RETURNEE HOUSEHOLD?":"IS THIS A RETURNEE HOUSEHOLD?",Benefits:Ek,"Cash received":"Cash received","Total Cash Received":"Total Cash Received",Vulnerabilities:vk,"Bio Data":"Bio Data","Given Name":"Given Name","Middle Name":"Middle Name","Family Name":"Family Name","Estimated Date of Birth":"Estimated Date of Birth","Marital Status":"Marital Status","Work Status":"Work Status",Pregnant:Sk,Role:Ik,"Relationship to HOH":"Relationship to HOH","Observed disabilities":"Observed disabilities","Seeing disability severity":"Seeing disability severity","Hearing disability severity":"Hearing disability severity","Physical disability severity":"Physical disability severity","Remembering or concentrating disability severity":"Remembering or concentrating disability severity","Self-care disability severity":"Self-care disability severity","Communicating disability severity":"Communicating disability severity","Phone Number":"Phone Number","Alternative Phone Number":"Alternative Phone Number","Date of last screening against sanctions list":"Date of last screening against sanctions list","Show Photo":"Show Photo",Individual:Dk,Photo:Tk,TIMEFRAME:Rk,status:Fk,"Frequency of payments":"Frequency of payments","Budget (USD)":"Budget (USD)","Population Goal (# of Individuals)":"Population Goal (# of Individuals)","Num. of Households":"Num. of Households","Num. of Recipients":"Num. of Recipients",SECTOR:Nk,"Programme Details":"Programme Details","START DATE":"START DATE","END DATE":"END DATE",Sector:Lk,Scope:Ok,"Frequency of Payment":"Frequency of Payment","Administrative Areas of implementation":"Administrative Areas of implementation",Description:kk,"Does this programme use individuals’ data for targeting or entitlement calculation?":"Does this programme use individuals’ data for targeting or entitlement calculation?","Total Number of Households":"Total Number of Households","Report type is required":"Report type is required","Date From is required":"Date From is required","End date have to be greater than":"End date have to be greater than","Date To is required":"Date To is required","Completion Date":"Completion Date","Delivery Date":"Delivery Date","End Date":"End Date","NEW REPORT":"NEW REPORT","Generate New Report":"Generate New Report","From Date":"From Date","To Date":"To Date",GENERATE:wk,"No data":"No data","Try adjusting your search or your filters to find what you are looking for.":"Try adjusting your search or your filters to find what you are looking for.","Target Population Entries (Households)":"Target Population Entries (Households)","Add targeting criteria to see results.":"Add targeting criteria to see results.",Add:Mk,Filter:$k,"Add Filter":"Add Filter",Score:Uk,"You need to select at least one targeting criteria":"You need to select at least one targeting criteria","Target Population Updated":"Target Population Updated","Enter Target Population Name":"Enter Target Population Name","Select Field":"Select Field","Programme Change":"Programme Change","Are you sure you want to change the programme?":"Are you sure you want to change the programme?","Changing the programme will result in deleting your current Targeting Criteria.":"Changing the programme will result in deleting your current Targeting Criteria.","Female Children":"Female Children","Female Adults":"Female Adults","Male Children":"Male Children","Male Adults":"Male Adults","Targeted Individuals":"Targeted Individuals","Programme population close date":"Programme population close date","Send by":"Send by","Send date":"Send date","Selected programme that the Target Population is created for":"Selected programme that the Target Population is created for",Partner:Vk,"Partner*":"Partner*",Module:Bk,Error:"Error","Payment Plan Details":"Payment Plan Details","Plan Start Date":"Plan Start Date","Plan End Date":"Plan End Date","cash plan name":"cash plan name","delivery type":"delivery type","assistance through":"assistance through","dispertion date":"dispertion date","fc id":"fc id","dp id":"dp id","Target population(s)":"Target population(s)","UPLOAD FILE":"UPLOAD FILE","Permission Denied":"Permission Denied","Ask the Administrator to get access to this page":"Ask the Administrator to get access to this page","Programme activated.":"Programme activated.","Programme activate action failed.":"Programme activate action failed.","Activate Programme":"Activate Programme","Are you sure you want to activate this Programme?":"Are you sure you want to activate this Programme?","Programme create action failed.":"Programme create action failed.","New Programme":"New Programme","Set-up a new Programme":"Set-up a new Programme","Programme removed.":"Programme removed.","Programme remove action failed.":"Programme remove action failed.","Remove Programme":"Remove Programme","Are you sure you want to remove this Programme?":"Are you sure you want to remove this Programme?",REMOVE:Gk,"Programme edited.":"Programme edited.","EDIT PROGRAMME":"EDIT PROGRAMME","Edit Programme Details":"Edit Programme Details","Programme finished.":"Programme finished.","Programme finish action failed.":"Programme finish action failed.","Finish Programme":"Finish Programme","Are you sure you want to finish this Programme?":"Are you sure you want to finish this Programme?","Programme reactivated.":"Programme reactivated.","Programme reactivate action failed.":"Programme reactivate action failed.",Reactivate:zk,"Reactivate Programme":"Reactivate Programme","Are you sure you want to reactivate this Programme?":"Are you sure you want to reactivate this Programme?",REACTIVATE:qk,All:Hk,"Field Type":"Field Type","Field List":"Field List","Targeting Diagram":"Targeting Diagram","Lock Target Population":"Lock Target Population","Target Population":"Target Population","After you lock this Target Population, the selected criteria will no longer accept new households that may get merged to Population in the future.":"After you lock this Target Population, the selected criteria will no longer accept new households that may get merged to Population in the future.","Note: You may duplicate the Programme Population target criteria at any time.":"Note: You may duplicate the Programme Population target criteria at any time.",Lock:Wk,"Target Population Locked":"Target Population Locked","Delete Target Population":"Delete Target Population","Are you sure you want to remove this Target Population?":"Are you sure you want to remove this Target Population?",Delete:Kk,"Target Population Duplicated":"Target Population Duplicated","Please use a unique name for the copy of this Target Population.":"Please use a unique name for the copy of this Target Population.",Note:Yk,"This duplicate will copy the Target Criteria of the Programme Population and update to the latest results from the system.":"This duplicate will copy the Target Criteria of the Programme Population and update to the latest results from the system.","Name Copy of Target Population":"Name Copy of Target Population","Target Population Finalized":"Target Population Finalized","Send to Cash Assist":"Send to Cash Assist","Are you sure you want to push":"Are you sure you want to push","households to CashAssist? Target population will not be editable further.":"households to CashAssist? Target population will not be editable further.","Send to cash assist":"Send to cash assist","Programme name is required":"Programme name is required","Too short":"Too short","Too long":"Too long","CashAssist Scope is required":"CashAssist Scope is required","Start Date is required":"Start Date is required","End Date is required":"End Date is required","End Date cannot be in the past":"End Date cannot be in the past","Sector is required":"Sector is required","Number is too big":"Number is too big","This programme will use only household and/or head of household details for targeting or entitlement calculation":"This programme will use only household and/or head of household details for targeting or entitlement calculation","This programme will use household member individuals’ details for targeting or entitlement calculation. Setting this flag can reduce the number of households filtered in the target population.":"This programme will use household member individuals’ details for targeting or entitlement calculation. Setting this flag can reduce the number of households filtered in the target population.","To create a new Programme, please complete all required fields on the form below and save.":"To create a new Programme, please complete all required fields on the form below and save.","Programme Name":"Programme Name","CashAssist Scope":"CashAssist Scope","Start Date":"Start Date","Administrative Areas of Implementation":"Administrative Areas of Implementation","Data for targeting or entitlement calculation*":"Data for targeting or entitlement calculation*",And:Qk,"Add Next Rule":"Add Next Rule","Payment Plan":"Payment Plan","Open in CashAssist":"Open in CashAssist",Targeting:Xk,"Target Population Created":"Target Population Created","All charts below show total numbers for the selected year.":"All charts below show total numbers for the selected year.",Dashboard:Jk,"Number of Programmes by Sector":"Number of Programmes by Sector","Total Transferred by Month":"Total Transferred by Month","Volume by Delivery Mechanism in USD":"Volume by Delivery Mechanism in USD","Delivery Type":"Delivery Type","Login via Active Directory":"Login via Active Directory","Sign in":"Sign in","PROGRAMME NAME":"PROGRAMME NAME","PROGRAMME ID":"PROGRAMME ID","PAYMENT RECORDS":"PAYMENT RECORDS","Bank reconciliation":"Bank reconciliation",SUCCESSFUL:Zk,ERRONEOUS:ew,"Verification Plan Details":"Verification Plan Details",SAMPLING:sw,RESPONDED:tw,"RECEIVED WITH ISSUES":"RECEIVED WITH ISSUES","VERIFICATION CHANNEL":"VERIFICATION CHANNEL","SAMPLE SIZE":"SAMPLE SIZE",RECEIVED:aw,"NOT RECEIVED":"NOT RECEIVED","ACTIVATION DATE":"ACTIVATION DATE","COMPLETION DATE":"COMPLETION DATE",PENDING:nw,"To see more details please activate Verification Plan":"To see more details please activate Verification Plan","To see more details please create Verification Plan":"To see more details please create Verification Plan","Registration Details":"Registration Details","Import name":"Import name","User name":"User name","Data Collection":"Data Collection","Start time":"Start time","End time":"End time","Device ID":"Device ID",Individuals:iw,"To see more details please Activate your Programme":"To see more details please Activate your Programme","All data will be pushed to CashAssist. You can edit this plan even if it is active.":"All data will be pushed to CashAssist. You can edit this plan even if it is active.",Reporting:rw,Timeframe:lw,"Created By":"Created By","DOWNLOAD REPORT":"DOWNLOAD REPORT","Report was successfully generated and sent to email address of the creator.":"Report was successfully generated and sent to email address of the creator.","ADMINISTRATIVE LEVEL 1":"ADMINISTRATIVE LEVEL 1",issued:ow,Duplicates:dw,"within batch ":"within batch ","Duplicates of":"Duplicates of","against population ":"against population ","are listed below.":"are listed below.","Proximity to the Score":"Proximity to the Score","Not provided":"Not provided","Error while merging Registration Data Import":"Error while merging Registration Data Import","Registration Data Import Merging started":"Registration Data Import Merging started",Merge:cw,"Merge Import":"Merge Import","Are your sure you want to merge this data import?":"Are your sure you want to merge this data import?","households and":"households and","individuals will be merged.":"individuals will be merged.","Do you want to proceed?":"Do you want to proceed?",MERGE:uw,"Import Preview":"Import Preview","View Tickets":"View Tickets","Registration Data import":"Registration Data import","Rerun Deduplication":"Rerun Deduplication","Are your sure you want to rerun deduplication?":"Are your sure you want to rerun deduplication?",Rerun:hw,"Apply Additional Formula":"Apply Additional Formula","Households available to Import":"Households available to Import","Individuals available to Import":"Individuals available to Import","File size is to big. It should be under 200MB":"File size is to big. It should be under 200MB","File size is":"File size is","Only approved submissions":"Only approved submissions","Pull pictures":"Pull pictures","Import from":"Import from","Kobo Project":"Kobo Project",IMPORT:mw,Title:pw,"DOWNLOAD TEMPLATE":"DOWNLOAD TEMPLATE","Import Date":"Import Date","List of Imports":"List of Imports",Households:gw,"Payment Records":"Payment Records","List of Payment Plans":"List of Payment Plans",DOWNLOAD:xw,"Target Populations":"Target Populations","Users List":"Users List",Filters:fw,SHOW:yw,"Verification Status":"Verification Status",EXPORT:bw,"Verification Records":"Verification Records","Household Composition":"Household Composition","Age Group":"Age Group",Females:jw,"with disability":"with disability",Males:Aw,Flags:_w,"Select Project":"Select Project","Sanction List Confirmed Match":"Sanction List Confirmed Match","Possible Duplicate":"Possible Duplicate","Possible Duplicates":"Possible Duplicates","Refuse Import":"Refuse Import",Resources:Pw,"Sanction List Possible Match":"Sanction List Possible Match","Houesehold has Duplicates":"Houesehold has Duplicates","Excluded Target Population Entries (Households or Individuals)":"Excluded Target Population Entries (Households or Individuals)",Reason:Cw,"Household or Individual IDs to exclude":"Household or Individual IDs to exclude","ID is not in the correct format":"ID is not in the correct format","Linked Households":"Linked Households","Formula is executing, please wait until completed":"Formula is executing, please wait until completed","Document to be edited":"Document to be edited","Document Type":"Document Type","Not updated":"Not updated","Show only Individuals from this household":"Show only Individuals from this household","Verification Plans Summary":"Verification Plans Summary","Activation Date":"Activation Date","Number of Verification Plans":"Number of Verification Plans","Import XLSX":"Import XLSX","Export XLSX":"Export XLSX","There are no payment records that could be assigned to a new verification plan.":"There are no payment records that could be assigned to a new verification plan."," When you close this ticket, the household that this Individual is a member of will be deactivated.":" When you close this ticket, the household that this Individual is a member of will be deactivated.","You did not approve the following household to be withdrawn. Are you sure you want to continue?":"You did not approve the following household to be withdrawn. Are you sure you want to continue?","You are approving the following household to be withdrawn. Are you sure you want to continue?":"You are approving the following household to be withdrawn. Are you sure you want to continue?","Household to be withdrawn":"Household to be withdrawn","Alternate Collector Issue":"Alternate Collector Issue","One of the Household members is an alternate collector. This household cannot be withdrawn.":"One of the Household members is an alternate collector. This household cannot be withdrawn.","Are you sure you would like to remove this verification plan?":"Are you sure you would like to remove this verification plan?","Payment Module":"Payment Module","Payment Plans":"Payment Plans","Dispersion Date":"Dispersion Date","Entitled Quantity":"Entitled Quantity","NEW PAYMENT PLAN":"NEW PAYMENT PLAN","New Payment Plan":"New Payment Plan","Select Target Population":"Select Target Population","Target Population is required":"Target Population is required",Currency:Ew,"Payment Details":"Payment Details","Delivered Value":"Delivered Value","Received Value":"Received Value","New Verified Value":"New Verified Value","Bank Account Number":"Bank Account Number","Bank Name":"Bank Name","Bank Branch Name":"Bank Branch Name","Bank Account Holder Name":"Bank Account Holder Name","NEW FSP":"NEW FSP","Set up FSP":"Set up FSP","Mobile Money":"Mobile Money","To be delivered USD":"To be delivered USD","Total Maximum Amount":"Total Maximum Amount","Set up order":"Set up order","Maximum Amount (USD)":"Maximum Amount (USD)","Add Delivery Mechanism":"Add Delivery Mechanism",Transfer:vw,Cash:Sw,Wallet:Iw,"Dispersion Start Date":"Dispersion Start Date","Dispersion End Date":"Dispersion End Date","Total Amount":"Total Amount","per FSP":"per FSP","Entitlement Formula":"Entitlement Formula","Select Entitlement Formula":"Select Entitlement Formula","Download Template":"Download Template","Upload File":"Upload File","Template contains payment list with all targeted households":"Template contains payment list with all targeted households","Payee List":"Payee List",Missing:Dw,"Payment Plan ID":"Payment Plan ID","is also included in the following Payment Plans":"is also included in the following Payment Plans",Unlock:Tw,Reject:Rw,Authorize:Fw,"Mark as Released":"Mark as Released","Download XLSX":"Download XLSX","Send to Fsp":"Send to Fsp",Name:Nw,"Vision Vendor Number":"Vision Vendor Number","Payment Channels":"Payment Channels","Suggest New Amount":"Suggest New Amount","Current Amount":"Current Amount","Proposed Amount":"Proposed Amount","Comment (Optional)":"Comment (Optional)","Linked Tickets":"Linked Tickets","To be delivered":"To be delivered","Maximum Amount":"Maximum Amount","New FSP":"New FSP","Are you sure you want to remove this FSP?":"Are you sure you want to remove this FSP?","Volume by Delivery Mechanism in":"Volume by Delivery Mechanism in",Preview:Lw,Comment:Ow,"Registration Data Import":"Registration Data Import","Assigned programme is not ACTIVE":"Assigned programme is not ACTIVE","Payment record has been marked as failed.":"Payment record has been marked as failed.","Mark as failed":"Mark as failed","Are you sure you would like to mark payment record as failed?":"Are you sure you would like to mark payment record as failed?","Linked Grievances":"Linked Grievances","Lock Payment Plan":"Lock Payment Plan","After you lock this Payment Plan, you will be able to run entitlement formula for selected target population.":"After you lock this Payment Plan, you will be able to run entitlement formula for selected target population.","There are":"There are","Note: ":"Note: ","'households that will be ignored in this Payment Plan.":"'households that will be ignored in this Payment Plan.","Are you sure you want to lock this Payment Plan?":"Are you sure you want to lock this Payment Plan?","Are you sure you want to approve this Payment Plan?":"Are you sure you want to approve this Payment Plan?","Note: Upon proceeding this payment plan will be automatically moved to locked status.":"Note: Upon proceeding this payment plan will be automatically moved to locked status.","Mark as released":"Mark as released","Note: You are the last reviewer. Upon proceeding, this Payment Plan will be automatically moved to accepted status":"Note: You are the last reviewer. Upon proceeding, this Payment Plan will be automatically moved to accepted status","Are you sure you want to mark this Payment Plan as reviewed?":"Are you sure you want to mark this Payment Plan as reviewed?","Are you sure you want to authorize this Payment Plan?":"Are you sure you want to authorize this Payment Plan?","Note: Upon Proceeding, this Payment Plan will be automatically moved to Finance Release stage.":"Note: Upon Proceeding, this Payment Plan will be automatically moved to Finance Release stage.",FSPs:kw,"Payment Plan Created":"Payment Plan Created","Dispersion Start Date is required":"Dispersion Start Date is required","End date has to be greater than":"End date has to be greater than","Dispersion End Date is required":"Dispersion End Date is required","Dispersion End Date cannot be in the past":"Dispersion End Date cannot be in the past","Dispersion End Date has to be greater than":"Dispersion End Date has to be greater than","Payment Plan Edited":"Payment Plan Edited","Edit Payment Plan":"Edit Payment Plan","Error during locking Payment Plan.":"Error during locking Payment Plan.","Payment Plan has been locked.":"Payment Plan has been locked.","Payment Plan has been rejected.":"Payment Plan has been rejected.","Error during rejecting Payment Plan.":"Error during rejecting Payment Plan.","Payment Plan has been approved.":"Payment Plan has been approved.","Error during approving Payment Plan.":"Error during approving Payment Plan.","Payment Plan has been authorized.":"Payment Plan has been authorized.","Error during authorizing Payment Plan.":"Error during authorizing Payment Plan.","Payment Plan has been marked as reviewed.":"Payment Plan has been marked as reviewed.","Error during marking Payment Plan as reviewed.":"Error during marking Payment Plan as reviewed.","Reject Payment Plan":"Reject Payment Plan",Approval:ww,Authorization:Mw,"Finance Release":"Finance Release","SHOW PREVIOUS":"SHOW PREVIOUS",Rejected:$w,"Are you sure you want to remove this Payment Plan?":"Are you sure you want to remove this Payment Plan?",Back:Uw,"Edit FSP":"Edit FSP","Payment Channel":"Payment Channel","Payment Channel Item":"Payment Channel Item","Add Payment Channel":"Add Payment Channel","Payment channels to be added":"Payment channels to be added","Re-Generate Report":"Re-Generate Report","Re-Generating Report":"Re-Generating Report","Re-Generating Report action failed.":"Re-Generating Report action failed.","Report is in processing status for over 30 min.":"Report is in processing status for over 30 min.","Please wait or re-generate report.":"Please wait or re-generate report.","Exporting...":"Exporting...","Download Xlsx":"Download Xlsx","Exporting XLSX started. Please check your email.":"Exporting XLSX started. Please check your email.","Delivery Mechanisms have been set":"Delivery Mechanisms have been set","FSPs have been assigned to the delivery mechanisms":"FSPs have been assigned to the delivery mechanisms","Total Entitled Quantity":"Total Entitled Quantity","Payment Plan FSPs are locked.":"Payment Plan FSPs are locked.","Error during FSP locking in Payment Plan.":"Error during FSP locking in Payment Plan.","Lock FSP":"Lock FSP","After you lock the FSP in this Payment Plan, you will be able to send the Payment Plan for approval.":"After you lock the FSP in this Payment Plan, you will be able to send the Payment Plan for approval.","Error during sending Payment Plan for approval.":"Error during sending Payment Plan for approval.","Payment Plan FSPs have been unlocked.":"Payment Plan FSPs have been unlocked.","Unlock FSP":"Unlock FSP","Are you sure you want to send":"Are you sure you want to send","households to HOPE? They will be accessible in Payment Module. Target population will not be editable further.":"households to HOPE? They will be accessible in Payment Module. Target population will not be editable further.","Mark Ready":"Mark Ready","Upload Reconciliation Info":"Upload Reconciliation Info","Save to see the list of households":"Save to see the list of households","List of households will be available after saving":"List of households will be available after saving","Reason of withdrawal":"Reason of withdrawal","Please provide the reason of withdrawal of this household.":"Please provide the reason of withdrawal of this household.",Confirm:Vw,"Household Id":"Household Id","This household is a duplicate of a household ID":"This household is a duplicate of a household ID","Grievance Dashboard":"Grievance Dashboard","SYSTEM-GENERATED":"SYSTEM-GENERATED","USER-GENERATED":"USER-GENERATED","TOTAL NUMBER OF TICKETS":"TOTAL NUMBER OF TICKETS","TOTAL NUMBER OF CLOSED TICKETS ":"TOTAL NUMBER OF CLOSED TICKETS","TICKETS AVERAGE RESOLUTION":"TICKETS AVERAGE RESOLUTION","Tickets by Status":"Tickets by Status","Tickets by Category":"Tickets by Category","Tickets by Category and Location":"Tickets by Category and Location","SHOW MORE LOCATIONS":"SHOW MORE LOCATIONS","ASSIGN TICKETS":"ASSIGN TICKETS",Priority:Bw,Urgency:Gw,"Active Tickets":"Active Tickets","All Tickets":"All Tickets","Tickets ID":"Tickets ID","Export Report":"Export Report","Upload Tickets":"Upload Tickets",Next:zw,"Not assigned":"Not assigned",Comments:qw,"Create a Data Change ticket":"Create a Data Change ticket","Select correctly answered questions (minimum 5)":"Select correctly answered questions (minimum 5):","Household Questionnaire":"Household Questionnaire","Individual Questionnaire":"Individual Questionnaire","Birth Date":"Birth Date","Individual Full Name":"Individual Full Name","Withdrawal Reason*":"Withdrawal Reason*","Description*":"Description*","Ticket already exists":"Ticket already exists","Tickets already exist":"Tickets already exist","Programme Title":"Programme Title",Message:Hw,"Title is required":"Title is required","Message is required":"Message is required","Field Selection is required":"Field Selection is required",Feedback:Ww,"Linked Grievance":"Linked Grievance","Create a ticket":"Create a ticket","Feedback created":"Feedback created","Feedback updated":"Feedback updated",Messages:Kw,Documentation:Yw,"Add another document":"Add another document","Add document":"Add document","Document Name":"Document Name",Communication:Qw,"New Survey":"New Survey","Survey created.":"Survey created.","Number of selected recipients":"Number of selected recipients","Survey Title":"Survey Title","Check Answers":"Check Answers","Are you sure you want to send this survey?":"Are you sure you want to send this survey?","New Survey with Rapid Pro":"New Survey with Rapid Pro","New Survey with SMS":"New Survey with SMS","New Survey with Manual Process":"New Survey with Manual Process","Are you sure you want to send this message?":"Are you sure you want to send this message?","Survey will be sent to all households selected":"Survey will be sent to all households selected","Message will be sent to all households selected":"Message will be sent to all households selected","You have selected households as the recipients group":"You have selected households as the recipients group","New message":"New message","Sort by":"Sort by","Uploaded file should contain entitlement for each household":"Uploaded file should contain entitlement for each household","Choose Delivery Mechanism":"Choose Delivery Mechanism","Assign FSP per Delivery Mechanism":"Assign FSP per Delivery Mechanism","Reconciliation Summary":"Reconciliation Summary","Payment has been marked as failed.":"Payment has been marked as failed.","Are you sure you would like to mark payment as failed?":"Are you sure you would like to mark payment as failed?","Households excluded":"Households excluded","Invalid household id":"Invalid household id","Create Follow-up Payment Plan":"Create Follow-up Payment Plan","Follow-up Payment Plan might be started just for unsuccessful payments":"Follow-up Payment Plan might be started just for unsuccessful payments","Withdrawn Household cannot be added into follow-up payment plan":"Withdrawn Household cannot be added into follow-up payment plan","Main Payment Plan Details":"Main Payment Plan Details","Follow-up Payment Plan Details":"Follow-up Payment Plan Details","Households excluded from Payment Plan":"Households excluded from Payment Plan","Show only Follow-up plans":"Show only Follow-up plans","All delivery mechanisms must have a FSP assigned":"All delivery mechanisms must have a FSP assigned","Exclude Households with Active Adjudication Ticket":"Exclude Households with Active Adjudication Ticket","Exclude Households with an Active Sanction Screen Flag":"Exclude Households with an Active Sanction Screen Flag","Households can only be excluded from a Payment Plan in status open or locked":"Households can only be excluded from a Payment Plan in status open or locked","Follow-up Payment Plan Edited":"Follow-up Payment Plan Edited","Households exclusion started":"Households exclusion started","Programme Users":"Programme Users","Surveys List":"Surveys List","Feedbacks List":"Feedbacks List","Messages List":"Messages List","Programme Duplicated":"Programme Duplicated","Copy Programme":"Copy Programme","Are you sure you want to erase RDI? Erasing RDI causes deletion of all related datahub RDI data":"Are you sure you want to erase RDI? Erasing RDI causes deletion of all related datahub RDI data","PDF generated. Please check your email.":"PDF generated. Please check your email.","Program has to be active to create a new Target Population":"Program has to be active to create a new Target Population","Program has to be active to create a Verification Plan":"Program has to be active to create a Verification Plan","There are no payment records that could be assigned to a new Verification Plan.":"There are no payment records that could be assigned to a new Verification Plan.","Preview Exclusion":"Preview Exclusion","Data Collecting Type is required":"Data Collecting Type is required","Registration Group":"Registration Group","Related Payment Id":"Related Payment Id","Failure Reason":"Failure Reason","Create Programme":"Create Programme","Edit Programme":"Edit Programme","To edit an existing Programme, please complete all required fields on the form below and save.":"To edit an existing Programme, please complete all required fields on the form below and save.","To create an new Programme, please complete all required fields on the form below and save.":"To create a new Programme, please complete all required fields on the form below and save.","Programme Partner":"Programme Partner","Provide info about Programme Partner and set Area Access":"Provide info about Programme Partner and set Area Access","The partner has access to the entire business area":"The partner has access to the entire business area","The partner will have access to the program's selected admin area(s):":"The partner will have access to the program's selected admin area(s):","Selected Admin Areas:":"Selected Admin Areas:","Targeting name should have at least 3 characters.":"Targeting name should have at least 3 characters.","Targeting name should have at most 255 characters.":"Targeting name should have at most 255 characters.","Area Access":"Area Access","DUPLICATE PROGRAMME":"DUPLICATE PROGRAMME","At least one partner is required":"At least one partner is required","Cross-Area Tickets":"Cross-Area Tickets","Area Scope":"Area Scope","All partners have been added":"All partners have been added","Select partner first":"Select partner first","Ticket Type":"Ticket Type","Debit Card Number":"Debit Card Number","Debit Card Issuer":"Debit Card Issuer","Account Holder Name":"Account Holder Name","Payment Plan Verification":"Payment Plan Verification","Partner Access":"Partner Access","Use Filters":"Use Filters","Use IDs":"Use IDs","Included Target Population Entries (Households or Individuals)":"Included Target Population Entries (Households or Individuals)","New Target Population":"New Target Population","Exclude People with Active Adjudication Ticket":"Exclude People with Active Adjudication Ticket","Edit Target Population":"Edit Target Population","Managerial Console":"Managerial Console","Payment Plans pending for Approval":"Payment Plans pending for Approval","Payment Plans pending for Authorization":"Payment Plans pending for Authorization","Payment Plans pending for Release":"Payment Plans pending for Release","Payment Verification Plans Overview":"Payment Verification Plans Overview","Selected Plans IDs":"Selected Plans IDs","Payment Plan(s) Approved":"Payment Plan(s) Approved","Payment Plan(s) Authorized":"Payment Plan(s) Authorized","Payment Plan(s) Released":"Payment Plan(s) Released","Action completed successfully":"Action completed successfully","Sent for Approval by":"Sent for Approval by","Approved by":"Approved by","Authorized by":"Authorized by","This individual is also included in other Payment Plans. Click this icon to view details.":"This individual is also included in other Payment Plans. Click this icon to view details.",AdditionalRegistrationInformation:Xw,"Delivery Mechanism Data to be edited":"Delivery Mechanism Data to be edited","Household Members":"Household Members","Programme Time Series Fields":"Programme Time Series Fields","Round Number":"Round Number","Round Name":"Round Name","Date of Collection":"Date of Collection","The Time Series Fields feature allows serial updating of individual data through an XLSX file.":"The Time Series Fields feature allows serial updating of individual data through an XLSX file.","Time Series Field Name":"Time Series Field Name","Data Type":"Data Type","Number of Expected Rounds":"Number of Expected Rounds","Are you sure you want to delete this field? This action cannot be reversed.":"Are you sure you want to delete this field? This action cannot be reversed.","Deleting Time Series Field":"Deleting Time Series Field","Please complete the PDU fields correctly.":"Please complete the PDU fields correctly.","Round Name is required":"Round Name is required","Mark as Distinct":"Mark as Distinct",Uniqueness:Jw,"Are you sure you want to clear the selected ids? They won't be marked as a duplicate or distinct anymore.":"Are you sure you want to clear the selected ids? They won't be marked as a duplicate or distinct anymore.","Include records with null value for the round":"Include records with null value for the round","Programme does not have defined fields for periodic updates.":"Programme does not have defined fields for periodic updates.","There are no records available":"There are no records available","Only Empty Values":"Only Empty Values","Open Biometrics Results":"Open Biometrics Results","Algorithm similarity score:":"Algorithm similarity score:","Face images matching suggests:":"Face images matching suggests:","Programme Partners updated.":"Programme Partners updated.","Select File to Upload":"Select File to Upload","The system accepts the following file extensions: XLSX, PDF, images (jpg, jpeg, png). File size must be ≤ 10MB.":"The system accepts the following file extensions: XLSX, PDF, images (jpg, jpeg, png). File size must be ≤ 10MB.","Deleting Supporting Document":"Deleting Supporting Document","You cannot upload more than 10 files.":"You cannot upload more than 10 files.","File deleted successfully.":"File deleted successfully.","FX Rate Applied":"FX Rate Applied","If displayed exchange rate differs from Vision, please contact your designated focal point for resolution. If displayed exchange rate differs from Vision, please contact your designated focal point for resolution":"If displayed exchange rate differs from Vision, please contact your designated focal point for resolution","View Biometrics Results":"View Biometrics Results","Individual Delivery Mechanisms":"Individual Delivery Mechanisms","Beneficiary Group":"Beneficiary Group","Password has been sent.":"Password has been sent.","Grievance Supporting Documents: upload of documents for the ticket":"Grievance Supporting Documents: upload of documents for the ticket","Documents: change/upload of document with other info (country, number etc.): add label beneficiary personal documents":"Documents: change/upload of document with other info (country, number etc.): add label beneficiary personal documents","Country Search":"Country Search","Abort Reason":"Abort Reason"},eM={en:{translation:Zw}};function sM(){return np.use(ip).init({resources:eM,lng:"en",keySeparator:!1,interpolation:{escapeValue:!1}})}Fa.register(rp,lp,op,dp,cp,up);Fa.defaults.font.family=vn;Fa.defaults.plugins.tooltip.padding=12;Fa.defaults.plugins.tooltip.cornerRadius=2;Fa.defaults.plugins.tooltip.mode="point";Fa.defaults.plugins.legend.position="bottom";Fa.defaults.plugins.legend.labels.usePointStyle=!0;Fa.defaults.plugins.legend.labels.boxWidth=8;sM();window.SENTRY_DSN&&hp({dsn:window.SENTRY_DSN,release:Rc.version,environment:window.SENTRY_ENVIRONMENT,ignoreErrors:["Permission Denied"],integrations:[mp({useEffect:Js.useEffect,useLocation:je,useNavigationType:yp,createRoutesFromChildren:fp,matchRoutes:xp}),pp({maskAllText:!0,blockAllMedia:!0})],replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1});const tM=gp.createRoot(document.getElementById("root"));tM.render(e.jsx(Js.StrictMode,{children:e.jsx(y0,{})}));
