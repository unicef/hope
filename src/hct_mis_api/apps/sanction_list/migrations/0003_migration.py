# Generated by Django 3.2.25 on 2025-06-12 11:41

import django.db.models.deletion
import strategy_field.fields
from django.db import migrations, models


def create_default_santionlist(apps, schema_editor):
    from strategy_field.fields import fqn

    from hct_mis_api.apps.sanction_list.strategies.un import UNSanctionList

    SanctionList = apps.get_model("sanction_list", "SanctionList")
    SanctionList.objects.get_or_create(
        pk=1,
        defaults={
            "name": "UN Sanction List",
            "strategy": fqn(UNSanctionList),
            "config": {
                "url": "https://scsanctions.un.org/resources/xml/en/consolidated.xml"
            },
        },
    )


class Migration(migrations.Migration):
    dependencies = [
        ("sanction_list", "0002_migration"),
    ]

    operations = [
        migrations.CreateModel(
            name="SanctionList",
            fields=[
                ("id", models.AutoField(primary_key=True)),
                ("created_at", models.DateTimeField(auto_now_add=True, db_index=True)),
                ("updated_at", models.DateTimeField(auto_now=True, db_index=True)),
                ("name", models.CharField(max_length=255)),
                ("config", models.JSONField(default=dict)),
                ("strategy", strategy_field.fields.StrategyField(unique=True)),
            ],
            options={
                "abstract": False,
            },
        ),
        migrations.RunPython(create_default_santionlist, migrations.RunPython.noop),
        migrations.AlterModelOptions(
            name="sanctionlistindividual",
            options={
                "ordering": ["-listed_on"],
                "verbose_name": "Individual",
                "verbose_name_plural": "Individuals",
            },
        ),
        migrations.AddField(
            model_name="sanctionlistindividual",
            name="sanction_list",
            field=models.ForeignKey(
                default=1,
                on_delete=django.db.models.deletion.CASCADE,
                to="sanction_list.sanctionlist",
            ),
            preserve_default=False,
        ),
    ]
